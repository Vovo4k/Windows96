/*****************************************
    *                                       *
    * Windows 96 - b12646.d0233cc9          *
    * Copyright (c) SYSTEM 36 2022.         *
    *                                       *
    * All external licenses apply           *
    *                                       *
    *****************************************/
//#SIG:A51D05037FED8257FEDF2B99CE31ECD887AC609FAD5F37A4644C70D6ACAF5A568C94B463C7D9E69697222EF257DC37B10C7FB2CA7DFF2CFCE79FC32AB04D48B7
Object.defineProperty(window.$96,'buildId',{get:a=>'12646.d0233cc9.220914-2311.fb4f3d1a22680f73f8b8',set:a=>console.warn('User is not in the sudoers file. This incident will be reported.')});/*! For license information please see kernel.js.LICENSE.txt */
(()=>{var __webpack_modules__={6434:(e,t,i)=>{"use strict";e=i.nmd(e);const r=i(2085),n=(e,t)=>function(){const i=e.apply(r,arguments);return`[${i+t}m`},o=(e,t)=>function(){const i=e.apply(r,arguments);return`[${38+t};5;${i}m`},s=(e,t)=>function(){const i=e.apply(r,arguments);return`[${38+t};2;${i[0]};${i[1]};${i[2]}m`};Object.defineProperty(e,"exports",{enumerable:!0,get:function(){const e=new Map,t={modifier:{reset:[0,0],bold:[1,22],dim:[2,22],italic:[3,23],underline:[4,24],inverse:[7,27],hidden:[8,28],strikethrough:[9,29]},color:{black:[30,39],red:[31,39],green:[32,39],yellow:[33,39],blue:[34,39],magenta:[35,39],cyan:[36,39],white:[37,39],gray:[90,39],redBright:[91,39],greenBright:[92,39],yellowBright:[93,39],blueBright:[94,39],magentaBright:[95,39],cyanBright:[96,39],whiteBright:[97,39]},bgColor:{bgBlack:[40,49],bgRed:[41,49],bgGreen:[42,49],bgYellow:[43,49],bgBlue:[44,49],bgMagenta:[45,49],bgCyan:[46,49],bgWhite:[47,49],bgBlackBright:[100,49],bgRedBright:[101,49],bgGreenBright:[102,49],bgYellowBright:[103,49],bgBlueBright:[104,49],bgMagentaBright:[105,49],bgCyanBright:[106,49],bgWhiteBright:[107,49]}};t.color.grey=t.color.gray;for(const i of Object.keys(t)){const r=t[i];for(const i of Object.keys(r)){const n=r[i];t[i]={open:`[${n[0]}m`,close:`[${n[1]}m`},r[i]=t[i],e.set(n[0],n[1])}Object.defineProperty(t,i,{value:r,enumerable:!1}),Object.defineProperty(t,"codes",{value:e,enumerable:!1})}const i=e=>e,a=(e,t,i)=>[e,t,i];t.color.close="[39m",t.bgColor.close="[49m",t.color.ansi={ansi:n(i,0)},t.color.ansi256={ansi256:o(i,0)},t.color.ansi16m={rgb:s(a,0)},t.bgColor.ansi={ansi:n(i,10)},t.bgColor.ansi256={ansi256:o(i,10)},t.bgColor.ansi16m={rgb:s(a,10)};for(let e of Object.keys(r)){if("object"!=typeof r[e])continue;const i=r[e];"ansi16"===e&&(e="ansi"),"ansi16"in i&&(t.color.ansi[e]=n(i.ansi16,0),t.bgColor.ansi[e]=n(i.ansi16,10)),"ansi256"in i&&(t.color.ansi256[e]=o(i.ansi256,0),t.bgColor.ansi256[e]=o(i.ansi256,10)),"rgb"in i&&(t.color.ansi16m[e]=s(i.rgb,0),t.bgColor.ansi16m[e]=s(i.rgb,10))}return t}})},2110:(e,t,i)=>{"use strict";i.d(t,{D:()=>p});var r=i(5690),n=i(6227),o=i(6110),s=i(1943);async function a(e){const t=`C:/system/local/lib/modules/${e}.json`;return!!await n.FS.exists(t)&&JSON.parse(await n.FS.readstr(t))}const l={WebAssembly:"This application requires WebAssembly support, which is currently not present in your runtime environment."};async function c(e,t={ui:!0}){for(let i of e){if("SWFSBridge"==i){if(await s.W.isOnline())continue;return t.ui&&r.O.create({icon:"error",body:"The Service Worker File System Bridge is not running. Check if any policy may be preventing the service worker from loading properly or try restarting your environment.",title:"Service Failure"}),!1}if(!o.o.has(i)){if(t.ui){let e=`Application requested feature "${i}" is not available on this system.<br><br>Contact the application publisher for additional assistance.`;l[i]&&(e=l[i]),r.O.create({icon:"error",body:e,title:"System Requirements Failure"})}return!1}}return!0}function d(e){return async function(t,i){const r={...i,ignoreJS:!1};let o,s=t;try{o=await a(s)}catch(e){console.error(`Failed to read module JSON ${s}. Please rectify this mistake.`),o=!1}if(!o&&"<anonymous>"!==e.modulePath){const t=n.FSUtil.deconstructFullPath(e.modulePath),i=t.prefix,r=""==t.path?"/":t.path,o=i+n.FSUtil.resolvePath(r,s);await n.FS.exists(o)&&(s=o)}if(s.endsWith(".js")&&!r.ignoreJS||o){o&&(s=o.libPath);let t=n.FSUtil.getParentPath(s);if(2==t.length&&(t+="/"),e.cachedModules[s])return e.cachedModules[s];const i={...e,modulePath:t,include:null};i.include=d(i);const r=await h(`\n            const module = {};\n\n            ${await n.FS.readstr(s)}\n\n            return module.exports;`).call(i);return e.cachedModules[s]=r,r}return s.endsWith(".json")?JSON.parse(await n.FS.readstr(s)):await n.FS.readstr(s)}}function h(e){return new Function(`\n    return (async function() {\n        const current = this;\n        const env = this.boxedEnv;\n\n        \nconst FS = w96.FS;\nconst FSUtil = w96.FSUtil;\nconst WApplication = w96.WApplication;\nconst StandardWindow = w96.StandardWindow;\nconst include = this.include;\nconst registerApp = (!w96.sys.reg) ? null : w96.sys.reg.registerApp;\nconst deregisterApp = (!w96.sys.reg) ? null : w96.sys.reg.deregisterApp;\nconst require_check = this.require_check;\n\n\n        ${e}\n    });`)()}const p={run:function(e,t){const i={include:null,require_check:c,cwd:"c:/user",scriptDir:"<anonymous>",modulePath:"<anonymous>",envType:"normal",boxedEnv:null,launchCommand:null,cachedModules:{},...t};return i.include=d(i),h(e).call(i)},runFile:async function(e,t){let i=n.FSUtil.getParentPath(e);return 2==i.length&&(i+="/"),await p.run(await n.FS.readstr(e),{cwd:i,scriptDir:i,modulePath:i,envType:"normal",launchCommand:e,boxedEnv:null,...t})},resolveModule:a}},2565:(e,t,i)=>{"use strict";i.d(t,{c:()=>d,z:()=>c});var r=i(9338),n=i(7612),o=i(5690),s=(i(6227),i(5563)),a=i(6482),l=i(4186);class c extends l.QP{constructor(){super()}async main(e,t){if(super.main(e),document.querySelector(".uam-applet"))return;const i=e.includes("--no-cancel"),l=this.createWindow({taskbar:!1,icon:await n.Q.getIconUrl("apps/uam","16x16"),center:!0,bodyClass:"uam-applet",initialWidth:280,initialHeight:180,resizable:!1,controlBoxStyle:i?"WS_CBX_NONE":"WS_CBX_CLOSE",title:"User Account Security",body:`\n            <div>\n                ${i?"Enter your user account password below. This password will be required on every boot.":"If you wish to prevent others from logging into your installation, you can enter a password below."}\n                <br>\n                <br>\n            </div>\n            <div>\n                <span>Current status: ${await(0,s.Ml)()?'<span class="status success">Password protected</span></span>':'<span class="status fail">Not secure</span></span>'}\n            </div>\n            <div class="pwd-input">\n                <div>Password:</div>\n                <input class="w96-textbox passwd" type="password">\n            </div>\n            <div class="buttons">\n                <button class="w96-button remove-pwd" disabled>Remove Pwd...</button>\n                <button class="w96-button apply">Apply</button>\n                <button class="w96-button cancel">Cancel</button>\n            </div>`},!0),c=l.getBodyContainer(),d=c.querySelector(".status");c.querySelector("button.cancel").addEventListener("click",(()=>l.close())),i&&(c.querySelector("button.cancel").disabled=!0);const h=c.querySelector("button.remove-pwd");h.addEventListener("click",(async()=>{(await a.Z.getConfig()).enabled?o.O.alert("If you remove your password, Remote Console will be disabled. Continue?",{title:"Warning",icon:"warning",buttons:[{text:"Cancel",action:"$close"},{text:"OK",action:async({dlg:e})=>{await a.Z.updateConfig({enabled:!1}),e.close(),h.click()}}]}):(await(0,s.Ew)(),r.jC.info("Security","Your logon password has been removed.","OK"),h.disabled=!0,d.className="status fail",d.innerText="Not secure",u.value="")})),await(0,s.Ml)()&&(h.disabled=!1);const p=c.querySelector("button.apply"),u=c.querySelector(".passwd");u.onkeydown=e=>{"Enter"===e.key&&p.click()},p.addEventListener("click",(async()=>{if(""!=u.value.trim()){try{await(0,s.Dj)("user",u.value)}catch(e){return void o.O.alert(`Your password could not be set. ${e}`,{title:"SAM Error",icon:"error"})}u.value="",i||r.jC.info("Security","Your logon password has now been set.","OK"),d.className="status success",d.innerText="Password protected",h.disabled=!1,"function"==typeof t&&t(),i&&l.close()}})),c.querySelector("input").focus(),l.show()}}const d=()=>{let e=new c;return new Promise((async(t,i)=>{await e.main(["--no-cancel"],t)}))}},5910:(e,t,i)=>{"use strict";i.r(t),i.d(t,{CtrlApplication:()=>A});var r=i(5690),n=i(7612),o=i(6999),s=i(5516),a=i(4186),l=i(2889),c=i(5544),d=i(6227);class h extends a.QP{constructor(){super()}async main(e){if(super.main(e),document.querySelector(".stormgr-applet"))return;const t=this.createWindow({taskbar:!1,icon:await n.Q.getIconUrl("apps/stormgr","16x16"),center:!0,bodyClass:"stormgr-applet",initialWidth:370,initialHeight:443,resizable:!1,controlBoxStyle:"WS_CBX_CLOSE",title:"Storage Manager",body:'<div class="tabc"></div>\n            <div class="buttons">\n                <button class="w96-button apply" disabled>Apply</button>\n                <button class="w96-button cancel">Cancel</button>\n                <button class="w96-button ok">OK</button>\n            </div>'},!0),i=t.getBodyContainer();i.classList.add("applet-base");const r=new c.a;await r.openPage(r.addPage("Usage",(async e=>{e.style.padding="10px",e.style.boxSizing="border-box",e.innerHTML=`<div class="icon-box">\n                <div class="icon stormgr" style="background-image: url(${await n.Q.getIconUrl("apps/stormgr")});"></div>\n                <div class="text">\n                    Your installation uses disk space to store data. Please note that the size figures below are estimated from all mounted file systems combined. \n                </div>\n            </div>\n            <div class="groupbox"></div>\n            <hr>\n            <div class="icon-box">\n                <div class="icon reinstall" style="background-image: url(${await n.Q.getIconUrl("apps/reinstall")});"></div>\n                <div class="text">\n                    If you wish to clear all data within your installation, you can reinstall your copy of Windows 96.\n                    <br><br>\n                    <span class="bold-noaa">WARNING: </span>All of your data will be removed and will not be recoverable!    \n                </div>\n            </div>\n            <div class="info">\n                To reinstall your copy of Windows 96, click the button below.<br>\n                <br><button class="w96-button reinstall">Reinstall</button>\n            </div>`;const t=await async function(){try{return await navigator.storage.estimate()}catch(e){return{quota:-1,usage:0}}}(),i=new l.E({body:`<span><span class="bold-noaa">Main Storage Backend: </span> ${d.FS.get("c:").driverName}</span><br>\n                <span><span class="bold-noaa">Cumulative Used: </span> ${(t.usage/1024/1024).toFixed(0)} MB</span><br>\n                <span><span class="bold-noaa">Cumulative Free Space: </span> ${((t.quota-t.usage)/1024/1024).toFixed(0)} MB</span><br>\n                <span><span class="bold-noaa">Disks Mounted: </span> ${d.FS.list().length}</span>`,title:"Statistics"});e.querySelector(".groupbox").replaceWith(i.getElement())}))),i.querySelector(".tabc").replaceWith(r.getElement()),i.querySelector("button.cancel").addEventListener("click",(()=>t.close())),i.querySelector("button.ok").addEventListener("click",(()=>t.close())),i.querySelector("button.reinstall").addEventListener("click",(()=>s.xP.execCmd("reinstall"))),t.show()}}var p=i(2565),u=i(9338),f=i(9182);class _ extends a.QP{constructor(){super()}async main(e){if(super.main(e),document.querySelector(".devcfg-applet"))return;const t=[{title:"iOS",icon:await n.Q.getIconUrl("devices/iphone"),sourceUrl:"/system/images/mobsupport-ios.zip",devId:"ios"},{title:"Android",icon:await n.Q.getIconUrl("devices/android"),sourceUrl:"/system/images/mobsupport-generic.zip",devId:"android"},{title:"PC/Other",icon:await n.Q.getIconUrl("devices/computer-alt"),sourceUrl:null,devId:null}],i=this.createWindow({taskbar:!1,icon:await n.Q.getIconUrl("apps/devcfg","16x16"),center:!0,bodyClass:"devcfg-applet",initialWidth:320,initialHeight:340,resizable:!1,controlBoxStyle:"WS_CBX_CLOSE",title:"Device Configuration",body:'<div class="info" style="margin-bottom: 24px;">Below you can choose a device profile to match the configuration of your device.<br><br>This may improve item navigation, useability, and UI sizing.</div>\n            <div class="groupbox"></div>\n            <br>\n            <div class="info" style="margin-bottom: 10px;">\n                PC/Other is the default profile used for Windows 96. If your device type is not listed here, your experience may suffer.\n            </div>\n            <br>\n            <div class="buttons" style="margin-top: 8px;">\n                <button class="w96-button ok">OK</button>\n            </div>'},!0),o=i.getBodyContainer(),s=new l.E({body:"",title:"Device Profiles"}).getElement();for(let e of t){const t=document.createElement("button");t.className="w96-button dp",t.style.backgroundImage=`url(${e.icon})`,t.innerText=e.title,t.addEventListener("click",(()=>{u.jC.confirm("Load this profile? Unsaved changes in your session will be lost!",(async t=>{if(t){try{if(await d.FS.exists("c:/system/etc/devprofiles/current.json")&&await d.FS.rm("c:/system/etc/devprofiles/current.json"),!e.devId)return localStorage.removeItem("mobile-mode"),localStorage.removeItem("mobile-mode-devtype"),void document.location.reload();let t=u.jC.idleProgress("DevCfg","Loading additional data...");await(0,f.N)(e.sourceUrl),t.closeDialog(),localStorage["mobile-mode"]="true",localStorage["mobile-mode-devtype"]=e.devId,document.location.reload()}catch(e){console.error("DevCfg error",e),r.O.create({body:"An error occured whilst applying the profile.",icon:"error",title:"Profile Error"})}i.close()}}))})),s.appendChild(t)}o.querySelector(".groupbox").replaceWith(s),o.querySelector("button.ok").addEventListener("click",(()=>i.close())),i.show()}}var g=i(225),m=i(4779);class b extends a.QP{constructor(){super(),this._blobs=[],this.cachedWp={},this.themes=[],this._mappedResources=[],this.applyStatus={wallpaper:null,wallpaperType:null,theme:null}}static async getWallpapers(){return await(await d.FS.readdir("c:/system/wallpapers")).aFilter((async e=>await d.FS.isFile(e)))}async reinitThemePreview(e){e.onload=async()=>{var t;for(let e of this._mappedResources)try{URL.revokeObjectURL(e.value)}catch(e){console.error(e)}this._mappedResources=[];const i=await(await fetch("/system/data/style-emu/index.html")).text();e.contentDocument.querySelector("html").innerHTML=i;e.contentDocument.body.querySelector(".user-desktop").setAttribute("style",document.body.querySelector(".user-desktop").getAttribute("style"));const r=e.contentDocument.createElement("style");r.textContent=document.querySelector("head>style").textContent,e.contentDocument.head.appendChild(r);const o=n.Q.registeredThemes[null!==(t=this.applyStatus.theme)&&void 0!==t?t:n.Q.currentTheme];if(o&&o.stylesheets){for(let e of o.resourceMap){if(null==e.id||null==e.path)continue;const t=d.FSUtil.resolvePath(o.path,e.path);try{this._mappedResources.push({id:e.id,value:URL.createObjectURL(await d.FS.toBlob(t))})}catch(e){console.error(`Error in mapped resource ${t}`),console.error(e)}}for(let t of o.stylesheets){const i=e.contentDocument.createElement("style");i.innerText=g.U.process(await d.FS.readstr(d.FSUtil.resolvePath(o.path,t)),{vars:this._mappedResources}),e.contentDocument.head.appendChild(i)}}},e.srcdoc=`<meta name="date" value="${Date.now()}">`}async main(e){if(super.main(e),document.querySelector(".laf-applet"))return;const t=this.createWindow({taskbar:!1,icon:await n.Q.getIconUrl("apps/laf","16x16"),center:!0,bodyClass:"laf-applet",initialWidth:404,initialHeight:455,resizable:!1,controlBoxStyle:"WS_CBX_CLOSE",title:"Display Properties",body:'<div class="tabc"></div>\n            <div class="buttons">\n                <button class="w96-button apply" disabled>Apply</button>\n                <button class="w96-button cancel">Cancel</button>\n                <button class="w96-button ok">OK</button>\n            </div>'},!0),i=t.getBodyContainer();i.classList.add("applet-base");const r=new c.a;r.openPage(r.addPage("Theme",(async e=>{e.style.padding="10px",e.style.boxSizing="border-box",e.classList.add("th"),e.innerHTML='<div class="info" style="margin-bottom: 16px;">\n                A theme is a set of icons, visual styles, and sounds to alter the core experience of the user interface.\n            </div>\n            <div style="margin-bottom: 8px;">Selected Theme:</div>\n            <select class="w96-textbox">\n                <option value="current">Current</option>\n            </select>\n            <div style="margin-bottom: 8px;margin-top: 8px;">Sample:</div>\n            <div class="theme-preview">\n                <iframe sandbox="allow-scripts allow-same-origin"></iframe>\n            </div>';const t=e.querySelector("iframe");this.reinitThemePreview(t);const r=e.querySelector("select"),o=Object.keys(n.Q.registeredThemes);for(let e of o){const t=n.Q.registeredThemes[e],i=document.createElement("option");i.value=e,i.innerText=t.name,r.appendChild(i)}r.addEventListener("change",(e=>{this.applyStatus.theme=r.options[r.selectedIndex].value,i.querySelector("button.apply").disabled=!1,this.reinitThemePreview(t)}))}))),r.addPage("Wallpaper",(async e=>{e.style.padding="10px",e.style.boxSizing="border-box",e.classList.add("wp"),e.innerHTML='<div class="wp-box">\n                <div class="preview"></div>\n            </div>\n            <div>Background:</div>\n            <div class="aside">\n                <div class="lbox"></div>\n                <div class="actions">\n                    <button class="w96-button browse">Browse</button>\n                    \n                    <div>Color:</div>\n                    <button style="margin: 0; padding-right: 3px; padding-left: 3px; width: 100%;" class="w96-button choosecolor">\n                        <div style="background: #000000; width: 100%; height: 15px;"></div>\n                    </button>\n                </div>\n            </div>';const t=new m.w,r=e.querySelector(".preview"),o=e.querySelector(".choosecolor");this.applyStatus.wallpaper&&("FS"==this.applyStatus.wallpaperType?r.style.backgroundImage=`url(${this.applyStatus.wallpaperBlob})`:"css"==this.applyStatus.wallpaperType&&(r.style.background=`${this.applyStatus.wallpaper}`));for(let e of await this.constructor.getWallpapers()){const i=t.addItem(d.FSUtil.fname(e),e),r=document.createElement("div");r.classList.add("icon"),r.style.backgroundImage=`url(${await n.Q.getFileIconUrl(e,"16x16")})`,i.prepend(r),i.addEventListener("click",(async()=>{this.setWp(e)}))}o.addEventListener("click",(()=>{let e=document.createElement("input");e.type="color",e.style.opacity="0%";let t=o.getBoundingClientRect();e.style.display="inline-block",e.style.position="absolute",e.style.left=t.x+"px",e.style.top=t.y+"px",document.body.appendChild(e),setTimeout((()=>{e.click(),setTimeout((()=>{e.style.left="-100px",e.style.top="-100px"}),100)}),100),e.onchange=()=>{document.body.removeChild(e),this.applyStatus.wallpaperBlob=null,this.applyStatus.wallpaper=e.value,this.applyStatus.wallpaperType="css",o.querySelector("div").style.background=e.value,r.style.backgroundColor=e.value,r.style.backgroundImage="",i.querySelector("button.apply").disabled=!1}})),e.querySelector(".lbox").replaceWith(t.getElement()),e.querySelector("button.browse").addEventListener("click",(()=>{new u.MT("c:/system/wallpapers",[".jpg",".JPG",".png",".PNG",".gif",".GIF",".webp",".WEBP"],(e=>{e&&this.setWp(e)})).show()}))})),i.querySelector(".tabc").replaceWith(r.getElement()),i.querySelector("button.cancel").addEventListener("click",(()=>t.close())),i.querySelector("button.ok").addEventListener("click",(async()=>{i.querySelector("button.ok").disabled=!0,i.querySelector("button.apply").disabled=!0,i.querySelector("button.cancel").disabled=!0,await this.applySettings(),t.close()})),i.querySelector("button.apply").addEventListener("click",(()=>this.applySettings())),t.show(),this.mainwnd=t}async setWp(e){const t=this.mainwnd.getBodyContainer(),i=t.querySelector("div.preview"),r=URL.createObjectURL(await d.FS.toBlob(e));i.style.backgroundImage=`url(${r})`,this._blobs.push(r),this.cachedWp[e]=r,this.applyStatus.wallpaperBlob=r,this.applyStatus.wallpaper=e,this.applyStatus.wallpaperType="FS",t.querySelector("button.apply").disabled=!1}ontermination(){for(let e of this._blobs)URL.revokeObjectURL(e);for(let e of this._mappedResources)URL.revokeObjectURL(e.value);this._mappedResources=[],this._blobs=null,this.cachedWp=null,this.mainwnd=null,this.themes=null}async applySettings(){this.mainwnd.getBodyContainer().querySelector("button.apply").disabled=!0;let e=document.querySelector(".ui-bg-iframe");if(e&&e.remove(),this.applyStatus.wallpaper){const e=JSON.parse(await d.FS.readstr("c:/system/config/desktop.json")),t=this.applyStatus.wallpaper;"FS"==this.applyStatus.wallpaperType?t.endsWith(".cbg")?(e.background.type="css",e.background.bg=await d.FS.readstr(t)):(e.background.type="local",e.background.bg=t):"css"==this.applyStatus.wallpaperType&&(e.background.type="css",e.background.bg=t),await w96.evt.shell.emit("config-modify",e)}if(this.applyStatus.theme&&"current"!==this.applyStatus.theme){console.log("Applying theme...");const e=document.createElement("div");e.classList.add("w96-ui-themewait"),e.innerHTML='<div class="box">Please wait...</div>',document.body.appendChild(e),await n.Q.applyTheme(this.applyStatus.theme),e.remove(),await d.FS.writestr("C:/system/config/theme.json",JSON.stringify({name:this.applyStatus.theme,overrides:{iconTheme:null,soundPack:null}},null,4)),w96.evt.ui.emit("reload-desktop")}n.Q.dropSoundCache(),this.applyStatus={wallpaper:null,wallpaperType:null,wallpaperBlob:null,theme:null}}}const y="C:/system/packages/configs/sources.json";async function v(e,t){const i=u.jC.idleProgress("Package Manager","Saving settings...");try{await d.FS.writestr(e,JSON.stringify(t,null,4))}catch(e){r.O.create({title:"Error",body:new String(e),icon:"error"})}i.closeDialog()}function w(e){return JSON.parse(JSON.stringify(e))}class x extends a.QP{constructor(){super()}async main(e){if(super.main(e),document.querySelector(".pkmgr-applet")||{}.pkm_settings)return;const t=this.createWindow({taskbar:!1,icon:await n.Q.getIconUrl("apps/pkmgr","16x16"),center:!0,bodyClass:"pkmgr-applet",initialWidth:370,initialHeight:243,resizable:!1,controlBoxStyle:"WS_CBX_CLOSE",title:"Package Manager Settings",body:'<div class="tabc"></div>\n            <div class="buttons">\n                <button class="w96-button close">Close</button>\n            </div>'},!0);await d.FS.exists("C:/system/packages/configs")||await d.FS.mkdir("C:/system/packages/configs");const i=t.getBodyContainer();i.classList.add("applet-base");const o=new c.a;o.openPage(o.addPage("Repositories",(async e=>{e.style.boxSizing="border-box",e.classList.add("repos-tab"),e.innerHTML='<div class="list-box"></div>\n            <div class="buttons">\n                <button class="w96-button add">Add</button>\n                <button class="w96-button remove">Remove</button>\n                <button class="w96-button reset">Reset</button>\n            </div>';const t=new m.w,i={sources:["https://packages.windows96.net/r3-main"],updateFrequency:2};let n;if(await d.FS.exists(y))try{n={...i,...JSON.parse(await d.FS.readstr(y))}}catch(e){console.error(e),n=w(i),r.O.alert("sources.json is corrupt. Any changes you make here will override it.",{icon:"error"})}else n=i;const o=e.querySelector("button.add"),s=e.querySelector("button.remove"),a=e.querySelector("button.reset");let l=null;const c=()=>{t.clear();for(let e of n.sources)t.addItem(e,e);0==n.sources.length?s.disabled=!0:s.disabled=!1,l=null};c(),t.onitemselected=e=>{l=e},o.addEventListener("click",(()=>{u.jC.prompt("Add new repository","Enter a repository URL below","",(e=>{if(null==e||""==e.trim())return;const t=function(e){let t=e;return t.endsWith("/")&&(t=t.substring(0,t.length-1)),t.trim()}(e);n.sources.includes(t)?r.O.alert("This source already exists.",{icon:"error",title:"Cannot add repository"}):(n.sources.push(t),c(),v(y,n))}))})),s.addEventListener("click",(()=>{u.jC.confirm("Are you sure you want to remove this repository?",(async e=>{e&&(n.sources.splice(n.sources.indexOf(l),1),await v(y,n),c())}),"warning")})),a.addEventListener("click",(()=>{u.jC.confirm("Are you sure you want to restore to defaults?",(async e=>{e&&(n=w(i),await v(y,n),c())}),"warning")})),e.querySelector(".list-box").replaceWith(t.getElement())}))),i.querySelector(".tabc").replaceWith(o.getElement()),i.querySelector("button.close").addEventListener("click",(()=>t.close())),t.show()}}var C=i(5563),S=i(6482),E=i(3970);class k extends a.QP{constructor(){super()}async main(e,t){if(super.main(e),document.querySelector(".rcon-applet"))return;const i=await S.Z.getConfig();let o=await S.Z.getConfig();const s=e.includes("--no-cancel"),a=await(0,C.Ml)(),l=this.createWindow({taskbar:!1,icon:await n.Q.getIconUrl("apps/rcon","16x16"),center:!0,bodyClass:"rcon-applet",initialWidth:280,initialHeight:a?124:161,resizable:!1,controlBoxStyle:s?"WS_CBX_NONE":"WS_CBX_CLOSE",title:"Remote Console settings",body:`\n            <span class="password-protected">\n                <img src="${await n.Q.getIconUrl("status/warning","16x16")}">\n                <span>A user account password needs to be set to enable this option.</span>\n            </span>\n            <span style="margin-bottom: 8px">\n                Remote Console lets users connect to this machine and execute scripts remotely using SuperTerm.\n            </span>\n            <div class="set"></div>\n            <div class="buttons">\n                <button class="w96-button apply">Apply</button>\n                <button class="w96-button cancel">Cancel</button>\n            </div>`},!0),c=l.getBodyContainer(),d=(c.querySelector(".status"),c.querySelector(".password-protected")),h=c.querySelector(".set"),p=new E.J({label:"Enable Remote Console",checked:o.enabled,onchange:e=>o.enabled=e.checked,displayAsBlock:!0}).getElement();h.replaceWith(p),a?d.remove():(p.style.opacity=.5,p.style.pointerEvents="none"),c.querySelector("button.cancel").addEventListener("click",(()=>l.close())),s&&(c.querySelector("button.cancel").disabled=!0);c.querySelector("button.apply").addEventListener("click",(async()=>{!i.enabled||o.enabled?(S.Z.updateConfig(o),"function"==typeof t&&t(),l.close()):r.O.alert("All active connections will be terminated. Continue?",{title:"Warning",icon:"warning",buttons:[{text:"Cancel",action:"$close"},{text:"OK",action:({dlg:e})=>{S.Z.updateConfig(o),"function"==typeof t&&t(),l.close(),e.close()}}]})})),l.show()}}var L=i(3991);class A extends a.QP{constructor(){super(),this.panelApplets={uam:p.z,stormgr:h,devcfg:_,laf:b,pkmgr:x,rcon:k}}async main(e){super.main(e);let t=!1;if(e.forEach((async(i,r,n)=>{if("--cpl"==i&&null!=n[r+1]){const i=n[r+1];if(console.log("Launching applet "+i),null==this.panelApplets[i])return;return t=!0,await a.QP.execAsync(new this.panelApplets[i],e),void console.log("Applet finished.")}})),!t)return this._blobsToDeregister=[],await this._createWindow()}async _createWindow(){let e=document.querySelector(".ctrl-app");if(e){this.terminate();let t=e.parentElement.parentElement.associatedWindow;return t.activate(),void(t.minimized&&t.toggleMinimize())}const t=[{caption:"System Tasks",items:[{label:"About Windows 96",onclick:()=>s.xP.execCmd("about-ui")},{label:"OS Flags",onclick:()=>s.xP.execCmd("flags")}]}],i=[{category:"Appearance"},{caption:"Dynamic Wallpaper",icon:await n.Q.getIconUrl("apps/dynwp"),onclick:()=>s.xP.execCmd("dynwp-prefs")},{caption:"Look and Feel",icon:await n.Q.getIconUrl("apps/laf"),onclick:()=>s.xP.execCmd("ctrl",["--cpl","laf"])},{caption:"Window Manager",icon:await n.Q.getIconUrl("apps/wm"),onclick:()=>s.xP.execCmd("wmsm",[])},{category:"Network"},{caption:"P3 Configuration",icon:await n.Q.getIconUrl("apps/p3"),onclick:()=>s.xP.execCmd("p3",["--notray"])},{caption:"Remote Console",icon:await n.Q.getIconUrl("apps/rcon"),onclick:()=>s.xP.execCmd("ctrl",["--cpl","rcon"])},{category:"Security"},{caption:"User Login",icon:await n.Q.getIconUrl("apps/uam"),onclick:()=>s.xP.execCmd("ctrl",["--cpl","uam"])},{caption:"Disk Encryption",icon:await n.Q.getIconUrl("devices/hdd-encrypted"),onclick:()=>{"2"!==localStorage.getItem("encr-stage")?u.jC.confirm("To encrypt your disk, a reboot is required. Would you like to reboot?",(async e=>{e&&(localStorage.setItem("encr-stage",1),s.xP.reboot())})):u.jC.info("Disk Encryption","Your disk is already encrypted.","OK")}},{category:"File systems"},{caption:"Backup Wizard",icon:await n.Q.getIconUrl("apps/backupmgr"),onclick:()=>s.xP.execCmd("backupmgr",[])},{caption:"Boot Folder",icon:await n.Q.getIconUrl("places/folder"),onclick:()=>s.xP.execCmd("explorer",["c:/system/boot"])},{caption:"Storage",icon:await n.Q.getIconUrl("apps/stormgr"),onclick:()=>s.xP.execCmd("ctrl",["--cpl","stormgr"])},{category:"System"},{caption:"Device Configuration",icon:await n.Q.getIconUrl("devices/iphone"),onclick:()=>s.xP.execCmd("ctrl",["--cpl","devcfg"])},{caption:"Device Manager",icon:await n.Q.getIconUrl("apps/devmgr"),onclick:()=>s.xP.execCmd("devmgr",[])},{}.pkm_settings?null:{caption:"PM Settings",icon:await n.Q.getIconUrl("apps/pkmgr"),onclick:()=>s.xP.execCmd("ctrl",["--cpl","pkmgr"])},{caption:"System Flags",icon:await n.Q.getIconUrl("objects/tools"),onclick:()=>s.xP.execCmd("flags")}],r=this.createWindow({title:"Control Panel",initialHeight:420,initialWidth:580,taskbar:!0,icon:await n.Q.getIconUrl("apps/settings","16x16"),bodyClass:"ctrl-app",body:'\n                <div class="appbar"></div>\n                <div class="view">\n                    <div class="p1"></div>\n                    <div class="p2"></div>\n                </div>\n                <footer class="w96-footer">\n                    <div class="cell">\n                        Windows 96\n                    </div>\n                </footer>\n            '},!0),a=r.getBodyContainer();a.querySelector("footer .cell").textContent="Windows 96 v"+L.d.getVersionString();const l=a.querySelector(".view>.p1");t.forEach((e=>{const t=document.createElement("div");t.classList.add("box");const i=document.createElement("div");i.classList.add("title"),i.innerText=e.caption,t.appendChild(i);const r=document.createElement("div");r.classList.add("items"),t.appendChild(r),e.items.forEach((e=>{const t=document.createElement("span");t.classList.add("item"),t.innerText=e.label,t.addEventListener("click",(()=>e.onclick())),r.appendChild(t)})),l.appendChild(t)}));const c=a.querySelector(".view>.p2");i.forEach((e=>{if(!e)return;if(e.category){const t=document.createElement("div");return t.innerText=e.category,t.classList.add("cat-marker"),void c.appendChild(t)}const t=document.createElement("div");t.classList.add("item");const i=document.createElement("div");i.style.backgroundImage=`url(${e.icon})`,i.classList.add("icon"),t.appendChild(i);const r=document.createElement("div");r.classList.add("title"),r.innerText=e.caption,t.appendChild(r),t.addEventListener("click",(()=>e.onclick())),c.appendChild(t)}));const d=new o.j;d.addRoot("File",[{type:"normal",label:"Exit",onclick:()=>r.close()}]),d.addRoot("Tools",[{type:"normal",label:"Reboot",onclick:()=>s.xP.reboot()},{type:"normal",label:"Reset",onclick:()=>s.xP.execCmd("resetwiz")}]),d.addRoot("Help",[{type:"normal",label:"About",onclick:()=>s.xP.execCmd("about-ui")}]),a.querySelector(".appbar").replaceWith(d.getMenuDiv()),r.show()}}},3872:(e,t,i)=>{"use strict";i.r(t),i.d(t,{KeyManagementApplication:()=>a});var r=i(4186),n=(i(9338),i(7612)),o=i(5690),s=(i(3978),i(9703));i(6999);class a extends r.QP{constructor(){super()}async main(e){let t;if(e.includes("-m"))new Audio("/system/resource/sounds/xd.mp3").play(),o.O.alert("This option is not available in production builds.",{icon:"/system/resource/themes/default/icons/misc/woozy.png",title:"Sorry"});else{t=this.createWindow({initialWidth:260,initialHeight:310,resizable:!1,title:"Product registration",taskbar:!0,center:!0,bodyClass:"keymgr",icon:await n.Q.getIconUrl("apps/keymgr","16x16"),controlBoxStyle:"WS_CBX_MINCLOSE"},!0);const e=t.getBodyContainer();e.innerHTML='\n\t\t\t\t<div>\n\t\t\t\t\t<span class="line">Enter the product key you have received on Patreon below to activate Windows 96.</span>\n\t\t\t\t\t<textarea spellcheck="false" class="km-keyinput" placeholder="AAAAA-BBBBB-CCCCC-DDDDD-EEEEE\nFFFFF-GGGGG-HHHHH-IIIII-JJJJJ\n..."></textarea>\n\t\t\t\t\t<button class="w96-button km-register">Register</button>\n\t\t\t\t</div>\n\t\t\t',e.classList.add("keymgr-register");let i=e.querySelector(".km-keyinput");e.querySelector(".km-register").onclick=async()=>{(await(0,s.Tn)(i.value)).valid?(localStorage.setItem("product-key",i.value),new Audio("/system/resource/sounds/tada.mp3").play(),o.O.alert("Thanks for your support!",{icon:await n.Q.getIconUrl("misc/check"),title:"Product registration"}),t.close()):o.O.alert("Your product key is invalid.",{icon:"error"})},t.show()}}}},8887:(e,t,i)=>{"use strict";i.r(t),i.d(t,{ScanWizardApp:()=>h});i(9338),i(5690);var r=i(7612),n=i(4779),o=i(1717),s=i(7390),a=i(1936),l=i(1638),c=i(6227),d=i(3516);class h extends d.p{constructor(){super()}async main(e){let t;await super.main(e);const i=this.findPage("intro");i.titleText="Welcome to the Scan Wizard",i.graphic="/system/resource/app/notron/scanwiz/graphic.png",i.body="This wizard will help scan your computer for potential viruses, malware, etc.<br><br>It is advised to close all programs before starting the scan.",i.buttons[1].onclick=()=>this.openPage("scan-select",[]);let s="quick";this.pages.push({id:"scan-select",type:"page",body:'Select an option:\n                <div class="w96-radiobox">\n                    <div class="option">\n                        <input type="radio" name="bopt" value="opt1">\n                        <label for="opt1" class="text">Quick scan - script files only</label>\n                    </div>\n                    <div class="option">\n                        <input type="radio" name="bopt" value="opt2">\n                        <label for="opt2" class="text">Full scan - all files</label>\n                    </div>\n                </div>',graphic:"/system/resource/app/notron/scanwiz/graphic-top.png",titleText:"What type of scan would you like to perform?",description:"The type of scan will decide the time it takes to scan your system.",buttons:[{class:"back",onclick:()=>this.openPage("intro",[]),enabled:!0,text:"Back"},{class:"next",onclick:()=>{this.openPage("scan",[])},enabled:!0,text:"Next"},{class:"cancel",onclick:()=>this.quit(),enabled:!0,text:"Cancel"}],onopen:(e,t)=>{const i=new o.X([{label:"Quick scan - script files only",id:"backup",onselect:()=>{s="quick"},selected:!0},{label:"Full scan - all files",id:"restore",onselect:()=>{s="full"},selected:!1}]);e.querySelector(".w96-radiobox").replaceWith(i.getElement())}}),this.pages.push({id:"scan",type:"page",body:'\n                <div>\n                    Scanning your files, this may take some time depending on the scan type...<br>\n                    <br>\n                    Status: <span class="status">Preparing...</span><br>\n                    Current File: <span class="current-file">(None)</span>\n                    <div class="w96-progressbar" style="margin-top: 16px;">\n                        <div class="progress" style="width: 0%; animation: none;"></div>\n                    </div>\n                    <div class="stats" style="margin-top: 16px;">\n                        Infections Found: <span class="stat-inf">0</span>\n                    </div>\n                </div>\n            ',graphic:"/system/resource/app/notron/scanwiz/graphic-top.png",titleText:"Scanning your system",description:"Do not restart or quit noTRON until the scan is complete.",buttons:[{class:"back",onclick:()=>this.openPage("scan-select",[]),enabled:!1,text:"Back"},{class:"finish",onclick:()=>{},enabled:!1,text:"Finish"},{class:"cancel",onclick:()=>this.quit(),enabled:!1,text:"Cancel"}],onopen:(e,t)=>{setTimeout((()=>this.performScan(s,e)),1e3)}}),this.pages.push({id:"finish",type:"page",body:"\n                No malware, viruses, etc. were found on your system.\n            ",graphic:"/system/resource/app/notron/scanwiz/graphic-top.png",titleText:"Scan complete",description:"No issues detected.",buttons:[{class:"back",onclick:()=>{},enabled:!1,text:"Back"},{class:"finish",onclick:()=>{this.terminate()},enabled:!0,text:"Finish"},{class:"cancel",onclick:()=>this.quit(),enabled:!1,text:"Cancel"}],onopen:(e,t)=>{}}),this.pages.push({id:"infected",type:"page",body:'\n                <div>\n                    Your system has been infected with malware. It is recommended that you clean it as fast as possible.<br>\n                    <br>\n                    Please review the infected files below.\n                </div>\n                <br>\n                <div>Infected files:</div>\n                <div class="lbox"></div>\n            ',graphic:"/system/resource/app/notron/scanwiz/graphic-top.png",titleText:"Scan complete",description:"Infections were found inside your system.",buttons:[{class:"back",onclick:()=>{},enabled:!1,text:"Back"},{class:"clean",onclick:()=>{this.openPage("clean",[])},enabled:!0,text:"Clean"},{class:"cancel",onclick:()=>this.quit(),enabled:!0,text:"Cancel"}],onopen:(e,i)=>{const r=new n.w;t=i[0];for(let e of t)r.addItem(e,e);const o=r.getElement();o.style.height="115px",e.querySelector(".lbox").replaceWith(o)}}),this.pages.push({id:"clean",type:"page",body:'\n                <div>The malware is being removed from your system - please wait...</div>\n                <div class="w96-progressbar" style="margin-top: 16px;">\n                    <div class="progress"></div>\n                </div>\n            ',graphic:"/system/resource/app/notron/scanwiz/graphic-top.png",titleText:"Cleaning your system",description:"The malware is being removed - do not reboot or interfere with your system.",buttons:[{class:"back",onclick:()=>{},enabled:!1,text:"Back"},{class:"next",onclick:()=>{this.terminate()},enabled:!1,text:"Next"},{class:"cancel",onclick:()=>this.quit(),enabled:!1,text:"Cancel"}],onopen:(e,i)=>{setTimeout((async()=>{for(let e of t)try{await c.FS.rm(e)}catch(t){console.error("Failed to clean "+e),console.error(t)}this.openPage("clean-success",[])}),1e3)}}),this.pages.push({id:"clean-success",type:"page",body:'\n                The system cleanup has completed successfully. Press "Finish" to quit.\n            ',graphic:"/system/resource/app/notron/scanwiz/graphic-top.png",titleText:"Clean successful",description:"",buttons:[{class:"back",onclick:()=>{},enabled:!1,text:"Back"},{class:"finish",onclick:()=>{this.terminate()},enabled:!0,text:"Finish"},{class:"cancel",onclick:()=>this.quit(),enabled:!1,text:"Cancel"}],onopen:(e,t)=>{}}),this.openPage("intro",[]),this.mainwnd.setTitle("Scan Wizard"),this.mainwnd.setWindowIcon(await r.Q.getIconUrl("apps/notron","16x16"))}async performScan(e,t){const i=t.querySelector(".status"),r=t.querySelector(".current-file"),n=t.querySelector(".w96-progressbar>.progress"),o=t.querySelector(".stat-inf"),d=c.FS.mounts();i.textContent="Calculating files needed for scan...";let h=[],p=[],u=0;switch(e){case"quick":await d.aForEach((async e=>{e.readOnly&&e.remote||(h=[...h,...(await c.FS.walk(`${e.prefix}/`)).filter((e=>e.toLowerCase().endsWith(".js")))])}));break;case"full":await d.aForEach((async e=>{e.readOnly&&e.remote||(h=[...h,...await c.FS.walk(`${e.prefix}/`)])}))}const f=s.h.getVirDefs();for(let e of h)try{if(u++,n.style.width=100*u/h.length+"%",r.textContent=e,!await c.FS.isFile(e))continue;const t=await c.FS.stat(e);if(t&&t.length>8388608)continue;const i=await c.FS.readstr(e),s=await a.p.formatAndHash(i);f[l.$.buffer2hex(s)]&&(p.push(e),o.textContent=p.length)}catch(t){console.error("Error scanning file "+e),console.error(t)}p.length>0?this.openPage("infected",[p]):this.openPage("finish",[])}}},6796:(e,t,i)=>{"use strict";i.r(t),i.d(t,{P3FS_CONFIG_PATH:()=>g,P3FileSystemSettingsApplication:()=>P});var r=i(4186),n=(i(1350),i(6227)),o=i(3513),s=i(7612),a=i(4871),l=(i(7839),i(8423)),c=i(5516),d=i(5690),h=i(3978),p=i(3078),u=i(9338),f=i(7619),_=i(6226);const g="C:/system/config/p3fs.json";var m=null,b=null;let y,v,w,x,C=-1,S={customLabel:null,maxConnections:3,passKey:null,disk:"C:",port:737,rateLimitMax:15},E={},k="",L=0,A=[],O=null,M=0;class P extends r.QP{constructor(){super()}async main(e){if(!{}.p3fs){if(super.main(e),m||(m=await s.Q.getIconUrl("apps/p3fs/icon","16x16")),b||(b=await s.Q.getIconUrl("apps/p3fs/hosting","16x16")),this._p3=w96.net.p3,this.argv=e,this.argv.includes("--connect"))return this._connect();this._createWindow()}}async _connect(){u.jC.prompt("Map P3 Network Drive","Enter a P3 address to connect to.","",(async e=>{if(e){let i=new URL(`http://${e}`);if(i.port||(i.port=737,e=i.host),!this._p3.connected&&!await p.e.p3Connect())return console.warn("[p3fs] p3 connection failed");const r=u.jC.idleProgress("P3 Network Drive","Connecting to network drive ...");let s=this._p3.createConnection(e);var t=async(e,t)=>(s.send([e,t]),1);let a=()=>r.closeDialog(),l=async([i,d])=>{switch(i){case"ERR":this._error(`Failed to connect to ${e}: ${d}`,r);break;case"AUTH":u.jC.prompt("Map P3 Network Drive","Enter passkey.","",(async i=>{i?t("AUTH",i):(await s.disconnect(!0),this._error(`Failed to connect to ${e}: No authentication provided`))}));break;case"SUCCESS":let i=n.FS.nextLetter();if(!i)return await s.disconnect(!0),this._error("No more drive letters available",r);let h=new o.b(i,d.label,s);l=h._onMsg.bind(h),a=h._onDisconnect.bind(h),await n.FS.mount(h),r.closeDialog(),c.xP.execCmd("explorer",[i+"/"]);break;case"HELLO":await t("HELLO",null);break;default:console.warn("[p3fs] unknown code received during handshake")}};s.on("disconnect",(e=>a())),s.on("message",(e=>l(e)));try{await s.connect()}catch(t){this._error(`Failed to connect to ${e}: ${t.toString()}`,r)}}}))}_error(e,t){d.O.alert(h.V.escapeHtml(e),{title:"P3 Network Drive Error",icon:"error"}),t&&t.closeDialog()}_createTray(){y||this.argv.includes("--notray")||(y=new a.K({iconUrl:b}),y.onclick=()=>{v?(v.close(),v=null,super.appWindow=null,this._wnd=null):c.xP.execCmd("p3fs",["--notray"])},l.e.registerNotifyIcon(y))}_destroyTray(){y&&(y.destroy(),y=null)}_Uint8ToBase64(e){for(var t,i=0,r=e.length,n="";i<r;)t=e.subarray(i,Math.min(i+32768,r)),n+=String.fromCharCode.apply(null,t),i+=32768;return btoa(n)}async _createWindow(){if(O&&O!==this)return O._createWindow();if(v)return;O=this;const e=this.createWindow({resizable:!1,center:!0,initialHeight:390,initialWidth:540,title:"P3FS Settings",taskbar:!0,bodyClass:"p3fs-app",icon:m,controlBoxStyle:"WS_CBX_CLOSE"},!0);e.onclose=()=>{v=null,super.appWindow=null,this._wnd=null},this._wnd=e,v=e;const t=e.getBodyContainer();t.innerHTML=`\n            <div class="p3fs-main">  \n                <div style="display: flex; padding: 10px 5px;">\n                    <img src="${await s.Q.getIconUrl("apps/p3fs")}" style="margin-right: 15px">\n                    <span style="display: inline-block">P3FS allows you to share your filesystems over P3 just using your P3 address. To use it, configure your options, then click on "Start Hosting".\n                    If you want to mount a disk from another user, click <a href="#" class="p3fs-mount">here</a>.</span>\n                </div>\n\n                <span>\n                    Disk: <select class="w96-inset p3fs-disk"></select>\n                </span>\n                <span>\n                    Custom label (optional):\n                    <input type="text" class="p3fs-customlabel" placeholder="disk name of your dreams ...">\n                </span>\n                <span>\n                    Passkey (optional):\n                    <input type="text" class="p3fs-passkey" placeholder="Secret passkey">\n                </span>\n                <span>\n                    Max connections:\n                    <input type="number" class="p3fs-conns" placeholder="3" value="3" min="1" max="50">\n                </span>\n                <div class="p3fs-buttons">\n                    <button class="w96-button p3fs-control">Start Hosting</button>\n                    <button class="w96-button p3fs-p3copy" style="width: 107px" disabled>Copy P3 Address</button>\n                </div>\n            </div>\n\n            <div class="p3fs-console">\n                <div class="p3fs-console-out w96-inset"></div>\n            </div>\n        `,this._cnt=t,this._console=t.querySelector(".p3fs-console-out"),this._console.innerHTML=k,t.querySelector(".p3fs-mount").onclick=e=>{e.preventDefault(),c.xP.execCmd("p3fs",["--connect"])};let i=n.FS.mounts().filter((e=>!e.readOnly&&!e.features.includes("read-only"))).sort(((e,t)=>e.prefix<t.prefix?-1:e.prefix>t.prefix?1:0));this._inputs={};let r=this._inputs.disk=t.querySelector(".p3fs-disk"),o=this._inputs.pass=t.querySelector(".p3fs-passkey"),a=this._inputs.label=t.querySelector(".p3fs-customlabel"),l=this._inputs.conns=t.querySelector(".p3fs-conns"),d=this._inputs.button=t.querySelector(".p3fs-control");if(-1===C){try{await n.FS.exists(g)?S={...S,...JSON.parse(await n.FS.readstr(g))}:await n.FS.writestr(g,JSON.stringify(S))}catch(e){this._logWarn("Failed to parse configuration. Please rectify it.")}this._logInfo("Idle ..."),C=0}else 1===C&&(this._disableControls(),this._inputs.button.innerText="Stop hosting",this._inputs.button.disabled=!1);try{for(let e of i){let t=document.createElement("option");t.value=e.prefix.substring(0,1),t.innerText=`${e.volumeLabel} (${e.prefix})`,e.prefix==S.disk&&(t.selected=1),r.appendChild(t)}S.passKey&&(o.value=S.passKey),S.customLabel&&(a.value=S.customLabel),l.value=S.maxConnections}catch(e){this._logWarn("Failed to load configuration! Please rectify it.")}let h=this._inputs.copy=t.querySelector(".p3fs-p3copy"),p=["Copied!","Double Copy!","Triple Copy!","Mega Copy!","Dominating!!","Insane!","GODLIKE!","fish nuts"],u=-1,f=null,b=!1;h.onclick=async e=>{if(this._p3.connected){if(!navigator.clipboard)return this._logErr("Clipboard API not available.");if(!b){if(b=!0,await navigator.clipboard.writeText(this._p3.address),(0,_.yE)("disable_easter_eggs"))h.innerText="Copied!";else{f&&clearTimeout(f),f=setTimeout((e=>u=-1),3e3);let e=p[++u]||p[p.length-1];h.innerText=e}setTimeout((e=>{h.innerText="Copy P3 Address",b=!1}),1e3)}}else h.disabled=!0},this._p3.connected&&(h.disabled=!1),d.onclick=async e=>{e.preventDefault(),0===C?(S={...S,customLabel:a.value||null,maxConnections:Number(l.value),passKey:o.value||null,disk:r.value+":"},await this._saveConfig(),this._clearConsole(),this._startServer()):1===C&&this._stopServer()},v.show()}async _saveConfig(){return await n.FS.writestr(g,JSON.stringify(S))}_clearConsole(){this._console.innerHTML="",k=""}_log(e){k+=e,v&&(this._console.innerHTML+=e,this._console.scrollTop=this._console.scrollHeight)}_logInfo(e){this._log(`<span style="color: #0ff">[i]</span> ${h.V.escapeHtml(e)}<br>`)}_logNInfo(e){this._log(`<span style="color: #0ff">[i]</span> ${e}<br>`)}_logWarn(e){this._log(`<span style="color: #ff0">[!]</span> ${h.V.escapeHtml(e)}<br>`)}_logErr(e){this._log(`<span style="color: #f00">[x]</span> ${h.V.escapeHtml(e)}<br>`)}_fatalError(e){this._logErr(e),this._stopServer()}async _startServer(){if(w||1===C)return this._stopServer();C=1,this._disableControls(),this._inputs.button.innerText="Starting...",this._createTray();const e=this._p3;if(!e.connected){if(this._logInfo("Connecting to P3..."),!await p.e.p3Connect())return this._fatalError("Failed to connect to P3.");this._logInfo("Connected to P3.")}if(this._inputs.copy.disabled=!1,x=n.FS.mounts().find((e=>e.prefix==S.disk)),!x)return this._fatalError("Could not find disk "+S.disk+"!");this._logInfo(`Using ${x.volumeLabel} (${S.disk})`),this._logInfo("Starting server..."),w=e.createServer(S.port,(async t=>{var i=async(e,i)=>(t.send([e,i]),1);let r=t.remoteAddress.split(":")[0];if(E[r])return await i("ERR","Already connected."),t.disconnect(!0),void this._logNInfo(`Duplicate client <span style="color: #c0ffee">${t.remoteAddress}</span> disconnected.`);if(r===e.address)return await i("ERR","Cannot connect to server from server address."),t.disconnect(!0),void this._logNInfo(`Client <span style="color: #c0ffee">${t.remoteAddress}</span> disconnected for being server address.`);let n=0;E[r]=t,this._logNInfo(`Client <span style="color: #c0ffee">${t.remoteAddress}</span> connected.`);var o=async e=>{this._logNInfo(`Client <span style="color: #c0ffee">${t.remoteAddress}</span> kicked for <span style="color: #ccc">${e}</span>`),await i("ERR",e),t.disconnect(!0)};if(t.on("disconnect",(()=>{this._logNInfo(`Client <span style="color: #c0ffee">${t.remoteAddress}</span> disconnected.`),delete E[r]})),Object.keys(E).length==S.maxConnections+1)return await o("Max connections reached.");t.on("message",(async([s,a])=>{try{switch(s){case"HELLO":if(0!==n)return await o("Invalid payload | Invalid connection state");S.passKey?(n=1,await i("AUTH",null)):(n=2,await i("SUCCESS",{label:S.customLabel||e.address}),this._logNInfo(`Client <span style="color: #c0ffee">${t.remoteAddress}</span> verified.`));break;case"AUTH":if(1!==n)return await o("Invalid payload | Invalid connection state");if(a!=S.passKey)return this._logWarn("Incorrect passkey!"),await o("Incorrect passkey.");n=2,await i("SUCCESS",{label:S.customLabel||e.address}),this._logNInfo(`Client <span style="color: #c0ffee">${t.remoteAddress}</span> authenticated.`);break;case"FSFN":if(2!==n)return await o("Invalid payload | Invalid connection state");let s=a.type,l=a.args,c=a.reqId,d=!1;if("number"!=typeof c)return await o("Invalid payload | Invalid parameter");let p=null,u=e=>`<span style="color: ${e}">`,_="</span>";await this._wait(),this._logNInfo(`${u("#373")}${++M}${_} ${u("#c0ffee")}${r}${_}: ${A.length>0?`${u("#f00")}${A.length}${_}`:`${u("#cff")}${L}${_}`} ${u("#fc0")}${s}${_} ${u("#799")}${h.V.escapeHtml(l[0])}${_} ${u("#fff")}${c}${_}`);try{switch(s){case"readdir":p=await x.readdir(l[0],l[1]);break;case"exists":p=await x.exists(l[0]);break;case"filetype":p=await x.filetype(l[0]);break;case"stat":p=await x.stat(l[0]);break;case"readbin":p=await x.readbin(l[0]);break;case"readBinChunk":p=await x.readBinChunk(l[0],l[1],l[2]);break;case"readstr":p=await x.readstr(l[0]);break;case"isEmpty":p=await x.isEmpty(l[0]);break;default:return await o("Invalid payload | Invalid FS function")}p&&p instanceof Uint8Array&&(d=!0,p=this._Uint8ToBase64(p)),await i("RES",{reqId:c,res:p,isB64:d}),this._finish()}catch(e){e instanceof f.J?await i("ERR",{reqId:c,errType:e.errno,path:l[0]}):await i("ERR",{reqId:c,errType:"EIO",path:l[0]}),this._finish()}break;default:return await o("Invalid payload | Incorrect code")}}catch(e){return console.log(e),await o("Invalid payload | Parsing error")}})),await i("HELLO",null)})),this._logNInfo(`Listening at <span style="color: #c0ffee">${e.address}</span> (:737)`),this._inputs.button.innerText="Stop hosting",this._inputs.button.disabled=!1}async _stopServer(){if(0===C)return console.warn("[p3fs] tried to stop server when it is already stopped.");if(w){for(var e of Object.keys(E))await E[e].disconnect(!0);w.close(),w=null}this._enableControls(),this._inputs.button.innerText="Start hosting",this._logInfo("Stopped server."),this._destroyTray(),L=0,A=[],M=0,C=0}_disableControls(){v&&(this._inputs.pass.disabled=!0,this._inputs.button.disabled=!0,this._inputs.label.disabled=!0,this._inputs.conns.disabled=!0,this._inputs.disk.disabled=!0)}_enableControls(){v&&(this._inputs.pass.disabled=!1,this._inputs.button.disabled=!1,this._inputs.label.disabled=!1,this._inputs.conns.disabled=!1,this._inputs.disk.disabled=!1)}_wait(){return L++,new Promise((e=>{L>S.rateLimitMax?A.push((t=>e())):e()}))}_finish(){L--,L<0&&(L=0),A[0]&&A.shift()()}ontermination(){this._cnt=null,v=null,super.ontermination()}}},4821:(e,t,i)=>{"use strict";i.d(t,{h:()=>E,p:()=>u});var r=i(4186),n=(i(1350),i(6227)),o=i(7612),s=i(4871),a=i(5544),l=i(7839),c=i(8423),d=i(5516),h=i(5690),p=i(3978);const u="C:/system/config/p3.json";let f=!1;var _=null,g=null,m=null,b=null,y=null;const v="p3_latency_test";let w,x,C=!1,S=null;class E extends r.QP{constructor(){super()}async main(e){if(super.main(e),this._p3=w96.net.p3,f||(_=await o.Q.getIconUrl("apps/p3/online","16x16"),g=await o.Q.getIconUrl("apps/p3/connecting","16x16","gif"),await o.Q.getIconUrl("apps/p3/offline","16x16"),m=await o.Q.getIconUrl("apps/p3/error","16x16"),b=await o.Q.getIconUrl("apps/p3/online-send","16x16"),y=await o.Q.getIconUrl("apps/p3/online-receive","16x16"),f=!0),e.includes("--notray")||this._createTray(),e.includes("--tray")||this._createWindow(),!C){C=!0;const e=async e=>{e.data===v&&await this._p3.send(`${e.source}:119`,v+" ok"),e.data===v+" ok"&&S&&S(e)};this._p3.listen(119,e)}}_createTray(){w||(setInterval((()=>this._updateTray()),500),w=new s.K({iconUrl:_}),w.onclick=()=>{x?(x.activate(),x.minimized&&x.toggleMinimize()):d.xP.execCmd("p3",["--notray"])},this._p3.on("_send",(()=>{this._p3.connected&&w.setIcon(b)})),this._p3.on("_receive",(()=>{this._p3.connected&&w.setIcon(y)})),this._p3.on("connecting",(()=>{this._updateTray()})),c.e.registerNotifyIcon(w)),this._trayMode=!0}_createWindow(){if(x)return;const e=this._p3,t=this.createWindow({resizable:!1,center:!0,initialHeight:290,initialWidth:300,title:"P3 Settings",taskbar:!0,bodyClass:"p3-app",icon:_,controlBoxStyle:"WS_CBX_CLOSE"},!0);this._wnd=t,x=t;const i=t.getBodyContainer(),r=new a.a;let o,s,c,d,f,g,m,b,y,w={relayServer:l.d8.RELAY_SERVER,secret:w96.net.P3Connection.randomSecret(),autoconnect:!1};const C=r.addPage("Auth",(async t=>{t.innerHTML='\n                <span>P3 (Pseudo Peer-to-Peer or PPP) allows Windows 96 programs to communicate using a relay server.</span>\n                <div class="p3-status-div">\n                    <span class="bold-noaa">Status:</span>\n                    <div class="p3-status"></div>\n                    <span class="p3-status-text">N/A</span>\n                </div>\n                <div style="display: flex; margin-top: 4px">Connect on startup<div class="w96-chkbox p3-autoconnect" style="margin-left: auto"><div class="box"></div></div></div>\n                <p class="bold-noaa">Relay URL</p>\n                <input type="text" class="p3-relay w96-textbox" placeholder="ws://host:11096">\n                <p class="bold-noaa">Parameters</p>\n                <input type="password" class="p3-secret w96-textbox" placeholder="Enter a long password...">\n                <p class="bold-noaa">Address</p>\n                <input type="text" class="p3-address w96-textbox" placeholder="Click Connect to resolve..." readonly disabled>\n\n                <div style="margin-top: 10px; float: right">\n                    <button class="w96-button p3-connect">Connect</button>\n                    <button class="w96-button p3-cancel">Cancel</button>\n                    <button class="w96-button p3-save-exit">OK</button>\n                </div>',await n.FS.exists(u)&&(w=JSON.parse(await n.FS.readstr(u))),y=t.querySelector(".p3-autoconnect>.box"),w.autoconnect&&y.classList.add("checked"),y.onclick=()=>{w.autoconnect?y.classList.remove("checked"):y.classList.add("checked"),w.autoconnect=!w.autoconnect},b=t.querySelector(".p3-status"),b.style.color=e.connected?"#0a0":"#a00",m=t.querySelector(".p3-status-text"),m.textContent=e.connected?"Online":"Offline",f=t.querySelector(".p3-relay"),f.value=w.relayServer,f.onkeyup=()=>{w.relayServer=f.value},g=t.querySelector(".p3-address"),d=t.querySelector(".p3-secret"),d.value=w.secret,d.onkeyup=e=>{w.secret=d.value,g.value=""},d.onfocus=()=>{d.setAttribute("type","text")},d.onblur=()=>{d.setAttribute("type","password")},s=t.querySelector(".p3-cancel"),s.onclick=()=>{this.ontermination()},c=t.querySelector(".p3-connect"),c.onclick=async()=>{await n.FS.writestr(u,JSON.stringify(w)),e.server=w.relayServer,e.secret=w.secret,e.connected?w96.net.p3.disconnect():w96.net.p3.connect(),this._updateStatus()},o=t.querySelector(".p3-save-exit"),o.onclick=async()=>{await n.FS.writestr(u,JSON.stringify(w)),this.ontermination()},this._el={btnConnect:c,inputSecret:d,inputRelay:f,inputAddress:g,statusText:m,statusDot:b,checkAutoconnect:y},this._updateStatus()}));this._onConnect=e=>{g.value=e.address,c.removeAttribute("disabled"),this._updateStatus()},this._onError=e=>{c.removeAttribute("disabled"),h.O.alert(p.V.escapeHtml(e.message),{title:"P3 Connection Failed",icon:"error"}).wnd.wndObject.classList.add("p3-message"),this._updateStatus()},this._onDisconnect=()=>{c.removeAttribute("disabled"),this._updateStatus()},e.on("connect",this._onConnect),e.on("error",this._onError),e.on("disconnect",this._onDisconnect),r.addPage("Diagnostics",(async t=>{t.innerHTML='<span class="bold-noaa" style="display: block">Latency</span>\n            <span style="display: block">Enter a P3 client address below to test latency.</span>\n            <div class="p3-combo-btn-wrap">\n                <input type="text" class="p3-latency w96-textbox" placeholder="example.ppp">\n                <button class="p3-latency-btn w96-button">Test</button>\n            </div>\n            <span class="bold-noaa" style="display: block">Ports</span>\n            <span style="display: block">This a list of ports currently in use.</span>\n            <div class="p3-port-list">\n                <div class="legend">\n                    <span class="port">Port</span>\n                    <span class="flags">Flags</span>\n                    <span class="type">Type</span>\n                </div>\n            </div>';let i=t.querySelector(".p3-latency"),r=t.querySelector(".p3-latency-btn");i.onkeydown=e=>{13===e.keyCode&&r.onclick()},r.onclick=async()=>{let t,n,o=i.value.trim();if(o){if(!e.connected)return h.O.alert("You must be connected to test latency.");r.setAttribute("disabled",""),S=e=>{e.source===o&&(alert(`Client-Server time: ${n-t}ms<br>Client-Target time: ${Date.now()-t}ms`),S=null,r.removeAttribute("disabled"))},t=Date.now();try{await e.send(`${o}:119`,v)}catch(e){h.O.alert(p.V.escapeHtml(e),{title:"P3 Error",icon:"error"}),r.removeAttribute("disabled")}n=Date.now()}};let n=t.querySelector(".p3-port-list");for(const t in e.ports){const i=e.ports[t];let r=document.createElement("div");r.innerHTML=`<span class="port">${p.V.escapeHtml(t)}</span>\n                <span class="flags">${p.V.escapeHtml(i.flags?i.flags.join(","):"none")}</span>\n                <span class="type">${i.public?"public":"private"}</span>`,r.classList.add("port-row",i.public?"public":"private"),n.appendChild(r)}})),r.addPage("Peers",(async t=>{t.innerHTML='<span class="bold-noaa" style="display: block">Discover</span>\n            <span style="display: block">Enter one or more flags (comma-separated) below to search for online peers.</span>\n            <div class="p3-combo-btn-wrap">\n                <input type="text" class="p3-flags w96-textbox" placeholder="Enter flags here...">\n                <button class="p3-find-btn w96-button">Find</button>\n            </div>\n            <div class="p3-port-list p3-peers">\n                <div class="legend">\n                    <span class="address">Address</span>\n                    <span class="port">Port</span>\n                    <span class="flags">Flags</span>\n                </div>\n            </div>';let i=t.querySelector(".p3-port-list"),r=t.querySelector(".p3-flags"),n=t.querySelector(".p3-find-btn");r.onkeydown=e=>{13===e.keyCode&&n.onclick()},n.onclick=async()=>{let{value:t}=r,n=t.trim().split(",").map((e=>e.trim())).filter((e=>""!==e));if(0!=n.length){let t;i.querySelectorAll(".port-row").forEach((e=>e.remove()));try{t=await e.discover(n,10)}catch(e){return h.O.alert("P3 Discover Error:\n"+p.V.escapeHtml(e),{title:"P3 Discover",icon:"error"})}if(0===t.length)return h.O.alert("No peers found!",{title:"P3 Discover"});t.forEach((e=>{let t=document.createElement("div");t.innerHTML=`<span class="address">${p.V.escapeHtml(e.address)}</span>\n                        <span class="port">${p.V.escapeHtml(e.port)}</span>\n                        <span class="flags">${p.V.escapeHtml(e.flags.join(","))}</span>`,t.classList.add("port-row"),i.appendChild(t)}))}}})),r.setSize("100%","100%"),i.appendChild(r.getElement()),t.show(),r.openPage(C)}_updateTray(){if(w){if(!this._p3.connected&&!this._p3.connecting)return w.notifyEl.style.display="none";w.notifyEl.style.display="",this._p3.connecting?w.setIcon(g):this._p3.connected?w.setIcon(_):this._p3.error&&w.setIcon(m)}}_updateStatus(){this._p3.connecting?(this._el.btnConnect.setAttribute("disabled",""),this._disableInputs(),this._el.statusDot.style.color="#a50",this._el.statusText.textContent="Connecting...",this._el.btnConnect.textContent="Disconnect"):this._p3.connected?(this._disableInputs(),this._el.btnConnect.removeAttribute("disabled"),this._el.statusDot.style.color="#0a0",this._el.statusText.textContent="Online",this._el.btnConnect.textContent="Disconnect",this._el.inputAddress.value=this._p3.address,w||(this._createTray(),this._updateTray())):(this._disableInputs(!1),this._el.btnConnect.removeAttribute("disabled"),this._el.statusDot.style.color="#a00",this._el.statusText.textContent=this._p3.error?"Error":"Offline",this._el.btnConnect.textContent="Connect"),this._updateTray()}_disableInputs(e=!0){e?(this._el.inputRelay.setAttribute("disabled",""),this._el.inputSecret.setAttribute("disabled","")):(this._el.inputRelay.removeAttribute("disabled"),this._el.inputSecret.removeAttribute("disabled"))}ontermination(){this._p3.removeEventListener("connect",this._onConnect),this._p3.removeEventListener("error",this._onError),this._p3.removeEventListener("disconnect",this._onDisconnect),this._el=null,x=null,super.ontermination()}}},9266:(e,t,i)=>{"use strict";i.d(t,{j:()=>a});i(5690);var r=i(6227),n=i(6110),o=i(3978);class s{constructor(){this.name="NULL",this.friendlyName="NULL",this.description="",this.author="<Unknown>",this.category="NULL",this.version=1,this.installedSize=0,this.downloadSize=0,this.feature_requirements=[],this.min_os_version=2,this.max_os_version=999999999,this.depends=[],this.iconFiles={"32x32":"/system/resource/icons/win96/32x32/mime/executable.png","16x16":"/system/resource/icons/win96/16x16/mime/executable.png"},this.repo="NULL",this.repoIndex=-1,this.repoId="",this.readmeFile="",this.packageRoot=null}getSpecificName(){return`${this.name}:${this.repoId}`}}class a{constructor(){this.logger=console,this.srcConfig=null,this.packageCache=[],this.repoCache=[],this.unpackPathMappings=[{source:"unpack/root",dest:"c:"},{source:"unpack/app-boot",dest:"c:/system/boot/apps"},{source:"unpack/package_dir",dest:"c:/local/$pkname"},{source:"unpack/user_folder",dest:"c:/user"},{source:"unpack/appdata",dest:"c:/user/appdata/$pkname"}],this.onfailure=()=>{}}async checkFS(){this.logger.log("Package manager FS init...");const e=["c:/system/temp/pkg-dl","c:/system/packages","c:/system/packages/configs","c:/system/packages/installed","c:/system/packages/indexes","c:/system/log","c:/local"],t=[{path:"c:/system/packages/configs/sources.json",data:JSON.stringify({sources:["https://packages.windows96.net/r3-main"],updateFrequency:2},null,4)}];for(let t of e)await r.FS.exists(t)||await r.FS.mkdir(t);for(let e of t)await r.FS.exists(e.path)||await r.FS.writestr(e.path,e.data);this.logger.log("Package manager FS init complete.")}async readSources(){try{return this.srcConfig=JSON.parse(await r.FS.readstr("c:/system/packages/configs/sources.json")),!0}catch(e){return!1}}resolveSourceFromIndex(e){return this.repoCache.find((t=>t.index==e))}getSourceIndexFromId(e){return this.repoCache.find((t=>t.id==e)).index}getPackage(e){let t=null;if(e.includes(":")){let i=e.split(":");t=i[1],e=i[0]}return(null!=t?this.packageCache.filter((e=>e.repoId==t)):this.packageCache).find((t=>t.name==e))}async getPackageInstallState(e){try{let t="@null";if(e.includes(":")){let i=e.split(":");t=i[1],e=i[0]}const i=`c:/system/packages/installed/${t}/${e}.json`;if(!await r.FS.exists(i))return"NOT_INSTALLED";const n=await r.FS.readstr(i),o=Object.assign(new s,JSON.parse(n));return this.getPackage(o.getSpecificName()).version>o.version?"UPGRADEABLE":"INSTALLED"}catch(e){return"BROKEN"}}async walkDependencies(e){const t=this.getPackage(e),i=[];for(let e of t.depends){let r=e.includes(":")?e:`${e}:${t.repoId}`;if(r==t.getSpecificName())throw new Error("Circular dependency error.");if("INSTALLED"==await this.getPackageInstallState(r))continue;let n=this.getPackage(r);if(null!=n&&null!=n.name){for(let e of await this.walkDependencies(n.getSpecificName()))i.push(e);i.push(n)}else i.push({unresolved:!0,item:e})}return i}async reloadPackageCache(){const e=[];let t=0;for(let i of this.srcConfig.sources){try{const n=await fetch(`${i}/Release.json`),a=await n.json();if(a.repo=i,a.index=t,null==a.id)throw new Error("Invalid 'id' in Release.json for source "+i);await r.FS.exists("c:/system/packages/installed/"+a.id)||await r.FS.mkdir("c:/system/packages/installed/"+a.id);const l=await fetch(`${i}/Packages.json`),c=await l.json();await r.FS.writestr(`c:/system/packages/indexes/${t}.rel`,JSON.stringify(a)),await r.FS.writestr(`c:/system/packages/indexes/${t}.pack`,JSON.stringify(c)),this.repoCache.push(a);for(let r of c){if(!r.packageRoot)continue;r.repo=i,r.repoId=a.id,r.repoIndex=t,e.push(r.name);const n=Object.keys(r);for(let e of n)"string"==typeof r[e]&&(r[e]=o.V.escapeHtml(r[e]));let l=Object.assign(new s,r);l.iconFiles["16x16"]&&(l.iconFiles["16x16"]=l.iconFiles["16x16"].replace("$REPO_PATH$",i)),l.iconFiles["32x32"]&&(l.iconFiles["32x32"]=l.iconFiles["32x32"].replace("$REPO_PATH$",i)),l.readmeFile=l.readmeFile.replace("$REPO_PATH$",i),l.packageRoot=l.packageRoot.replace("$REPO_PATH$",i),this.packageCache.push(l)}this.logger.log("Updating indexes for source "+i)}catch(e){this.onfailure({code:"cache_reload_failure",e})}t++}}async unpackContentZip(e,t,i=(()=>{})){const n=new JSZip;await n.loadAsync(e);const o=Object.keys(n.files);i({message:"Mapping paths..."});const s=[];for(let e of o)for(let i of this.unpackPathMappings)if(e.startsWith(i.source)){let r=e;r.startsWith("/")&&(r=r.substring(1)),r.endsWith("/")&&(r=r.substring(0,r.length-1));let o=r.replace(i.source,i.dest).replace("$pkname",t.name);if(2==o.length)continue;s.push({target:o,zipEntry:e,dir:n.files[e].dir})}for(let e of s){if(e.dir){i({message:`Create Dir ${e.target}`});continue}let t=r.FSUtil.getParentPath(e.target);2==t.length&&(t+="/"),await r.FS.exists(t)||await r.FS.mkdir(t),i({message:`Writing ${e.zipEntry} => ${e.target}`}),await r.FS.writebin(e.target,await n.files[e.zipEntry].async("uint8array"))}i({message:"Saving package meta and scripts..."}),await r.FS.writestr(`c:/system/packages/installed/${t.repoId}/${t.name}.json`,JSON.stringify(Object.assign(t,{zKeys:o}))),await r.FS.writebin(`c:/system/packages/installed/${t.repoId}/${t.name}_inst.js`,null!=n.files["scripts/install.js"]?await n.files["scripts/install.js"].async("uint8array"):[]),await r.FS.writebin(`c:/system/packages/installed/${t.repoId}/${t.name}_repair.js`,null!=n.files["scripts/repair.js"]?await n.files["scripts/repair.js"].async("uint8array"):[]),await r.FS.writebin(`c:/system/packages/installed/${t.repoId}/${t.name}_uninst.js`,null!=n.files["scripts/uninstall.js"]?await n.files["scripts/uninstall.js"].async("uint8array"):[])}async removePackage(e,t=(()=>{})){try{if(t({message:"Removing package `"+e.name+"`",type:"info"}),await r.FS.exists(`c:/system/packages/installed/${e.repoId}/${e.name}_uninst.js`)){const t=await r.FS.readstr(`c:/system/packages/installed/${e.repoId}/${e.name}_uninst.js`);new Function(`const pm = this.pm; ${t}`).call({pm:this})}const i=JSON.parse(await r.FS.readstr(`c:/system/packages/installed/${e.repoId}/${e.name}.json`)).zKeys;t({message:"Remapping paths..."});const n=[];for(let t of i)for(let i of this.unpackPathMappings)if(t.startsWith(i.source)){let r=t;r.startsWith("/")&&(r=r.substring(1)),r.endsWith("/")&&(r=r.substring(0,r.length-1));let o=r.replace(i.source,i.dest).replace("$pkname",e.name);if(2==o.length)continue;n.push({target:o,zipEntry:t})}for(let e of n)try{await r.FS.exists(e.target)&&r.FS.isFile(e.target)&&(t({message:`Deleting ${e.target}...`}),await r.FS.rm(e.target))}catch(i){t({message:`Failed to delete ${e.target}...`,type:"error"})}await r.FS.rm(`c:/system/packages/installed/${e.repoId}/${e.name}.json`),await r.FS.rm(`c:/system/packages/installed/${e.repoId}/${e.name}_inst.js`),await r.FS.rm(`c:/system/packages/installed/${e.repoId}/${e.name}_repair.js`),await r.FS.rm(`c:/system/packages/installed/${e.repoId}/${e.name}_uninst.js`)}catch(i){return t({message:"Error removing package `"+e.name+"`",type:"error"}),void this.onfailure({code:"pkg_remove_failure",e:i,pkg:e})}}async checkFeatures(e){const t=[];for(let i of e.feature_requirements)n.o.has(i)||t.push(i);return t}async installPackage(e,t=(()=>{})){const i=[e,...await this.walkDependencies(e.getSpecificName())];for(let e of i){const t=await this.checkFeatures(e);if(t.length>0)return void this.onfailure({code:"pkg_missing_features",e:t,p:e})}for(let e of i)try{t({message:"Fetching package `"+e.name+"`",type:"info"});let i=`${e.packageRoot}/content@${e.version.toFixed(1)}.zip`;t({message:`Getting content zip at ${i}`});const n=await fetch(i),o=await n.arrayBuffer();if(t({message:"Unpacking content zip...",type:"info"}),await this.unpackContentZip(o,e,t),t({message:"Executing install script...",type:"info"}),await r.FS.exists(`c:/system/packages/installed/${e.repoId}/${e.name}_inst.js`)){const t=await r.FS.readstr(`c:/system/packages/installed/${e.repoId}/${e.name}_inst.js`);new Function(`const pm = this.pm; ${t}`).call({pm:this})}}catch(i){return t({message:"Error installing package `"+e.name+"`",type:"error"}),void this.onfailure({code:"pkg_install_failure",e:i,pkg:e})}}getPackagesByCategory(e){return"all"==e?this.packageCache:this.packageCache.filter((t=>t.category==e))}async performChecks(){await this.checkFS()}}},3361:(e,t,i)=>{"use strict";i.r(t),i.d(t,{PackageManagerApplication:()=>b});var r=i(9338),n=i(5690),o=i(7612),s=i(4779),a=i(6999),l=i(5544),c=i(2168),d=i(254),h=i(6227),p=i(3991),u=i(5516),f=i(2430),_=i(4186),g=i(9266);let m=null;class b extends _.QP{constructor(){super(),this.uiState={compactButton:{},viewInstalledButton:{}},this.pm=new g.j,this.pm.onfailure=e=>{this.failureOccured=!0,this.lastFailureData=e,console.log(e)}}async setupFS(){await this.pm.checkFS()}async openCategory(e,t=null){const i=this.mainwnd.getBodyContainer();this.ui_currentCategory=e,this.catListBox.selectItem(e);const r=this.pm.getPackagesByCategory(e);this.pkgListBox.clear(),r.sort((function(e,t){if(!e||!t)return;let i=e.friendlyName.toLowerCase(),r=t.friendlyName.toLowerCase();return i>r?1:i<r?-1:0}));let n=0;for(let e of r){if(t){const i=t.ignoreCase?e.friendlyName.toLowerCase():e.friendlyName,r=t.ignoreCase?e.name.toLowerCase():e.name;if("contains"===t.type)if(!i.includes(t.query)&&!r.includes(t.query))continue}const i=await this.pm.getPackageInstallState(e.getSpecificName());if(this.uiState.viewInstalledButton.checked&&"NOT_INSTALLED"==i)continue;const r=this.pkgListBox.addItem("",e.name);switch(r.innerHTML='<div class="icon"></div><div class="content"><span class="name"></span><span class="desc"></span></div>',r.querySelector(".name").innerText=e.friendlyName+" ("+e.name+")",r.querySelector(".desc").innerText=e.description,r.querySelector(".icon").style.backgroundImage=`url(${e.iconFiles["32x32"]})`,i){case"INSTALLED":r.classList.add("installed");break;case"BROKEN":r.classList.add("broken");break;case"UPGRADEABLE":r.classList.add("upgradeable")}r.addEventListener("click",(()=>{this.displayPackageInfo(e,{installState:i})})),n++}const o=this.mainwnd.getBodyContainer().querySelector(".content>.view>.info");for(;o.firstChild;)o.removeChild(o.firstChild);i.querySelector(".w96-footer .cell").textContent=1==n?"1 package listed":`${n} packages listed`}displayPackageInfo(e,t){const i=this.mainwnd.getBodyContainer(),r=i.querySelector(".content>.view>.info");for(;r.firstChild;)r.removeChild(r.firstChild);const n=new l.a;r.appendChild(n.getElement()),n.openPage(n.addPage("Details",(r=>{switch(r.classList.add("info-page"),r.innerHTML=`<span class="bold-noaa hdr">Actions</span>\n                                ${"INSTALLED"==t.installState?'<button class="w96-button remove">Remove</button>':"UPGRADEABLE"==t.installState?'<button class="w96-button upgrade">Upgrade</button><button class="w96-button remove">Remove</button>':"BROKEN"==t.installState?'<button class="w96-button force-remove">Force Remove</button>':'<button class="w96-button install">Install</button>'}\n                                <span class="bold-noaa hdr">Package Information</span>\n                                <span class="field"><span class="key bold-noaa">From: </span>"${this.pm.repoCache.find((t=>t.repo==e.repo)).name}"</span>\n                                <span class="field"><span class="key bold-noaa">Name: </span>${e.name} (${e.friendlyName})</span>\n                                <span class="field"><span class="key bold-noaa">Author: </span>${e.author}</span>\n                                <span class="field"><span class="key bold-noaa">Size: </span>${f.p.getSizeStringFromLength(e.installedSize)} (${f.p.getSizeStringFromLength(e.downloadSize)} to download)</span>\n                                <span class="field"><span class="key bold-noaa">Version: </span>${e.version.toFixed(1)}</span>\n                                <span class="field"><span class="key bold-noaa">Description: </span>${e.description.replace("\n","<br>")}</span>\n                                <span class="field"><span class="key bold-noaa">Depends: </span>${e.depends}</span>`,t.installState){case"BROKEN":i.querySelector(".info .w96-button.force-remove").addEventListener("click",(t=>{t.target.setAttribute("disabled",""),this.ui_forceRemove(e)}));break;case"NOT_INSTALLED":i.querySelector(".info .w96-button.install").addEventListener("click",(t=>{t.target.setAttribute("disabled",""),this.ui_install(e)}));break;case"INSTALLED":i.querySelector(".info .w96-button.remove").addEventListener("click",(t=>{t.target.setAttribute("disabled",""),this.ui_remove(e)}));break;case"UPGRADEABLE":i.querySelector(".info .w96-button.remove").addEventListener("click",(t=>{t.target.setAttribute("disabled",""),this.ui_remove(e)})),i.querySelector(".info .w96-button.upgrade").addEventListener("click",(t=>{t.target.setAttribute("disabled",""),this.ui_install(e)}))}}))),""!=e.readmeFile&&n.addPage("Description",(t=>{t.classList.add("desc-page");const i=document.createElement("iframe");i.setAttribute("sandbox","allow-same-origin"),i.src=e.readmeFile,t.appendChild(i)}))}async ui_install(e){this.setBusy(!0);try{const t=await this.pm.walkDependencies(e.getSpecificName()),i=[];for(let e of t)!e.unresolved&&e||i.push(e.item);if(i.length>0)return n.O.create({title:"Unresolved Dependencies",body:`Unable to install package due to unresolved dependencies.<br>\n                    <br>\n                    <span class="bold-noaa">Missing Packages</span>: ${i}<br>\n                    <br>\n                    You may have to add an additional source or otherwise reload your package indexes to resolve this problem.`,icon:"error",maxWidth:300,maxHeight:-1}),void this.setBusy(!1);if(p.d.getVersion()>e.max_os_version)return n.O.create({title:"Package Installation Error",body:`Your operating system is too new to install this package (max OS version ${e.max_os_version}).`,icon:"error"}),void this.setBusy(!1);if(p.d.getVersion()<e.min_os_version)return n.O.create({title:"Package Installation Error",body:`Your operating system is too old to install this package (min OS version ${e.min_os_version}).`,icon:"error"}),void this.setBusy(!1);n.O.create({title:"Package Manager",icon:"question",body:`Are you sure you want to install the following package?<br>\n                <br>\n                Please check the details below before continuing.<br>\n                <br>\n                <span class="bold-noaa">Package Name</span>: ${e.name}<br>\n                <span class="bold-noaa">Computed Dependencies</span>: ${t.map((e=>e.name))}`,events:{onclose:()=>{this.setBusy(!1)}},buttons:[{id:"yes",text:"Yes",action:t=>{t.dlg.close(),this.ui_installing(e)}},{id:"no",text:"No",action:e=>{this.setBusy(!1),e.dlg.close()}}],maxWidth:460})}catch(e){r.jC.error("Error Installing Package",String(e),"OK")}}async ui_remove(e){this.setBusy(!0);try{r.jC.confirm(`Are you sure you want to remove the following package?<br>\n            <br>\n            Please check the details below before continuing.<br>\n            <br>\n            <span class="bold-noaa">Package Name</span>: ${e.name}<br>`,(t=>{t?this.ui_removing(e):this.setBusy(!1)}),"warning").setSize(422,155).dlg.center()}catch(e){r.jC.error("Error Removing Package",String(e),"OK")}}async createStatusWindow(e,t="apps/pkmgr"){return this.createWindow({body:`\n                <div class="icon" style="background-image: url(${await o.Q.getIconUrl(t)})"></div>\n                <div class="content">\n                    <div class="status-text">\n                        ${e}\n                    </div>\n\n                    <div class="w96-textbox log"></div>\n                </div>\n            `,bodyClass:"pmdlg-status",title:"Package Manager Status",center:!0,controlBoxStyle:"WS_CBX_NONE",initialHeight:240,initialWidth:340,resizable:!1},!1)}async ui_removing(e){this.resetFail();const t=await this.createStatusWindow("Removing package, please wait...","places/trash-full");t.show();const i=t.getBodyContainer().querySelector(".log");function r(e,t){const r=document.createElement("div");r.classList.add("line"),t&&r.setAttribute("style",t),r.innerHTML=e,i.appendChild(r),i.scrollTop=i.scrollHeight}if(r("Package Manager started at "+(new Date).toString()+"\n\n"),await this.pm.removePackage(e,(e=>{r(e.message)})),this.failureOccured)n.O.create({icon:"error",body:"Error removing package. Please check the logs for more information."});else{let e=n.O.create({title:"Complete",body:"The package(s) were successfully removed.",buttons:[{id:"ok",text:"OK",action:()=>{t.close(),e.close(),this.openCategory(this.ui_currentCategory)}}],icon:"info"})}this.setBusy(!1)}async ui_installing(e){this.resetFail();const t=await this.createStatusWindow("Installing package, please wait...");t.show();const i=t.getBodyContainer().querySelector(".log");function r(e,t){const r=document.createElement("div");r.classList.add("line"),t&&r.setAttribute("style",t),r.innerHTML=e,i.appendChild(r),i.scrollTop=i.scrollHeight}if(r("Package Manager started at "+(new Date).toString()+"\n\n"),r("Recalculating dependencies before installation..."),await this.pm.installPackage(e,(e=>{r(e.message)})),this.failureOccured)n.O.create({icon:"error",body:"Error installing package. Please check the logs for more information."}),t.close();else{let e=n.O.create({title:"Complete",body:"The package(s) were successfully installed.",buttons:[{id:"ok",text:"OK",action:()=>{t.close(),e.close(),this.openCategory(this.ui_currentCategory)}}],icon:"info"})}this.setBusy(!1)}ui_forceRemove(e){this.setBusy(!0),r.jC.confirm("Are you sure you want to continue?<br><br>If you force remove this package, only the meta files will be deleted.",(async t=>{t&&await h.FS.rm(`c:/system/packages/installed/${e.repoId}/${e.name}.json`),this.setBusy(!1),this.openCategory(this.ui_currentCategory)})).setSize(322,135).dlg.center()}async initUI(){if(!await this.pm.readSources())return void r.jC.error("Error","Could not read package sources, press OK to exit.","OK");m=[{displayName:"(All)",id:"all",icon:await o.Q.getIconUrl("misc/pkmgr/all","16x16")},{displayName:"Accessories",id:"accessories",icon:await o.Q.getIconUrl("misc/pkmgr/accessories","16x16")},{displayName:"CLI",id:"cli",icon:await o.Q.getIconUrl("misc/pkmgr/cli","16x16")},{displayName:"Development",id:"development",icon:await o.Q.getIconUrl("misc/pkmgr/development","16x16")},{displayName:"Entertainment",id:"entertainment",icon:await o.Q.getIconUrl("misc/pkmgr/entertainment","16x16")},{displayName:"Libraries",id:"libraries",icon:await o.Q.getIconUrl("misc/pkmgr/libraries","16x16")},{displayName:"Productivity",id:"productivity",icon:await o.Q.getIconUrl("misc/pkmgr/produc","16x16")},{displayName:"Social",id:"social",icon:await o.Q.getIconUrl("misc/pkmgr/social","16x16")},{displayName:"System",id:"system",icon:await o.Q.getIconUrl("misc/pkmgr/system","16x16")},{displayName:"Utilities",id:"utilities",icon:await o.Q.getIconUrl("objects/tools","16x16")},{displayName:"Other",id:"other",icon:await o.Q.getIconUrl("misc/pkmgr/other","16x16")}];const e=this.createWindow({title:"Package Manager",center:!0,body:'<div class="w96-ui-inset">\n                <div class="appbar"></div>\n                <div class="toolbar"></div>\n            </div>\n            <div class="content">\n                <div class="aside">\n                    <span class="bold-noaa">Categories</span>\n                    <div class="w96-listbox">\n                        <div class="item">\n                            Yes\n                        </div>\n                    </div>\n                </div>\n                <div class="view">\n                    <span class="bold-noaa">Packages</span>\n                    <div class="packages"></div>\n                    <div class="info"></div>\n                </div>\n            </div>\n            <footer class="w96-footer">\n                <div class="cell">\n                    0 packages listed\n                </div>\n            </footer>',bodyClass:"pkmgr-app",taskbar:!0,icon:await o.Q.getIconUrl("apps/pkmgr","16x16"),initialWidth:572,initialHeight:397},!0),t=e.getBodyContainer(),i=new a.j;t.classList.add("view-compact"),i.addRoot("File",[{type:"normal",label:"Exit",onclick:()=>this.terminate()}]),i.addRoot("View",[{type:"normal",label:"Refresh",onclick:()=>Promise.all([this.reloadPackages(),this.openCategory(this.ui_currentCategory)])},{type:"separator"},this.uiState.compactButton={type:"normal",label:"Compact Mode",onclick:()=>{t.classList.contains("view-compact")?(t.classList.remove("view-compact"),this.uiState.compactButton.checked=!1):(t.classList.add("view-compact"),this.uiState.compactButton.checked=!0)},checked:!0},this.uiState.viewInstalledButton={type:"normal",label:"Show Installed Only",onclick:()=>{this.uiState.viewInstalledButton.checked=!this.uiState.viewInstalledButton.checked,this.openCategory(this.ui_currentCategory)},checked:!1}]),i.addRoot("Tools",[{type:"normal",label:"Open Package Stores",onclick:()=>d.l.execFile("c:/system/packages")},{type:"normal",label:"Edit Sources",onclick:()=>{u.xP.execCmd("ctrl",["--cpl","pkmgr"])}}]),i.addRoot("Help",[{type:"normal",label:"About",onclick:()=>n.O.create({body:'<span class="bold-noaa">Package Manager 1.0</span><br><br>Copyright (C) Windows 96 Team 2021.',icon:"info",title:"About"})}]),t.querySelector(".appbar").replaceWith(i.getMenuDiv());const l=new c.u({iconSize:16,defaults:{itemTextPosition:"right"},compact:!0});l.addItem({text:"Refresh",imageUrl:await o.Q.getIconUrl("actions/refresh","16x16"),onclick:()=>this.openCategory(this.ui_currentCategory)}),l.addSeparator(),l.addItem({text:"Search",imageUrl:await o.Q.getIconUrl("actions/search","16x16"),onclick:()=>this.showSearchUI()}),t.querySelector(".toolbar").replaceWith(l.getElement());const h=new s.w;for(let e of m){const t=h.addItem(e.displayName,e.id),i=document.createElement("div");i.style.backgroundImage=`url(${e.icon})`,i.classList.add("icon"),t.insertAdjacentElement("afterbegin",i),t.addEventListener("click",(()=>this.openCategory(e.id)))}t.querySelector(".aside>.w96-listbox").replaceWith(h.getElement()),this.catListBox=h;const p=new s.w,f=p.getElement();f.classList.add("packages"),t.querySelector(".view>.packages").replaceWith(f),this.pkgListBox=p,e.onclose=e=>{if(this.busy)return e.canceled=!0;u.xP.wmem.pkRunning=!1},e.show(),this.mainwnd=e}async reloadPackages(){if(this.packages=[],this.failureOccured=!1,this.setBusy(!0),null==this.pm.srcConfig.sources||this.pm.srcConfig.sources.length<0)return r.jC.error("Error","No sources are available.","OK"),this.terminate();await this.pm.reloadPackageCache(),this.failureOccured&&(r.jC.error("Error","One or more sources failed to refresh.<br><br>Old indexes will be used instead, but you may encounter errors installing packages.","OK").setSize(322,135),this.resetFail()),this.setBusy(!1)}setBusy(e){const t=this.mainwnd.getBodyContainer();this.busy=e,this.busy?this.mainwnd.getBodyContainer().classList.add("busy"):(this.mainwnd.getBodyContainer().classList.remove("busy"),t.querySelectorAll(".info>.w96-button").forEach((e=>e.removeAttribute("disabled"))))}resetFail(){this.failureOccured=!1,this.lastFailureData=null}async main(e){if(super.main(e),u.xP.wmem.pkRunning)return void r.jC.error("Error","Only 1 instance may be running!","OK");u.xP.wmem.pkRunning=!0,this.packages=[],await this.setupFS(),await this.initUI();const t=r.jC.idleProgress("Package Manager","Reloading sources, please wait...");try{this.progress=t,await this.reloadPackages()}catch(e){console.log(e),r.jC.error("Error","Failed reloading packages. Please check your internet connection.","OK")}t.closeDialog(),this.progress=null,this.openCategory("all"),this.mainwnd.activate(),"true"!=localStorage.getItem("pkmgrui_wdone")&&(n.O.create({title:"Welcome",body:'<span class="bold-noaa">Welcome to the package manager!</span><br><br>\n                Software on your disk is organized in packages, which are usually software/addons, but can be anything really.<br><br>\n                It is recommended to only install what you need, it is easy to fill up your disk space with too much installed.<br><br>\n                <span style="color: darkred">\n                Packages served outside the official repository could be malicious! As with any software, use it at your own risk!\n                </span>',maxWidth:410,icon:"info"}),localStorage.setItem("pkmgrui_wdone","true"))}showSearchUI(){return n.O.prompt("Enter package search text",{title:"Package Manager Search"},(e=>{e&&""!=e.trim()&&this.openCategory(this.ui_currentCategory,{type:"contains",ignoreCase:!0,query:e.toLowerCase()})}))}ontermination(){super.ontermination(),this.pm=null}}},3516:(e,t,i)=>{"use strict";i.d(t,{p:()=>l});var r=i(9338),n=i(5690),o=i(7612),s=i(9471),a=i(4186);class l extends a.QP{constructor(){super(),this.wizardInfo={name:"Untitled Wizard"},this.pages=[{id:"intro",type:"intro",body:"This wizard will help you install program XYZ",graphic:"/system/resource/ui/wizard/graphic-unknown.png",titleText:"Welcome to the installation wizard lol xD",buttons:[{class:"back",onclick:()=>{},enabled:!1,text:"Back"},{class:"next",onclick:()=>{},enabled:!0,text:"Next"},{class:"cancel",onclick:()=>this.quit(),enabled:!0,text:"Cancel"}],onopen:(e,t)=>{}},{id:"page",type:"page",body:"bla",graphic:"/system/resource/ui/wizard/graphic-top.png",titleText:"Sample text",description:"Sample text lolololol",buttons:[{class:"back",onclick:()=>this.openPage("intro",[]),enabled:!0,text:"Back"},{class:"next",onclick:()=>{},enabled:!0,text:"Next"},{class:"cancel",onclick:()=>this.quit(),enabled:!0,text:"Cancel"}],onopen:(e,t)=>{}}]}quit(){r.jC.confirm("Are you sure you want to quit?",(e=>{e&&this.mainwnd.close()}))}clearPage(){const e=this.mainwnd.getBodyContainer();for(;e.firstChild;)e.removeChild(e.firstChild)}findPage(e){return this.pages.find((t=>t.id==e))}openPage(e,t){this.clearPage();const i=this.mainwnd.getBodyContainer(),r=this.findPage(e);if(r){"intro"==r.type?(this.mainwnd.setHtml('\n            <div class="container intro">\n                <div class="box">\n                    <div class="graphic"></div>\n                    <div class="content">\n                        <div class="title"></div>\n                        <div class="description">TODO</div>\n                        <span class="explain bold-noaa">Click Next to continue.</span>\n                    </div>\n                </div>\n                <div class="buttons"></div>\n            </div>\n            '),i.querySelector(".box>.graphic").style.backgroundImage=`url(${r.graphic})`,i.querySelector(".content>.title").innerText=r.titleText,i.querySelector(".content>.description").innerHTML=r.body):"page"==r.type?(this.mainwnd.setHtml('\n            <div class="container page">\n                <div class="box">\n                    <div class="top">\n                        <div class="title bold-noaa">TODO</div>\n                        <div class="description">TODO</div>\n                    </div>\n                    <div class="content">\n                        TODO\n                    </div>\n                </div>\n                <div class="buttons"></div>\n            </div>\n            '),i.querySelector(".top").style.backgroundImage=`url(${r.graphic})`,i.querySelector(".top>.title").innerText=r.titleText,i.querySelector(".top>.description").innerHTML=r.description,i.querySelector(".content").innerHTML=r.body):this.mainwnd.setHtml(r.body);for(let e of[...r.buttons]){const t=s.K.mkElement("button",["w96-button",e.class]);t.innerText=e.text,t.addEventListener("click",e.onclick),t.disabled=!e.enabled,i.querySelector(".container>.buttons").appendChild(t)}r.onopen(i.querySelector(".container"),t)}else n.O.alert("The specified wizard page "+e+" was not found.")}async main(){this.mainwnd=this.createWindow({bodyClass:"wizard-app",initialWidth:482,initialHeight:371,controlBoxStyle:"WS_CBX_CLOSE",taskbar:!0,icon:await o.Q.getIconUrl("mime/executable","16x16"),resizable:!1,title:"Untitled Wizard"},!0),this.mainwnd.show()}}},42:(e,t,i)=>{"use strict";i.r(t),i.d(t,{NewTerminalApplication:()=>k});var r=i(4186),n=i(1350),o=i(6227),s=i(2320),a=i(2617),l=i(292),c=i(7612),d=i(3080),h=i(8223),p=i(722),u=i(3991),f=i(7362),_=i(120),g=i(4876);const m={name:"bins",register:function(e,t){return async(i,r)=>{const n=f.nP.getEnv("path").split(";");for(let i of n){if(await o.FS.isFile(i))continue;if(!await o.FS.exists(i))continue;e.println(t.color.cyan(`${i}`));const r=[];for(let e of await o.FS.readdir(i))!e.endsWith(".txt")&&await o.FS.isFile(e)&&r.push(e);const n=r.map((e=>o.FSUtil.fname(e))).join(", ");e.println(n)}}}};i(3978);const b=["__exe","__lnk","about-ui","devtools","runlnk42","__support-us","hterm","dd","__conhost"],y=[{name:"ls",aliases:["dir"],register:function(e,t){return async(i,r)=>{const n=i.split(" ")[0];if(r.includes("--help"))return e.write(`usage: ${n} [path]\nLists the contents of a directory.\n\nIf [path] is specified, it will list the contents of that directory instead of the current working directory.`),0;const s=r.join(" ").substring(3);let a=t.cwd;if(""!=s&&(a=s),/^([a-zA-Z]:)/.test(a)||(a=t.resolvePath(t.cwd,a)),!await o.FS.exists(a))return e.write(e.color.red(`error: unable to access '${a}': no such file or directory.`)),1;if(await o.FS.isFile(a))return t.write(t.color.greenBright(a)),0;const l=await o.FS.readdir(a),c=[],d=[];for(let e of l)await o.FS.isFile(e)?d.push(t.color`{greenBright ${g.R.fname(e)}}`):c.push(t.color`{hex('4169E1') ${g.R.fname(e)}/}`);c.length>0&&e[d.length>0?"writeln":"write"](c.join("\r\n")),d.length>0&&e.write(d.join("\r\n"))}}},{name:"clear",aliases:["cls"],register:function(e,t){return(i,r)=>{const n=i.split(" ")[0];r.includes("--help")?e.println(`usage: ${n}\nClears the current terminal window.`):t.term.write("c")}}},{name:"cd",aliases:["chdir"],register:function(e,t){return async(i,r)=>{const n=i.split(" ")[0];if(r.includes("--help"))return e.write(`usage: ${n} <path>\nChanges the current directory.`),0;let s=r.join(" ").substring(n.length+1);return""==s?(e.write(`cd: '${n}' requires a directory argument (none specified).`),1):(/^([a-zA-Z]:)/.test(s)||(s=t.resolvePath(t.cwd,s)),await o.FS.exists(s)?await o.FS.isFile(s)?(e.write(t.color.red("cd: cannot cd to a file.")),1):void("/"!==s&&(t.cwd=s)):(e.write(t.color.red(`cd: unable to access '${s}': No such file or directory.`)),1))}}},{name:"cat",aliases:["type"],register:function(e,t){return async(i,r)=>{const n=i.split(" ")[0];if(r.includes("--help"))return e.print(`usage: ${n} <path> [path(s) ...]\nConcatenates files.`),0;for(var s of(r.shift(),r[0]||e.printError(`cat: '${n}' requires a file path argument (none specified).`),r)){let i=s;if(""==i||null==i)return e.printError(`cat: '${n}' requires a file path argument (none specified).`),1;if(/^([a-zA-Z]:)/.test(i)||(i=t.resolvePath(t.cwd,i)),!await o.FS.exists(i))return e.printError(`cat: unable to access '${i}': No such file or directory.`),1;if(!await o.FS.isFile(i))return e.printError("cat: invalid argument."),1;e.println(await o.FS.readstr(i))}}}},{name:"touch",register:function(e,t){return async(i,r)=>{if(r.includes("--help"))return t.println("usage: touch <path>\nCreates an empty file."),0;let n=r[1];return""==n||null==n?(e.printError("touch: 'touch' requires a file path argument (none specified)."),1):(/^([a-zA-Z]:)/.test(n)||(n=t.resolvePath(t.cwd,n)),await o.FS.exists(n)?await o.FS.isFile(n)?(e.printError(`touch: file '${n}' exists.`),1):(e.printError("Error: invalid argument."),1):void await o.FS.writebin(n,[]))}}},m,{name:"mkdir",aliases:["md"],register:function(e,t){return async(i,r)=>{const n=i.split(" ")[0];if(r.includes("--help"))return e.println(`usage: ${n} <path>\nCreates a new directory.`),0;const s=[...r];if(s.splice(0,1),0==s.length)return e.printError("mkdir: no directory name was specified."),1;let a=0;for(let i of s)try{let r=i;if(/^([a-zA-Z]:)/.test(r)||(r=t.resolvePath(t.cwd,r)),await o.FS.exists(r)){e.printError(`mkdir: '${r}': path exists.`),a=1;continue}await o.FS.mkdir(r)}catch(t){e.printError("mkdir: could not create directory:"),e.printError(new String(t))}return a}}},{name:"exit",register:function(e,t){return async(e,i)=>t.quit()}},{name:"icon",register:function(e,t){return(i,r)=>{if(r.includes("--help"))return void e.println("usage: icon <url>\nSets the current window icon.");const n=i.substring(4).trim();""!=n?t.wnd.setWindowIcon(n):e.printError("No URL has been specified.")}}},{name:"echo",register:function(e,t){return async(t,i)=>{if(i.includes("--help"))return void e.println("usage: echo <text>\nOutputs text to the terminal.");const r=t.substring(4).trim();""!=r&&e.print(r)}}},{name:"fetch",register:function(e,t){return async(i,r)=>{if(r.includes("--help"))return void e.println("usage: fetch <url> [-o OUTPUT_PATH]\nFetches contents from URL.\n\nIf option -o is specified, an output path must be specified to save the file.");const n=r[1];if(null==n||""==n.trim())return void e.printError("fetch: No URL has been specified.");let s=null;for(var a=0;a<r.length;a++)if("-o"==r[a]){if(null==r[a+1]||""==r[a+1].trim())return void t.printError("fetch: No output path specified.");const i=r[a+1].trim(),n=t.resolvePath(t.cwd,i);if(await o.FS.exists(n)&&!await o.FS.isFile(n))return void e.printError("fetch: A directory already exists with this output name.");s=n}const l=await fetch(n,{cache:"no-cache",method:"GET",mode:"no-cors"});if(null!=s)await o.FS.writebin(s,new Uint8Array(await l.arrayBuffer())),e.println("Fetch complete");else{const t=await l.text();e.println(t,{escapeANSI:!0})}}}},{name:"help",register:function(e,t){return async(i,r)=>{if(r.includes("--help"))return void e.println("usage: help\nDisplays command line help.");e.println(t.color.cyan("Built-ins"));const n=Object.values(y).map((e=>e.aliases?`(${e.name}, ${e.aliases.join(", ")})`:e.name));n.sort((function(e,t){return e>t?1:e<t?-1:0}));let s="";for(let e of n)s+=e+", ";e.println(s.substring(0,s.length-2)),e.println(t.color`\n{cyan Installed Applications}`);const a=(0,f.V7)();a.sort((function(e,t){return e>t?1:e<t?-1:0}));let l="";for(let e of a){if(b.includes(e))continue;l+=e+", "}e.println(l.substring(0,l.length-2));const c=f.nP.getEnv("path").split(";");for(let i of c){if(await o.FS.isFile(i))continue;if(!await o.FS.exists(i))continue;e.println("\n"+t.color.cyan(`${i}`));const r=[];for(let e of await o.FS.readdir(i))!e.endsWith(".txt")&&await o.FS.isFile(e)&&r.push(e);const n=r.map((e=>o.FSUtil.fname(e))).join(", ");e.println(n)}}}},{name:"rm",aliases:["del","delete"],register:function(e,t){return async(i,r)=>{const n=i.split(" ")[0];if(r.includes("--help"))return e.println(`usage: ${n} <path> [-R, --no-preserve-root]\nRemoves a file.\n\nIf -R is specified, it will remove a directory and its contents recursively.\nIf --no-preserve-root is specified, it will allow the root of the drive to be deleted.`),0;let s=!r.includes("--no-preserve-root"),a=!!r.includes("-R");_.A.stripOptions(1,r,["-R","--no-preserve-root"]);let l=r[1];if(""==l||null==l)return e.printError(`rm: '${n}' requires a file path argument (none specified).`),1;if(/^([a-zA-Z]:)/.test(l)||(l=t.resolvePath(t.cwd,l)),!await o.FS.exists(l))return e.printError(`rm: unable to access '${l}': No such file or directory.`),1;if(await o.FS.isFile(l))await o.FS.rm(l);else{if(!a)return e.printError(`rm: cannot remove '${l}': Is a directory.`),1;const t=o.FSUtil.deconstructFullPath(l);if("/"==t.path&&s)return e.printError(`rm: refusing to remove "${l}" - it is potentially dangerous.\nYou may specify --no-preserve-root to bypass this message.`),1;if("/"==t.path){const e=await o.FS.readdir(l);for(let t of e)await o.FS.isFile(t)?await o.FS.rm(t):await o.FS.rmdir(t)}else await o.FS.rmdir(l)}return 0}}},{name:"cp",aliases:["copy"],register:function(e,t){return async(i,r)=>{const n=i.split(" ")[0];if(r.includes("--help"))return e.println(`usage: ${n} <src> <dest> [-R, --overwrite]\nCopies a file.\n\nIf -R is specified, the specified directory will be recursively copied.\nIf --overwrite is specified, it will overwrite the target path.`),0;let s=r.includes("-R"),a=r.includes("--overwrite");_.A.stripOptions(1,r,["-R","--overwrite"]);let l=r[1],c=r[2];if(""==l||null==l)return e.printError(`cp: '${n}' requires a source path argument (none specified).`),1;if(""==c||null==c)return e.printError(`cp: '${n}' requires a dest path argument (none specified).`),1;if(/^([a-zA-Z]:)/.test(l)||(l=t.resolvePath(t.cwd,l)),/^([a-zA-Z]:)/.test(c)||(c=t.resolvePath(t.cwd,c)),!await o.FS.exists(l))return e.printError(`cp: unable to access '${l}': No such file or directory.`),1;if(await o.FS.isFile(l)){if(await o.FS.exists(c)){if(!await o.FS.isFile(c))return e.printError(`cp: refusing to overwrite '${c}': Target is not a file.`),1;if(!a)return e.printError(`cp: refusing to overwrite '${l}': File exists. Use option --overwrite to overwrite this file.`),1}await o.FS.cpfile(l,c)}else{if(!s)return e.printError(`cp: cannot copy '${l}': Is a directory. Specify -R to copy this directory.`),1;if(await o.FS.exists(c)){if(await o.FS.isFile(c))return e.printError(`cp: refusing to overwrite '${c}': Target is not a directory.`),1;if(!a)return e.printError(`cp: refusing to overwrite '${c}': Directory exists. Use option --overwrite to overwrite this directory.`),1}await o.FS.cpdir(l,c)}return 0}}},{name:"mv",aliases:["move"],register:function(e,t){return async(i,r)=>{const n=i.split(" ")[0];if(r.includes("--help"))return e.println(`usage: ${n} <src> <dest> [--overwrite]\n       ${n} <srcdir> <destdir> [--merge]\n\nMoves a file or directory.\n\nIf --overwrite is specified, it will overwrite the target path if it exists.\nIf --merge is specified, the target directory will be merged with the source. Merging may overwrite contents that exist in the directory.`),0;let s=r.includes("--overwrite"),a=r.includes("--merge");_.A.stripOptions(1,r,["--overwrite","--merge"]);let l=r[1],c=r[2];if(""==l||null==l)return e.printError(`mv: '${n}' requires a source path argument (none specified).`),1;if(""==c||null==c)return e.printError(`mv: '${n}' requires a dest path argument (none specified).`),1;if(/^([a-zA-Z]:)/.test(l)||(l=t.resolvePath(t.cwd,l)),/^([a-zA-Z]:)/.test(c)||(c=t.resolvePath(t.cwd,c)),!await o.FS.exists(l))return e.printError(`mv: unable to access '${l}': No such file or directory.`),1;if(await o.FS.isFile(l)){if(await o.FS.exists(c)){if(!await o.FS.isFile(c))return e.printError(`mv: refusing to overwrite '${c}': Target is not a file.`),1;if(!s)return e.printError(`mv: refusing to overwrite '${c}': File exists. Use option --overwrite to overwrite this file.`),1}await o.FS.mvfile(l,c)}else{if(await o.FS.exists(c)){if(await o.FS.isFile(c))return e.printError(`mv: refusing to overwrite '${c}': Target is not a directory.`),1;if(!a)return e.printError(`mv: refusing to overwrite '${c}': Directory exists. Use option --merge to merge this directory instead.`),1}const t=o.FSUtil.deconstructFullPath(c);if("/"==o.FSUtil.deconstructFullPath(l).path)return e.printError("mv: function not supported."),1;if("/"==t.path)return e.printError("mv: cannot move files directly to root."),0;await o.FS.mvdir(l,c)}return 0}}},{name:"env",register:function(e,t){return(t,i)=>{if(i.includes("--help"))return e.println("usage: env [filter]\nPrints all environment variables.\n\nIf [filter] is specified, all variable names containing [filter] will be returned."),0;let r=null==i[1]?"":i[1];let n=f.nP.envKeys().filter((e=>e.includes(r))).map((t=>{const i=t,r=new String(f.nP.getEnv(t)).replace(/\n/g,e.color`{red \\n}`).replace(/\t/g,e.color`{red \\t}`);return e.color`${i} {cyan = }${r}`})).join("\n");e.println(n)}}},{name:"pwd",register:function(e,t){return(i,r)=>{const n=i.split(" ")[0];r.includes("--help")?e.println(`usage: ${n}\nPrint the current working directory`):e.write(t.cwd)}}}];var v=i(254),w=i(5516);class x{constructor(e){this.color=e.color,this._wndsetTitle=e.setTitle,this.term=e.xterm,this.iterm=e.term,this.cfg=e.cfg,this.argv=e.argv,this.initialTerminal=!!e.initialTerminal,this.cwd=w96.isRecovery?"x:/":"c:/user",this.builtIns=function(e){let t={};for(let i of y){let r=i.register(e.iterm,e);t[i.name]=r.bind(e);for(let n of i.aliases||[])t[n]=r.bind(e)}return t}(this),this.history=[],this._command="",this._isRunning=!1,this._finish=null,this._historyOption=0,this._newHistory=[],this._historyInProgress=!1,this._promptLength=0,this._commandRunning=!1,this._cursor=0,this._promptText="",this._histPath=w96.isRecovery?"c:/.hist":"c:/user/.wsh_history"}run(){return new Promise(((e,t)=>{this._isRunning&&t("Already running."),this._isRunning=!0,this._finish=()=>{this._isRunning=!1,e()},this._start()}).bind(this))}quit(){return!!this._isRunning&&(this._finish(),!0)}resolvePath(e,t){if(/^([a-zA-Z]:)/.test(t))return t;let i=g.R.resolvePath(e,t);2==i.length&&(i+="/");const r=g.R.deconstructFullPath(this.cwd).prefix;return i.includes("/")?i:r+i}async _start(){let e=this.iterm,t=this.color;var i=$96.buildId;if(i||(i=(await fetch("/system/images/bstr.json",{cache:"no-store"}).then((e=>e.json()))).bstr),e._setInputIface(this._attachStdin.bind(this)),this.term.onData(this._onData.bind(this)),this.argv[0]){this.initialTerminal&&await this._runCommand("clear",!0);let e=!1;if("-c"===this.argv[0]&&(this.argv.shift(),e=!0),this._setTitle(this.argv[0]),await this._runCommand(this.argv.join(" "),!e),!e)return await this._runCommand("exit",!0)}else await this._readHistory(),e.write([t`{hex('#00FFFF') SYS36 Windows 96 [Version ${u.d.getVersionString()}.${i.split(".")[0]}]}`,t`{hex('#00FFFF') (c) 2022 Sys36.}`," "].join("\n")),this._prompt()}_clearCommand(e=!0){for(let e of this._command)this.term.write("\b \b");e&&(this._command="")}_setCursorPos(e,t=!1){for(let i=0;i<e;i++)this.term.write("["+(t?"D":"C"))}_resetHistoryState(){this._historyOption=0,this._newHistory=[],this._historyInProgress=!1}_onData(e){let t=this.term;if(this._commandRunning)return this._stdin&&this._stdin(e);switch(e){case"":t.write("^C"),this._prompt();break;case"\r":if(""===this._command)return this._prompt();this._runCommand(this._command);break;case"[A":if(this._historyInProgress){if(this._historyOption+=1,void 0===this._newHistory[this._historyOption])return this._historyOption-=1}else if(this._historyInProgress=!0,this._newHistory=[...this.history.filter((e=>e)).filter((e=>e.startsWith(this._command))),this._command+""].reverse(),this._historyOption=1,void 0===this._newHistory[this._historyOption])return void this._resetHistoryState();this._clearCommand();let i=this._newHistory[this._historyOption];t.write(i),this._command=i,this._cursor=this._command.length;break;case"[B":if(!this._historyInProgress)return;if(this._historyOption-=1,void 0===this._newHistory[this._historyOption])return this._historyOption+=1;this._clearCommand();let r=this._newHistory[this._historyOption];t.write(r),this._command=r,this._cursor=this._command.length;break;case"[C":this._cursor<this._command.length&&(this._cursor+=1,t.write(e));break;case"[D":this._cursor>0&&(this._cursor-=1,t.write(e));break;case"":this._historyInProgress&&this._resetHistoryState(),t._core.buffer.x>this._promptLength&&(t.write("\b \b"),this._command.length>0&&(this._command=this._command.substring(0,this._cursor-1)+this._command.substring(this._cursor),this._cursor-=1,this._cursor!==this._command.length&&(this.term.write(`\r[K${this._promptText}`),this.term.write(this._command),this._setCursorPos(this._command.length-this._cursor,!0))));break;default:if(e>=String.fromCharCode(32)&&e<=String.fromCharCode(123)&&(this._historyInProgress&&this._resetHistoryState(),this._cursor+=e.length,this._command=this._command.substring(0,this._cursor-1)+e+this._command.substring(this._cursor-1),t.write(e),this._cursor<this._command.length)){this._setCursorPos(this._command.length-this._cursor-e.length);for(let t=0;t<this._command.length-e.length;t++)this.term.write("\b \b");this.term.write(this._command),this._setCursorPos(this._command.length-this._cursor,!0)}}}async _pushHistory(e,t){t||this.history[this.history.length-1]!==e&&(this.history.push(e),await o.FS.writestr(this._histPath,JSON.stringify(this.history)))}async _readHistory(){try{!w96.isRecovery&&await o.FS.exists(this._histPath)?this.history=JSON.parse(await o.FS.readstr(this._histPath)):w96.isRecovery||await o.FS.writestr(this._histPath,"[]")}catch(e){this._err("failed to read history\n")}}async _runCommand(e,t=!1){let i=this.iterm,r=this.color;i.write(this.iterm.hasNewLine?"":"\n"),this._commandRunning=!0,this._setTitle(e);try{let n=e+"";const s=f.nP.envKeys();for(let e of s)n=n.replaceAll(new RegExp("\\$"+e,"gi"),f.nP.getEnv(e));const a=_.A.parse(n);if(a.length<1)return this._prompt();const l=a[0],c=this.resolvePath(this.cwd,a[0]);if(await this._pushHistory(e,t),"wsh"===l){let e=new x({color:this.color,setTitle:e=>{this._setTitle("wsh - "+e)},xterm:this.term,term:this.iterm,cfg:this.cfg,argv:[...a].slice(1)});await e.run()}else if((0,f.K2)(l)){const e=[...a];e.splice(0,1),await(0,f.lw)(l,e,{term:i})}else if(/^([a-zA-Z]:)/.test(n)&&2==n.length){const e=n[0]+":";null!=o.FS.get(e)?this.cwd=e+"/":this._err(r`{red device not found:} {yellow ${e}/}`)}else if(this.builtIns[l]){if(await this.builtIns[l](n,a),"exit"==l)return}else if(await o.FS.exists(c))await v.l.execFile(c,{args:[...a],term:i,cwd:this.cwd});else{let e=null;for(let t of f.nP.getEnv("path").split(";")){const i=t+"/"+a[0];if(await o.FS.exists(i)){e=i;break}}if(null!=e){let e=[...a];e.splice(0,1),await w.xP.execCmd(a[0],e,{term:i,cwd:this.cwd})}else this._err(`command not found: ${a[0]}`)}}catch(e){console.error(e),i.write(r`{redBright ${e.stack}}`)}t||this._prompt()}_err(e){this.iterm.write("wsh: "+e)}_prompt(){this._command="",this._commandRunning=!1,this._stdin=null,this._cursor=0,this._resetHistoryState();let e=this.cwd;e=e.replace("c:/user","~"),"~/"===e&&(e="~"),this._promptLength=e.length+3,this._setTitle(e),this._promptText=this.color`{greenBright ${e}} {hex('#DDCDCA') $} `,this.iterm.write((this.iterm.hasNewLine?"":"\n")+this._promptText)}_setTitle(e){this._wndsetTitle(e)}_attachStdin(e){this._stdin=e}end(){}}var C=i(4101);let S={foreground:"#eff0eb",background:"#282a36",selection:"#97979b33",black:"#282a36",brightBlack:"#686868",red:"#ff5c57",brightRed:"#ff5c57",green:"#5af78e",brightGreen:"#5af78e",yellow:"#f3f99d",brightYellow:"#f3f99d",blue:"#57c7ff",brightBlue:"#57c7ff",magenta:"#ff6ac1",brightMagenta:"#ff6ac1",cyan:"#9aedfe",brightCyan:"#9aedfe",white:"#f1f1f0",brightWhite:"#eff0eb"},E=!1;class k extends r.QP{constructor(){super()}async main(e){super.main(e),this.disposable=[],this._createWindow(e)}async _createWindow(e){E||(await h.a.loadStyleAsync("/system/resource/stylesheets/xterm.css"),E=!0);var t=new n.Lw;t.title="Terminal",t.initialWidth=900,t.initialHeight=500,t.resizable=!0,"--no-ctrl"===e[0]&&(t.controlBoxStyle="WS_CBX_NONE",e.shift());var i=this.createWindow(t,!0);i.registerWindow(),i.registerAppBar(),i.setHtml('<div class="terminal-new"></div>');const r=i.wndObject.querySelector(".window-html-content");r.classList.add("terminal-app"),i.setWindowIcon(await c.Q.getIconUrl("apps/terminal","16x16"));let o,u,f=!1,_={shell:"$builtin$",theme:S,fontFamily:'fixed_bmp, "Cascadia Code", Menlo, monospace',fontSize:13,cursorBlink:!0,scrollback:1e3};try{w96.isRecovery||void 0===C.F.get("Software/Terminal")?w96.isRecovery||await C.F.setAndSync("Software/Terminal",_):_={..._,...C.F.get("Software/Terminal")}}catch(e){f=!0}i.onshown=async()=>{u=new s.Terminal({theme:_.theme,fontFamily:_.fontFamily,fontSize:_.fontSize,scrollback:_.scrollback}),this.disposable.push(u),o=new a.FitAddon,u.loadAddon(o),this.disposable.push(o),u.open(g),g.querySelector(".xterm").addEventListener("wheel",(e=>{u.buffer.active.baseY>0&&e.preventDefault()}));try{let e=new l.WebglAddon;u.loadAddon(e),this.disposable.push(e)}catch(e){console.warn("Failed to load WebGL renderer",e)}window.dispatchEvent(new Event("resize")),o.fit(),f&&u.writeln(d.$`{red Failed to parse configuration. Please rectify it.}`);let t=new p.H(u,d.$,i),r={xterm:u,term:t,setTitle:i.setTitle.bind(i),color:d.$,cfg:_,argv:e,initialTerminal:!0,mainwnd:i};u.focus(),u.setOption("cursorBlink",_.cursorBlink),"$builtin$"!==_.shell&&(r.argv=[_.shell,...e]);let n=new x(r);this.shell=n,await n.run(),i.close()},i.onresize=()=>{o&&o.fit()},i.onlightenelements=()=>{try{u.focus()}catch(e){}},i.show();let g=r.querySelector(".terminal-new");g.style.backgroundColor=_.theme.background,this.mainwnd=i}ontermination(){super.ontermination(),this.disposable.forEach((e=>{e.dispose()})),this.shell.end()}}},722:(e,t,i)=>{"use strict";i.d(t,{H:()=>o});const r=["[\\u001B\\u009B][[\\]()#;?]*(?:(?:(?:(?:;[-a-zA-Z\\d\\/#&.:=?%@~_]+)*|[a-zA-Z\\d]+(?:;[-a-zA-Z\\d\\/#&.:=?%@~_]*)*)?\\u0007)","(?:(?:\\d{1,4}(?:;\\d{0,4})*)?[\\dA-PR-TZcf-ntqry=><~]))"].join("|"),n=new RegExp(r);class o{constructor(e,t,i){this.term=e,this.color=t,this.wnd=i,this._lastChars=new Array(50).fill(" "),this._setInput=()=>{},this._actualHandler=()=>{}}get lastChars(){return this._lastChars.join("")}get hasNewLine(){return this.lastChars.endsWith("\r\n")}_pushCharacters(e){let t=e.split("");for(let e of t)this._lastChars.shift(),this._lastChars.push(e)}_setInputIface(e){this._setInput=e}write(e,t={}){(t={convertCRLF:void 0===t.convertCRLF||!!t.convertCRLF,escapeANSI:void 0!==t.escapeANSI&&!!t.escapeANSI}).convertCRLF&&(e=e.split("\n").join("\r\n")),t.escapeANSI&&(e=this.escapeANSI(e)),this.term.write(e),this._pushCharacters(e)}writeln(e,t){this.write(e+"\n",t)}print(e,t){this.write(e,t)}println(e,t){this.write(e+"\n",t)}printlnEscaped(e,t){this.write(e+"\n",t)}printError(e,t){this.write(this.color.red(e)+"\n",t)}prompt(e,t=!1){let i=`${this.hasNewLine?"":"\n"}${e}`,r=i.length,n="",o=0,s=(e,t=!1)=>{for(let i=0;i<e;i++)this.write("["+(t?"D":"C"))};return new Promise((a=>{this._setInput((i=>{switch(i){case"":if(!t)return;this.write("^C"),a(null);break;case"\r":if(""===n)return;this.write("\n"),this._setInput(this._actualHandler),a(n);break;case"[C":o<n.length&&(o+=1,this.write(i));break;case"[D":o>0&&(o-=1,this.write(i));break;case"":this.term._core.buffer.x>r&&(this.write("\b \b"),n.length>0&&(n=n.substring(0,o-1)+n.substring(o),o-=1,o!==n.length&&(this.write(`\r[K${e}`),this.write(n),s(n.length-o,!0))));break;default:if(i>=String.fromCharCode(32)&&i<=String.fromCharCode(123)&&(o+=i.length,n=n.substring(0,o-1)+i+n.substring(o-1),this.write(i),o<n.length)){s(n.length-o-i.length);for(let e=0;e<n.length-i.length;e++)this.write("\b \b");this.write(n),s(n.length-o,!0)}}})),this.write(i)}))}pause(){return new Promise((e=>{this._setInput((t=>{t>=String.fromCharCode(32)&&t<=String.fromCharCode(123)&&(this.write("\n"),e())})),this.write((this.hasNewLine?"":"\n")+"Press any key to continue . . .")}))}clear(){this.write("\nc")}escapeANSI(e){return e.replace(n,"")}onData(e){this._setInput(e),this._actualHandler=e}}},4186:(e,t,i)=>{"use strict";i.d(t,{QP:()=>a,Ue:()=>l,zF:()=>s});var r=i(1350),n=i(4876),o=0,s=new Array(8192);class a{constructor(){if(this.appId=o++,this.appId>s.length)throw new Error("Maximum number of processes reached, id >= "+s.length);s[this.appId]=this,this.appWindow=null,this.windows=[],this.onterminated=null,this.title="unnamed",this.execCtx={},this._running=!1,this._terminating=!1,this._appResult=null}static async kill(e,t){let i=s[e];if(null==i)throw new Error("Application not found.");if(t){try{i.ontermination()}catch(e){}for(let e of i.windows)e.close(!0),e.wndObject&&e.wndObject.remove()}else await i.ontermination(),s[e]=null;const r=Reflect.ownKeys(i);for(let e of r)i[e]=null;i=null}static execAsync(e,t,i={}){return new Promise((async(r,o)=>{try{e.onterminated=function(e){r(e)},null!=i&&(e.title=n.R.fname(i.launchCommand||"")||"unnamed",e.execCtx=i);let o=await e.main(null==t?[]:t,i);e.windows.length<1&&r(o)}catch(e){o(e)}}))}setAppResult(e){this._appResult=e}terminate(){this.ontermination()}createWindow(e,t){var i=new r.DI(e);if(t&&null!=this.appWindow)throw new Error("An application window has already been defined.");if(t){this.appWindow=i;var n=this;this.appWindow.onfinalclose=function(){n.ontermination()},this.windows.push(this.appWindow)}else this.windows.push(i);return i}main(e){if(!(e instanceof Array))throw new Error("Invalid argument.");if(this._running)throw new Error("The application has already started. Please create a new instance using the `new` operator.");this._running=!0}ontermination(){if(!this._terminating){this._terminating=!0;for(var e=0;e<this.windows.length;e++){const t=this.windows[e];if(null==this.appWindow||this.appWindow.id!=t.id){try{t.close()}catch(e){console.error("Failed to close window for application `"+this.appId+"`.")}this.windows[e]=null}}null!=this.appWindow&&this.appWindow.close(),this.appWindow=null,this.execCtx=null,s[this.appId]=null,null!=this.onterminated&&this.onterminated(this._appResult)}}}class l{static getImageNames(){return s.filter((e=>null!=e)).map((e=>e.title))}static getFromPid(e){return s.find((t=>null!=t&&t.appId==e))}static async quit(e,t=!1){switch(typeof e){case"number":await a.kill(e,t);break;case"string":await a.kill(s.find((t=>t.title==e)),t)}}static getRunningProcesses(){return s.filter((e=>null!==e))}}},9951:(e,t,i)=>{"use strict";i.d(t,{E:()=>n,s:()=>o});const r={simpleAnimation:!1};function n(e){r.simpleAnimation=e}function o(e,t,i){r.simpleAnimation&&"function"==typeof i&&i();var n=null;function o(){n.classList.remove("animated",t),n.removeEventListener("animationend",o),"function"==typeof i&&i()}"string"!=typeof e?n=e:document.querySelector(e),n.classList.add("animated",t),t?n.addEventListener("animationend",o):o()}},9338:(e,t,i)=>{"use strict";i.d(t,{MT:()=>p,Vu:()=>g,_5:()=>_,_p:()=>f,jC:()=>m,pp:()=>u});var r=i(1350),n=i(4876),o=i(6227),s=i(3978),a=i(408),l=i(7612),c=i(1674);function d(e,t,i,r){var n=new f(e,t,"info",i,null,r);return n.show(),n}function h(e,t,i){var r=new f(e,t,"warning",i);return l.Q.playSound("asterisk"),r.show(),r}class p{constructor(e,t,i){this.currentPath=e[0].toUpperCase()+e.substring(1),this.completed=!1,this.callback=i,this.filter=t,this.title="Open"}async _createWindow(){var e={x:window.innerWidth/2-207.5|0,y:window.innerHeight/2-190|0},t=new r.Lw;t.title=this.title,t.initialX=e.x,t.initialY=e.y,t.initialWidth=420,t.initialHeight=300,t.resizable=!1,t.animations.windowOpen="heartBeat",this.dlg=new r.DI(t),this.dlg.setControlBoxStyle(r.KZ.WS_CBX_CLOSE),this.dlg.setHtml(""),this.dlg.registerWindow(),this.dlg.onclose=()=>{this.completed||this.callback&&this.callback(null)},this._pos=e;const i=this.dlg.wndObject.querySelector(".window-html-content");i.classList.add("wexplorer-app","cdlg-ofd"),this.fsv=new a.n(this.currentPath),this.fsv.init(),this.fsv.uiComponent.style.width=t.initialWidth+"px",this.fsv.uiComponent.style.height=t.initialHeight+"px",this.fsv.setSize("100%","100%"),this.fsv.ondropfinish=()=>{this.fsv.refreshView()};const s=new c.p({compactToolbar:!0});if(s.label.textContent="Look in:",s.navigate=(...e)=>this._navigate(...e),s.fsv=this.fsv,this.pathBar=s.input,await o.FS.exists("c:/system/config/explorer.json"))try{let e=JSON.parse(await o.FS.readstr("c:/system/config/explorer.json"));e.showHiddenFiles&&(this.fsv.options.showHiddenFiles=e.showHiddenFiles),e.metaLookup&&(this.fsv.options.metaLookup=e.metaLookup)}catch(e){}this.fsv.readdirFunc=async e=>await(await o.FS.readdir(e,!0)).aFilter((async e=>{if(0!==e.filetype)return!0;for(var t of this.filter)if(t instanceof RegExp){if(t.test(e.path))return!0}else if(e.path.toLowerCase().endsWith(t.toString()))return!0;return!1})),this.fsv.onitemdblclick=async e=>{switch(e.getAttribute("ent")){case"0":this.completed=!0,this.callback(e.getAttribute("path")),this.dlg.close();break;case"1":case"2":this.fsv.deselectAllIcons(),await this._navigate(e.getAttribute("path"))}},this.dlg.ondarkenelements=()=>{this.fsv.uiComponent.querySelectorAll(".shell-icon.selected").forEach((e=>{e.classList.add("inactive")}))},this.dlg.onlightenelements=()=>{this.fsv.uiComponent.querySelectorAll(".shell-icon.inactive").forEach((e=>{e.classList.remove("inactive")}))};const l=document.createElement("div");l.classList.add("bp"),l.innerHTML='\n            <div class="input-area">\n                <span>File Name: </span><input class="w96-textbox" type="text">\n            </div>\n            <div class="buttons">\n                <button class="w96-button open">Open</button>\n                <button class="w96-button cancel">Cancel</button>\n            </div>\n        ';const d=l.querySelector("input");this.fsv.onitemselected=e=>{"0"==e.getAttribute("ent")&&(d.value=n.R.fname(e.getAttribute("path")))};l.querySelector("button.cancel").onclick=()=>{this.dlg.close()};l.querySelector("button.open").onclick=()=>{this._conclude()},d.onkeypress=e=>{"Enter"==e.key&&this._conclude()},this.fileBox=d,i.appendChild(s.getElement()),i.appendChild(this.fsv.getElement()),i.appendChild(l)}async _conclude(){const e=this.fileBox.value.includes("/")?this.fileBox.value:3==this.currentPath.length?this.currentPath+this.fileBox.value:this.currentPath+"/"+this.fileBox.value;if(null!=e&&""!=e.trim())if(await o.FS.exists(e)){if(!await o.FS.isFile(e))return this.fileBox.value="",void await this._navigate(e);this.completed=!0,this.callback(e),this.dlg.close()}else h("Error","The specified file does not exist.","OK");else h("Error","No valid item was selected!","OK")}async _navigate(e,t=!1,i=!0){if("computer://"!=e&&!await o.FS.exists(e))return m.error("Error","Directory does not exist.","OK");this.currentPath=e,this.pathBar.value=this.currentPath,this.fsv.navigate(e,(e=>{}),t,i)}async show(){this.fsv||await this._createWindow(),this.dlg.show(),this.dlg.wndObject.style.left=this._pos.x+"px",this.dlg.wndObject.style.top=this._pos.y+"px",await this._navigate(this.currentPath)}}class u extends p{constructor(e,t,i){super(e,t,i),this.title="Save File"}async _createWindow(){await super._createWindow(),this.dlg.setTitle(this.title);this.dlg.wndObject.querySelector("button.open").innerText="Save"}async _conclude(){const e=this.fileBox.value.includes("/")?this.fileBox.value:3==this.currentPath.length?this.currentPath+this.fileBox.value:this.currentPath+"/"+this.fileBox.value;!await o.FS.exists(e)||await o.FS.isFile(e)?(this.completed=!0,this.callback(e),this.dlg.close()):h("Error","Unable to save file.","OK")}}class f{constructor(e,t,i,n,o,s=!1){var a={x:window.innerWidth/2-l.Q.uiVars.defaults.mbox.w/2|0,y:window.innerHeight/2-l.Q.uiVars.defaults.mbox.h/2|0};this.quiet=s,this.onclose=o,this.icon=i;var c=new r.Lw;c.title=e,c.initialX=a.x,c.initialY=a.y,c.initialHeight=l.Q.uiVars.defaults.mbox.h,c.initialWidth=l.Q.uiVars.defaults.mbox.w,c.resizable=!1,c.animations.windowOpen="anim-null",c.animations.windowClose="anim-null",this.dlg=new r.DI(c),this.dlg.setControlBoxStyle(r.KZ.WS_CBX_CLOSE),this.dlg.registerWindow(),this.dlg.onclose=o,this.dlg.setHtml(`\n            <div class="mbox">\n                <div class="content">\n                    <div class="icon"></div>\n                    <div class="text">${t}</div>\n                </div>\n                <div class="buttons">\n                    <button autofocus onclick="this.associatedWindow.close()" class="w96-button btnok">${n}</button>\n                </div>\n            </div>\n        `);var d=this.dlg.wndObject.querySelector(".btnok");d.associatedWindow=this.dlg,this.btnOk=d,l.Q.getIconUrl(`status/${i}`).then((e=>this.dlg.wndObject.querySelector(".content>.icon").style.backgroundImage=`url(${e})`))}show(){var e=window.innerWidth/2-l.Q.uiVars.defaults.mbox.w/2|0,t=window.innerHeight/2-l.Q.uiVars.defaults.mbox.h/2|0;if(this.dlg.show(),this.dlg.wndObject.style.left=e+"px",this.dlg.wndObject.style.top=t+"px",!this.quiet)switch(this.icon){case"error":l.Q.playSound("error");break;case"info":l.Q.playSound("asterisk")}setTimeout((()=>{this.dlg.activate(),this.btnOk.focus()}),100)}setSize(e,t){return this.dlg.setSize(e,t),this}closeDialog(){this.dlg.close()}}async function _(e){let t=new String(e);e instanceof Error&&(t=e.message+"\n"+e.stack);const i=new r.DI({title:"Exception",taskbar:!1,bodyClass:"dlg-except",body:`<div class="top">\n            <div class="std-message">\n                <div class="icon" style="background-image: url(${await l.Q.getIconUrl("status/error")})"></div>\n                <div class="text">\n                    This application has caused an exception and will be closed.<br><br>Contact the maintainer if this problem persists.\n                </div>\n            </div>\n            <div class="buttons">\n                <button class="w96-button">Close</button>\n            </div>\n        </div>\n        <textarea class="ex w96-textbox" readonly>${t}</textarea>`,initialWidth:404,initialHeight:269,animations:{windowOpen:"anim-null",windowClose:"anim-null"},center:!0,resizable:!1,controlBoxStyle:"WS_CBX_CLOSE",mobResize:!0});i.getBodyContainer().querySelector(".w96-button").addEventListener("click",(()=>i.close())),i.show()}class g{constructor(e){this.params={animation:null,oncancel:()=>{},useIdleProgress:!0,canCancel:!0,text:"Sample text",title:"Operation dialog",...e},this.wnd=new r.DI({title:this.params.title,initialHeight:162,initialWidth:381,bodyClass:"commdlg-operation",controlBoxStyle:"WS_CBX_CLOSE",body:`<div class="animation"></div>\n            <div class="status">${s.V.escapeHtml(this.params.text)}</div>\n            <div class="dlg-progress">\n                <div class="p-cnt">\n                    <div class="w96-progressbar">\n                        <div class="progress"></div>\n                    </div>\n                </div>\n                <div class="b-cnt">\n                    <button class="w96-button cancel"${this.params.canCancel?"":"disabled"}>Cancel</button>\n                </div>\n            </div>`,taskbar:!1,resizable:!1,animations:{windowClose:"anim-null",windowOpen:"anim-null"}}),this.params.canCancel?this.wnd.onclose=e=>{this.params.oncancel({wndEvt:e})}:this.wnd.setControlBoxStyle("WS_CBX_NONE");const t=this.wnd.getBodyContainer();if(this.params.animation&&(t.querySelector(".animation").style.backgroundImage=`url(/system/resource/anim/${s.V.escapeHtml(this.params.animation)}.gif)`),!this.params.useIdleProgress){const e=t.querySelector(".progress");e.style.animation="none",e.style.width="0%"}t.querySelector("button.cancel").addEventListener("click",(()=>this.params.oncancel())),this.wnd.show()}setStatusText(e){this.wnd.getBodyContainer().querySelector(".status").textContent=e}setProgress(e){this.wnd.getBodyContainer().querySelector(".progress").style.width=`${e}%`}close(){this.wnd.close(),this.wnd=null,this.params=null}show(){this.wnd.show()}wait(){return this.wnd.wait()}static async copy(e,t){if(!(e instanceof Array))throw new Error("Invalid argument.");const i=new g({title:"Copying...",animation:"copy",text:"<Pending...>\nFrom: '<Pending>'",useIdleProgress:!0,canCancel:!1}),r=n.R.normalizeDriveLetter(3==t.length?t.substring(0,2):t);for(let t of e){const e=n.R.normalizeDriveLetter(t),s=n.R.fname(e);i.setStatusText(`${s}\nFrom: '${n.R.getParentPath(e)}'`);try{let t=`${r}/${s}`;e==t&&(t=`${r}/Copy of ${s}`),await o.FS.isFile(e)?await o.FS.cpfile(e,t):await o.FS.cpdir(e,t)}catch(e){throw i.close(),e}}i.close()}static async move(e,t){if(!(e instanceof Array))throw new Error("Invalid argument.");const i=new g({title:"Moving...",animation:"copy",text:"<Pending...>\nFrom: '<Pending>'",useIdleProgress:!0,canCancel:!1}),r=n.R.normalizeDriveLetter(3==t.length?t.substring(0,2):t);for(let t of e){const e=n.R.normalizeDriveLetter(t),s=n.R.fname(e);i.setStatusText(`${s}\nFrom: '${n.R.getParentPath(e)}'`);try{let t=`${r}/${s}`;if(e==t)throw new Error(`${t}: The source and destination match.`);if(t.startsWith(e+"/"))throw new Error("Cannot move top level directory inside itself.");await o.FS.isFile(e)?await o.FS.mvfile(e,t):await o.FS.mvdir(e,t)}catch(e){throw i.close(),e}}i.close()}static async recycle(e){if(!(e instanceof Array))throw new Error("Invalid argument.");const t=new g({title:"Deleting...",animation:"recycle",text:"<Pending...>\nFrom: '<Pending>'",useIdleProgress:!0,canCancel:!1});for(let i of e){const e=n.R.fname(i);t.setStatusText(`${e}\nFrom: '${n.R.getParentPath(i)}'`);try{await o.FS.isFile(i)?await o.FS.mvfile(i,`c:/trash/${e}`):await o.FS.mvdir(i,`c:/trash/${e}`)}catch(e){throw t.close(),e}}t.close()}static async delete(e,t="normal"){if(!(e instanceof Array))throw new Error("Invalid argument.");const i=new g({title:"Deleting...",animation:"normal"==t?"delete":"bin-empty",text:"<Pending...>\nFrom: '<Pending>'",useIdleProgress:!0,canCancel:!1});for(let t of e){const e=n.R.fname(t);i.setStatusText(`${e}\nFrom: '${n.R.getParentPath(t)}'`);try{await o.FS.isFile(t)?await o.FS.rm(t,`c:/trash/${e}`):await o.FS.rmdir(t,`c:/trash/${e}`)}catch(e){throw i.close(),e}}i.close()}static async emptyBin(){new g({title:"Deleting...",animation:"bin-empty",text:"<Pending...>\nFrom: '<Pending>'",useIdleProgress:!0,canCancel:!1});throw new Error("Not implemented.")}}const m={error:function(e,t,i,r=(()=>{})){var n=new f(e,t,"error",i,r);return n.show(),n},warning:h,info:d,status:function(e,t){var i={x:window.innerWidth/2-154.5|0,y:window.innerHeight/2-62.5|0},n=new r.Lw;n.initialWidth=310,n.initialHeight=125,n.initialX=i.x,n.initialY=i.y,n.resizable=!1,n.animations.windowOpen="anim-null",n.animations.windowClose="anim-null";var o=new r.DI(n);return o.setControlBoxStyle(r.KZ.WS_CBX_NONE),o.registerWindow(),o.setTitle(e),o.setHtml(`<div class="w96-panel" style="width: 100%; height: 100%; display: flex;">\n        <div id="msg" style="margin: auto;">\n            ${t}\n        </div>\n    </div>`),o.show(),o.wndObject.style.left=i.x+"px",o.wndObject.style.top=i.y+"px",o},prompt:function(e,t,i,n,o=!1){var a={x:window.innerWidth/2-156|0,y:window.innerHeight/2-62.5|0},l=new r.Lw;l.initialWidth=340,l.initialHeight=135,l.initialX=a.x,l.initialY=a.y,l.resizable=!1,l.disableCommentsBtn=o;var c=new r.DI(l);c.setControlBoxStyle(r.KZ.WS_CBX_CLOSE),c.registerWindow(),c.setTitle(e),c.setHtml(`<div class="w96-panel prompt-container">\n        <div class="message">\n            ${t}\n        </div>\n        <input class="w96-textbox" ${o?'type="password"':""} value="${s.V.escapeHtml(i)}">\n        <div class="buttons">\n            <button class="w96-button cancel">Cancel</button>\n            <button class="w96-button ok">OK</button>\n        </div>\n    </div>`);var d=!1;c.onclose=function(){d||n(null)};const h=c.wndObject.querySelector(".prompt-container"),p=h.querySelector(".w96-textbox");return c.onshown=function(){p.focus(),""!=i.trim()&&(p.selectionEnd=p.value.length)},c.show(),c.wndObject.style.left=a.x+"px",c.wndObject.style.top=a.y+"px",h.querySelector(".w96-button.ok").onclick=function(){n(p.value),d=!0,c.close()},h.querySelector(".w96-button.cancel").onclick=function(){n(null),d=!0,c.close()},p.onkeyup=function(e){"Enter"==e.key&&(n(p.value),d=!0,c.close(),p.onkeyup=null)},c.onshown(),c},confirm:function(e,t,i="warning"){var r=new f("Confirmation",e,i,"OK");l.Q.playSound("question");const n=r.dlg.wndObject.querySelector(".mbox>.buttons"),o=n.querySelector(".btnok"),s=document.createElement("button");o.setAttribute("onclick",""),s.classList.add("w96-button","btncancel"),s.associatedWindow=r.dlg,s.innerText="Cancel",n.prepend(s);var a=!1;return r.dlg.onclose=function(){a||t(!1)},o.onclick=()=>{a=!0,t(!0),r.dlg.close()},s.onclick=()=>{a=!0,t(!1),r.dlg.close()},r.show(),r},idleProgress:function(e,t){const i=d(e,t+'<div style="margin-top: 10px;" class="w96-progressbar"><div class="progress"></div></div>',"OK",!0);return i.dlg.setControlBoxStyle("WS_CBX_NONE"),i.dlg.wndObject.querySelector(".buttons").remove(),i.dlg.setSize(320,115),i.show(),i.dlg.center(),i}}},674:(e,t,i)=>{"use strict";i.d(t,{u:()=>s});var r=i(9275);i(1350);let n=!1,o=new r.v;const s={callComposite:function(e){if(!n)return!1;o.emit("compose",{wnd:e})},enable:function(e){e&&console.log("wcomp is enabled."),n=e},events:o}},5690:(e,t,i)=>{"use strict";i.d(t,{O:()=>a});var r=i(7612),n=i(1350);class o{constructor(e){this.params={title:"Alert",icon:"warning",body:"Sample text",buttons:[{id:"ok",text:"OK",action:"$close",focus:!0}],sounds:{error:"error",warning:"asterisk",info:"asterisk",question:"question"},events:{onclose:null,onshown:null},maxWidth:640,maxHeight:null,noComments:!1,...e},this.result={button:null},this._resolveFn=null,this.wnd=new n.DI({title:this.params.title,controlBoxStyle:n.KZ.WS_CBX_CLOSE,resizable:!1,initialHeight:140,initialWidth:322,body:`<div class="mbox">\n                <div class="content">\n                    <div class="icon"></div>\n                    <div class="text">${this.params.body}</div>\n                </div>\n                <div class="buttons">\n\n                </div>\n            </div>`,animations:{windowClose:"anim-null",windowOpen:"anim-null"},disableCommentsBtn:this.params.noComments}),this.wnd.wndObject.style.height="auto",this.wnd.wndObject.style.width="auto",this.params.maxWidth&&(this.wnd.wndObject.style.maxWidth=this.params.maxWidth+"px"),this.params.maxHeight&&(this.wnd.wndObject.style.maxHeight=this.params.maxHeight+"px"),this.closing=!1,this.wnd.onclose=e=>{this.params.events.onclose&&!this.closing&&this.params.events.onclose({dlg:this,e})},this.wnd.onshown=e=>{const i=t.querySelectorAll(".buttons>button");for(let e=0;e<this.params.buttons.length;e++){this.params.buttons[e].focus&&i[e].focus()}};const t=this.wnd.getBodyContainer(),i=t.querySelector(".content .icon");this.params.icon.includes("/")?i.style.backgroundImage=`url(${this.params.icon})`:r.Q.getIconUrl(`status/${this.params.icon}`).then((e=>i.style.backgroundImage=`url(${e})`)),"none"===this.params.icon&&i.remove();const o=t.querySelector(".buttons");t.classList.add("d"),this.params.buttons.forEach((e=>{const t=document.createElement("button");if(t.classList.add("w96-button"),e.id&&t.classList.add(e.id),t.innerText=e.text,t.addEventListener("click",(()=>this.result.button=e.id)),"string"==typeof e.action){if("$close"===e.action)t.addEventListener("click",(()=>this.close()))}else e.action&&t.addEventListener("click",(()=>e.action({btn:t,dlg:this})));o.appendChild(t)}))}close(){this.closing=!0,this.wnd.close(),this.params.events.onclose&&this.params.events.onclose({dlg:this}),this._resolveFn&&(this._resolveFn(this),this._resolveFn=null),this.wnd=null,this.params=null}wait(){return new Promise((e=>this._resolveFn=e))}show(){const e=this.wnd.getBodyContainer().querySelector(".mbox>.content>.text");this.wnd.show(),this.params.sounds[this.params.icon]&&r.Q.playSound(this.params.sounds[this.params.icon]),this.params.events.onshown&&this.params.events.onshown({dlg:this}),this.params.maxWidth&&(e.style.maxWidth=`${this.params.maxWidth}px`),-1==this.params.maxHeight&&(e.style.maxHeight="")}center(){const e=this.wnd.getComputedBounds();this.wnd.setPosition(window.innerWidth/2-e.width/2,window.innerHeight/2-e.height/2)}body(){return this.wnd.getBodyContainer()}}class s extends o{constructor(e){const t={message:"Sample text",progress:"idle",...e};super({title:t.title,body:`\n                <div class="message">${t.message}</div>\n                <div class="w96-progressbar">\n                    <div class="progress"></div>\n                </div>\n            `,icon:"info",title:"Progress",buttons:[],sounds:{},...t});this.body().classList.add("progress-dlg"),this.setProgress(t.progress)}setProgress(e){const t=this.body().querySelector(".w96-progressbar>.progress");"idle"==e?(t.style.animation="",t.style.width=""):(t.style.animation="none",t.style.width=`${e}%`)}setMessage(e){const t=this.body().querySelector(".message");t&&(t.innerHTML=e)}}const a={progress:function(e,t={}){const i=new s({message:e,...t});return i.show(),i.center(),i},fieldset:function(e,t={},i=(()=>{})){let r=!1,n=a.create({body:'<div class="fieldset-container"></div>',icon:"none",buttons:[{id:"cancel",text:"Cancel",action:({dlg:e})=>{r=!0,e.close(),i(null)}},{id:"ok",text:"OK",action:({dlg:e})=>{r=!0;const t=[];e.wnd.getBodyContainer().querySelectorAll(".fld.text").forEach((e=>{t.push({name:e.getAttribute("fname"),value:e.value})})),(null==e.params.onvalidate||e.params.onvalidate(t))&&(i(t),e.close())}}],events:{onclose:()=>{r||i(null)}},title:"Input Dialog",...t});const o=n.wnd.getBodyContainer(),s=o.querySelector(".fieldset-container");return o.classList.add("fieldset-dlg"),e.forEach((e=>{let t;switch(e.type){case"textbox":if(e.caption){const t=document.createElement("div");t.textContent=e.caption,s.appendChild(t)}t=e.multiline?document.createElement("textarea"):document.createElement("input"),t.classList.add("w96-textbox","fld","text"),e.multiline||(t.type="text"),e.value&&(t.value=e.value);break;case"spacer":t=document.createElement("div"),t.classList.add("ui-spacer");break;case"text":if(!e.value)return;t=document.createElement("div"),e.raw?t.innerHTML=e.value:t.textContent=e.value}t&&(e.style&&t.setAttribute("style",e.style),e.classes&&t.classList.add(...e.classes),e.attr&&e.attr.forEach((e=>t.setAttribute(e.name,e.value))),e.name&&t.setAttribute("fname",e.name),s.appendChild(t))})),n.center(),n},alert:function(e,t={}){return a.create({body:e,icon:"warning",...t})},confirm:function(e,t={},i=(()=>{})){let r=!1;return a.create({body:e,icon:"question",buttons:[{id:"cancel",text:"Cancel",action:({dlg:e})=>{r=!0,e.close(),i(!1)}},{id:"ok",text:"OK",action:({dlg:e})=>{r=!0,e.close(),i(!0)}}],events:{onclose:()=>{r||i(!1)}},...t})},prompt:function(e,t={},i=(()=>{})){let r=!1;return a.create({body:`<div class="prompt-container">\n                <div class="message" style="max-width: ${t.maxWidth?t.maxWidth:"unset"}">${e}</div>\n                <br><input class="w96-textbox" ${t.isPassword?'type="password"':""}>\n            </div>`,icon:"none",buttons:[{id:"cancel",text:"Cancel",action:({dlg:e})=>{r=!0,e.close(),i(null)}},{id:"ok",text:"OK",action:({dlg:e})=>{r=!0;let t=e.wnd.getBodyContainer().querySelector(".w96-textbox").value;i(t),e.close()}}],events:{onshown:({dlg:e})=>{const t=e.wnd.getBodyContainer();t.querySelector(".w96-textbox").onkeydown=t=>{if("Enter"===t.code){t.preventDefault(),r=!0;let n=e.wnd.wndObject.querySelector(".w96-textbox").value;i(n),e.close()}},t.querySelector(".w96-textbox").focus()},onclose:()=>{r||i(null)}},...t})},create:function(e){let t=new o(e);return t.show(),t.center(),t},Dialog:o}},4871:(e,t,i)=>{"use strict";i.d(t,{K:()=>r});class r{constructor(e){const t={onclick:null,ondblclick:null,tooltip:null,iconUrl:null,...e};this.params=t,this.onclick=t.onclick,this.ondblclick=t.ondblclick,this.notifyEl=document.createElement("div"),this.notifyEl.style.backgroundImage=`url(${t.iconUrl})`,this.notifyEl.classList.add("notify-icon","notify-item"),this.notifyEl.onmouseup=e=>{this.onclick&&this.onclick({type:2==e.button?"context":"normal",event:e})},this.notifyEl.ondblclick=e=>{this.ondblclick&&this.ondblclick({event:e})}}hide(){this.notifyEl.style.display="none"}show(){this.notifyEl.style.display=""}setIcon(e){this.notifyEl.style.backgroundImage=`url(${e})`}destroy(){this.params=null,this.notifyEl.remove()}}},225:(e,t,i)=>{"use strict";i.d(t,{U:()=>r});const r={process:function(e,t={vars:[]}){let i=`${e}`;for(let e of t.vars){let t=new RegExp(`\\$${e.id}\\$`,"g");i=i.replace(t,e.value),t=null}return i}}},7612:(e,t,i)=>{"use strict";i.d(t,{Q:()=>I});var r=i(6227),n=i(2110),o=i(6167),s=i(225),a=i(5516);const l="default",c={strict:!1};let d=!1;const h={assoc:{},named:{},absolute:{},fixed:{}};let p={},u={},f={},_=[],g={...c},m={folder:"",unknown:""},b={},y={},v={};const w=3e5;let x={},C={};const S={titlebarIconPadding:"19px",maxWindowSizeFormulaW:"calc(100%)",maxWindowSizeFormulaH:"calc(100% - 28px)",defaults:{mbox:{w:322,h:110}},tbOffsetH:0,tbOffsetW:0,taskbarHeight:28,superbarEnabled:!1,clearFixEnabled:!0};let E=Object.assign({},S);async function k(e,t="32x32",i="png"){if(!e)return"system/resource/misc/missing.png";if(await r.FS.exists(e)){const t=await r.FS.stat(e);return y[e]?(y[e].length!==t.length&&(URL.revokeObjectURL(b[e]),y[e].length=t.length,b[e]=URL.createObjectURL(await r.FS.toBlob(e))),b[e]):(y[e]={length:t.length},b[e]=URL.createObjectURL(await r.FS.toBlob(e)),b[e])}const n=v[I.currentTheme];if(null==n)return"system/resource/misc/missing.png";let o=n.iconTheme;if(f[e])return k(f[e],t,i);const s=r.FSUtil.deconstructFullPath(n.iconTheme),a=r.FS.get(s.prefix);if(!a)return"system/resource/misc/missing.png";if(a.remote)o=s.path.startsWith("/")?s.path.substring(1):s.path;else{const n=`${o}/${t}/${e}.${i}`;if(await r.FS.exists(n))return b[n]||(b[n]=URL.createObjectURL(await r.FS.toBlob(n))),b[n];if(g.strict)return"system/resource/misc/missing.png"}let l=`${o}/${t}/${e}.${i}`;i||(l=`${o}/${t}/${e}`);return!r.FS.mounts().find((e=>"W:"==e.prefix))||await r.FS.exists(`W:/${l}`)||g.strict||(l=`${v.default.iconTheme.substring(3)}/${t}/${e}.${i}`),l}var L=[],A=null;function O(e){Promise.all([r.FS.exists(e),r.FS.readstr(e)]).then((e=>{const t=document.createElement("style");t.classList.add("themed-css");try{t.innerText=s.U.process(e[1],{vars:[..._]})}catch(e){console.error(e)}document.body.appendChild(t)})).catch((()=>{const t=document.createElement("link");t.rel="stylesheet",t.classList.add("themed-css"),t.href=e,document.body.appendChild(t),L.push(t)}))}async function M(){w96.evt.ui.emit("theme-reload-desktop")}async function P(e){const{sounds:t}=I.registeredThemes[I.currentTheme];if(t&&t.hasOwnProperty(e)){let i=t[e];const n=()=>{URL.revokeObjectURL(x[e]),delete x[e],delete C[e]};if(x.hasOwnProperty(e))return clearTimeout(C[e]),C[e]=setTimeout(n,w),x[e];if(await r.FS.exists(i)){let t=URL.createObjectURL(new Blob([await r.FS.readbin(i)]));return x[e]=t,C[e]=setTimeout(n,w),t}}}async function R(e){const t=JSON.parse(await r.FS.readstr(e));if(!t.assoc&&!t.absolute&&t.alias)throw new Error("Invalid icon map.");u=t.assoc.inherit?{...h.assoc,...t.assoc}:t.assoc,f=t.named.inherit?{...h.named,...t.named}:t.named,p=t.absolute.inherit?{...h.absolute,...t.absolute}:t.absolute,m=t.absolute.inherit?{...h.fixed,...t.fixed}:t.fixed,t.options&&(g={...c,...t.options})}function D(){const e=Object.keys(b);for(let t of e)URL.revokeObjectURL(t);b={}}async function T(e){var t;const i=v[e];if(!i)throw new Error("Theme not found.");D();for(let e of _)try{URL.revokeObjectURL(e.value)}catch(e){console.error(e)}_=[],document.querySelectorAll(".themed-css").forEach((e=>e.remove())),E=Object.assign({},S);try{o.p.ui.emit("theme-unload")}catch(e){console.error(e)}let s=null!==(t=await r.FS.exists(i.iconTheme+"/iconmap.json")?i.iconTheme:null)&&void 0!==t?t:v.default.iconTheme;p={},u={},f={},g={...c},m={},await R(s+"/iconmap.json"),I.currentTheme=e;for(let e of i.resourceMap){if(null==e.id||null==e.path)continue;const t=r.FSUtil.resolvePath(i.path,e.path);try{_.push({id:e.id,value:URL.createObjectURL(await r.FS.toBlob(t))})}catch(e){console.error(`Error in mapped resource ${t}`),console.error(e)}}for(let e of i.scripts)try{await n.D.runFile(r.FSUtil.resolvePath(i.path,e))}catch(t){console.error(`Script execution error in ${e}`),console.error(t)}for(let e of i.stylesheets)try{O(r.FSUtil.resolvePath(i.path,e))}catch(t){console.error(`Error adding stylesheet ${e}`),console.error(t)}}const I={__debug:{__iconMap:u,__iconMapFixed:m,__iconMapOptions:g,__iconNamedMap:f,__UIV_DEFAULT:S,getMappedBlobRsrc:()=>_},currentTheme:l,iconCache:b,clearIconCache:D,registeredThemes:v,getIconUrl:k,getFileIconUrl:async function(e,t="32x32",i="png"){if(p[e])return await k(p[e],t,i);if(1===this._cachedFiletype)return await k(m.folder,t,i);if(void 0===this._cachedFiletype&&!await r.FS.isFile(e))return await k(m.folder,t,i);var n=r.FSUtil.getExtension(e);return null!=u[n]?await k(u[n],t,i):await k(m.unknown,t,i)},getIconFromFileExtension:async function(e,t="32x32",i="png"){return null!=u[e]?await k(u[e],t,i):await k(m.unknown,t,i)},getMappedBlobResources:()=>_,cssa:function(e){const t=document.querySelector(".csst-common")||function(){const e=document.createElement("style");return e.classList.add("csst-common","themed-css"),document.body.appendChild(e),e}();A||(A=t.innerText),t.innerText+="\n"+e},cssl:O,uiVars:E,unloadTheme:function(e=!0){E=Object.assign({},S),L.forEach((e=>{document.body.removeChild(e)})),L=[],(document.querySelector(".csst-common")||function(){const e=document.createElement("style");return e.classList.add("csst-common"),document.body.appendChild(e),e}()).innerText=A,A=null,I.currentTheme=l,e&&M()},reloadDesktop:M,getSound:P,playSound:async function(e){let t=await P(e);if(t)return new Promise(((e,i)=>{let r=new Audio(t);r.onended=()=>{e()};try{return r.play()}catch(e){i(),console.error("playSound(): ",e)}}))},dropSoundCache:function(){for(let e in x)URL.revokeObjectURL(x[e]),clearTimeout(C[e]);x={},C={}},loadIconMap:R,applyTheme:T,init:async function(e){if(d)return;d=!0,console.log("Initializing theming engine..."),console.log("Reading themes...");let t=["W:/system/resource/themes","C:/system/resource/themes"];e&&(t=t.filter((e=>e.startsWith("W:"))));let i=[];for(let e of t)await r.FS.exists(e)&&(i=[...i,...await(await r.FS.readdir(e)).aFilter((async e=>!await r.FS.isFile(e)&&await r.FS.exists(e+"/manifest.json")))]);for(let t of i)try{var n,o,s,l,c,_,g;const i=await r.FS.readstr(t+"/manifest.json"),d=JSON.parse(i);if(!d.id)throw new Error("No theme ID was specified.");if(!await r.FS.exists(d.iconTheme+"/manifest.json"))throw new Error("The specified icon theme is not found.");if(!await r.FS.exists(d.soundPack+"/manifest.json")&&!e)throw new Error("The specified sound pack cannot be found.");v[d.id]={name:null!==(n=d.name)&&void 0!==n?n:"(Unknown)",description:null!==(o=d.description)&&void 0!==o?o:"(none)",author:null!==(s=d.author)&&void 0!==s?s:"(none)",themeType:null!==(l=d.type)&&void 0!==l?l:"normal",sounds:e?null:JSON.parse(await r.FS.readstr(d.soundPack+"/manifest.json")).sounds,iconTheme:d.iconTheme,stylesheets:null!==(c=d.stylesheets)&&void 0!==c?c:[],scripts:null!==(_=d.scripts)&&void 0!==_?_:[],path:t,resourceMap:null!==(g=d.resourceMap)&&void 0!==g?g:[]},a.xP.log.log(`Registered theme "${d.id}"`,"Theme Engine","info")}catch(e){console.error(`Failed to load theme ${t}`),console.error(e)}if(!v.default)throw new Error("No system theme was found - aborted.");const b=v.default.iconTheme;if(!b)throw new Error("System init must have icon theme path.");if(!/^([a-zA-Z]:)/.test(b))throw new Error("Icon theme path must be absolute.");const y=`${b}/iconmap.json`;if(!await r.FS.exists(y))throw new Error("System theme must have an icon map.");await R(`${b}/iconmap.json`),h.absolute=p,h.assoc=u,h.named=f,h.fixed=m,console.log("Theme engine initialized without errors."),console.log("Reading default theme..."),await async function(e){if(e)return await T("default");await r.FS.exists("C:/system/config/theme.json")||await r.FS.writestr("C:/system/config/theme.json",JSON.stringify({name:I.currentTheme,overrides:{iconTheme:null,soundPack:null}},null,4));const t=JSON.parse(await r.FS.readstr("C:/system/config/theme.json"));t.name&&await T(t.name)}(e)}}},3970:(e,t,i)=>{"use strict";i.d(t,{J:()=>o});var r=i(9471),n=i(6993);class o extends n.UIComponent{constructor(e){super(),(e=Object.assign({label:"My Checkbox",checked:!1,onchange:null,displayAsBlock:!1},e)).onchange?this.onchange=e.onchange:this.onchange=()=>{},this.uiComponent=r.K.mkElement("label",["w96-checkbox"]);const t=r.K.mkElement("input",[]);t.type="checkbox",t.addEventListener("click",(()=>{this.onchange({checked:t.checked})})),this.uiComponent.appendChild(t);const i=r.K.mkElement("span",["text"]);i.textContent=e.label,this.uiComponent.appendChild(i),t.checked=e.checked,e.displayAsBlock&&(this.uiComponent.style.display="block")}}},8576:(e,t,i)=>{"use strict";i.r(t),i.d(t,{ContextMenu:()=>n});var r=i(7612);class n{constructor(e){this.items=e,this.menuCounter=0}renderMenu(e,t,i=this.items,n=!1,o="right"){const s=document.createElement("div");if(s.classList.add("wcontext-menu"),s.style.left=e-4+"px",s.style.top=t-2+"px",s.style.zIndex="10000001",s.menuId=this.menuCounter++,s.id="cxmenu_"+s.menuId,e-4+240>=document.body.clientWidth&&(o="left"),e-4-240<=0&&(o="right"),n||r.Q.playSound("ctxmenuopen"),i.forEach((t=>{if("normal"==t.type){var i;const e=document.createElement("span");let n=null!==(i=t.disabled)&&void 0!==i&&i;if(e.classList.add("item"),e.onmouseenter=function(e){n||r.Q.playSound("ctxmenuhover")},e.onclick=function(e){t.onclick&&!n&&(t.onclick(e,t.tag),r.Q.playSound("ctxmenucmd"))},null!=t.icon&&(e.classList.add("wi"),e.style.backgroundImage="url("+t.icon+")"),t.checked&&e.classList.add("checked"),e.innerHTML=t.label,t.onopened){const i=t.onopened(e);n="boolean"==typeof i&&!i}n&&e.setAttribute("disabled","true"),s.appendChild(e)}else if("submenu"==t.type){const i=document.createElement("span");i.classList.add("item","hs"),t.removeIconPrespace&&i.classList.add("no-icon"),i.innerHTML=t.label,i.onclick=function(e){t.onclick&&t.onclick(e,t.tag)},null!=t.icon&&(i.classList.add("wi"),i.style.backgroundImage="url("+t.icon+")"),i.iid=Math.floor(1e8*Math.random()),s.appendChild(i),i.onmouseenter=r=>{if(i.classList.add("selected"),document.getElementById("cxmenu_"+t.id))return;const n=s.getBoundingClientRect(),a=i.getBoundingClientRect();let l;l="right"==o?e+n.width-6:e-n.width+6;const c=this.renderMenu(l,a.y-1,t.items,!0,o);c.parentMenu=s,c.id="cxmenu_"+t.id,s.querySelectorAll(".item").forEach((e=>{if(e.iid==i.iid)return;const t=e.onmouseenter;e.onmouseenter=r=>{i.classList.contains("selected")&&i.classList.remove("selected");const n=Array.from(document.querySelectorAll(".wcontext-menu"));n.reverse();for(var o=0;o<n.length;o++){if(n[o].menuId==s.menuId)return e.onmouseenter=t,void(t&&t(r));n[o].remove()}e.onmouseenter=t,t&&t(r)}}))}}else if("separator"==t.type){const e=document.createElement("div");e.classList.add("separator"),s.appendChild(e)}})),0===i.length){let e=document.createElement("span");e.classList.add("item"),e.textContent="(Empty)",e.setAttribute("disabled","true"),s.appendChild(e)}return document.body.appendChild(s),s}}},1674:(e,t,i)=>{"use strict";i.d(t,{p:()=>n});var r=i(6993);class n extends r.UIComponent{constructor(e={}){super(),this.options=e={compactToolbar:!1,...e},this.navigate=null;const t=document.createElement("div");if(t.classList.add("nav-bar"),t.innerHTML='<span class="label-address">Address</span>\n        <input type="text" class="nav">\n        <button class="w96-button go"></button>',e.compactToolbar){t.classList.add("compact-toolbar"),t.innerHTML+='<button class="w96-button btn-up"></button>\n            <button class="w96-button btn-desktop"></button>\n            <button class="w96-button btn-new-folder"></button>',t.querySelector(".btn-up").onclick=()=>{this.navigate(this.fsv.up(!1))},t.querySelector(".btn-desktop").onclick=()=>this.navigate("C:/user/desktop"),t.querySelector(".btn-new-folder").onclick=()=>{this.fsv.uiCreateDirectory((e=>{e&&this.fsv.refreshView()}))}}this.uiComponent=t,this.label=t.querySelector(".label-address"),this.input=t.querySelector(".nav"),this.go=t.querySelector(".go"),this.go.addEventListener("click",(()=>this.ongo())),this.input.addEventListener("keydown",(({key:e})=>{"Enter"===e&&this.ongo()}))}getElement(){return this.uiComponent}ongo(){return this.navigate(this.getPath())}getPath(){return this.uiComponent.querySelector(".nav").value.trim()}}},408:(e,t,i)=>{"use strict";i.d(t,{n:()=>f});var r=i(6993),n=i(6227),o=i(7612),s=i(9338),a=i(8279),l=i(1124),c=i(5516),d=i(5690),h=i(9807);class p{constructor(e){this.containerEl=e,this.onselectionfinished=()=>{},this.onselectionstart=()=>{},this.detectionGridSize={h:23,w:20},this.minProcessingSize={h:3,w:3},this.disabled=!1,this.__initialized=!1}init(){if(this.__initialized)return;this.__initialized=!0;let e=null,t=null,i=null,r=null;this.containerEl.addEventListener("mousedown",(s=>{this.disabled||0===s.button&&s.target==this.containerEl&&(this.containerEl.querySelectorAll(".selected").forEach((e=>e.classList.remove("selected"))),e&&(e.remove(),t.remove(),e=null,t=null,document.removeEventListener("mousemove",n),document.removeEventListener("mouseup",o)),e=document.createElement("div"),e.classList.add("select-box"),e.style.height="1px",e.style.width="1px",e.style.left=`${s.offsetX}px`,e.style.top=`${s.offsetY}px`,t=document.createElement("div"),t.classList.add("w96-selection-box-container"),t.style.pointerEvents="none",t.style.display="none",t.appendChild(e),this.containerEl.appendChild(t),i={x:s.offsetX,y:s.offsetY},r=this.containerEl.getBoundingClientRect(),document.addEventListener("mousemove",n),document.addEventListener("mouseup",o),this.onselectionstart&&this.onselectionstart({container:t,box:e}))}));const n=n=>{if(!e)return;const o=e.getBoundingClientRect();if("none"==t.style.pointerEvents&&(t.style.pointerEvents="",t.style.display="block"),!(n.screenX<r.x||n.screenY<r.y)){n.offsetX<i.x?(e.style.left=`${n.offsetX}px`,e.style.width=-(n.offsetX-i.x)+"px"):(e.style.left!==`${i.x}px`&&(e.style.left=`${i.x}px`),e.style.width=n.offsetX-i.x+"px"),n.offsetY<i.y?(e.style.top=`${n.offsetY}px`,e.style.height=-(n.offsetY-i.y)+"px"):(e.style.top!==`${i.y}px`&&(e.style.top=`${i.y}px`),e.style.height=n.offsetY-i.y+"px"),this.containerEl.querySelectorAll(".selected").forEach((e=>e.classList.remove("selected")));for(let i=o.left;i<o.left+o.width;i+=this.detectionGridSize.w)for(let r=o.top;r<o.top+o.height;r+=this.detectionGridSize.h)for(let n of document.elementsFromPoint(i,r))n.parentElement==this.containerEl&&n!=t&&n!=e&&n.classList.add("selected")}},o=()=>{document.removeEventListener("mousemove",n),document.removeEventListener("mouseup",o),e&&(e.remove(),t.remove(),e=null,t=null,i=null,this.onselectionfinished&&this.onselectionfinished())}}getSelectedItems(){return this.containerEl.querySelectorAll(".selected")}uninit(){this.containerEl=null,this.onselectionfinished=null}}var u=i(6841);class f extends r.UIComponent{constructor(e){if(super(),c.xP.wmem.clipboard||this.resetClipboard(),this.initialNav=!0,""==e.trim()||null==e)throw new Error("Cannot navigate to null path.");e=e[0].toUpperCase()+e.substring(1),this.fsPath=e,this.uiComponent=document.createElement("div"),this.uiComponent.classList.add("exp-file-view"),this.uiComponent.tabIndex=1,this.selectedIcons=[],this.history=[],this.historyPos=-1,this.options={showHiddenFiles:!1,enableNavigation:!0,metaLookup:!0,iconPreviews:!0,singleClick:h.a.getProfile().preferences.single_click,previewMaxSize:5242880,viewMode:"icons",alignMode:"explorer",iconMovement:"align",storedIconPositions:[],specialIcons:[]},this.uiComponent.onclick=e=>{let t=e.target;for(;t&&!t.classList.contains("exp-file-view");){if(t.classList.contains("shell-icon"))return;t=t.parentNode}this.deselectAllIcons()},this.onitemdblclick=function(e){},this.onitemselected=function(e){},this.onicondrop=function(e){},this.ondropfinish=function(){},this.onkeyrequest=function(){return!0},this.onrefreshneeded=function(){},this.onclipboard=function(){},this.readdirFunc=async function(e){const t=await n.FS.readdir(e,!0),i=[];return t.forEach((e=>{if(this.options.showHiddenFiles)i.push(e);else{n.FSUtil.fname(e.path).startsWith(".")||i.push(e)}})),i},this.uiComponent.ondragenter=()=>{this.uiComponent.classList.add("fdrag-box")},this.uiComponent.ondragleave=()=>{this.uiComponent.classList.remove("fdrag-box")},this.uiComponent.ondrop=async e=>{if(e.preventDefault(),e.stopPropagation(),this.uiComponent.classList.remove("fdrag-box"),"computer://"==this.fsPath)return void s.jC.warning("File Upload Error","You cannot upload files in this system folder!","Damn...");const t=n.FSUtil.deconstructFullPath(this.fsPath);if(n.FS.get(t.prefix).features.includes(a.f.readOnly))s.jC.error("File Upload Error","Read-only file system.","Damn...");else if(console.log("Processing file upload..."),console.log(e.dataTransfer.files),e.dataTransfer.files){let t=[];for(let i=0;i<e.dataTransfer.files.length;i++)t.push(e.dataTransfer.files[i]);for(var i of t)console.log("Uploading "+i.name+"..."),await n.FS.writebin(this.fsPath+(this.fsPath.endsWith(":/")&&3==this.fsPath.length?"":"/")+i.name,new Uint8Array(await i.arrayBuffer()));t=[],this.ondropfinish&&this.ondropfinish()}},this.uiComponent.ondragover=e=>{e.preventDefault()},this.uiComponent.addEventListener("keydown",(e=>{this.onkeyrequest()&&(!e.ctrlKey||"c"!=e.key&&"x"!=e.key?e.ctrlKey&&"v"==e.key&&this.performClipboard("paste"):(e.preventDefault(),e.stopPropagation(),this.performClipboard("c"==e.key?"copy":"cut")))})),l.r.create(this.uiComponent,this.fsPath);const t=l.r.get(this.uiComponent);t.accepts.push("shell-icon"),t.ondrop=(e,t)=>this._ondzdropFn(e,t),this.dropzone=t,this.selBoxListener=new p(this.uiComponent),this.selBoxListener.init(),this.selBoxListener.onselectionstart=e=>{"desktop"==this.options.alignMode&&(e.container.style.zIndex="10",document.body.classList.add("desktop-select"))},this.selBoxListener.onselectionfinished=()=>{"desktop"==this.options.alignMode&&document.body.classList.remove("desktop-select");let e=this.selBoxListener.getSelectedItems();this.deselectAllIcons();for(let t of e)this.selectIcon(t,!0)}}async drawWatermark(){const e=document.createElement("div");let t=$96.buildId;t&&"undefined"!=t||(t=(await fetch("/system/images/bstr.json",{cache:"no-store"}).then((e=>e.json()))).bstr),e.classList.add("build-info"),e.style.textAlign="right",e.style.fontFamily="monospace";e.innerHTML=`<span class="bright">Windows 96 main<br>Build ${t}</span>`,console.log(c.xP),c.xP.bootFlags.includes("no_build_info")&&(e.style.opacity="0%"),this.uiComponent.appendChild(e)}async performClipboard(e){const t=[];switch(e){case"cut":case"copy":this.uiComponent.querySelectorAll(".ghost").forEach((e=>e.classList.remove("ghost")));for(let i of this.selectedIcons){const r=i.getAttribute("ent"),o=i.getAttribute("path");if("cut"==e?i.classList.add("ghost"):i.classList.remove("ghost"),"2"==r)return;t.push(n.FSUtil.normalizeDriveLetter(o))}this.clipboardPut(t,e);break;case"paste":if(0==c.xP.wmem.clipboard.items.length)return;switch(c.xP.wmem.clipboard.action){case"cut":try{await s.Vu.move(c.xP.wmem.clipboard.items,this.fsPath),c.xP.wmem.clipboard.oncomplete(),this.onclipboard()}catch(e){d.O.create({title:"Error",body:`${e}`,icon:"error"}),console.error(e)}this.resetClipboard();break;case"copy":try{await s.Vu.copy(c.xP.wmem.clipboard.items,this.fsPath),c.xP.wmem.clipboard.oncomplete(),this.onclipboard()}catch(e){d.O.create({title:"Error",body:`${e}`,icon:"error"}),console.error(e)}}}}resetClipboard(){c.xP.wmem.clipboard={items:[],action:"cut",oncomplete:()=>this.onclipboard()}}clipboardPut(e,t){this.resetClipboard(),e&&t&&(c.xP.wmem.clipboard.items=[...e],c.xP.wmem.clipboard.action=t)}setViewMode(e){switch(e){default:throw new Error("View mode not found.");case"icons":this.options.iconSize="32x32";case"tile":this.options.iconSize="48x48";case"details":this.options.iconSize="16x16"}this.options.viewMode=e,this.uiComponent.classList.forEach((e=>{e.startsWith("view-")&&this.uiComponent.classList.remove(e)})),"icons"!=e&&this.uiComponent.classList.add(`view-${e}`)}async _ondzdropFn(e,t){const i=e.getAttribute("path");if(null==i)return!1;if(e.parentElement==this.uiComponent)return!1;if("computer://"==this.fsPath)return!1;const r=await n.FS.filetype(i),o=(3==this.fsPath.length?this.fsPath:this.fsPath+"/")+n.FSUtil.fname(i);if(i===this.fsPath||i===o)return!1;this.onicondrop(o,{...t,left:t.x,top:t.y});try{switch(r){case 0:await n.FS.mvfile(i,o);break;case 1:await n.FS.mvdir(i,o)}this.ondropfinish&&this.ondropfinish()}catch(e){s.jC.error("Error",new String(e),"OK")}return e.remove(),!0}init(){}async navigate(e,t,i=!1,r=!0){i||o.Q.playSound("navigate"),r&&(this.historyPos+1!=this.history.length&&(this.history=this.history.slice(0,this.historyPos+1)),this.history[this.history.length-1]!==e&&(this.history.push(e),this.historyPos++)),this.fsPath=e,await this.refreshView(t)}mkIcon(e,t){const i=document.createElement("div");i.classList.add("shell-icon"),i.style.top="10px",i.style.left="10px",i.style.display="inline-flex",i.style.position="absolute",i.style.flexDirection="column";const r=document.createElement("div");r.classList.add("icon-image"),r.style.background=`url(${t})`,i.appendChild(r);const n=document.createElement("span");return n.classList.add("icon-text"),n.innerText=e,i.appendChild(n),i}createRenameBoxListener(e,t){const i=e.querySelector(".icon-text");i.addEventListener("click",(async r=>{if(await(0,u.Dc)(500),!e.classList.contains("selected")||e.classList.contains("internal-no-rename"))return;const n=i.textContent.toString(),o=document.createElement("input");o.classList.add("rename-box"),o.value=i.textContent,e.appendChild(o);let s=e=>{o.remove(),i.style.display="",o.value!=n&&""!=o.value.trim()&&e?t(o.value):t(null)},a=()=>s(!0);o.addEventListener("blur",a),o.addEventListener("keydown",(e=>{switch(e.key){case"Escape":o.removeEventListener("blur",a),s(!1);break;case"Enter":o.removeEventListener("blur",a),s(!0)}})),o.addEventListener("dblclick",(e=>e.stopPropagation())),o.addEventListener("click",(e=>e.stopPropagation())),o.addEventListener("mousedown",(e=>e.stopPropagation())),i.style.display="none",o.focus(),o.select()}))}deselectAllIcons(){this.selectedIcons=[];this.uiComponent.querySelectorAll(".shell-icon").forEach((e=>{e.classList.remove("selected")}))}selectIcon(e,t=!1){t||this.deselectAllIcons(),e.classList.add("selected"),this.selectedIcons.includes(e)||(this.selectedIcons.push(e),this.onitemselected&&this.onitemselected(e))}sortIcons(){var e=3,t=2;const i=this.uiComponent.getBoundingClientRect(),r=Array.prototype.slice.call(this.uiComponent.querySelectorAll('.shell-icon[ent="1"]')),s=Array.prototype.slice.call(this.uiComponent.querySelectorAll('.shell-icon[ent="0"]')),a=Array.prototype.slice.call(this.uiComponent.querySelectorAll('.shell-icon[ent="2"]')),l=function(e,t){return e.getAttribute("name").toLowerCase()<t.getAttribute("name").toLowerCase()?-1:e.getAttribute("name").toLowerCase()>t.getAttribute("name").toLowerCase()?1:0};let c;r.sort(l),s.sort(l),a.sort(l);let d=e=>{let t=e.getAttribute("path");"2"==e.getAttribute("ent")&&(t=n.FSUtil.normalizeDriveLetter("c:/dummy/"+e.querySelector(".icon-text").textContent));const i=n.FSUtil.fname(t),r=this.options.storedIconPositions.find((e=>e.name==i));return!!r&&(e.style.left=`${r.pos.left}px`,e.style.top=`${r.pos.top}px`,!0)},h=()=>{t+140>window.innerHeight-o.Q.uiVars.taskbarHeight?(e+=75,t=2):t+=74};c="explorer"==this.options.alignMode?r=>{d(r)||(r.style.left=`${e}px`,r.style.top=`${t}px`,e+145>i.width?(e=3,t+=70):e+=74)}:i=>{if(d(i))return h();i.style.left=`${e}px`,i.style.top=`${t}px`,"free"==this.options.iconMovement&&this.options.storedIconPositions.push(i.getAttribute("path"),{top:t,left:e}),h()},a.forEach(c),r.forEach(c),s.forEach(c)}async refreshView(e){for(;this.uiComponent.firstChild;)this.uiComponent.removeChild(this.uiComponent.firstChild);"desktop"==this.options.alignMode&&await this.drawWatermark(),l.r.get(this.uiComponent).data=this.fsPath,this.selectedIcons=[];const t=[];let i=e=>{e.onmousedown=t=>{0!=t.button&&2!=t.button||(this.selectedIcons.length<2&&!t.ctrlKey&&this.deselectAllIcons(),this.selectIcon(e,!0))},e.onmouseup=t=>{0!=t.button&&2!=t.button||t.ctrlKey||(this.deselectAllIcons(),this.selectIcon(e,!0))}};for(let e of this.options.specialIcons){if(e.path!==this.fsPath)continue;const t=this.mkIcon(e.name,await o.Q.getIconUrl(e.icon,"32x32"));e.path&&t.setAttribute("path",e.path),e.id&&t.setAttribute("ident",e.id),t.setAttribute("ent","2"),t.setAttribute("name",e.name),this.makeDraggable(t),t.ondblclick=async()=>{this.selectIcon(t),this.onitemdblclick(t)},t.click=()=>{this.selectIcon(t)},this.options.singleClick&&t.addEventListener("click",(()=>t.ondblclick())),"details"==this.options.viewMode?(t.onclick=()=>this.selectIcon(t),t.querySelector(".icon-text").onclick=()=>this.selectIcon(t)):i(t),"details"==this.options.viewMode&&(t.onclick=()=>this.selectIcon(t)),this.uiComponent.appendChild(t)}if("computer://"==this.fsPath)return await(await n.FS.list()).aForEach((async e=>{const r=n.FS.get(e);if(r.features.includes(a.f.hidden))return;t.push(e);var s="devices/hdd";switch(r.driverName){default:case"idbfs":break;case"localfs":s="devices/floppy";break;case"ramfs":s="devices/memory";break;case"zipfs-ro":s="mime/zip";break;case"rofs":s="devices/hdd-ro";break;case"ecfs":s="devices/hdd-encrypted";break;case"p3fs":s="apps/p3fs"}const l=this.mkIcon(r.volumeLabel+" ("+e+")",await o.Q.getIconUrl(s,this.options.iconSize?this.options.iconSize:"32x32"));l.setAttribute("path",e+"/"),l.setAttribute("ent","2"),l.setAttribute("name",e),l.ondblclick=()=>{this.selectIcon(l),this.onitemdblclick(l)},this.options.singleClick&&l.addEventListener("click",(()=>l.ondblclick())),"details"==this.options.viewMode?(l.onclick=()=>this.selectIcon(l),l.querySelector(".icon-text").onclick=()=>this.selectIcon(l)):i(l),"details"==this.options.viewMode&&(l.onclick=()=>this.selectIcon(l)),this.uiComponent.appendChild(l)})),this.sortIcons(),void(e&&e(t));const r=await this.readdirFunc(this.fsPath);await async function(t){let s=[];for(var l of r){let e=l.path;const r=n.FSUtil.fname(e),h=l.filetype;let p;if("c:/trash"==e)p=0==(await n.FS.readdir("c:/trash")).length?t.mkIcon(r,await o.Q.getIconUrl.call({_cachedFiletype:h},"trash",t.options.iconSize?t.options.iconSize:"32x32")):t.mkIcon(r,await o.Q.getIconUrl.call({_cachedFiletype:h},"trash-full",t.options.iconSize?t.options.iconSize:"32x32"));else if(e.endsWith(".link")&&await n.FS.isFile(e))p=t.mkIcon(r.substring(0,r.lastIndexOf(".")),""),n.FS.readstr(e).then((async e=>{let i;try{i=JSON.parse(e)}catch(e){return}const r=p.querySelector(".icon-image");i.icon?i.icon.startsWith("data:")?r.style.background=`url(${i.icon})`:r.style.background=`url(${await o.Q.getIconUrl.call({_cachedFiletype:h},i.icon,t.options.iconSize?t.options.iconSize:"32x32",null!=i.iconFmt?i.iconFmt:"png")})`:await n.FS.exists(i.action)&&(await n.FS.isFile(i.action)?r.style.background=`url(${await o.Q.getFileIconUrl(i.action,t.options.iconSize?t.options.iconSize:"32x32",null!=i.iconFmt?i.iconFmt:"png")})`:r.style.background=`url(${await o.Q.getIconUrl.call({_cachedFiletype:h},"places/folder",t.options.iconSize?t.options.iconSize:"32x32",null!=i.iconFmt?i.iconFmt:"png")})`);const s=document.createElement("div");s.classList.add("icon-shortcut-emblem"),o.Q.getIconUrl("misc/shortcut-emblem").then((e=>s.style.background=`url(${e})`)),r.appendChild(s)}));else if(e.endsWith(".png")&&(await n.FS.stat(e)).length<t.options.previewMaxSize&&t.options.iconPreviews){const i=n.FSUtil.deconstructFullPath(e),s=n.FS.get(i.prefix);if(s.features.includes(a.f.readOnly)&&s.origin){const e=s.origin+"/"+i.path;p=t.mkIcon(r,e)}else p=t.mkIcon(r,await o.Q.getFileIconUrl.call({_cachedFiletype:h},e,t.options.iconSize?t.options.iconSize:"32x32"))}else p=t.mkIcon(r,await o.Q.getFileIconUrl.call({_cachedFiletype:h},e,t.options.iconSize?t.options.iconSize:"32x32"));"cut"==c.xP.wmem.clipboard.action&&c.xP.wmem.clipboard.items.includes(n.FSUtil.normalizeDriveLetter(e))&&p.classList.add("ghost"),t.makeDraggable(p),p.setAttribute("path",e),p.setAttribute("ent",h),p.setAttribute("name",r),p.style.left="10px",p.style.top="10px",p.ondblclick=function(){t.onitemdblclick(p)},t.options.singleClick&&p.addEventListener("click",(()=>p.ondblclick())),"details"==t.options.viewMode?(p.onclick=e=>{t.selectIcon(p)},p.querySelector(".icon-text").onclick=()=>t.selectIcon(p)):i(p),t.createRenameBoxListener(p,(async i=>{if(null!=i)try{if("c:/system"==e.toLowerCase()){"ok"==(await d.O.confirm("Renaming this folder may prevent your system from starting up properly.<br><br>Continue?",{icon:"warning"}).wait()).result.button&&await n.FS.rename(e,i)}else e.endsWith(".link")?await n.FS.rename(e,i+".link"):await n.FS.rename(e,i);if("desktop"==t.options.alignMode){const r=t.options.storedIconPositions.findIndex((t=>t==e));t.options.storedIconPositions[r]=i}t.onrefreshneeded&&t.onrefreshneeded()}catch(e){d.O.create({title:"Error Renaming File",body:null!=e.message?e.message:String(e),icon:"error"})}}));const f=n.FSUtil.deconstructFullPath(e),_=n.FS.get(f.prefix);!_.features.includes(a.f.remote)&&!_.remote&&(await n.FS.stat(e)).length<10485760&&n.FS.readStrChunk(e,0,256).then((async e=>{if(e.startsWith("//!wrt")){if(e.includes("$BSPEC:")){const i=e.indexOf("\n"),r=e.substring(e.indexOf("$BSPEC:"),-1==i?void 0:i);try{const e=JSON.parse(r.substring(7));if(null!=e.icn)return void(p.querySelector(".icon-image").style.background=`url(${await o.Q.getIconUrl(e.icn,t.options.iconSize?t.options.iconSize:"32x32")})`)}catch(e){console.error(e)}}p.querySelector(".icon-image").style.background=`url(${await o.Q.getIconUrl("mime/executable",t.options.iconSize?t.options.iconSize:"32x32")})`}})),p.addEventListener("dblclick",(async()=>{p.classList.add("internal-no-rename"),await(0,u.Dc)(600),p.classList.remove("internal-no-rename")})),s.push(p)}s.forEach((e=>t.uiComponent.appendChild(e))),t.sortIcons(),e&&e(r)}(this)}destroy(){this.uiComponent.remove()}getElement(){return this.uiComponent}getSize(){return{h:this.uiComponent.style.width,w:this.uiComponent.style.height}}setSize(e,t){this.uiComponent.style.width=e,this.uiComponent.style.height=t}_createIconFolderDropzone(e,t){l.r.create(e);const i=l.r.get(e);i.accepts.push("shell-icon"),i.data=t,i.ondrop=e=>this._ondzdropFn(e)}makeDraggable(e){let t=null,i=null,r=!1,o=[];class a{constructor(e,t){this.path=e.getAttribute("path"),this.ent=e.getAttribute("ent"),this.elem=e,this.parent=t,this.tempElem=null}create(){let e=this.elem.cloneNode(!0);return e.classList.add("clone-icon"),e.classList.remove("selected"),this.parent.appendChild(e),this.tempElem=e,e}start(){this.elem.style.display="none"}stop(){this.elem.style.display="inline-flex"}}$(e).draggable({helper:()=>{i=document.createElement("div"),i.style.padding=0,i.style.margin=0;for(let e of this.selectedIcons){let t=new a(e,i);t.create(),o.push(t)}return document.querySelector("#maingfx").appendChild(i),i},start:(e,t)=>{for(let e of o)e.start();const i=document.querySelector(".user-desktop>.build-info");i&&(i.style.pointerEvents="none")},drag:(e,n)=>{if(!r){r=!0;let e=parseInt(i.style.left),t=parseInt(i.style.top),n=o[0].elem.parentElement.getBoundingClientRect();for(let i of o)i.tempElem.style.left=parseInt(i.tempElem.style.left)-e+n.x+"px",i.tempElem.style.top=parseInt(i.tempElem.style.top)-t+n.y+"px"}const s=document.elementFromPoint(e.clientX,e.clientY);if(e.clientX>document.body.clientWidth||e.clientY+2>document.body.clientHeight)return e.preventDefault();s&&s.classList&&s!=this.uiComponent&&(s.classList.contains("dropzone")&&null==t?(t=s,s.classList.add("hlight")):t!=s&&null!==t&&(t.classList.remove("hlight"),t=null))},stop:async(e,a)=>{t&&(t.classList.remove("hlight"),t=null);const c=e.clientX,h=e.clientY;for(let e of o)e.stop();i.style.display="none";const p=document.elementFromPoint(c,h),u=document.querySelector(".user-desktop>.build-info");u&&(u.style.pointerEvents="auto");let f=!1,_=()=>{r=!1,i=null,f&&this.refreshView(),this.deselectAllIcons(),setTimeout((()=>{let e=!1;for(let t of o)t.nowExternal||e?e=!0:this.selectIcon(t.elem,!0);e&&this.deselectAllIcons(),o=[]}),0)};if(p&&p.classList.contains("dropzone")){const e=l.r.get(p);if(!e.accepts.includes("shell-icon"))return _();const t=n.FSUtil.deconstructFullPath(e.data);if("computer://"==e.data)return d.O.create({body:"Invalid path.",icon:"error",title:"Error during transfer"}),_();if(n.FS.get(t.prefix).readOnly)return d.O.create({body:"Read-only filesystem.",icon:"error",title:"Error during transfer"}),_();for(let t of o){const r=t.tempElem,o=t.elem,a=parseInt(i.style.left),l=parseInt(i.style.top),c=parseInt(r.style.left)+a,d=parseInt(r.style.top)+l,h=t.path;if(e===this.dropzone){if("free"!==this.options.iconMovement)continue;o.style.left=`${c}px`,o.style.top=`${d}px`,this.onicondrop(o,{top:d,left:c})}if(2!=t.ent&&(null!=h&&e.data!=this.fsPath&&e.data!=h&&!e.data.startsWith(h+"/"))){if("C:/system"==h){s.jC.confirm("This is a terrible idea. Continue?",(i=>{i&&e.ondrop(o,{x:c,y:d})&&(f=!0,t.nowExternal=!0)}),"warning");continue}const i=o.getAttribute("path"),r=n.FSUtil.fname(i),a=e.data+("3"==e.data.length?"":"/")+r;if(h[0].toLowerCase()+h.slice(1)===e.data||h[0].toLowerCase()+h.slice(1)===a)continue;await n.FS.exists(a)?s.jC.confirm(a+" exists. Replace?",(async i=>{i&&await e.ondrop(o,{x:c,y:d})&&(f=!0,t.nowExternal=!0)}),"question"):await e.ondrop(o,{x:c,y:d})&&(f=!0,t.nowExternal=!0)}}}return _()}})}backwards(e=!0){if(this.history.length>0&&this.historyPos-1>=0){let t=this.history[--this.historyPos];return e&&this.navigate(t),t}}forwards(e=!0){if(this.history.length>0&&this.historyPos+1<this.history.length){let t=this.history[++this.historyPos];return e&&this.navigate(t),t}}up(e=!0){if("computer://"==this.fsPath)return this.fsPath;const t=n.FSUtil.deconstructFullPath(this.fsPath);let i;return i="/"==t.path?"computer://":t.prefix+n.FSUtil.getParentPath(t.path),e&&this.navigate(i),i}uiCreateDirectory(e){if("computer://"==this.fsPath)return e(!1);const t=n.FSUtil.deconstructFullPath(this.fsPath);if(n.FS.get(t.prefix).features.includes(a.f.readOnly))return s.jC.error("FS Error","Read-only file system.","Damn..."),e(!1);s.jC.prompt("Create Directory","Enter the name of the directory to create.","New Folder",(async t=>{if(null==t)return e(!1);const i=n.FSUtil.deconstructFullPath(this.fsPath),r=i.prefix+("/"==i.path?"":i.path)+"/"+t;await n.FS.exists(r)?s.jC.warning("Directory Creation Failure","The path specified already exists.","OK"):(await n.FS.mkdir(r),e(!0))}))}uiCreateFile(e){if("computer://"==this.currentPath)return e(!1);const t=n.FSUtil.deconstructFullPath(this.fsPath);if(n.FS.get(t.prefix).features.includes(a.f.readOnly))return s.jC.error("FS Error","Read-only file system.","Damn..."),e(!1);s.jC.prompt("Create File","Enter the name of the file to create.","New File.txt",(async t=>{if(null==t)return;const i=n.FSUtil.deconstructFullPath(this.fsPath),r=i.prefix+("/"==i.path?"":i.path)+"/"+t;await n.FS.exists(r)?s.jC.warning("File Creation Failure","The path specified already exists.","OK"):(await n.FS.touch(r),e(!0))}))}}},2889:(e,t,i)=>{"use strict";i.d(t,{E:()=>o});var r=i(9471),n=i(6993);class o extends n.UIComponent{constructor(e){super(),e=Object.assign({title:"Sample Text",body:""},e),this.uiComponent=r.K.mkElement("div",["w96-groupbox"]);const t=r.K.mkElement("div",["title"]);t.innerText=e.title,this.uiComponent.appendChild(t);const i=r.K.mkElement("div",["content"]);i.innerHTML=e.body,this.uiComponent.appendChild(i)}setBody(e){this.uiComponent.querySelector(".content").innerHTML=e}setTitle(e){this.uiComponent.querySelector(".title").innerText=e}}},4779:(e,t,i)=>{"use strict";i.d(t,{w:()=>o});var r=i(9471),n=i(6993);class o extends n.UIComponent{constructor(){super(),this.uiComponent=r.K.mkElement("div",["w96-listbox"]),this.onitemselected=e=>{},this.onitemdeselected=e=>{},this.selectedItem=null}addItem(e,t="untitled"){if(void 0===e)throw new DOMError("Invalid label.");const i=r.K.mkElement("div",["item"]);return i.innerText=e,i.setAttribute("ident",t),i.addEventListener("click",(()=>{this.selectItem(i.getAttribute("ident"))})),this.uiComponent.appendChild(i),i}selectItem(e){if(void 0===e)throw new DOMError("Invalid ID.");const t=this.uiComponent.querySelector(`.item[ident="${e}"]`);return null!=t&&(this._deselectAll(),t.classList.add("selected"),this.onitemselected&&this.onitemselected(e),this.selectedItem=e,!0)}clear(){for(;this.uiComponent.firstChild;)this.uiComponent.removeChild(this.uiComponent.firstChild);this.selectedItem=null}_deselectAll(){this.uiComponent.querySelectorAll(".item.selected").forEach((e=>{e.classList.contains("selected")&&(e.classList.remove("selected"),this.onitemdeselected&&this.onitemdeselected(e.getAttribute("ident")))}))}}},6999:(e,t,i)=>{"use strict";i.d(t,{j:()=>n});const{ContextMenu:r}=i(8576);class n{constructor(){this.menuElement=document.createElement("div"),this.menuElement.classList.add("w96-menubar"),this._menu=new r([])}addRoot(e,t,i=!0){const r=document.createElement("span");return r.classList.add("root-item"),r.innerText=e,r.onclick=e=>{if(e.stopPropagation(),r.classList.contains("selected"))return r.classList.remove("selected"),void document.querySelectorAll(".wcontext-menu").forEach((e=>e.remove()));document.body.querySelectorAll(".root-item.selected").forEach((e=>e.classList.remove("selected"))),document.querySelectorAll(".wcontext-menu").forEach((e=>e.remove()));const n=r.getBoundingClientRect();i?this._menu.renderMenu(n.x+4,n.y+n.height+2,t).classList.add("mbar"):this._menu.renderMenu(n.x+4,n.y+n.height+2,t),r.classList.add("selected")},r.onmouseenter=e=>{if(r.classList.contains("selected"))return;const t=r.parentElement.querySelector(".root-item.selected");t&&t!=r&&(t.classList.remove("selected"),r.onclick(e))},this.menuElement.appendChild(r),r}getMenuDiv(){return this.menuElement}}},1717:(e,t,i)=>{"use strict";i.d(t,{X:()=>o});var r=i(9471),n=i(6993);class o extends n.UIComponent{constructor(e){super(),this.uiComponent=r.K.mkElement("div",["w96-radiobox"]),this._addItems(e)}_addItems(e){const t="r_"+Math.floor(1e5*Math.random());let i=0;for(let n of e){if(!n.label)continue;const e=r.K.mkElement("div",["option"]),o=document.createElement("input");o.type="radio",o.checked=n.selected,o.name=t,o.id=`radio-${t}-${i++}`,o.addEventListener("click",(()=>{n.onselect&&n.onselect({element:o,id:n.id})})),e.appendChild(o);const s=document.createElement("label");s.innerText=n.label,s.setAttribute("for",o.id),e.appendChild(s),this.uiComponent.appendChild(e)}}}},5544:(e,t,i)=>{"use strict";i.d(t,{a:()=>n});const{UIComponent:r}=i(6993);class n extends r{constructor(){super(),this.uiComponent=document.createElement("div"),this.uiComponent.classList.add("w96-tab-control"),this.pagesContainer=document.createElement("div"),this.pagesContainer.classList.add("pages"),this.uiComponent.appendChild(this.pagesContainer),this.contentContainer=document.createElement("div"),this.contentContainer.classList.add("content"),this.uiComponent.appendChild(this.contentContainer),this._createdPages=0}_createActivationZone(e,t){const i=document.createElement("div"),r=e.getBoundingClientRect();i.style.background="transparent",i.style.zIndex=10,i.style.position="absolute";const n=(()=>{let e=0;return this.pagesContainer.querySelectorAll("button").forEach((t=>e+=t.getBoundingClientRect().width)),e})();i.style.left=n+"px",i.style.top="0px",i.style.height=r.height+"px",i.style.width=r.width+"px",i.onclick=t,this.pagesContainer.appendChild(i)}async openPage(e){for(this.contentContainer.className="content";this.contentContainer.firstChild;)this.contentContainer.removeChild(this.contentContainer.firstChild);this.contentContainer.innerHTML="";const t=this.pagesContainer.querySelector('button[pid="'+e+'"]');null!=t&&(this.pagesContainer.querySelectorAll("button").forEach((e=>{e.classList.remove("active")})),await t.ontabdraw(this.contentContainer),t.classList.add("active"))}addPage(e,t){const i=this._createdPages++,r=document.createElement("button");return r.onclick=e=>{Array.from(e.target.classList).includes("active")||this.openPage(i)},r.setAttribute("pid",i),r.innerText=e,r.ontabdraw=t,this.pagesContainer.appendChild(r),i}getSize(){return{h:this.uiComponent.style.width,w:this.uiComponent.style.height}}setSize(e,t){this.uiComponent.style.width=e,this.uiComponent.style.height=t}getElement(){return this.uiComponent}destroy(){this.uiComponent.remove()}}},2168:(e,t,i)=>{"use strict";i.d(t,{u:()=>o});var r=i(6993);i(8576);const n=["bottom","top","left","right"];class o extends r.UIComponent{constructor(e={}){super(),this.options={iconSize:24,defaults:{itemTextPosition:"bottom"},compact:!1,...e},this.createdItems=0,this.uiComponent=document.createElement("div"),this.uiComponent.classList.add("w96-toolbar"),this.options.compact&&this.uiComponent.classList.add("compact")}addSeparator(){const e=document.createElement("div");e.classList.add("vseparator"),this.uiComponent.appendChild(e)}getItemById(e){return this.uiComponent.querySelector(`.item[ident="${e}"]`)}getItemByName(e){return this.uiComponent.querySelector(`.item[name="${e}"]`)}getItem(e){return"number"==typeof e?this.getItemById(e):this.getItemByName(e)}setDisabled(e,t){const i=this.getItem(e);i&&i.setAttribute("disabled",t)}resetItemStates(){this.uiComponent.querySelectorAll('.item[disabled="true"]').forEach((e=>e.removeAttribute("disabled")))}addItem(e={}){const t={textPosition:this.options.defaults.itemTextPosition,text:null,imageUrl:null,isDropdown:!1,dropdownMenu:null,onclick:null,name:"",...e,id:this.createdItems++},i=document.createElement("div");if(i.classList.add("item"),i.setAttribute("ident",t.id),i.setAttribute("name",t.name),t.imageUrl){const e=document.createElement("div");e.classList.add("icon"),e.style.backgroundImage=`url(${t.imageUrl})`,e.style.height=`${this.options.iconSize}px`,e.style.width=`${this.options.iconSize}px`,i.appendChild(e)}if(t.text){if(!n.includes(t.textPosition))throw new Error("Invalid alignment for item.");const e=document.createElement("div");e.innerText=t.text,i.classList.add(`item-${t.textPosition}`),e.classList.add("text",t.textPosition),i.appendChild(e)}return t.onclick&&i.addEventListener("click",(()=>{i.hasAttribute("disabled")||t.onclick()})),this.uiComponent.appendChild(i),{el:i,id:t.id}}}},1124:(e,t,i)=>{"use strict";i.d(t,{r:()=>r});const r={create:function(e,t){e.dzone||(e.dzone={accepts:["file","text"],data:t,ondrop:function(e){return!1}},e.classList.add("dropzone"))},get:function(e){return e.dzone}}},797:(e,t,i)=>{"use strict";i.d(t,{P:()=>a});var r=i(1350),n=(i(6227),i(9338)),o=i(5563);async function s(e,t=!1,i=!1){if(!await(0,o.Ml)()){const t=n.jC.error("System Security","The security account manager (SAM) config is missing.","OK");return t.setSize(385,110),t.dlg.center(),void e(!1)}const s=new r.Lw;s.resizable=!1,s.title="Log On to Windows",s.initialHeight=t?270:236,s.disableCommentsBtn=!0,s.initialWidth=388;const a=new r.DI(s);a.registerWindow(),a.setControlBoxStyle("WS_CBX_NONE"),a.show(),a.center();const l=a.wndObject.querySelector(".window-html-content");l.classList.add("logon-app"),a.setHtml(`\n        <div class="logo"></div>\n        <div class="content">\n            <span class="password-protected">\n                <img src="/system/resource/icons/win96/16x16/status/warning.png">\n                <span>This system's files are password-protected. If you forgot your password and want to ${i?"cancel disk encryption":"reinstall"}, click Cancel.</span>\n            </span>\n\n            <div class="field">\n                <span>Username:</span>\n                <input disabled="true" class="w96-textbox disabled" type="text">\n            </div>\n            <div class="field pwd">\n                <span>Password:</span>\n                <input class="w96-textbox" type="password">\n            </div>\n        </div>\n        <div class="buttons">\n            <button class="w96-button btn-ok">OK</button>\n            &nbsp;\n            <button class="w96-button btn-cancel" disabled>Cancel</button>\n            &nbsp;\n            <button class="w96-button btn-reboot">Reboot</button>\n        </div>\n\n    `);const c=l.querySelector(".password-protected");t||c.remove();const d=l.querySelector('input[type="text"]');d.value=(await(0,o.B1)()).name;const h=l.querySelector('input[type="password"]'),p=l.querySelector(".btn-ok"),u=l.querySelector(".btn-cancel"),f=l.querySelector(".btn-reboot");t&&(u.disabled=!1),u.onclick=()=>{a.close(),e(!1)},f.onclick=()=>document.location.reload(),p.onclick=async()=>{if(await(0,o.TK)(d.value,h.value))a.close(),e(!0);else{new Audio("/system/resource/sounds/misc/access_deny.mp3").play();const e=n.jC.error("System Security","The specified password is incorrect.","OK");setTimeout((()=>{e.dlg.wndObject.querySelector("button").focus()}),1)}},h.onkeyup=function(e){"Enter"==e.key&&p.onclick()}}var a={displayLogonUI:s,displayLogonUIAsync:function(e=!1,t=!1){return new Promise((i=>s(i,e,t)))}}},6993:(e,t,i)=>{"use strict";i.r(t),i.d(t,{Size:()=>n,UIComponent:()=>o});var r=i(9275);class n{constructor(e,t){this.width=e,this.height=t}getWidth(){return this.width}getHeight(){return this.height}}class o extends r.v{constructor(){super()}init(){this.uiComponent=null}getSize(){return{h:this.uiComponent.style.width,w:this.uiComponent.style.height}}setSize(e,t){this.uiComponent.style.width=e,this.uiComponent.style.height=t}getElement(){return this.uiComponent}destroy(){this.uiComponent.remove()}}},1350:(e,t,i)=>{"use strict";i.d(t,{KZ:()=>v,DI:()=>k,Lw:()=>E,C$:()=>y});var r=i(9951),n=i(8423),o=i(6841),s=i(3978),a=i(7612),l=i(8576),c=i(4078),d=i(674);i(6226),i(9338),i(5690),i(254),i(6227),i(8223),i(3991),i(5516);let h={dragging:{hideWindow:!1,simpleDragBox:!1},features:{windowSnap:!0,disableAllAnimations:!1,enableClearFix:!1,use12hTime:!1},animations:{windowOpen:"zoomIn",windowClose:"zoomOut"}};const p=[];let u=null;var f=null,_=null,g={x:11,y:11};let m=!1,b=0;const y={deactivateAllWindows:function(){p.forEach((e=>{if(null!=e){var t=e.wndObject;null!=t&&(t.children[0].classList.add("titlebar-title-disabled"),t.classList.remove("active"),e.darkenElements())}})),document.querySelectorAll(".taskbar-task").forEach((e=>{e.classList.contains("taskbar-task_active")&&e.classList.remove("taskbar-task_active")})),u=null},setWindowContainer:function(e){f=e},findWindow:function(e){var t=null;return p.forEach((i=>{i.id==e&&(t=i)})),t},closeAllWindows:function(e){p.forEach((t=>{null!=t&&null!=t.wndObject&&t.close(e)}))},getActiveWindow:()=>u,destroyDragHandler:e=>$(e.wndObject).draggable("destroy"),createDragHandler:C,createResizeHandler:w,destroyResizeHandler:e=>$(e.wndObject).resizable("destroy"),getWindowContainer:()=>f,disableAppBar:e=>m=e,setConfig:async function(e){h={...h,...e},h.dragging.simpleDragBox?f.classList.add("f-smdrag"):f.classList.remove("f-smdrag"),h.features.disableAllAnimations?((0,r.E)(!0),h.animations.windowOpen="anim-null",h.animations.windowClose="anim-null"):(0,r.E)(!1)},getConfig:function(){return h},startZIndex:10,windows:p};var v={WS_CBX_MINMAXCLOSE:"WS_CBX_MINMAXCLOSE",WS_CBX_CLOSE:"WS_CBX_CLOSE",WS_CBX_MINCLOSE:"WS_CBX_MINCLOSE",WS_CBX_NONE:"WS_CBX_NONE"};function w(e){$(e.wndObject).resizable({handles:"n, s, w, e, ne, se, sw, nw",minHeight:e.params.minHeight,minWidth:e.params.minWidth,iframeFix:!0,start:()=>{S();const t=document.createElement("style");t.innerText="iframe { pointer-events: none !important; }",t.classList.add("iframe-fix"),document.body.appendChild(t),e.activate()},resize:()=>{e.onresize()},stop:()=>{$("iframe").css("pointer-events","auto");const e=document.querySelector(".iframe-fix");e&&e.remove()}})}function x(e){g.x=e.x,g.y=e.y}function C(e){$(e.wndObject).draggable({cancel:".nodrag",iframeFix:!0,start:()=>{S(),h.dragging.hideWindow&&e.wndObject.classList.add("dragging"),h.features.windowSnap&&e.params.resizable&&document.addEventListener("mousemove",x)},stop:()=>{h.dragging.hideWindow&&e.wndObject.classList.remove("dragging"),h.features.windowSnap&&e.params.resizable&&(_&&(_.remove(),_=null),g.x>window.innerWidth-10?(e._ext.windowSnap.snapped=!0,e._ext.windowSnap.originalSize={height:e.wndObject.style.height,width:e.wndObject.style.width},e._ext.windowSnap.snappedSize={width:Math.ceil(window.innerWidth/2)-8,height:window.innerHeight-36},e.setSize(e._ext.windowSnap.snappedSize.width,e._ext.windowSnap.snappedSize.height,!0),e.setPosition(window.innerWidth/2,0)):g.x<10?(e._ext.windowSnap.snapped=!0,e._ext.windowSnap.originalSize={height:e.wndObject.style.height,width:e.wndObject.style.width},e._ext.windowSnap.snappedSize={width:(window.innerWidth/2|0)-8,height:window.innerHeight-36},e.setSize(e._ext.windowSnap.snappedSize.width,e._ext.windowSnap.snappedSize.height,!0),e.setPosition(0,0)):g.y<10&&(e.wndObject.style.top="0px",e.toggleMaximize()),document.removeEventListener("mousemove",x),g={x:11,y:11})},drag:t=>{if(u!=e&&e.activate(),h.features.windowSnap&&e.params.resizable){if(e._ext.windowSnap.snapped){const t=e._ext.windowSnap.originalSize;e.wndObject.style.height=t.height,e.wndObject.style.width=t.width,e._ext.windowSnap.snapped=!1,e._ext.windowSnap.originalSize=null}_?(0,o.dl)((0,o.dl)(g.x>10,g.x<window.innerWidth-10),g.y>10)&&(_.remove(),_=null):g.x>window.innerWidth-10?((_=document.createElement("div")).classList.add("winsnap-panel"),_.classList.add("right"),document.body.appendChild(_)):g.x<10?((_=document.createElement("div")).classList.add("winsnap-panel"),_.classList.add("left"),document.body.appendChild(_)):g.y<10&&((_=document.createElement("div")).classList.add("winsnap-panel"),_.classList.add("top"),document.body.appendChild(_))}}})}function S(){document.querySelectorAll(".wcontext-menu").forEach((e=>e.remove()))}class E{constructor(){this.initialX=100,this.initialY=100,this.minHeight=22,this.minWidth=72,this.initialHeight=340,this.initialWidth=480,this.title="Untitled Window",this.resizable=!0,this.draggable=!0,this.taskbar=!1,this.icon=null,this.center=!1,this.body=null,this.bodyClass=null,this.windowClass=null,this.controlBoxStyle="WS_CBX_MINMAXCLOSE",this.mobResize=!1,this.iframeFix=!0,this.disableCommentsBtn=!1,this.animations={windowOpen:h.animations.windowOpen,windowClose:h.animations.windowClose},this.wndContainer=null}}class k{constructor(e){null==e&&(e=new E),e=Object.assign(new E,e),0!=a.Q.uiVars.tbOffsetH&&(e.initialHeight+=a.Q.uiVars.tbOffsetH),0!=a.Q.uiVars.tbOffsetW&&(e.initialWidth+=a.Q.uiVars.tbOffsetW),this.id="wnd_"+(b++).toString(),this.useIcon=!1,this.wndObject=document.createElement("div"),this.wndObject.associatedWindow=this,this.wndObject.classList.add("window-dlg"),this.wndObject.id=this.id;let t=s.V.escapeHtml(e.title),i=h.features.enableClearFix&&a.Q.uiVars.clearFixEnabled;i&&(t=t.replaceAll(" "," &nbsp;")),this.wndObject.innerHTML=`<div class="titlebar">\n            <div class="titlebar-title ${i?" wordspacing-2":""}">${t}</div>\n            <div class="nodrag titlebar-closebutton"></div>\n            <div class="nodrag titlebar-maxbutton"></div>\n            <div class="nodrag titlebar-minbutton"></div>\n            \n        </div>\n        <div class="window-html">\n            <div class="window-html-content nodrag"></div>\n        </div>`,this.wndObject.querySelector(".titlebar-closebutton").addEventListener("click",(()=>this.close())),this.wndObject.querySelector(".titlebar-maxbutton").addEventListener("click",(e=>{Array.from(e.target.classList).includes("wm-cbx-disabled")||this.toggleMaximize()})),this.wndObject.querySelector(".titlebar-minbutton").addEventListener("click",(e=>{Array.from(e.target.classList).includes("wm-cbx-disabled")||this.toggleMinimize()})),this.wndObject.style.position="absolute",this.wndObject.style.height=`${e.initialHeight}px`,this.wndObject.style.width=`${e.initialWidth}px`,this.wndObject.style.top=`${e.initialX}px`,this.wndObject.style.left=`${e.initialY}px`,this.wndObject.onmousedown=e=>{this.isActive()||e.target==this.wndObject.querySelector(".titlebar-icon")||this.activate()},this.animations=e.animations,this.params=e,this.isRegistered=!1,this.appbarRegistered=!1,this.shown=!1,this._wmStylingAllowed=!0,this._waitResolveFn=null,this.maximized=!1,this.minimized=!1,this.uiUpdating=!1,this.windowIcon=null,this.title=e.title,this.maximizeInfo={x:"0px",y:"0px",h:"0px",w:"0px"},this.ownerWindow=e.owner||null,this._ownerProps=e.ownerProps||null,this._childWindowDlg=null,this.onclose=null,this.onfinalclose=null,this.onload=null,this.ondarkenelements=function(){},this.onshown=function(){},this.onresize=function(){},this.onlightenelements=function(){},this._ext={windowSnap:{snapped:!1,originalSize:null,snappedSize:null}};this.wndObject.querySelector(".titlebar").addEventListener("contextmenu",(e=>this.showTitlebarMenu(e))),this.registerWindow(),e.taskbar&&this.registerAppBar(),null!=e.icon&&this.setWindowIcon(e.icon),null!=e.body&&this.setHtml(e.body),null!=e.bodyClass&&this.getBodyContainer().classList.add(e.bodyClass),null!=e.windowClass&&this.wndObject.classList.add(e.windowClass),null!=e.controlBoxStyle&&this.setControlBoxStyle(e.controlBoxStyle),e.iframeFix&&this.wndObject.classList.add("ifr")}wait(){return new Promise((e=>this._waitResolveFn=e))}setOwner(e,t){const i={mode:"dialogParent",...t};this.ownerWindow=e,this._ownerProps=i,"dialogParent"==i.mode&&(this.ownerWindow._childWindowDlg=e)}showTitlebarMenu(e){S();let t=!0,i=!0,r=!0;switch(this.params.controlBoxStyle||"WS_CBX_MINMAXCLOSE"){case"WS_CBX_MINMAXCLOSE":break;case"WS_CBX_CLOSE":i=!1,r=!1;break;case"WS_CBX_MINCLOSE":i=!1;break;default:t=!1,r=!1,i=!1}const n=new l.ContextMenu([i?{type:"normal",label:"Maximize/Restore",onclick:()=>this.toggleMaximize()}:null,r?{type:"normal",label:"Minimize",onclick:()=>this.toggleMinimize()}:null,(i||r)&&t?{type:"separator"}:null,t?{type:"normal",label:"Close",onclick:()=>this.close()}:null].filter((e=>e)));(t||i||r)&&n.renderMenu(e.x+1,e.y+1)}registerWindow(){this.isRegistered||(p.push(this),this.params.wndContainer?this.params.wndContainer.appendChild(this.wndObject):f.appendChild(this.wndObject),this.isRegistered=!0,this.setStartPos())}registerAppBar(){m||this.appbarRegistered||(this.appbarRegistered=!0,n.e.createWindowAppBar(this))}setTitle(e){this.title=e;var t=this.wndObject.querySelector(".titlebar-title");let i=s.V.escapeHtml(e);if(h.features.enableClearFix&&a.Q.uiVars.clearFixEnabled?(i=i.replaceAll(" "," &nbsp;"),t.classList.contains("wordspacing-2")||t.classList.add("wordspacing-2")):t.classList.contains("wordspacing-2")&&t.classList.remove("wordspacing-2"),t.innerHTML=i,this.appbarRegistered){const t=document.getElementById(this.id+"_appbar");t&&(t.querySelector(".taskbar-task-text").innerText=e)}}setHtml(e){const t=this.wndObject.querySelector(".window-html-content");for(;t.firstChild;)t.removeChild(t.firstChild);t.innerHTML=e}randomizePosition(){const e=this.getBounds(),t=window.innerWidth-e.width-20,i=window.innerHeight-e.height-20;this.setPosition((0,o.TN)(20,t),(0,o.TN)(54,i))}setStartPos(e=!1){const t=this.getBounds(),i=window.innerWidth-t.width-50,r=window.innerHeight-t.height-50,n=22*(e?b:(b-1)%10)+50,s=22*(e?b:(b-1)%10)+84;this.setPosition((0,o.N5)(50,i,n),(0,o.N5)(84,r,s))}show(){d.u.callComposite(this),this.shown||(this.wndObject.style.display="flex",this.shown=!0,(0,r.s)(this.wndObject,this.animations.windowOpen,(()=>{this.onshown()})),setTimeout((()=>this.activate()),20),this.wndObject.children[0].ondblclick=()=>{this.params.resizable&&this.toggleMaximize()},this.params.resizable&&w(this),this.params.draggable&&C(this),this.params.center&&this.center(),c.f.isMobileModeEnabled()&&(this.params.resizable||this.params.mobResize)&&this.toggleMaximize())}center(e=!1){e||(this.wndObject.style.left=`${Math.round(window.innerWidth/2-this.params.initialWidth/2)}px`,this.wndObject.style.top=`${Math.round(window.innerHeight/2-this.params.initialHeight/2)}px`)}activate(){if(this.wndObject){this._ownerProps&&"dialogParent"==this._ownerProps.mode&&this.ownerWindow&&this.ownerWindow.activate(),u=this,n.e.activateAppBar(this.id);for(var e=parseInt(this.wndObject.style.zIndex),t=10,i=0;i<p.length;i++){if(null!=p[i])if(null!=(o=p[i].wndObject)&&o.id!=this.id){var r=parseInt(o.style.zIndex);r>t&&(t=r)}}for(i=0;i<p.length;i++){var o;if(null!=p[i])null!=(o=p[i])&&o.id!=this.id&&(o.wndObject.children[0].classList.add("titlebar-title-disabled"),o.wndObject.classList.remove("active"),o.darkenElements())}this.wndObject.children[0].classList.remove("titlebar-title-disabled"),this.lightenElements(),this.wndObject.classList.add("active"),e!=t&&(this.wndObject.style.zIndex=t+1)}}setVisible(e){this.wndObject.style.display=e?"flex":"none"}isActive(){return this.wndObject.classList.contains("active")}toggleMinimize(e=!1){if(this.minimized){if(a.Q.playSound("restore"),this.minimized=!1,this.uiUpdating=!0,n.e.activateAppBar(this.id),this.appbarRegistered){const e=document.getElementById(this.id+"_appbar").getBoundingClientRect(),t=document.createElement("div");t.classList.add("ui-minimize-tempbox"),t.style.left=e.left+"px",t.style.top=e.top+"px",t.style.width=e.width+"px",t.style.height=e.height+"px",f.appendChild(t);const i="wnd-min-temp-"+this.id,n=document.createElement("style");return n.innerText=`\n                    .${i} {\n                        animation: ${i} 200ms linear;\n                        z-index: 1000000;\n                    }\n\n                    @keyframes ${i} {\n                        100% {\n                            left: ${this.wndObject.style.left};\n                            top: ${this.wndObject.style.top};\n                            height: ${this.wndObject.style.height};\n                            width: ${this.wndObject.style.width};\n                        }\n                    }\n                `,document.body.appendChild(n),void(0,r.s)(t,i,(()=>{this.activate(),t.remove(),this.wndObject.style.display="flex",this.uiUpdating=!1}))}this.wndObject.style.display="flex",e?(this.activate(),this.uiUpdating=!1):(0,r.s)(this.wndObject,"bounceInUp",(()=>{this.activate(),this.uiUpdating=!1}))}else{if(a.Q.playSound("minimize"),this.uiUpdating=!0,this.minimized=!0,u=null,setTimeout((()=>n.e.deactivateAppBar(this.id)),50),this.appbarRegistered){const e=document.createElement("div");e.classList.add("ui-minimize-tempbox"),e.style.left=this.wndObject.style.left,e.style.top=this.wndObject.style.top,e.style.width=this.wndObject.style.width,e.style.height=this.wndObject.style.height,f.appendChild(e),this.wndObject.style.display="none";const t="wnd-min-temp-"+this.id,i=document.createElement("style"),n=document.getElementById(this.id+"_appbar").getBoundingClientRect();return i.innerText=`\n                    .${t} {\n                        animation: ${t} 200ms linear;\n                        z-index: 1000000;\n                    }\n\n                    @keyframes ${t} {\n                        100% {\n                            left: ${n.left}px;\n                            top: ${n.top}px;\n                            height: ${n.height}px;\n                            width: ${n.width}px;\n                        }\n                    }\n                `,document.body.appendChild(i),void(0,r.s)(e,t,(()=>{i.remove(),e.remove(),this.uiUpdating=!1}))}(0,r.s)(this.wndObject,"windowMinimize",(()=>{this.wndObject.style.display="none",this.uiUpdating=!1}))}}toggleMaximize(){this.uiUpdating||(this.maximized?(a.Q.playSound("unmaximize"),this.maximized=!1,this.wndObject.children[0].children[2].classList.remove("titlebar-maxxed"),this.wndObject.classList.remove("nodrag"),w(this),this.wndObject.style.height=this.maximizeInfo.h,this.wndObject.style.width=this.maximizeInfo.w,this.wndObject.style.top=this.maximizeInfo.y,this.wndObject.style.left=this.maximizeInfo.x,this.wndObject.classList.remove("maximized")):(a.Q.playSound("maximize"),this.maximized=!0,this.wndObject.children[0].children[2].classList.add("titlebar-maxxed"),this.wndObject.classList.add("nodrag"),this.maximizeInfo={x:this.wndObject.style.left,y:this.wndObject.style.top,h:this.wndObject.style.height,w:this.wndObject.style.width},this.wndObject.style.height=a.Q.uiVars.maxWindowSizeFormulaH,(0,r.s)(this.wndObject,"winmaximize",(()=>{this.wndObject.style.width=a.Q.uiVars.maxWindowSizeFormulaW,this.wndObject.style.left="0px",this.wndObject.style.top="0px",this.wndObject.classList.add("maximized");try{$("#"+this.id).resizable("destroy")}catch(e){}this.onresize()}))))}close(e){if(!this.uiUpdating){if(this.uiUpdating=!0,S(),null!=this.onclose&&!e){const e={canceled:!1};if(this.onclose(e),e.canceled)return void(this.uiUpdating=!1)}this.onfinalclose&&this.onfinalclose(),this.wndObject.style.pointerEvents="none",this.appbarRegistered&&n.e.destroyAppBar(this.id),this.minimized?this._onCloseEnd():(0,r.s)(this.wndObject,this.animations.windowClose,(()=>this._onCloseEnd()))}}_onCloseEnd(){const e=this.id,t=this.wndObject;this.ownerWindow&&this.ownerWindow.activate(),t.uiUpdating=!1,u=null,p.forEach(((t,i)=>{if(null!=t&&t.id==e){if(p[i].wndObject.associatedWindow=null,p[i].wndObject.remove(),p[i]._waitResolveFn)return p[i]._waitResolveFn(),void(p[i]._waitResolveFn=null);p[i].wndObject=null,p[i]=null}}))}_destroy(){this.params=null,this.animations=null,this.maximizeInfo=null,this.wndObject=null,this.windowIcon=null,this.ownerWindow=null,this._childWindowDlg=null}darkenElements(){this._wmStylingAllowed&&(null!=this.ondarkenelements&&this.ondarkenelements(),this.wndObject.querySelectorAll(".w96-listbox>.item.enabled").forEach((e=>{e.style.background="rgb(156,156,156)",e.style.color="black"})))}lightenElements(){this._wmStylingAllowed&&(null!=this.onlightenelements&&this.onlightenelements(),this.wndObject.querySelectorAll(".w96-listbox>.item").forEach((e=>{e.style.background="",e.style.color=""})),this._styleTimeoutComplete=!1,setTimeout((()=>this._styleTimeoutComplete=!0),150))}setWindowIcon(e){var t=this.wndObject.querySelector(".titlebar-title"),i=this.wndObject.querySelector(".titlebar-icon");if(null==e)return this.windowIcon=null,null!=i&&i.remove(),!1;if(t.style.paddingLeft=a.Q.uiVars.titlebarIconPadding,null==i){let e;(i=document.createElement("div")).classList.add("titlebar-icon"),i.addEventListener("click",(t=>{t.stopPropagation(),e&&clearTimeout(e),e=setTimeout((()=>{this.showTitlebarMenu(t),e=null}),230)})),i.addEventListener("contextmenu",(e=>this.showTitlebarMenu(e))),i.addEventListener("dblclick",(()=>{this.close(),clearTimeout(e),e=null})),this.wndObject.appendChild(i)}if(i.style.backgroundImage=`url(${e})`,this.windowIcon=e,w96.ui.Theme.uiVars.superbarEnabled&&(e=e.replace("/16x16/","/32x32/")),this.appbarRegistered){const t=document.getElementById(this.id+"_appbar");t&&(t.querySelector(".taskbar-task-icon").style.background="url("+e+")")}return i}setControlBoxStyle(e){if(this.params.controlBoxStyle=e.trim(),this.wndObject.children[0].children[2].style.width="",w96.ui.Theme.uiVars.classicWMButtonBehavior){switch(e.trim()){case"WS_CBX_MINMAXCLOSE":this.wndObject.children[0].children[1].style.display="inline-block",this.wndObject.children[0].children[2].style.display="inline-block",this.wndObject.children[0].children[3].style.display="inline-block";break;case"WS_CBX_CLOSE":this.wndObject.children[0].children[1].style.display="inline-block",this.wndObject.children[0].children[2].style.display="none",this.wndObject.children[0].children[3].style.display="none";break;case"WS_CBX_MINCLOSE":this.wndObject.children[0].children[1].style.display="inline-block",this.wndObject.children[0].children[2].style.display="none",this.wndObject.children[0].children[2].style.width="0px",this.wndObject.children[0].children[3].style.display="inline-block";break;case"WS_CBX_NONE":this.wndObject.children[0].children[1].style.display="none",this.wndObject.children[0].children[2].style.display="none",this.wndObject.children[0].children[3].style.display="none"}this.wndObject.querySelector(".titlebar").setAttribute("cbxstyle",e)}else switch(e.trim()){case"WS_CBX_MINMAXCLOSE":this.wndObject.children[0].children[1].style.display="inline-block",this.wndObject.children[0].children[2].style.display="inline-block",this.wndObject.children[0].children[2].classList.remove("wm-cbx-disabled"),this.wndObject.children[0].children[2].disabled=!1,this.wndObject.children[0].children[3].style.display="inline-block",this.wndObject.children[0].children[3].classList.remove("wm-cbx-disabled"),this.wndObject.children[0].children[3].disabled=!1;break;case"WS_CBX_CLOSE":this.wndObject.children[0].children[1].style.display="inline-block",this.wndObject.children[0].children[2].style.display="none",this.wndObject.children[0].children[3].style.display="none";break;case"WS_CBX_MINCLOSE":this.wndObject.children[0].children[1].style.display="inline-block",this.wndObject.children[0].children[2].style.display="inline-block",this.wndObject.children[0].children[2].classList.add("wm-cbx-disabled"),this.wndObject.children[0].children[2].disabled=!0,this.wndObject.children[0].children[3].style.display="inline-block",this.wndObject.children[0].children[3].classList.remove("wm-cbx-disabled"),this.wndObject.children[0].children[3].disabled=!1;break;case"WS_CBX_NONE":this.wndObject.children[0].children[1].style.display="none",this.wndObject.children[0].children[2].style.display="none",this.wndObject.children[0].children[3].style.display="none"}}setSize(e,t,i=!1){i?(this.wndObject.style.height=`${t}px`,this.wndObject.style.width=`${e}px`):(this.wndObject.style.height=`${t+a.Q.uiVars.tbOffsetH}px`,this.wndObject.style.width=`${e+a.Q.uiVars.tbOffsetW}px`)}setPosition(e,t){this.wndObject.style.left=(0|e)+"px",this.wndObject.style.top=(0|t)+"px"}getBounds(){return this.wndObject.getBoundingClientRect()}getComputedBounds(){return this.wndObject.getBoundingClientRect()}getBodyContainer(){return this.wndObject.querySelector(".window-html-content")}}},845:(e,t,i)=>{"use strict";i.d(t,{b:()=>Qt});i(5524);var r=i(5516),n=i(6227),o=i(1350),s=i(9338),a=i(4186),l=i(3991),c=i(7362),d=i(7612),h=i(9182),p=i(8576),u=i(8223),f=i(1561),_=i(3177),g=i(5506),m=i(9110),b=i(797),y=i(9951);const v={mkShortcut:function(e,t,i,r=!1){const o={};return o.hideShortcutEmblem=r,o.icon=t,o.action=i,n.FS.writestr(e,JSON.stringify(o))}};var w=i(3978),x=i(6841);const C={wnd:function(e){let t={initialX:100,initialY:100,minHeight:22,minWidth:72,initialHeight:340,initialWidth:480,title:"Untitled Window",resizable:!0,draggable:!0,icon:null,html:"",displayInTaskbar:!0,animations:{windowOpen:"zoomIn",windowClose:"zoomOut"}};Object.assign(t,e);const i=new o.DI(t);return i.registerWindow(),t.displayInTaskbar&&i.registerAppBar(),null!=t.icon&&i.setWindowIcon(t.icon),i.setHtml(t.html),i}},S={ui:C,shell:{mkShortcut:v.mkShortcut},fs:n.FS,fsUtil:n.FSUtil,sys:{reboot:r.xP.reboot},util:{xor:x.dl,htmlSafe:w.V.escapeHtml,loadScriptAsync:u.a.loadlibAsync,clamp:x.N5,rand:x.TN,sideloadZip:h.N,waitAsync:x.Dc},exec:r.xP.execCmd};var E=i(4799),k=(i(4876),i(7619)),L=i(8279);class A extends E.N{constructor(e,t,i){super(e),this.fileTable={"/":{length:0,type:1}},this.readOnly=!0,this.volumeLabel="Shared",this.driverName="rofs",this.remote=!0,this.features.push(L.f.readOnly,L.f.remote),this.socket=null}async _getItem(e){return await fetch(e).then((e=>e.arrayBuffer()))}async init(){}async uninit(){this.fileTable=null}isFile(e){return 0==this.filetype(e)}exists(e){return null!=this.fileTable[e]}filetype(e){return this.exists(e)?this.fileTable[e].type:-1}touch(e){throw new k.J(k.H.EROFS,e)}rm(e){throw new k.J(k.H.EROFS,e)}mkdir(e){throw new k.J(k.H.EROFS,e)}readdir(e,t){var i=[],r=Object.keys(this.fileTable),n=e;if(!this.exists(e))throw new k.J(k.H.ENOENT,e);var o=n.split("/").length;for(var s in r){var a=r[s];if(a!=n&&null!=this.fileTable[a]){if("/"!=e){if(!a.startsWith(n+"/"))continue;if(!a.startsWith(n))continue}var l=a.split("/").length;"/"==e&&l>o||l>o+1||(t?i.push({path:a,filetype:this.filetype(a)}):i.push(a))}}return this._fsSort?i.sort((function(e,i){return t?e.path.toLowerCase().localeCompare(i.path.toLowerCase()):e.toLowerCase().localeCompare(i.toLowerCase())})):i}isEmpty(e){if(!this.exists(e))throw new k.J(k.H.ENOENT,e);if(!this.isFile(e))throw new k.J(k.H.EISDIR,e);return 0==this.fileTable[e].length}async cpdir(e,t){throw new k.J(k.H.EROFS,t)}async mvdir(e,t){throw new k.J(k.H.EROFS,t)}async rmdir(e){throw new k.J(k.H.EROFS,e)}async mvfile(e,t){throw new k.J(k.H.EROFS,t)}async cpfile(e,t){throw new k.J(k.H.EROFS,t)}async readbin(e){if(!this.exists(e))throw new k.J(k.H.ENOENT,e);if(!this.isFile(e))throw new k.J(k.H.EISDIR,e);return this.fileTable[e].length<1?new Uint8Array(0):await this._getItem(e)}async readstr(e){if(!this.exists(e))throw new k.J(k.H.ENOENT,e);if(!this.isFile(e))throw new k.J(k.H.EISDIR,e);return this.fileTable[e].length<1?"":(new TextDecoder).decode(await this.readbin(e))}async writebin(e){throw new k.J(k.H.EROFS,e)}async writestr(e){throw new k.J(k.H.EROFS,e)}stat(e){return this.fileTable[e]}}var O=i(5544),M=i(6993);class P extends M.UIComponent{constructor(){super(),this.uiComponent=document.createElement("div"),this.uiComponent.classList.add("container-3d")}addText3d(){console.log("gameing")}}var R=i(9471);let D=!1,T=null,I=0;function B(e){const t=T.querySelector(".windows"),i=t.children.item(e);if(null!=i){for(let e=0;e<t.children.length;e++)t.children.item(e).classList.remove("selected");i.classList.add("selected")}}function F(e){e.stopPropagation();const t=T.querySelector(".windows");"ArrowDown"==e.key||"K"==e.key?(I>=t.children.length-1?I=0:I++,B(I)):"ArrowUp"==e.key?(I<1?I=t.children.length-1:I--,B(I)):"Enter"==e.key&&H()}function W(e){e.stopPropagation(),!e.ctrlKey&&!e.shiftKey||"Shift"!=e.key&&"Control"!=e.key||U.closeUI()}function H(){if(D){try{T.querySelector(".windows").querySelector(".window.selected").wnd.activate()}catch(e){}T.remove(),T=null,I=0,document.body.removeEventListener("keydown",F),document.body.removeEventListener("keyup",W),N.closeAllPopups(),D=!1}}const U={selectWindowIndex:B,keyDownHandler:async function(e){if(D);else{if(function(){let e=0;for(let t of o.C$.windows)null!=t&&e++;return e}()<1)return;D=!0,T=R.K.mkElement("div",["imde-ui-winswitcher","imde-ui-popup"]),T.innerHTML='<div class="windows"></div>';const e=T.querySelector(".windows");for(let t of o.C$.windows){if(null==t)continue;const i=R.K.mkElement("div",["window"]);if(i.setAttribute("wnd",t.id),null!=t.windowIcon&&""!=t.windowIcon.trim()){const e=R.K.mkElement("div",["icon"]);e.style.backgroundImage=`url(${t.windowIcon})`,i.appendChild(e)}else{const e=R.K.mkElement("div",["icon"]);e.style.backgroundImage=`url(${await d.Q.getIconUrl("mime/executable","16x16")})`,i.appendChild(e)}const r=R.K.mkElement("div",["title"]);r.innerText=t.title,i.appendChild(r),i.onclick=e=>{e.stopPropagation(),H()},i.wnd=t,e.appendChild(i)}document.body.appendChild(T),document.body.addEventListener("keydown",F),document.body.addEventListener("keyup",W);const t=function(){const e=document.querySelector(".window-dlg.active");if(null==e)return-1;const t=e.id,i=T.querySelector(".windows");if(!t)return-1;const r=i.querySelector(`.window[wnd="${t}"]`);for(let e=0;e<i.children.length;e++)if(r==i.children[e])return e;return-1}();-1!=t&&(B(t),I=t)}},keyUpHandler:function(e){},closeUI:H};function j(){document.querySelectorAll(".imde-ui-popup").forEach((e=>e.remove()))}function z(){document.body.addEventListener("keydown",(e=>{if(e.ctrlKey&&e.shiftKey)switch(e.key){case"F8":e.preventDefault(),function(){let e=document.querySelector(".imde-ui-popup.shkeys");if(e)return void e.remove();N.closeAllPopups();const t=R.K.mkElement("div",["imde-ui-popup","shkeys"]);t.innerHTML='<div class="title">\n    Keyboard Shortcuts\n</div>\n<div class="popup">\n    <div class="keys-list">\n        <div class="key-item">\n            <span class="key">CTRL</span>+<span class="key">SHIFT</span>+<span class="key">K</span>\n            <span class="explanation">\n            Fast window switching\n            </span>\n        </div>\n        <div class="key-item">\n            <span class="key">CTRL</span>+<span class="key">SHIFT</span>+<span class="key">F8</span>\n            <span class="explanation">\n            Toggles this dialog\n            </span>\n        </div>\n        <div class="key-item">\n            <span class="key">CTRL</span>+<span class="key">SHIFT</span>+<span class="key">T</span>\n            <span class="explanation">Quickly open a terminal window\n            </span>\n        </div>\n        <div class="key-item">\n            <span class="key">CTRL</span>+<span class="key">R</span>\n            <span class="explanation">Reload the desktop</span>\n        </div>\n        <div class="key-item">\n            <span class="key">ALT</span>+<span class="key">R</span>\n            <span class="explanation">Open the Run box</span>\n        </div>\n    </div>\n</div>',document.body.appendChild(t)}();break;case"K":e.preventDefault(),U.keyDownHandler(e);break;case"T":e.preventDefault(),j(),r.xP.execCmd("terminal",[])}else if(e.altKey&&"R"===e.key)e.preventDefault(),execCmd("run",[])})),document.body.addEventListener("keyup",(e=>{if(e.ctrlKey&&e.shiftKey&&"K"===e.key)U.keyUpHandler(e)}))}const N={init:async function(){console.group("[ IMDE ]"),console.log("Initializing..."),console.log("Loading data..."),await u.a.loadStyleAsync("/system/resource/stylesheets/imde.css"),console.log("Assigning events..."),z(),console.log("Done initializing."),console.groupEnd()},closeAllPopups:j},{UIComponent:q}=i(6993);var K=i(6999),$=i(4779),V=i(8423),J=[];function G(){J=[]}const X={queue:{get:function(){return J},clear:G},enqueue:function(e){J.push(e)},enqueueMany:function(e){for(let t of e)J.push(t)},setOperation:function(e){switch(e){default:throw new Error("Invalid queue operation");case"move":case"copy":}e},sanitize:async function(){for(let e in J)await n.FS.exists(J[e])||J.splice(e,1)},reset:function(){G(),"copy"}},{FS:Q}=i(6227);var Y=i(9275),Z=i(6167),ee=i(254),te=i(2889),ie=i(9266),re=i(5690),ne=i(3078),oe=i(2110),se=i(5905),ae=i(7839),le=i(9150),ce=i(674);class de extends M.UIComponent{constructor(e){super(),this.uiComponent=R.K.mkElement("div",["w96-tree","w96-inset"]),this._addItems(e)}_addItems(e){for(let t of e)this.uiComponent.appendChild(this.createDetails(t))}createDetails(e){const t=R.K.mkElement("details",[]),i=R.K.mkElement("summary",[]);if(e.icon){const t=R.K.mkElement("div",["icon"]);t.style.backgroundImage=`url(${e.icon})`,i.appendChild(t)}if(e.label){const t=R.K.mkElement("span",["text"]);t.innerText=e.label,i.appendChild(t)}if(e.opened&&t.setAttribute("open",""),t.appendChild(i),!e.items)return t;for(let i of e.items)if(i.items){const e=this.createDetails(i);t.appendChild(e),i.opened&&e.setAttribute("open","")}else{const r=R.K.mkElement("div",["item"]);if(e.icon){const e=R.K.mkElement("div",["icon"]);e.style.backgroundImage=`url(${i.icon})`,r.appendChild(e)}if(i.label){const e=R.K.mkElement("span",["text"]);e.innerText=i.label,r.appendChild(e)}t.appendChild(r)}return t}}const he={makeBackup:async function(){const e=new JSZip,t=(await n.FS.walk("c:/")).map((e=>e.substring(3,e.length)));for(let i of t){const t="c:/"+i;if(await n.FS.isFile(t))try{await e.file(i,await n.FS.readbin(t))}catch(e){console.log("Error zipping contents.")}}return e}};var pe=i(1717),ue=i(4871),fe=i(7733),_e=i(8918),ge=i(5293);const{UIComponent:me}=i(6993),be=[{name:"default",lineColor:"lime",paperColor:"#008040"}],ye={time:1e3,theme:be[0],previousData:[],ondata:()=>0,onmaxval:()=>100,size:{box_width:12,box_height:12,width:200,height:60},drawOffset:2,autoUpdate:!0,showDetails:{name:"CPU",unit:"%",enabled:!1}};function ve(e,t,i,r,n,o,s,a,l,c=[],d=!1,h=(()=>100)){let p=e.width=t,u=e.height=i;const f=a;let _=r,g=n;const m=o,b=s;let y=e.getContext("2d"),v=0,w=[...c];if(w.length<p/f+10&&d){let e=Math.round(p/f+10);w=[...new Array(e).fill(0),...c]}function x(e,t,i,r){let n=new Array,o=Math.abs(i-e),s=Math.abs(r-t),a=e<i?1:-1,l=t<r?1:-1,c=o-s;for(n.push([e,t]);e!=i||t!=r;){let i=c<<1;i>-s&&(c-=s,e+=a),i<o&&(c+=o,t+=l),n.push([e,t])}return n}function C(e){for(let t of e)y.fillRect(t[0],t[1],1,1)}return function(){var e;e=l(v),w.push(e),w.length>p/f+10&&w.shift(),y.fillStyle="#000000",y.fillRect(0,0,p,u),v++,y.fillStyle=m;for(let e=0;e<u;e++)(e+1)%g==0&&e!=u-1&&y.fillRect(0,e,p,1);for(let e=0;e<p;e++)(e+v*f)%_==0&&y.fillRect(e,0,1,u);y.fillStyle=b;let t=null;w.reverse();for(let e in w){let i=p-e*f;if(i<=2)continue;let r=w[e],n=u-Math.floor(r/h()*u);n>=u&&(n=u-1),t&&C(x(t[0],t[1],i,n)),t=[i,n]}w.reverse()}}class we extends me{constructor(e){if(super(),this._state={init:!1,proc:-1,draw:()=>{}},this.options={...ye,...e},"string"==typeof this.options.theme){const e=be.find((e=>e.name==this.options.theme));e&&(this.options.theme=e)}this.uiComponent=document.createElement("div"),this.uiComponent.classList.add("w96-graph"),this.uiComponent.style.width=`${this.options.size.width}px`,this.uiComponent.style.height=`${this.options.size.height}px`;const t=document.createElement("canvas");if(this.uiComponent.appendChild(t),this.graph=t,this.options.showDetails){const e=document.createElement("div");e.innerHTML='<div class="w96-graph-el"><span class="w96-graph-top"></span><br><span class="w96-graph-bottom"></span></div>',e.querySelector(".w96-graph-top").innerText=this.options.showDetails.name,this.uiComponent.appendChild(e),this.detailsEl=e}}init(){if(this._state.init)return;this._state.init=!0;const e=ve(this.graph,this.options.size.width,this.options.size.height,this.options.size.box_width,this.options.size.box_height,this.options.theme.paperColor,this.options.theme.lineColor,this.options.drawOffset,(e=>{let t=this.options.ondata(e);return this._ondata(t),t}),this.options.previousData,this.options.zeroData,this.options.onmaxval);this.options.autoUpdate&&(this._state.proc=setInterval((()=>e()),this.options.time)),this._state.draw=e,e()}pause(){clearInterval(this._state.proc),this._state.proc=-1}resume(){this._state.proc=setInterval((()=>this._state.draw()),this.options.time)}isPaused(){return-1==this._state.proc}draw(){if(this._state&&this._state.draw)return this._state.draw();throw new Error("Invalid state")}_ondata(e){this.detailsEl&&(this.detailsEl.querySelector(".w96-graph-bottom").innerText=e+this.options.showDetails.unit)}destroy(){super.destroy(),clearInterval(this._state.proc),this.uiComponent=null,this.options=null,this._state=null,this.graph=null}}const xe={showDOMFps:function(){const e=new we({zeroData:!0,ondata:()=>o,onmaxval:()=>n+5,showDetails:{enabled:!0,name:"FPS",unit:" fps"},size:{box_width:12,box_height:12,width:500,height:60},autoUpdate:!1});let t;const i=document.createElement("div");i.classList.add("dbg-fps-counter"),i.appendChild(e.getElement()),window.performance.memory&&(i.appendChild(document.createElement("br")),t=new we({zeroData:!0,ondata:()=>a,onmaxval:()=>s+2,showDetails:{enabled:!0,name:"Memory",unit:" MiB"},size:{box_width:12,box_height:12,width:500,height:60},theme:{lineColor:"yellow",paperColor:"#008040"},autoUpdate:!1}),i.appendChild(t.getElement())),document.body.appendChild(i);let r=0,n=0,o=0,s=0,a=0,l=()=>{r++,requestAnimationFrame(l)};setInterval((()=>{o=Number(r),r=0,o>n&&(n=o),t&&(a=Number((window.performance.memory.usedJSHeapSize/1024/1024).toFixed(1)),a>s&&(s=a)),e.draw(),t&&t.draw()}),1e3),l(),e.init(),t&&t.init()}};var Ce=i(9807),Se=i(3970),Ee=i(5624),ke=i(6110),Le=i(5563),Ae=i(6226),Oe=i(1602),Me=i(3080);class Pe{constructor(e,t){this.buffer="",this.prgmPath=e,this.onclose=t,this._init()}async _init(){let e=await(0,Oe.X)(this.prgmPath,await d.Q.getIconUrl("mime/executable","16x16"));e.terminal.write(this.buffer),this.terminal=e.terminal,this.terminal.wnd.onclose=this.onclose,delete this.buffer}print(e){this.terminal?this.term.write(e):this.buffer+=e}println(e){return this.print(`${e}\n`)}printErr(e){return this.println(Me.$`{redBright ${e}}`)}}const Re=[];const De={generatePID:function(){let e=10+Re.length;if(e>65535)throw new Error("System resources exhausted - maximum process limit reached.");return Re.push(e),e},releasePID:function(e){if(!e||"number"!=typeof e||!Re.includes(e))throw new Error("Invalid PID.");Re.splice(Re.indexOf(e),1)}},Te=[],Ie=Te;const Be={proc:{processes:Ie,kill:function(e){Te.find((t=>t.pid==e)).cls.target.instance.onExit(255)}},CAPIProvider:class{constructor(e){this.target=e,this.windows=[],this._state={terminal:null,execOrigin:"unnamed"},Te.push({pid:De.generatePID(),title:"unnamed",cls:this})}requestTerminal(){return this._state.terminal||(this._state.terminal=new Pe(this._state.execOrigin,(()=>this.target.instance.onExit(255)))),this.terminal}setProcessTitle(e){const t=Te.findIndex((e=>e.cls==this));-1!=t&&(Te[t].title=e)}createWindow(e){return this.windows.push(new o.DI(e)),this.windows.length-1}}};class Fe extends Error{constructor(e,t){super(e+": "+t),this.prgm=e,this.name="WEXError"}}const We={read:async function(e){const t=new JSZip;if(await t.loadAsync(await n.FS.readbin(e)),!t.files["PRGM.WASM"])throw new Fe(e,"Missing item: PRGM.WASM");if(!t.files["PRGM.JS"])throw new Fe(e,"Missing item: PRGM.JS");return{files:{wasm:URL.createObjectURL(await t.files["PRGM.WASM"].async("blob")),js:URL.createObjectURL(await t.files["PRGM.JS"].async("blob")),rc:{name:"",description:"",version:"",copyright:"",...t.files.RC?JSON.parse(await t.files.RC.async("string")):{}}}}}};const He={runFile:function(e){return new Promise((async(t,i)=>{if(!await n.FS.exists(e))throw new Error("Invalid file.");const r=await We.read(e);let o=document.createElement("iframe");try{document.body.appendChild(o),o.style.display="none",o.src="/system/libraries/wex/wex.html",o.onload=()=>{let i=new Be.CAPIProvider(o.contentWindow);i._state.execOrigin=e,o.contentWindow.instance.c_api=i,o.contentWindow.instance.srcinfo.wasm_binary=r.files.wasm,o.contentWindow.instance.srcinfo.RC=r.files.rc,o.contentWindow.instance.onExit=e=>{i._state.terminal.wnd&&i._state.terminal.wnd.close(!0);for(let e of i.windows)e.close(!0);const r=Ie.find((e=>e.cls==i));De.releasePID(r.pid),Ie.splice(Ie.indexOf(r),1),i=null,o.remove(),o=null,t(e)};const n=o.contentDocument.createElement("script");n.src=r.files.js,o.contentDocument.head.appendChild(n)}}catch(e){console.error(e),o.remove()}}))}};const Ue=class{constructor(e){this.target=e,this.context=this.target.getContext("2d"),this.config={desktop:{background:{type:"solid",color:"#3B6EA5"}}}}draw(){if("solid"===this.config.desktop.background.type)this.context.fillStyle=this.config.desktop.background.color,this.context.fillRect(0,0,this.target.width,this.target.height)}};class je extends a.QP{constructor(){super(),this.mainwnd=this.createWindow({title:"Test Window",body:'<canvas height="100%" width="100%"></canvas>',bodyClass:"sdgfx-test"},!0)}drawText(e){}async main(e){super.main(e),this.mainwnd.show();const t=this.mainwnd.getBodyContainer();new Ue(t.querySelector("canvas")).draw()}}var ze=i(2168),Ne=i(1943),qe=i(1638),Ke=i(9326),$e=i(120);const Ve=["/","-","\\","|"];function Je(e,t){var i={seen:[],stylize:Ge};return arguments.length>=3&&(i.depth=arguments[2]),arguments.length>=4&&(i.colors=arguments[3]),Xe(t)?i.showHidden=t:t&&ht(i,t),Qe(i.showHidden)&&(i.showHidden=!1),Qe(i.depth)&&(i.depth=2),Qe(i.colors)&&(i.colors=!1),Qe(i.customInspect)&&(i.customInspect=!0),i.colors&&(i.stylize=Ye),ct(i,e,i.depth)}function Ge(e,t){return e}function Xe(e){return"boolean"==typeof e}function Qe(e){return void 0===e}function Ye(e,t){var i=Je.styles[t];return i?"["+Je.colors[i][0]+"m"+e+"["+Je.colors[i][1]+"m":e}function Ze(e){return"function"==typeof e}function et(e){return"string"==typeof e}function tt(e){return null===e}function it(e,t){return Object.prototype.hasOwnProperty.call(e,t)}function rt(e){return nt(e)&&"[object RegExp]"===at(e)}function nt(e){return"object"==typeof e&&null!==e}function ot(e){return nt(e)&&("[object Error]"===at(e)||e instanceof Error)}function st(e){return nt(e)&&"[object Date]"===at(e)}function at(e){return Object.prototype.toString.call(e)}function lt(e){return"["+Error.prototype.toString.call(e)+"]"}function ct(e,t,i){if(e.customInspect&&t&&Ze(t.inspect)&&t.inspect!==Je&&(!t.constructor||t.constructor.prototype!==t)){var r=t.inspect(i,e);return et(r)||(r=ct(e,r,i)),r}var n=function(e,t){if(Qe(t))return e.stylize("undefined","undefined");if(et(t)){var i="'"+JSON.stringify(t).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return e.stylize(i,"string")}if(r=t,"number"==typeof r)return e.stylize(""+t,"number");var r;if(Xe(t))return e.stylize(""+t,"boolean");if(tt(t))return e.stylize("null","null")}(e,t);if(n)return n;var o=Object.keys(t),s=function(e){var t={};return e.forEach((function(e,i){t[e]=!0})),t}(o);try{e.showHidden&&Object.getOwnPropertyNames&&(o=Object.getOwnPropertyNames(t))}catch(e){}if(ot(t)&&(o.indexOf("message")>=0||o.indexOf("description")>=0))return lt(t);if(0===o.length){if(Ze(t)){var a=t.name?": "+t.name:"";return e.stylize("[Function"+a+"]","special")}if(rt(t))return e.stylize(RegExp.prototype.toString.call(t),"regexp");if(st(t))return e.stylize(Date.prototype.toString.call(t),"date");if(ot(t))return lt(t)}var l,c="",d=!1,h=["{","}"];(Array.isArray(t)&&(d=!0,h=["[","]"]),Ze(t))&&(c=" [Function"+(t.name?": "+t.name:"")+"]");return rt(t)&&(c=" "+RegExp.prototype.toString.call(t)),st(t)&&(c=" "+Date.prototype.toUTCString.call(t)),ot(t)&&(c=" "+lt(t)),0!==o.length||d&&0!=t.length?i<0?rt(t)?e.stylize(RegExp.prototype.toString.call(t),"regexp"):e.stylize("[Object]","special"):(e.seen.push(t),l=d?function(e,t,i,r,n){for(var o=[],s=0,a=t.length;s<a;++s)it(t,String(s))?o.push(dt(e,t,i,r,String(s),!0)):o.push("");return n.forEach((function(n){n.match(/^\d+$/)||o.push(dt(e,t,i,r,n,!0))})),o}(e,t,i,s,o):o.map((function(r){return dt(e,t,i,s,r,d)})),e.seen.pop(),function(e,t,i){if(e.reduce((function(e,t){return t.indexOf("\n")>=0&&0,e+t.replace(/\u001b\[\d\d?m/g,"").length+1}),0)>60)return i[0]+(""===t?"":t+"\n ")+" "+e.join(",\n  ")+" "+i[1];return i[0]+t+" "+e.join(", ")+" "+i[1]}(l,c,h)):h[0]+c+h[1]}function dt(e,t,i,r,n,o){var s,a,l;l={value:void 0};try{l.value=t[n]}catch(e){}try{Object.getOwnPropertyDescriptor&&(l=Object.getOwnPropertyDescriptor(t,n)||l)}catch(e){}if(l.get?a=l.set?e.stylize("[Getter/Setter]","special"):e.stylize("[Getter]","special"):l.set&&(a=e.stylize("[Setter]","special")),it(r,n)||(s="["+n+"]"),a||(e.seen.indexOf(l.value)<0?(a=tt(i)?ct(e,l.value,null):ct(e,l.value,i-1)).indexOf("\n")>-1&&(a=o?a.split("\n").map((function(e){return"  "+e})).join("\n").substr(2):"\n"+a.split("\n").map((function(e){return"   "+e})).join("\n")):a=e.stylize("[Circular]","special")),Qe(s)){if(o&&n.match(/^\d+$/))return a;(s=JSON.stringify(""+n)).match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(s=s.substr(1,s.length-2),s=e.stylize(s,"name")):(s=s.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),s=e.stylize(s,"string"))}return s+": "+a}function ht(e,t){if(!t||!nt(t))return e;for(var i=Object.keys(t),r=i.length;r--;)e[i[r]]=t[i[r]];return e}Je.colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]},Je.styles={special:"cyan",number:"yellow",boolean:"yellow",undefined:"grey",null:"bold",string:"green",date:"magenta",regexp:"red"};var pt=i(9703),ut=i(5685),ft=i(408),_t=i(1674),gt=i(3516);const mt={debugWriteUI:async function(e){await n.FS.writestr(e,prompt("Enter file contents for "+e,""))},assert:function(e,t){if(!e)throw new Error(`Assertion failed: ${t}`)}};var bt=i(4078),yt=i(4101),vt=i(3379),wt=i.n(vt),xt=i(7795),Ct=i.n(xt),St=i(569),Et=i.n(St),kt=i(3565),Lt=i.n(kt),At=i(9216),Ot=i.n(At),Mt=i(4589),Pt=i.n(Mt),Rt=i(4680),Dt={};Dt.styleTagTransform=Pt(),Dt.setAttributes=Lt(),Dt.insert=Et().bind(null,"head"),Dt.domAPI=Ct(),Dt.insertStyleElement=Ot();wt()(Rt.Z,Dt);Rt.Z&&Rt.Z.locals&&Rt.Z.locals;var Tt=i(225),It=i(2430);class Bt extends Error{constructor(e,t,i){super(`At line ${e}:${t}: ${i}`),this.name="INIParsingError"}}const Ft=[[String.fromCharCode(10),"\\n"],[String.fromCharCode(13),"\\r"],[String.fromCharCode(9),"\\t"],[String.fromCharCode(97),"\\a"],[String.fromCharCode(59),"\\;"],[String.fromCharCode(61),"\\="],[String.fromCharCode(34),'\\"'],[String.fromCharCode(39),"\\'"]],Wt=/^\[.*\]$/,Ht=/\=/,Ut=/".*?"/gi,jt=/^[+-]?([0-9]+\.?[0-9]*|\.[0-9]+)$/gi,zt=/^(true|false)+$/gi;function Nt(e){let t=`${e}`;for(let e of Ft)t=t.replaceAll(e[1],e[0]);return t}function qt(e){let t=`${e}`;for(let e of Ft)t=t.replaceAll(e[0],e[1]);return t}const Kt={parse:function(e,t={}){const i={escape:!1,throwErrors:!0,typeInference:!0,duplicateSectionMode:"merge",...t},r={},n=e.split("\n");let o=null,s=0;for(let e of n){s++;const t=e.trim();if(""!=t&&!t.startsWith(";"))if(Wt.test(t)){const e=t.substring(1,t.length-1).trim();if(""==e){if(i.throwErrors)throw new Bt(s,1,"Empty section name not allowed.");continue}null!=r[e]&&"replace"!=i.duplicateSectionMode||(r[e]={}),o=e}else if(Ht.test(t)){if(null==o){if(i.throwErrors)throw new Bt(s,0,"Property must be contained within a section!");continue}const e=t.split("=")[0].trim(),n=t.substring(t.indexOf("=")+1).trim();let a=n;i.typeInference&&(a=Ut.test(n)?i.escape?Nt(a.substring(1,a.length-1)):a.substring(1,a.length-1):jt.test(n)?parseFloat(n):zt.test(n)?"true"==n.toLowerCase():""==n?null:i.escape?Nt(a):a),r[o][i.escape?Nt(e):e]=a}else if(i.throwErrors)throw new Bt(s,0,"Unknown syntax.")}return r},stringify:function(e,t={}){const i={escape:!1,...t};if(!e||"object"!=typeof e)return"";let r="";for(let t of Object.keys(e))if(r+=`\n[${t}]\n`,"object"==typeof e[t])for(let n of Object.keys(e[t])){let o=e[t][n];"object"!=typeof o&&("string"==typeof o?o=`${i.escape?qt(o):o}`:null==o&&(o=""),r+=`${n}=${i.escape?qt(o):o}\n`)}return r},INIParsingError:Bt};var $t=i(7460);class Vt extends M.UIComponent{constructor(){super(),this.uiComponent=R.K.mkElement("div",["w96-table"]),this.uiComponent.appendChild(R.K.mkElement("table")),this.setSelectionMode("first-bbox"),this.autoSelect=!0,this._stat={createdColumns:0,lastSortingMode:"ascending"}}setSelectionMode(e){switch(this.uiComponent.className="w96-table",e){case"full":this.uiComponent.classList.add("a-full");break;case"first-bbox":this.uiComponent.classList.add("a-fbb")}}_checkColumnHeaderDefault(){const e=this.uiComponent.querySelector("table");e.querySelector("tr.header")||e.appendChild(R.K.mkElement("tr",["header"]))}addColumnHeader(e,t=""){this._checkColumnHeaderDefault();const i=this.uiComponent.querySelector("tr.header"),r=R.K.mkElement("th");r.textContent=e,r.style.width="number"==typeof t?`${t}px`:t;const n=this._stat.createdColumns++;return r.addEventListener("click",(()=>this.sortList(n,"ascending"==this._stat.lastSortingMode?"descending":"ascending"))),i.appendChild(r),r}sortList(e,t){const i=[...this.uiComponent.querySelectorAll("tr:not(.header)")];let r;switch(t){case"ascending":case"descending":r="ascending"==t?1:-1,i.sort(((t,i)=>{const n=t.children[e].textContent,o=i.children[e].textContent;return n>o?1*r:n<o?-1*r:0}))}for(let e=0;e<i.length;e++)i[e].parentNode.appendChild(i[e]);this._stat.lastSortingMode=t}pushData(e,t){const i=R.K.mkElement("tr");for(let t of e){const e=document.createElement("td"),r=R.K.mkElement("div",["bbox"]);r.textContent=t,e.appendChild(r),i.appendChild(e)}if(t){const e=R.K.mkElement("div",["icon"]);e.style.backgroundImage=`url(${t})`,i.querySelector("td:first-child").prepend(e)}return this.uiComponent.querySelector("table").appendChild(i),i.addEventListener("click",(()=>{this.select(i)})),i}select(e=0){if(this.deselectAll(),"number"!=typeof e)e.classList.add("selected");else{const t=this.uiComponent.querySelectorAll("tr:not(.header)");if(t.length<1)return;t[e].classList.add("selected")}}getSelectedItem(){return this.uiComponent.querySelector("tr.selected")}getSelectedColumnData(e){const t=this.getSelectedItem();if(t)return null!=t.children[e]?t.children[e].textContent:null}deselectAll(){const e=this.uiComponent.querySelector("table");for(let t of e.children)t.classList.contains("selected")&&t.classList.remove("selected")}clear(){const e=this.uiComponent.querySelector("table");for(;e.firstChild;)e.removeChild(e.firstChild);this._stat.createdColumns=0,this._stat.lastSortingMode=null}}var Jt=i(2177),Gt=i(6471),Xt=i(1124);const Qt={main:r.ek,FS:n.FS,FSUtil:n.FSUtil,FSFeatures:L.f,app:{...ge.c,templates:{WizardBaseApplication:gt.p}},fstype:{IndexedFileSystem:n.IndexedFileSystem,LocalStorageFileSystem:n.LocalStorageFileSystem,RemoteReadOnlyFileSystem:g.O,SharedDriveFileSystem:A,RamFileSystem:f.s,P3FileSystem:n.P3FileSystem,FileSystemBase:n.IFileSystem,ZipReadOnlyFileSystem:n.ZipReadOnlyFileSystem,SysROMFileSystem:n.SysROMFileSystem},WindowSystem:o.C$,WindowParams:o.Lw,StandardWindow:o.DI,ui:{ecss:Tt.U,comp:ce.u,MsgBoxSimple:s.jC,Theme:d.Q,ContextMenu:p.ContextMenu,MessageBox:s._p,MenuBar:K.j,OpenFileDialog:s.MT,SaveFileDialog:s.pp,OperationDialog:s.Vu,showExceptionWindow:s._5,DialogCreator:re.O,animateElement:y.s,DropZone:Xt.r,components:{TabControl:O.a,CSS3dContainer:P,Panel:class extends q{constructor(){super(),this.uiComponent=document.createElement("div"),this.uiComponent.classList.add("w96-panel")}},ListBox:$.w,GroupBox:te.E,TreeView:de,RadioBox:pe.X,CheckBox:Se.J,ToolBar:ze.u,ListView:Vt,GraphStatBox:we,FSView:ft.n,ExplorerAddressBar:_t.p},util:ne.e},WApplication:a.QP,__debug:{processes:a.zF,WinLogon:b.P,ImmersiveDesktopEnvironment:N,SdgfxTest:je},state:{processes:a.zF,procMgr:a.Ue},ktypes:{KConsole:$t.E},sec:{cprovider:qe.$},sys:{wpa:{getLocalKey:pt._M},execFile:ee.l.execFile,execCmd:r.xP.execCmd,rel:l.d,env:c.nP,reboot:r.xP.reboot,reg:{registerApp:(...e)=>((0,Ke.x)("reg_registerApp","registerApp() is deprecated, use w96.app.register() instead."),(0,c.VG)(...e)),appExists:c.K2,getInstalledApps:c.V7,deregisterApp:c.N9,executeApp:c.lw,getFileHandlers:c.rr,getShellAppRegistry:c.FN},loader:u.a,renderBSOD:_.A,wasm:m.K,setKernImage:r.xP.setKernImage,updateNeeded:r.xP.updateRequired,DirMetadataReader:class{constructor(e){3==e.length?this.metaPath=e+".meta":this.metaPath=e+"/.meta",this.properties={background:null,icon:null,description:null,displayName:null,generateThumbnails:!1}}async read(){try{if(r.xP.wmem.eCachedMetadata[this.metaPath])return this.properties=r.xP.wmem.eCachedMetadata[this.metaPath],r.xP.wmem.eCachedMetadata[this.metaPath];const e=await Q.readstr(this.metaPath);return""==e.trim()?r.xP.wmem.eCachedMetadata[this.metaPath]=this.properties:(r.xP.wmem.eCachedMetadata[this.metaPath]=Object.assign(this.properties,JSON.parse(e)),r.xP.wmem.eCachedMetadata[this.metaPath])}catch(e){return this.properties}}static clearCache(){r.xP.wmem.eCachedMetadata={}}},PkMgr:ie.j,BackupManager:he,Service:fe.D,ServiceManager:_e.W,services:r.xP.services,DevProfileManager:Ce.a,biosConfig:Ee.Z,features:ke.o,flags:{has:Ae.yE,set:Ae.mB,clear:Ae.RI,getAll:Ae.zM},wex:He,capi:Be,sam:{readSAM:Le.B1,requiresCredentials:Le.Ml,disableCredentials:Le.Ew,setCredentials:Le.Dj,verifyCredentials:Le.TK},swfsbr:Ne.W,MobileDeviceConfiguration:bt.f,log:r.xP.log,EventLog:Jt.K,kInfo:Gt.v},shell:{mkShortcut:v.mkShortcut,fileQueue:X,Taskbar:V.e,NotifyIcon:ue.K,imde:N},util:{cli:{ProgressBar:class{constructor(e,t,i){this.length=e,this.term=i,this.action=t}setProgress(e,t=""){this.text=t;let i=e/100*this.length,r=Math.floor(i),n=this.length-r;this.term.write(`\r${this.action} [${"-".repeat(r)}${" ".repeat(n)}] ${Math.floor(e)}% ${this.text} `)}stop(e,t=!1){this.setProgress(100,e),t||this.term.write("\n")}},Spinner:class{constructor(e,t){this.action=e,this.term=t,this._int=null,this._count=0}start(){this._go(),this.int=setInterval((()=>this._go()),100)}_go(){this.term.write(`\r${this.action} ${Ve[this._count++%Ve.length]} `)}stop(e=!1){clearInterval(this.int),e||this.term.write("\n")}}},inspect:Je,requestTerminal:Oe.X,isURL:x.PX,isDataURL:x.b2,sideloadZip:h.N,blobToDataURI:se.y,dataURItoBlob:se.O,rand:x.TN,wait:x.Dc,clampNum:x.N5,getMimetypeFromPath:ut.i,getMimetype:ut.D,escapeHtml:w.V.escapeHtml,DomUtils:R.K,argParser:$e.A,sizeFmt:It.p,INI:Kt},net:{P3Connection:ae.d8,p3:null,crossifr:le.f},debug:{perf:xe,...mt},wmem:r.xP.wmem,evt:Z.p,WRT:oe.D,urlopen:e=>r.xP.execCmd("internete",[e]),isRecovery:!1,sysConf:yt.F,toString:()=>"Windows 96\n\nCopyright (C) windows96.net 2022.\n\nYou can view the dev docs at https://devdocs.windows96.net/"};if("undefined"!=typeof window){window.w96=Qt,Object.defineProperty(window,"u96",{get:()=>((0,Ke.x)("u96","Windows96 User APIs have been deprecated. Use the System API instead."),S)}),window.EventEmitter=Y.v,window.alert=re.O.alert;let e={buildId:window.$96.buildId+"",isSigned:!!window.$96.isSigned};"undefined"===e.buildId&&(e.buildId=null),Object.defineProperty(window,"$96",{get:t=>Object.freeze(e),set:e=>console.warn("https://xkcd.com/838/")})}else i.g.K_NJS=1},9275:(e,t,i)=>{"use strict";i.d(t,{v:()=>r});class r{constructor(){this.eventQueue=[]}wait(e){return new Promise((t=>{if(null==e)throw new Error("Event name cannot be null.");this.eventQueue.push({name:e,callback:()=>{console.log("done",e),t()},type:"single"})}))}on(e,t){if(null==e)throw new Error("Event name cannot be null.");this.eventQueue.push({name:e,callback:t,type:"recurring"})}once(e,t){if(null==e)throw new Error("Event name cannot be null.");this.eventQueue.push({name:e,callback:t,type:"single"})}emit(e,...t){if(null==e)throw new Error("Event name cannot be null.");this.eventQueue.forEach(((i,r)=>{if(null==i||i.name!=e)return;const n=i.callback;"single"==i.type&&(this.eventQueue[r]=null);try{n.call(window,...t)}catch(e){console.error("Event error: "+String(e))}}))}remove(e,t){this.eventQueue.forEach(((i,r)=>{null!=i&&i.name==e&&i.callback==t&&(this.eventQueue[r]=null)}))}}},5524:function(e,t){!function(e){"use strict";var t={searchParams:"URLSearchParams"in self,iterable:"Symbol"in self&&"iterator"in Symbol,blob:"FileReader"in self&&"Blob"in self&&function(){try{return new Blob,!0}catch(e){return!1}}(),formData:"FormData"in self,arrayBuffer:"ArrayBuffer"in self};function i(e){return e&&DataView.prototype.isPrototypeOf(e)}if(t.arrayBuffer)var r=["[object Int8Array]","[object Uint8Array]","[object Uint8ClampedArray]","[object Int16Array]","[object Uint16Array]","[object Int32Array]","[object Uint32Array]","[object Float32Array]","[object Float64Array]"],n=ArrayBuffer.isView||function(e){return e&&r.indexOf(Object.prototype.toString.call(e))>-1};function o(e){if("string"!=typeof e&&(e=String(e)),/[^a-z0-9\-#$%&'*+.^_`|~]/i.test(e))throw new TypeError("Invalid character in header field name");return e.toLowerCase()}function s(e){return"string"!=typeof e&&(e=String(e)),e}function a(e){var i={next:function(){var t=e.shift();return{done:void 0===t,value:t}}};return t.iterable&&(i[Symbol.iterator]=function(){return i}),i}function l(e){this.map={},e instanceof l?e.forEach((function(e,t){this.append(t,e)}),this):Array.isArray(e)?e.forEach((function(e){this.append(e[0],e[1])}),this):e&&Object.getOwnPropertyNames(e).forEach((function(t){this.append(t,e[t])}),this)}function c(e){if(e.bodyUsed)return Promise.reject(new TypeError("Already read"));e.bodyUsed=!0}function d(e){return new Promise((function(t,i){e.onload=function(){t(e.result)},e.onerror=function(){i(e.error)}}))}function h(e){var t=new FileReader,i=d(t);return t.readAsArrayBuffer(e),i}function p(e){var t=new FileReader,i=d(t);return t.readAsText(e),i}function u(e){for(var t=new Uint8Array(e),i=new Array(t.length),r=0;r<t.length;r++)i[r]=String.fromCharCode(t[r]);return i.join("")}function f(e){if(e.slice)return e.slice(0);var t=new Uint8Array(e.byteLength);return t.set(new Uint8Array(e)),t.buffer}function _(){return this.bodyUsed=!1,this._initBody=function(e){this._bodyInit=e,e?"string"==typeof e?this._bodyText=e:t.blob&&Blob.prototype.isPrototypeOf(e)?this._bodyBlob=e:t.formData&&FormData.prototype.isPrototypeOf(e)?this._bodyFormData=e:t.searchParams&&URLSearchParams.prototype.isPrototypeOf(e)?this._bodyText=e.toString():t.arrayBuffer&&t.blob&&i(e)?(this._bodyArrayBuffer=f(e.buffer),this._bodyInit=new Blob([this._bodyArrayBuffer])):t.arrayBuffer&&(ArrayBuffer.prototype.isPrototypeOf(e)||n(e))?this._bodyArrayBuffer=f(e):this._bodyText=e=Object.prototype.toString.call(e):this._bodyText="",this.headers.get("content-type")||("string"==typeof e?this.headers.set("content-type","text/plain;charset=UTF-8"):this._bodyBlob&&this._bodyBlob.type?this.headers.set("content-type",this._bodyBlob.type):t.searchParams&&URLSearchParams.prototype.isPrototypeOf(e)&&this.headers.set("content-type","application/x-www-form-urlencoded;charset=UTF-8"))},t.blob&&(this.blob=function(){var e=c(this);if(e)return e;if(this._bodyBlob)return Promise.resolve(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(new Blob([this._bodyArrayBuffer]));if(this._bodyFormData)throw new Error("could not read FormData body as blob");return Promise.resolve(new Blob([this._bodyText]))},this.arrayBuffer=function(){return this._bodyArrayBuffer?c(this)||Promise.resolve(this._bodyArrayBuffer):this.blob().then(h)}),this.text=function(){var e=c(this);if(e)return e;if(this._bodyBlob)return p(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(u(this._bodyArrayBuffer));if(this._bodyFormData)throw new Error("could not read FormData body as text");return Promise.resolve(this._bodyText)},t.formData&&(this.formData=function(){return this.text().then(y)}),this.json=function(){return this.text().then(JSON.parse)},this}l.prototype.append=function(e,t){e=o(e),t=s(t);var i=this.map[e];this.map[e]=i?i+", "+t:t},l.prototype.delete=function(e){delete this.map[o(e)]},l.prototype.get=function(e){return e=o(e),this.has(e)?this.map[e]:null},l.prototype.has=function(e){return this.map.hasOwnProperty(o(e))},l.prototype.set=function(e,t){this.map[o(e)]=s(t)},l.prototype.forEach=function(e,t){for(var i in this.map)this.map.hasOwnProperty(i)&&e.call(t,this.map[i],i,this)},l.prototype.keys=function(){var e=[];return this.forEach((function(t,i){e.push(i)})),a(e)},l.prototype.values=function(){var e=[];return this.forEach((function(t){e.push(t)})),a(e)},l.prototype.entries=function(){var e=[];return this.forEach((function(t,i){e.push([i,t])})),a(e)},t.iterable&&(l.prototype[Symbol.iterator]=l.prototype.entries);var g=["DELETE","GET","HEAD","OPTIONS","POST","PUT"];function m(e){var t=e.toUpperCase();return g.indexOf(t)>-1?t:e}function b(e,t){var i=(t=t||{}).body;if(e instanceof b){if(e.bodyUsed)throw new TypeError("Already read");this.url=e.url,this.credentials=e.credentials,t.headers||(this.headers=new l(e.headers)),this.method=e.method,this.mode=e.mode,this.signal=e.signal,i||null==e._bodyInit||(i=e._bodyInit,e.bodyUsed=!0)}else this.url=String(e);if(this.credentials=t.credentials||this.credentials||"same-origin",!t.headers&&this.headers||(this.headers=new l(t.headers)),this.method=m(t.method||this.method||"GET"),this.mode=t.mode||this.mode||null,this.signal=t.signal||this.signal,this.referrer=null,("GET"===this.method||"HEAD"===this.method)&&i)throw new TypeError("Body not allowed for GET or HEAD requests");this._initBody(i)}function y(e){var t=new FormData;return e.trim().split("&").forEach((function(e){if(e){var i=e.split("="),r=i.shift().replace(/\+/g," "),n=i.join("=").replace(/\+/g," ");t.append(decodeURIComponent(r),decodeURIComponent(n))}})),t}function v(e){var t=new l;return e.replace(/\r?\n[\t ]+/g," ").split(/\r?\n/).forEach((function(e){var i=e.split(":"),r=i.shift().trim();if(r){var n=i.join(":").trim();t.append(r,n)}})),t}function w(e,t){t||(t={}),this.type="default",this.status=void 0===t.status?200:t.status,this.ok=this.status>=200&&this.status<300,this.statusText="statusText"in t?t.statusText:"OK",this.headers=new l(t.headers),this.url=t.url||"",this._initBody(e)}b.prototype.clone=function(){return new b(this,{body:this._bodyInit})},_.call(b.prototype),_.call(w.prototype),w.prototype.clone=function(){return new w(this._bodyInit,{status:this.status,statusText:this.statusText,headers:new l(this.headers),url:this.url})},w.error=function(){var e=new w(null,{status:0,statusText:""});return e.type="error",e};var x=[301,302,303,307,308];w.redirect=function(e,t){if(-1===x.indexOf(t))throw new RangeError("Invalid status code");return new w(null,{status:t,headers:{location:e}})},e.DOMException=self.DOMException;try{new e.DOMException}catch(t){e.DOMException=function(e,t){this.message=e,this.name=t;var i=Error(e);this.stack=i.stack},e.DOMException.prototype=Object.create(Error.prototype),e.DOMException.prototype.constructor=e.DOMException}function C(i,r){return new Promise((function(n,o){var s=new b(i,r);if(s.signal&&s.signal.aborted)return o(new e.DOMException("Aborted","AbortError"));var a=new XMLHttpRequest;function l(){a.abort()}a.onload=function(){var e={status:a.status,statusText:a.statusText,headers:v(a.getAllResponseHeaders()||"")};e.url="responseURL"in a?a.responseURL:e.headers.get("X-Request-URL");var t="response"in a?a.response:a.responseText;n(new w(t,e))},a.onerror=function(){o(new TypeError("Network request failed"))},a.ontimeout=function(){o(new TypeError("Network request failed"))},a.onabort=function(){o(new e.DOMException("Aborted","AbortError"))},a.open(s.method,s.url,!0),"include"===s.credentials?a.withCredentials=!0:"omit"===s.credentials&&(a.withCredentials=!1),"responseType"in a&&t.blob&&(a.responseType="blob"),s.headers.forEach((function(e,t){a.setRequestHeader(t,e)})),s.signal&&(s.signal.addEventListener("abort",l),a.onreadystatechange=function(){4===a.readyState&&s.signal.removeEventListener("abort",l)}),a.send(void 0===s._bodyInit?null:s._bodyInit)}))}C.polyfill=!0,self.fetch||(self.fetch=C,self.Headers=l,self.Request=b,self.Response=w),e.Headers=l,e.Request=b,e.Response=w,e.fetch=C,Object.defineProperty(e,"__esModule",{value:!0})}(t),"remove"in Element.prototype||(Element.prototype.remove=function(){this.parentNode&&this.parentNode.removeChild(this)}),[Element.prototype,Document.prototype,DocumentFragment.prototype].forEach((function(e){e.hasOwnProperty("prepend")||Object.defineProperty(e,"prepend",{configurable:!0,enumerable:!0,writable:!0,value:function(){var e=Array.prototype.slice.call(arguments),t=document.createDocumentFragment();e.forEach((function(e){var i=e instanceof Node;t.appendChild(i?e:document.createTextNode(String(e)))})),this.insertBefore(t,this.firstChild)}})})),NodeList.prototype.forEach=NodeList.prototype.forEach||function(e){const t=[];for(var i=0;i<this.length;i++)t.push(this[i]);var r;r=this,t.forEach((function(t,i,n){e(t,i,r)}))},"srcElement"in MouseEvent.prototype||MouseEvent.prototype.__defineGetter__("srcElement",(function(){return this.target})),Object.defineProperty(Array.prototype,"aFilter",{value:function(e){return Promise.all(this.map(e)).then((e=>this.filter(((t,i)=>e[i]))))}}),Object.defineProperty(Array.prototype,"aForEach",{value:async function(e){for(let t=0;t<this.length;t++)await e(this[t],t,this)}}),window.w96bld?w96bld.poly=!0:window.w96bld={poly:!0},window.process||(window.process={platform:"linux",env:{TERM:"xterm"}}),String.prototype.replaceAt=function(e,t){return this.substr(0,e)+t+this.substr(e+t.length)},String.prototype.replaceAll||(String.prototype.replaceAll=function(e,t){return"[object regexp]"===Object.prototype.toString.call(e).toLowerCase()?this.replace(e,t):this.replace(new RegExp(e,"g"),t)})},7390:(e,t,i)=>{"use strict";i.d(t,{h:()=>l});var r=i(6167),n=i(6227),o=(i(1638),i(1936));let s={},a={};const l={initialize:async function(){if(console.log("Starting Windows 96 AntiVirus service..."),await n.FS.exists("c:/system/av")||await n.FS.mkdir("c:/system/av"),await n.FS.exists("c:/system/av/defs.json"))s=JSON.parse(await n.FS.readstr("c:/system/av/defs.json"));else try{console.log("Downloading latest virus definitions...");const e=await fetch("https://etc.windows96.net/notron/virdefs.json",{cache:"no-cache"}),t=await e.text();s=JSON.parse(t),await n.FS.writestr("c:/system/av/defs.json",t)}catch(e){console.error(e),console.error("Unable to download virus definitions. Please check your internet connection.")}window.__f=o.p,r.p.fs.on("rm",(e=>{a[e.path]&&(a[e.path]=null)}))},getVirDefs:()=>s}},1936:(e,t,i)=>{"use strict";i.d(t,{p:()=>o});var r=i(1638);async function n(e){let t="";return t=e.replace(/((["'])(?:\\[\s\S]|.)*?\2|\/(?![*\/])(?:\\.|\[(?:\\.|.)\]|.)*?\/)|\/\/.*?$|\/\*[\s\S]*?\*\//gm,""),t=t.replace(/^(?:[\t ]*(?:\r?\n|\r))+/gim,""),t}const o={formatScript:n,formatAndHash:async function(e){return r.$.simpleDigest(await n(e))}}},1349:(e,t,i)=>{"use strict";i.r(t),i.d(t,{EncryptionWizardApplication:()=>c});var r=i(7612),n=i(1638),o=i(6227),s=i(3516),a=i(5516),l=i(5690);class c extends s.p{constructor(){super()}async main(e){await super.main(e);const t=this.findPage("intro");t.titleText="Welcome to the Disk Encryption Wizard",t.graphic="/system/resource/app/ecfs/wizard-main.png",t.body="This wizard will help you encrypt your root filesystem, requiring a password on startup.<br><br>It is different to the User Password option, in that your actual files are not readable without your password.<br><br>If you forget your password, the only option is to reinstall.<br><br>You should NOT power off your computer in the process.",t.buttons[1].onclick=()=>this.openPage("1"===localStorage.getItem("encr-bkp-done")?"pw":"bkp-select",[]),this.pages.push({id:"noidb",type:"intro",body:"The wizard cannot start as IndexedDB is missing from your browser.",graphic:"/system/resource/app/ecfs/wizard-main.png",titleText:"Wizard Interrupted",buttons:[{class:"back",onclick:()=>{},enabled:!1,text:"Back"},{class:"finish",onclick:()=>{this.terminate()},enabled:!0,text:"Finish"},{class:"cancel",onclick:()=>this.quit(),enabled:!1,text:"Cancel"}],onopen:(e,t)=>{e.querySelector(".explain").innerText="Click Finish to close the wizard."}}),this.pages.push({id:"nocrypto",type:"intro",body:"The wizard cannot start as the Crypto API is unavailable or missing from your browser.",graphic:"/system/resource/app/ecfs/wizard-main.png",titleText:"Wizard Interrupted",buttons:[{class:"back",onclick:()=>{},enabled:!1,text:"Back"},{class:"finish",onclick:()=>{this.terminate()},enabled:!0,text:"Finish"},{class:"cancel",onclick:()=>this.quit(),enabled:!1,text:"Cancel"}],onopen:(e,t)=>{e.querySelector(".explain").innerText="Click Finish to close the wizard."}}),this.pages.push({id:"bkp-select",type:"page",body:'The system will encrypt your files, which is not reversible without the password.<br>\n            <br>Should you lose the encryption password to your filesystem, your data cannot be recovered.<br>\n            <br>You may wish to <a href="#" style="color:#00f">make a backup of your data</a> in case this occurs.',graphic:"/system/resource/app/ecfs/wizard-top.png",titleText:"Would you like to backup your data first?",description:"It's strongly recommended to backup first before continuing.",buttons:[{class:"back",onclick:()=>this.openPage("intro",[]),enabled:!0,text:"Back"},{class:"next",onclick:()=>{this.openPage("pw")},enabled:!0,text:"Next"},{class:"cancel",onclick:()=>this.quit(),enabled:!0,text:"Cancel"}],onopen:(e,t)=>{e.querySelector("a").onclick=e=>{e.preventDefault(),a.xP.execCmd("backupmgr",["--no-restore"])}}});let i=null,n=null;this.pages.push({id:"pw",type:"page",body:'Please select a password to be used for the encryption.<br><br>\n            <span class="bold-noaa">DO NOT FORGET THIS PASSWORD</span>.<br><br><nt>Your files cannot be recovered without it, unless you have backed up your data.<br><br><br>\n            <input type="password" class="encrwiz-pwb w96-textbox" style="width: 100%" placeholder="Don\'t use a weak password"></input>',graphic:"/system/resource/app/ecfs/wizard-top.png",titleText:"Password selection",description:"Select your password here.",buttons:[{class:"back",onclick:()=>this.openPage("1"===localStorage.getItem("encr-bkp-done")?"intro":"bkp-select",[]),enabled:!0,text:"Back"},{class:"next",onclick:()=>{let e=i.value;if(0!==e.length)if(e.length<8){l.O.alert("Password must be 8 characters long.",{icon:"error"}).wnd.wndObject.querySelector("button").focus()}else n=e,this.openPage("begin")},enabled:!0,text:"Next"},{class:"cancel",onclick:()=>this.quit(),enabled:!0,text:"Cancel"}],onopen:(e,t)=>{i=e.querySelector(".encrwiz-pwb"),i.focus(),i.value=n,i.onkeydown=t=>{"Enter"==t.code&&(t.preventDefault(),e.querySelector(".next").click())}}}),this.pages.push({id:"begin",type:"page",body:"The system will now begin to encrypt your filesystem.<br>This process cannot currently be undone.<br><br>Every time you start up Windows 96, you will be asked for the password to decrypt your disk.\n            <br><br>Some notes:<ul>\n                <li>Please make sure to close any other Windows 96 tabs.</li>\n                <li>Unsaved data will be lost.</li>\n                <li>Make <b>sure</b> you remember your password.</li>\n                <li>This is the point of no return.</li>\n            </ul><br><br>Click Next to begin.",graphic:"/system/resource/app/ecfs/wizard-top.png",titleText:"Start the encryption",description:"Read these notes before starting.",buttons:[{class:"back",onclick:()=>this.openPage("pw"),enabled:!0,text:"Back"},{class:"next",onclick:()=>{this.openPage("encrypt")},enabled:!0,text:"Next"},{class:"cancel",onclick:()=>this.quit(),enabled:!0,text:"Cancel"}],onopen:(e,t)=>{}}),this.pages.push({id:"encrypt",type:"page",body:'\n                <div>\n                    Encrypting your files, this will take some time...<br>\n                    <br>\n                    Status: <span class="status">Preparing...</span><br>\n                    Current File: <span class="current-file">(None)</span>\n                    <div class="w96-progressbar" style="margin-top: 16px;">\n                        <div class="progress" style="width: 0%; animation: none;"></div>\n                    </div>\n                    <div class="stats" style="margin-top: 16px;">\n                        Files encrypted: <span class="stat-inf">0</span>\n                    </div>\n                </div>\n            ',graphic:"/system/resource/app/ecfs/wizard-top.png",titleText:"Encrypting your disk",description:"Do NOT restart or turn off your computer.",buttons:[{class:"back",onclick:()=>this.openPage("scan-select",[]),enabled:!1,text:"Back"},{class:"finish",onclick:()=>{},enabled:!1,text:"Finish"},{class:"cancel",onclick:()=>this.quit(),enabled:!1,text:"Cancel"}],onopen:(e,t)=>{setTimeout((()=>this.encryptDisk(n,e)),500)}}),this.pages.push({id:"finish",type:"intro",body:"The encryption has concluded. You may now restart your computer.",graphic:"/system/resource/app/ecfs/wizard-main.png",titleText:"Encryption Complete",buttons:[{class:"back",onclick:()=>{},enabled:!1,text:"Back"},{class:"finish",onclick:()=>{this.terminate()},enabled:!0,text:"Finish"},{class:"cancel",onclick:()=>this.quit(),enabled:!1,text:"Cancel"}],onopen:(e,t)=>{e.querySelector(".explain").innerText="Click Finish to close the wizard."}}),this.openPage(window.indexedDB?window.crypto&&window.crypto.subtle?"intro":"nocrypto":"noidb",[]),this.mainwnd.setTitle("ECFS Wizard"),this.mainwnd.setWindowIcon(await r.Q.getIconUrl("devices/hdd-encrypted","16x16")),this.mainwnd.setControlBoxStyle("WS_CBX_NONE"),this.mainwnd.center(),this.mainwnd.onclose=this.ontermination}async encryptDisk(e,t){const i=t.querySelector(".status"),r=t.querySelector(".current-file"),s=t.querySelector(".w96-progressbar>.progress"),a=t.querySelector(".stat-inf");i.textContent="Generating key...";let l=new o.EncryptedFileSystem("c:",e),c=n.$.getRandomData(16);localStorageDB.removeItem("$encSALT"+l.prefix.toLowerCase()),localStorageDB.removeItem("$encTEST"+l.prefix.toLowerCase()),localStorageDB.removeItem("$enc$_FileTable_"+l.prefix.toLowerCase()),localStorageDB.setItem("$encSALT"+l.prefix.toLowerCase(),c),await l._getKey(),await l._setItem("TEST"+l.prefix.toLowerCase(),"$EncryptionTest1"+l.prefix.toLowerCase()),l.prefix="C:",await o.FS.mount(l,"Y:"),i.textContent="Encrypting...";let d=await o.FS.walk("x:/"),h=0;for(let e of d)try{h++,s.style.width=100*h/d.length+"%",r.textContent=e;let t=e.replace("X:/","Y:/");if(!await o.FS.isFile(e)){await o.FS.mkdir(t);continue}await o.FS.writebin(t,await o.FS.readbin(e)),await o.FS.rm(e),a.textContent=h}catch(t){console.error("Error encrypting file "+e),console.error(t)}i.textContent="Cleaning...",h=0;for(let e of d)try{h++,s.style.width=100*h/d.length+"%",r.textContent=e,await o.FS.exists(e)&&!await o.FS.isFile(e)&&await o.FS.rmdir(e)}catch(t){console.error("Error cleaning dir "+e),console.error(t)}localStorage.setItem("encr-stage",2),this.openPage("finish",[])}ontermination(){"1"===localStorage.getItem("encr-stage")&&localStorage.removeItem("encr-stage"),a.xP.reboot()}}},1638:(e,t,i)=>{"use strict";i.d(t,{$:()=>n});function r(e){return crypto.getRandomValues(new Uint8Array(e))}const n={simpleDigest:async function(e,t="SHA-256"){const i=(new TextEncoder).encode(e);return await crypto.subtle.digest(t,i)},buffer2hex:function(e){return[...new Uint8Array(e)].map((e=>e.toString(16).padStart(2,"0"))).join("")},getRandomData:r,passwordToKM:async function(e){let t=new TextEncoder;return await crypto.subtle.importKey("raw",t.encode(e),"PBKDF2",!1,["deriveBits","deriveKey"])},deriveFromKM:async function(e,t){return await crypto.subtle.deriveKey({name:"PBKDF2",salt:t,iterations:31e4,hash:"SHA-512"},e,{name:"AES-GCM",length:256},!0,["encrypt","decrypt"])},encrypt:async function(e,t){let i="string"==typeof t,n="object"==typeof t&&!(t instanceof Blob);if(i){t=(new TextEncoder).encode(t)}else if(n){t=(new TextEncoder).encode(JSON.stringify(t))}t instanceof Blob&&(t=await t.arrayBuffer());let o=r(12);return{data:await crypto.subtle.encrypt({name:"AES-GCM",iv:o},e,t),iv:o,isStr:i,isJSON:n}},decrypt:async function(e,t){let i=await crypto.subtle.decrypt({name:"AES-GCM",iv:t.iv},e,t.data);if(t.isStr){i=(new TextDecoder).decode(i)}else if(t.isJSON){let e=new TextDecoder;i=JSON.parse(e.decode(i))}else i=new Blob([new Uint8Array(i)]);return i}}},254:(e,t,i)=>{"use strict";i.d(t,{l:()=>d});var r=i(7362),n=i(6227),o=i(5516),s=i(9338),a=i(120),l=i(1602),c=i(7612);class d{static async tryExecFile(e){try{return await this.execFile(e)}catch(e){(0,s._5)(e)}}static async execFile(e,t={}){let i;if(i=await n.FS.isFile(e),e.endsWith(".link")&&i){const i=await n.FS.readstr(e),r=JSON.parse(i);if(await n.FS.exists(r.action))return await d.execFile(r.action,t);const s=a.A.parse(r.action),l=s[0];return s.shift(),await o.xP.execCmd(l,s,t)}if(!i)return await o.xP.execCmd("explorer",[e],t);{let i=await n.FS.readStrChunk(e,0,256);if(!(null!=i&&i.startsWith("//!wrt"))){var s=(0,r.rr)(e);if(s.length<1)return await o.xP.execCmd("openwith",[e]);var h=s[0];return await o.xP.execCmd(h,[e])}{let r=e.split("/"),n=r.pop();r=r.join("/");let s=null,a=null;if(i.includes("$BSPEC:")){const e=i.indexOf("\n"),t=i.substring(i.indexOf("$BSPEC:"),-1==e?void 0:e);try{s=JSON.parse(t.substring(7))}catch(e){console.error(e)}}if(s&&s.ssy&&"cli"===s.ssy&&null==t.term){let t=s.icn?s.icn:"mime/executable";a=await(0,l.X)(e,await c.Q.getIconUrl(t,"16x16"))}if(!a)return await o.xP.execCmd(n,[],t,[r]);try{await o.xP.execCmd(n,[],{...t,term:a.terminal},[r]);a.stopHost()}catch(e){throw a.stopHost(),e}}}}}},8423:(e,t,i)=>{"use strict";i.d(t,{e:()=>a});i(1350),i(7612);var r=null,n=null,o=null;function s(e,t=!1){var i=document.querySelector("#"+e+"_appbar");if(null!=i){var r=i.associatedWindow;if((r.wndObject.classList.contains("active")||r.minimized)&&t&&!r.uiUpdating&&r.toggleMinimize(),r.appbarRegistered){for(var o in Object.keys(n.children)){var s=n.children[o];null!=s&&s.classList.remove("taskbar-task_active")}i.classList.add("taskbar-task_active")}}else{if(!n)return;for(let e of n.children)e&&e.classList.contains("taskbar-task_active")&&e.classList.remove("taskbar-task_active")}}const a={assign:function(e){null==r&&(n=(r=e).querySelector(".taskbar-tasks"),o=r.querySelector(".taskbar-notify"))},createWindowAppBar:function(e){var t=e.id,i=e.windowIcon,r=document.createElement("button"),o=document.createElement("div");o.id=t+"_appbar_icon",o.classList.add("taskbar-task-icon"),(null==i||useIcon)&&(i="system/resource/icons/win96/16x16/mime/executable.png"),o.style.background="url("+i+")",r.appendChild(o);var a=document.createElement("div");a.classList.add("taskbar-task-text"),a.innerText=e.title,a.id=t+"_appbar_text",r.appendChild(a),r.classList.add("taskbar-task"),r.setAttribute("id",t+"_appbar"),r.associatedWindow=e,r.onclick=function(){s(e.id,!0),e.activate()},r.oncontextmenu=function(t){e.showTitlebarMenu({x:t.x,y:t.y-65})},n&&n.appendChild(r)},activateAppBar:s,deactivateAppBar:function(e){var t=document.getElementById(e+"_appbar");null!=t&&t.classList.remove("taskbar-task_active")},destroyAppBar:function(e){var t=document.getElementById(e+"_appbar");null!=t&&n.removeChild(t)},registerNotifyIcon:function(e){null!=e&&o&&o.prepend(e.notifyEl)},setVisibility:function(e=!0){r.style.display=e?"":"none"}}},1865:(e,t,i)=>{"use strict";i(7460),i(5516);var r=i(5624);r.Z},5624:(e,t,i)=>{"use strict";i.d(t,{Z:()=>o});const r={boot_entries:{}};function n(e){e&&localStorage.setItem(JSON.stringify({...r,...e}))}const o={defaultRom:r,get:function(){return{...r,...JSON.parse(localStorage.getItem("rom"))}},loadDefaults:function(){n(r)},save:n,has:function(){return localStorage.getItem("rom")}}},8313:(e,t,i)=>{"use strict";function r(e,t){t?function(e){const t=document.createElement("div");t.style.height="100vh",t.style.width="100vw",t.style.zIndex="3",t.style.pointerEvents="none",t.style.position="absolute",t.style.top="0px",t.style.left="0px",t.style.display="flex",t.style.flexDirection="column",e.style["background-image"]="url(system/resource/boot/logo_no_text.png)";const i=document.createElement("div");i.style.position="absolute",i.style.bottom="0",i.style.left="0",i.style.width="100%",i.style.height="8px",i.style.marginLeft="auto",i.style.marginRight="auto",i.style.marginBottom="auto",i.style.background="rgba(100, 180, 255, .2)",i.style.boxSizing="border-box";const r=document.createElement("div");r.classList.add("progress-indicator"),i.appendChild(r),t.appendChild(i),e.appendChild(t)}(e):function(e){const t=document.createElement("div");t.style.height="100vh",t.style.width="100vw",t.style.zIndex="3",t.style.pointerEvents="none",t.style.opacity="0.8",t.style.position="absolute",t.style.top="0px",t.style.left="0px",t.style.display="flex",t.style.flexDirection="column";const i=document.createElement("div");i.style.backgroundImage="url(system/resource/boot/logo.png)",i.style.height="256px",i.style.width="256px",i.style.marginTop="auto",i.style.marginLeft="auto",i.style.marginRight="auto",i.classList.add("boot-logo"),t.appendChild(i);const r=document.createElement("div");r.style.width="256px",r.style.height="18px",r.style.marginLeft="auto",r.style.marginRight="auto",r.style.marginBottom="auto",r.style.background="rgb(192,192,192)",r.style.boxSizing="border-box",r.style.padding="1px";const n=document.createElement("div");n.style.width="0%",n.classList.add("progress-indicator"),n.style.height="100%",n.style.background="var(--select-color-primary)",r.appendChild(n),t.appendChild(r),e.appendChild(t)}(e)}function n(e){document.querySelector(".progress-indicator").style.width=`${e}%`}function o(e){document.querySelector("#convga").style.backgroundImage=`url(${e})`}i.d(t,{H6:()=>n,U6:()=>r,lE:()=>o})},119:(e,t,i)=>{"use strict";i(2320),i(2617),i(292),i(722);var r=i(3080);i(8223);r.$`{cyan [Sys36 Rescue]# }`},4101:(e,t,i)=>{"use strict";i.d(t,{F:()=>_});var r=i(4186),n=i(1350),o=i(6227),s=i(5516);const a={roots:{},indexes:[],scmVer:1};let l=null;function c(e,t=""){a.indexes.push({name:e,id:`DAT${a.indexes.length}`,description:t,pseudo:!1}),a.roots[e]={quota:{maxSize:1048576},data:{}}}async function d(){await o.FS.exists(l)||await o.FS.mkdir(l),await o.FS.writestr(l+"/index",JSON.stringify({ver:a.scmVer,indexes:a.indexes}));for(let e of a.indexes)e.pseudo||await o.FS.writestr(`${l}/${e.id}`,JSON.stringify(a.roots[e.name]));s.xP.log.log("Full SCM commit to disk","SCM","info")}function h(e,t){if(!e)return;const i="string"==typeof t?t.split("/"):t,r=e[i.shift()];return i.length>0?h(r,t):r}function p(e,t){const i=e.split("/"),r=i.shift();if(!a.roots[r])return null;let n=a.roots[r].data;for(let e=0;e<i.length;e++){const r=i[e];if(e>=i.length-1){n[r]=t;break}n[r]||(n[r]={}),n=n[r]}}function u(e){const t=e.split("/"),i=t.shift();if(0==t.length)return!1;if(!a.roots[i])return!1;let r=a.roots[i].data,n={},o=0;for(let e of t)void 0!==r[e]&&(o++,n=r,r=r[e]);return t.length==o&&Reflect.deleteProperty(n,t[t.length-1])}async function f(e){const t=a.indexes.find((t=>t.name==e&&!t.pseudo));t&&await o.FS.writestr(`${l}/${t.id}`,JSON.stringify(a.roots[t.name]))}const _={loadAll:async function(e="C:/system/config/SCM"){if(e&&(l=e),s.xP.log.log("SCM Load from "+l,"SCM","info"),!await o.FS.exists(l+"/index"))return c("System","System settings.\n\nIt is recommended to leave this alone."),c("Software","Software specific settings.\n\nYou can modify your favorite program settings here."),c("Security","Security settings. Modifying anything here may affect the overall security of your system."),c("Device","Device specific settings.\n\nIt is recommended to leave this alone."),void await d();const t=JSON.parse(await o.FS.readstr(l+"/index"));a.scmVer=t.ver,a.indexes=t.indexes;for(let e of a.indexes)a.roots[e.name]=JSON.parse(await o.FS.readstr(`${l}/${e.id}`));c("$Pseudo","Pseudo root containing current instance information.\n\nDo NOT make any modifications unless you know what you're doing."),a.indexes.find((e=>"$Pseudo"==e.name)).pseudo=!0,a.roots.$Pseudo.data={API:{w96},DOM:{document,window,body:document.body.children,get elements(){return document.querySelectorAll("*")},cookie:document.cookie,get url(){return window.location.href}},SCM:{configurationState:a,..._},FS:o.FS.mounts(),WM:n.C$,wMem:s.xP.wmem,get Proc(){return r.zF},get rand(){return Math.floor(Math.random()*Number.MAX_SAFE_INTEGER)},get utime(){return(new Date).getTime()}}},createRoot:c,syncAll:d,syncRoot:f,getIndex:function(e){return a.indexes.find((t=>t.name==e))},get:function(e){const t=e.split("/"),i=t.shift();return a.roots[i]?0==t.length?a.roots[i].data:h(a.roots[i].data,t):null},set:p,setAndSync:async function(e,t){p(e,t),await f(e.split("/")[0])},remove:u,removeAndSync:async function(e){let t=u(e);return await f(e.split("/")[0]),t},ls:function(e){const t=o.FSUtil.fixPath(e),i=[];if(""==t){for(let e of a.indexes)i.push({type:"root",name:e.name});return i}const r=t.split("/"),n=r[0];if(!a.roots[n])throw new Error(`The root name '${n}' does not exist.`);r.shift();const s=0==r.length?a.roots[n].data:h(a.roots[n].data,r);if("object"!=typeof s&&("function"!=typeof(l=s)||!/^\s*class\s+/.test(l.toString())))return[];var l;const c=Reflect.ownKeys(s);for(let e of c)i.push({type:"object"==typeof s[e]&&null!==s[e]?"key":"value",name:e});return i},scmPath:l}},66:(e,t,i)=>{"use strict";i.d(t,{q:()=>p});var r=i(5690),n=i(4871),o=i(7612),s=i(8423);let a,l=!1,c="unknown";function d(e){c!=e&&(a.notifyEl.classList.forEach((e=>{e.startsWith("icn-")&&a.notifyEl.classList.remove(e)})),a.notifyEl.classList.add(`icn-${e}`),c=e)}function h(e){e.level<=.1?(l||(r.O.create({title:"System",body:"Your battery is critically low (10%). You may want to save any unsaved work.",icon:"error"}),l=!0),d("critical")):e.level>.1&&e.level<.2?d("low"):e.level>.2&&e.level<.55?d("half"):e.level>.55&&d("full"),e.level>.1&&(l=!1)}const p={begin:async function(){const e=await navigator.getBattery();a=new n.K({iconUrl:await o.Q.getIconUrl("small/exec"),onclick:()=>async function(e){r.O.create({title:"Battery Information",icon:"info",body:`Current Level: ${(100*e.level).toFixed(0)}%`}).body().classList.add("notify-battery-dlg","icn-"+c)}(e)}),a.hide(),a.notifyEl.classList.add("notify-battery"),s.e.registerNotifyIcon(a),e&&(e.charging||a.show(),e.addEventListener("chargingchange",(()=>{e.charging?a.hide():a.show()})),e.addEventListener("levelchange",(()=>h(e))),h(e))}}},4078:(e,t,i)=>{"use strict";i.d(t,{f:()=>o});var r=i(8223);function n(){return"true"==localStorage.getItem("mobile-mode")}const o={isMobileModeEnabled:n,applyPatches:async function(){n()&&(await r.a.loadStyleAsync("/system/resource/stylesheets/mobile.css"),document.body.classList.add("s36-mobile"))},getDeviceType:function(){return localStorage.getItem("mobile-mode-devtype")}}},9807:(e,t,i)=>{"use strict";i.d(t,{a:()=>s});var r=i(6227);const n={preferences:{single_click:!1}};let o={...n};const s={getProfile:()=>o,loadProfile:async function(e){try{const t=JSON.parse(await r.FS.readstr(e));o={...n,...t}}catch(e){console.error(e)}}}},6167:(e,t,i)=>{"use strict";i.d(t,{p:()=>n});var r=i(9275);const n={fs:new r.v,sys:new r.v,wm:new r.v,ui:new r.v,shell:new r.v}},6226:(e,t,i)=>{"use strict";let r;i.d(t,{RI:()=>s,mB:()=>o,yE:()=>n,zM:()=>a});try{r=null!=localStorage["system-flags"]?JSON.parse(localStorage.getItem("system-flags")):[]||0}catch(e){r=[],console.error("Flags API:",e)}function n(e){return r.includes(e)}function o(e,t){n(e)?r=r.filter((t=>t!==e)):r.push(e),l()}function s(){r=[],l()}function a(){return r}function l(){localStorage["system-flags"]=JSON.stringify(r)}},7619:(e,t,i)=>{"use strict";i.d(t,{H:()=>r,J:()=>n});const r={EPERM:{id:1,message:"Operation not permitted"},ENOENT:{id:2,message:"No such file or directory"},ESRCH:{id:3,message:"No such process"},EINTR:{id:4,message:"Interrupted system call"},EIO:{id:5,message:"I/O error"},ENXIO:{id:6,message:"No such device or address"},E2BIG:{id:7,message:"Arg list too long"},ENOEXEC:{id:8,message:"Exec format error"},EBADF:{id:9,message:"Bad file number"},ECHILD:{id:10,message:"No child processes"},EAGAIN:{id:11,message:"Try again"},ENOMEM:{id:12,message:"Out of memory"},EACCES:{id:13,message:"Permission denied"},EFAULT:{id:14,message:"Bad address"},ENOTBLK:{id:15,message:"Block device required"},EBUSY:{id:16,message:"Device or resource busy"},EEXIST:{id:17,message:"File exists"},EXDEV:{id:18,message:"Cross-device link"},ENODEV:{id:19,message:"No such device"},ENOTDIR:{id:20,message:"Not a directory"},EISDIR:{id:21,message:"Is a directory"},EINVAL:{id:22,message:"Invalid argument"},ENFILE:{id:23,message:"File table overflow"},EMFILE:{id:24,message:"Too many open files"},ENOTTY:{id:25,message:"Not a typewriter"},ETXTBSY:{id:26,message:"Text file busy"},EFBIG:{id:27,message:"File too large"},ENOSPC:{id:28,message:"No space left on device"},ESPIPE:{id:29,message:"Illegal seek"},EROFS:{id:30,message:"Read-only file system"},EMLINK:{id:31,message:"Too many links"},EPIPE:{id:32,message:"Broken pipe"},EDOM:{id:33,message:"Math argument out of domain of func"},ERANGE:{id:34,message:"Math result not representable"},EDEADLK:{id:35,message:"Resource deadlock would occur"},ENAMETOOLONG:{id:36,message:"File name too long"},ENOLCK:{id:37,message:"No record locks available"},ENOSYS:{id:38,message:"Function not implemented"},ENOTEMPTY:{id:39,message:"Directory not empty"},ELOOP:{id:40,message:"Too many symbolic links encountered"},EWOULDBLOCK:{id:41,message:"Operation would block"},ENOMSG:{id:42,message:"No message of desired type"},EIDRM:{id:43,message:"Identifier removed"},ECHRNG:{id:44,message:"Channel number out of range"},EL2NSYNC:{id:45,message:"Level 2 not synchronized"},EL3HLT:{id:46,message:"Level 3 halted"},EL3RST:{id:47,message:"Level 3 reset"},ELNRNG:{id:48,message:"Link number out of range"},EUNATCH:{id:49,message:"Protocol driver not attached"},ENOCSI:{id:50,message:"No CSI structure available"},EL2HLT:{id:51,message:"Level 2 halted"},EBADE:{id:52,message:"Invalid exchange"},EBADR:{id:53,message:"Invalid request descriptor"},EXFULL:{id:54,message:"Exchange full"},ENOANO:{id:55,message:"No anode"},EBADRQC:{id:56,message:"Invalid request code"},EBADSLT:{id:57,message:"Invalid slot"},EDEADLOCK:{id:58,message:"File locking deadlock error"},EBFONT:{id:59,message:"Bad font file format"},ENOSTR:{id:60,message:"Device not a stream"},ENODATA:{id:61,message:"No data available"},ETIME:{id:62,message:"Timer expired"},ENOSR:{id:63,message:"Out of streams resources"},ENONET:{id:64,message:"Machine is not on the network"},ENOPKG:{id:65,message:"Package not installed"},EREMOTE:{id:66,message:"Object is remote"},ENOLINK:{id:67,message:"Link has been severed"},EADV:{id:68,message:"Advertise error"},ESRMNT:{id:69,message:"Srmount error"},ECOMM:{id:70,message:"Communication error on send"},EPROTO:{id:71,message:"Protocol error"},EMULTIHOP:{id:72,message:"Multihop attempted"},EDOTDOT:{id:73,message:"RFS specific error"},EBADMSG:{id:74,message:"Not a data message"},EOVERFLOW:{id:75,message:"Value too large for defined data type"},ENOTUNIQ:{id:76,message:"Name not unique on network"},EBADFD:{id:77,message:"File descriptor in bad state"},EREMCHG:{id:78,message:"Remote address changed"},ELIBACC:{id:79,message:"Can not access a needed shared library"},ELIBBAD:{id:80,message:"Accessing a corrupted shared library"},ELIBSCN:{id:81,message:".lib section in a.out corrupted"},ELIBMAX:{id:82,message:"Attempting to link in too many shared libraries"},ELIBEXEC:{id:83,message:"Cannot exec a shared library directly"},EILSEQ:{id:84,message:"Illegal byte sequence"},ERESTART:{id:85,message:"Interrupted system call should be restarted"},ESTRPIPE:{id:86,message:"Streams pipe error"},EUSERS:{id:87,message:"Too many users"},ENOTSOCK:{id:88,message:"Socket operation on non-socket"},EDESTADDRREQ:{id:89,message:"Destination address required"},EMSGSIZE:{id:90,message:"Message too long"},EPROTOTYPE:{id:91,message:"Protocol wrong type for socket"},ENOPROTOOPT:{id:92,message:"Protocol not available"},EPROTONOSUPPORT:{id:93,message:"Protocol not supported"},ESOCKTNOSUPPORT:{id:94,message:"Socket type not supported"},EOPNOTSUPP:{id:95,message:"Operation not supported on transport endpoint"},EPFNOSUPPORT:{id:96,message:"Protocol family not supported"},EAFNOSUPPORT:{id:97,message:"Address family not supported by protocol"},EADDRINUSE:{id:98,message:"Address already in use"},EADDRNOTAVAIL:{id:99,message:"Cannot assign requested address"},ENETDOWN:{id:100,message:"Network is down"},ENETUNREACH:{id:101,message:"Network is unreachable"},ENETRESET:{id:102,message:"Network dropped connection because of reset"},ECONNABORTED:{id:103,message:"Software caused connection abort"},ECONNRESET:{id:104,message:"Connection reset by peer"},ENOBUFS:{id:105,message:"No buffer space available"},EISCONN:{id:106,message:"Transport endpoint is already connected"},ENOTCONN:{id:107,message:"Transport endpoint is not connected"},ESHUTDOWN:{id:108,message:"Cannot send after transport endpoint shutdown"},ETOOMANYREFS:{id:109,message:"Too many references: cannot splice"},ETIMEDOUT:{id:110,message:"Connection timed out"},ECONNREFUSED:{id:111,message:"Connection refused"},EHOSTDOWN:{id:112,message:"Host is down"},EHOSTUNREACH:{id:113,message:"No route to host"},EALREADY:{id:114,message:"Operation already in progress"},EINPROGRESS:{id:115,message:"Operation now in progress"},ESTALE:{id:116,message:"Stale NFS file handle"},EUCLEAN:{id:117,message:"Structure needs cleaning"},ENOTNAM:{id:118,message:"Not a XENIX named type file"},ENAVAIL:{id:119,message:"No XENIX semaphores available"},EISNAM:{id:120,message:"Is a named type file"},EREMOTEIO:{id:121,message:"Remote I/O error"}};class n extends Error{constructor(e,t){let i="ERRNO";for(let t of Object.keys(r))if(null!=r[t]&&r[t].id==e.id){i=t;break}super(i+" "+t+": "+e.message),this.name="FSErrno",this.errno=e}}},3451:(e,t,i)=>{"use strict";i.d(t,{O:()=>r});class r{constructor(e){this.data=null!=e?e:{}}getItem(e){return this.data[e]?this.data[e]:null}setItem(e,t){this.data[e]=t.toString()}removeItem(e){this.data[e]=null}clear(){this.data={}}}},8279:(e,t,i)=>{"use strict";i.d(t,{f:()=>r});const r={readOnly:"read-only",remote:"remote",hidden:"hidden"}},4799:(e,t,i)=>{"use strict";i.d(t,{N:()=>r});i(5685);class r{constructor(e){if(null==e)throw new Error("Cannot create file system without prefix.");this.remote=!1,this.readOnly=!1,this.prefix=e.toUpperCase(),this.watchId=null,this.volumeLabel="Disk",this.driverName="null",this.features=[]}async init(){}async uninit(){}async isFile(e){}async isEmpty(e){}async mkdir(e){}async rmdir(e){}async touch(e){}async rm(e){}async readdir(e){}async cpdir(e,t){}async cpfile(e,t){}async mvfile(e,t){}async mvdir(e,t){}async exists(e){}async stat(e){}watchFolder(e,t){}updateWatch(e){}async readstr(e){}async readbin(e){}async toURL(e){}async filetype(e){}async writestr(e,t){}async writebin(e,t){}async readBinChunk(e,t,i){}async readStrChunk(e,t,i){}}},6499:(e,t,i)=>{"use strict";i.d(t,{k:()=>l});var r=i(4799),n=i(4876),o=i(7619),s=i(5685);function a(){return Math.floor(Math.random()*Number.MAX_SAFE_INTEGER).toString()}class l extends r.N{constructor(e){super(e),this._fileTable={"/":{length:0,dateAccessed:null,dateModified:null,dateCreated:null,readOnly:!1,type:1,recordId:"_null_"}},this._fsSort=!0,this.driverName="idbfs"}_getItem(e){return new Promise(((t,i)=>{try{localStorageDB.getItem(e,(e=>t(e)))}catch(e){i(e)}}))}_setItem(e,t){return new Promise(((i,r)=>{try{localStorageDB.setItemAsync(e,t,(()=>i()))}catch(e){r(e)}}))}_pushFtableRecord(e,t,i,r){this._fileTable[e]={length:t,type:i,readOnly:r}}_fTableExists(e){return null!=this._fileTable[e]}_pauseSync(){this._syncPaused=!0}_resumeSync(){this._syncPaused=!1}async _sync(){try{if(this._syncPaused)return;for(let e of Object.keys(this._fileTable))null==this._fileTable[e]&&delete this._fileTable[e];await this._setItem("$_FileTable_"+this.prefix.toLowerCase(),this._fileTable)}catch(e){}}async init(){const e=await this._getItem("$_FileTable_"+this.prefix.toLowerCase());null!=e&&(this._fileTable=e)}async uninit(){await this._sync(),this._fileTable=null}async isFile(e){return 0==await this.filetype(e)}async exists(e){return null!=this._fileTable[e]}async filetype(e){return await this.exists(e)?this._fileTable[e].type:-1}async touch(e){const t=n.R.getParentPath(e);if(!await this.exists(t)||await this.isFile(t))throw new o.J(o.H.ENOENT,t);return this._pushFtableRecord(e,0,0,!1),this._fileTable[e].recordId=a(),this.updateWatch(e),this._sync(),!0}async rm(e){if(!await this.exists(e))throw new o.J(o.H.ENOENT,e);if(!await this.isFile(e))throw new o.J(o.H.EISDIR,e);if(this._fileTable[e].readOnly)throw new o.J(o.H.EACCES,e);if(this._fileTable[n.R.getParentPath(e)].readOnly)throw new o.J(o.H.EACCES,n.R.getParentPath(e));return localStorageDB.removeItem((this.enPrefix||"")+this._fileTable[e].recordId),this._fileTable[e]=void 0,this._sync(),!0}async mkdir(e){if(await this.exists(e))return!0;if(null!=this._fileTable[n.R.getParentPath(e)]&&this._fileTable[n.R.getParentPath(e)].readOnly)throw new o.J(o.H.EACCES,n.R.getParentPath(e));try{const t=n.R.resolvePath("/",e).split("/");let i="/";for(let e=0;e<t.length;e++){i+="/"+t[e],i.includes("//")&&(i=i.split("//").join("/")),await this.exists(i)||await this._intmkf(i)}return this._sync(),!0}catch(e){throw e}}async _intmkf(e){return!!await this.exists(n.R.getParentPath(e))&&(!await this.exists(e)&&(this._pushFtableRecord(e,0,1,!1),this.updateWatch(e),!0))}async readdir(e,t){const i=[],r=Object.keys(this._fileTable),n=e;if(!await this.exists(e))throw new o.J(o.H.ENOENT,e);if(await this.isFile(e))throw new o.J(o.H.ENOTDIR,e);const s=n.split("/").length;for(let o in r){const a=r[o];if(a==n)continue;if(null==this._fileTable[a])continue;if("/"!=e){if(!a.startsWith(n+"/"))continue;if(!a.startsWith(n))continue}const l=a.split("/").length;"/"==e&&l>s||(l>s+1||(t?i.push({path:a,filetype:await this.filetype(a)}):i.push(a)))}return this._fsSort?i.sort((function(e,i){return t?e.path.toLowerCase().localeCompare(i.path.toLowerCase()):e.toLowerCase().localeCompare(i.toLowerCase())})):i}async isEmpty(e){if(!await this.exists(e))throw new o.J(o.H.ENOENT,e);if(!await this.isFile(e))throw new o.J(o.H.EISDIR,e);return 0==this._fileTable[e].length}async cpdir(e,t){if(!await this.exists(e))throw new o.J(o.H.ENOENT,e);if(await this.isFile(e))throw new o.J(o.H.ENOTDIR,e);await this.exists(t)||await this.mkdir(t),this._pushFtableRecord(t,0,1,!1);const i=Object.keys(this._fileTable);return await i.aForEach((async i=>{if(null!=this._fileTable[i])if(i.startsWith(e+"/")){const r=i.split(e+"/").join(t+"/");await this.isFile(i)?await this.cpfile(i,r):this._pushFtableRecord(r,0,1,!1)}else;})),this.updateWatch(t),await this._sync(),!0}async mvdir(e,t){if(!await this.exists(e))throw new o.J(o.H.ENOENT,e);if(await this.isFile(e))throw new o.J(o.H.ENOTDIR,e);await this.exists(t)||await this.mkdir(t),this._fileTable[e]=void 0,this._pushFtableRecord(t,0,1,!1);const i=Object.keys(this._fileTable);return await i.aForEach((async i=>{if(null!=this._fileTable[i]&&i.startsWith(e+"/")){const r=i.split(e+"/").join(t+"/");return await this.isFile(i)?(this._pushFtableRecord(r,this._fileTable[i].length,0,!1),this._fileTable[r].recordId=this._fileTable[i].recordId):this._pushFtableRecord(r,0,1,!1),void(this._fileTable[i]=void 0)}})),this.updateWatch(t),await this._sync(),!0}async rmdir(e){if(!await this.exists(e))throw new o.J(o.H.ENOENT,e);if(await this.isFile(e))throw new o.J(o.H.ENOTDIR,e);if("/"==e)throw new o.J(o.H.EINVAL,e);const t=await this.readdir(e);for(let e of t)await this.isFile(e)?await this.rm(e):await this.rmdir(e);return this._fileTable[e]=void 0,await this._sync(),!0}async mvfile(e,t){if(!await this.exists(e))throw new o.J(o.H.ENOENT,e);if(!await this.isFile(e))throw new o.J(o.H.EISDIR,e);if(this._fileTable[e].readOnly)throw new o.J(o.H.EACCES,e);const i=n.R.getParentPath(t);return await this.exists(i)||await this.mkdir(i),this._pushFtableRecord(t,this._fileTable[e].length,0,!1),this._fileTable[t].recordId=this._fileTable[e].recordId,this._fileTable[e]=null,await this._sync(),!0}async cpfile(e,t){if(!await this.exists(e))throw new o.J(o.H.ENOENT,e);if(!await this.isFile(e))throw new o.J(o.H.EISDIR,e);if(null!=this._fileTable[t]&&this._fileTable[t].readOnly)throw new o.J(o.H.EACCES,t);const i=n.R.getParentPath(t);await this.exists(i)||await this.mkdir(i),this._pushFtableRecord(t,this._fileTable[e].length,0,!1),this._fileTable[t].recordId=a();const r=await this._getItem(this._fileTable[e].recordId);return await this._setItem(this._fileTable[t].recordId,new Blob([r],{type:(0,s.i)(t)})),await this._sync(),!0}async readbin(e){if(!await this.exists(e))throw new o.J(o.H.ENOENT,e);if(!await this.isFile(e))throw new o.J(o.H.EISDIR,e);if(this._fileTable[e].length<1)return new Uint8Array(0);const t=await this._getItem(this._fileTable[e].recordId);return new Uint8Array(await new Response(t).arrayBuffer())}async readstr(e){if(!await this.exists(e))throw new o.J(o.H.ENOENT,e);if(!await this.isFile(e))throw new o.J(o.H.EISDIR,e);return this._fileTable[e].length<1?"":(new TextDecoder).decode(await this.readbin(e))}async writebin(e,t){const i=n.R.getParentPath(e);if(!await this.exists(i)||await this.isFile(i))throw new o.J(o.H.ENOENT,i);if(await this.exists(e)){if(!await this.isFile(e))throw new o.J(o.H.EISDIR,e);if(this._fileTable[e].readOnly)throw new o.J(o.H.EACCES,e)}else await this.touch(e);let r=new Uint8Array(0);if(t instanceof Uint8Array)r=t;else if(t instanceof Array){r=new Uint8Array(t.length);let e=0;for(let i of t)"number"==typeof i&&(r[e]=i,e++)}else r=(new TextEncoder).encode(t.toString());return await this._setItem(this._fileTable[e].recordId,new Blob([r],{type:(0,s.i)(e)})),this._fileTable[e].length=r.length,await this._sync(),!0}async writestr(e,t){await this.writebin(e,"string"==typeof t?t:t.toString())}async readBinChunk(e,t,i){if(!await this.exists(e))throw new o.J(o.H.ENOENT,e);if(!await this.isFile(e))throw new o.J(o.H.EISDIR,e);if(this._fileTable[e].length<1)return new Uint8Array(0);const r=await this._getItem(this._fileTable[e].recordId),n=new Uint8Array(await new Response(r).arrayBuffer());return n?n.subarray(t,t+i):new Uint8Array(0)}async readStrChunk(e,t,i){return this._fileTable[e].length<1?"":(new TextDecoder).decode(await this.readBinChunk(e,t,i))}async stat(e){return this._fileTable[e]}async toURL(e){if(!await this.exists(e))throw new o.J(o.H.ENOENT,e);if(!await this.isFile(e))throw new o.J(o.H.EISDIR,e);const t=await this._getItem(this._fileTable[e].recordId);if(!t)throw new o.J(o.H.EINVAL,e);return URL.createObjectURL(t)}}},3513:(e,t,i)=>{"use strict";i.d(t,{b:()=>a});var r=i(4799),n=i(7619),o=i(8279);const s=524288;class a extends r.N{constructor(e,t,i){super(e),this.readOnly=!0,this._socket=i,this.volumeLabel=t,this.driverName="p3fs",this.remote=!0,this.features.push(o.f.readOnly,o.f.remote),this._reqQueue=new Map,this._internalOffset=Math.floor(1e3*Math.random())}async _getItem(e){return null}async init(){}async uninit(){}async isFile(e){return 0==await this.filetype(e)}async exists(e){return await this._invokeFunction("exists",e)}async filetype(e){return await this._invokeFunction("filetype",e)}touch(e){throw new n.J(n.H.EROFS,e)}rm(e){throw new n.J(n.H.EROFS,e)}mkdir(e){throw new n.J(n.H.EROFS,e)}async readdir(e,t){return await this._invokeFunction("readdir",e,t)}async isEmpty(e){return await this._invokeFunction("isEmpty",e)}cpdir(e,t){throw new n.J(n.H.EROFS,t)}mvdir(e,t){throw new n.J(n.H.EROFS,t)}rmdir(e){throw new n.J(n.H.EROFS,e)}mvfile(e,t){throw new n.J(n.H.EROFS,t)}cpfile(e,t){throw new n.J(n.H.EROFS,t)}async readbin(e){let t=(await this.stat(e)).length;if(t<s)return await this._readbin(e);let i=Math.floor(t/s)+1,r=[];for(var o=0;o<i;o++){let e=o+1,i=e*s-s,n=(e*s>t?t:e*s)-i;r[o]=[i,n]}let a=(await Promise.allSettled(r.map((async t=>await this.readBinChunk(e,t[0],t[1]))))).map((t=>{if(t.rejected)throw new n.J(n.H.EIO,e);return t.value}));return this._mergeUint8(a)}async _readbin(e){return await this._invokeFunction("readbin",e)}async readBinChunk(e,t,i){return await this._invokeFunction("readBinChunk",e,t,i)}async readstr(e){return await this._invokeFunction("readstr",e)}async writebin(e){throw new n.J(n.H.EROFS,e)}async writestr(e){throw new n.J(n.H.EROFS,e)}async stat(e){return await this._invokeFunction("stat",e)}async _send(e,t){this._socket.send([e,t])}_mergeUint8(e){let t=0;e.forEach((e=>{t+=e.length}));let i=new Uint8Array(t),r=0;return e.forEach((e=>{i.set(e,r),r+=e.length})),i}_base64ToUint8(e){if(0==e.length)return new Uint8Array(0);for(var t=atob(e),i=t.length,r=new Uint8Array(i),n=0;n<i;n++)r[n]=t.charCodeAt(n);return r}async _invokeFunction(e,...t){let i=await this._invokeRemoteFunction(e,...t);if(i[1])throw"object"==typeof i[2]?new n.J(i[2],i[3]):new n.J(n.H[i[2]],i[3]);return i[0]}_invokeRemoteFunction(e,...t){return new Promise(((i,r)=>{let n=++this._internalOffset;this._reqQueue.set(n,(([e,t])=>{if("RES"===e){let e=t.res;t.isB64&&(e=this._base64ToUint8(e)),i([e])}else"ERR"===e&&i([null,!0,t.errType,t.path]);this._reqQueue.delete(n)})),this._send("FSFN",{type:e,args:t,reqId:n})}))}_onMsg([e,t]){switch(e){case"ERR":case"RES":t.reqId&&this._reqQueue.get(t.reqId)&&this._reqQueue.get(t.reqId)([e,t]);break;default:console.warn("[p3fs] unknown code received by fs")}}_onDisconnect(){w96.FS.umount(this.prefix)}}},1561:(e,t,i)=>{"use strict";i.d(t,{s:()=>n});var r=i(6499);class n extends r.k{constructor(e){super(e),this.driverName="ramfs",this.store={}}_getItem(e){return new Promise(((t,i)=>{try{t(this.store[e])}catch(e){i(e)}}))}async _setItem(e,t){this.store[e]=t}}},5506:(e,t,i)=>{"use strict";i.d(t,{O:()=>s});var r=i(4799),n=i(7619),o=i(8279);class s extends r.N{constructor(e,t){super(e),this.fileTable={"/":{length:0,type:1}},this.readOnly=!0,this.volumeLabel="Disk",this.driverName="rofs",this.remote=!0,this.schemaPath=t;try{this.origin=new URL(this.schemaPath).origin}catch(e){this.origin=location.origin}this.features.push(o.f.readOnly,o.f.remote)}async _getItem(e){return await fetch(this.origin+"/"+e).then((e=>e.arrayBuffer()))}async init(){this.fileTable=await fetch(this.schemaPath).then((e=>e.json()))}async uninit(){this.fileTable=null}isFile(e){return 0==this.filetype(e)}exists(e){return null!=this.fileTable[e]}filetype(e){return this.exists(e)?this.fileTable[e].type:-1}touch(e){throw new n.J(n.H.EROFS,e)}rm(e){throw new n.J(n.H.EROFS,e)}mkdir(e){throw new n.J(n.H.EROFS,e)}readdir(e,t){const i=[],r=Object.keys(this.fileTable),o=e;if(!this.exists(e))throw new n.J(n.H.ENOENT,e);const s=o.split("/").length;for(let n in r){const a=r[n];if(a==o)continue;if(null==this.fileTable[a])continue;if("/"!=e){if(!a.startsWith(o+"/"))continue;if(!a.startsWith(o))continue}const l=a.split("/").length;"/"==e&&l>s||(l>s+1||(t?i.push({path:a,filetype:this.filetype(a)}):i.push(a)))}return this._fsSort?i.sort((function(e,i){return t?e.path.toLowerCase().localeCompare(i.path.toLowerCase()):e.toLowerCase().localeCompare(i.toLowerCase())})):i}isEmpty(e){if(!this.exists(e))throw new n.J(n.H.ENOENT,e);if(!this.isFile(e))throw new n.J(n.H.EISDIR,e);return 0==this.fileTable[e].length}async cpdir(e,t){throw new n.J(n.H.EROFS,t)}async mvdir(e,t){throw new n.J(n.H.EROFS,t)}async rmdir(e){throw new n.J(n.H.EROFS,e)}async mvfile(e,t){throw new n.J(n.H.EROFS,t)}async cpfile(e,t){throw new n.J(n.H.EROFS,t)}async readbin(e){if(!this.exists(e))throw new n.J(n.H.ENOENT,e);if(!this.isFile(e))throw new n.J(n.H.EISDIR,e);return this.fileTable[e].length<1?new Uint8Array(0):await this._getItem(e)}async readstr(e){if(!this.exists(e))throw new n.J(n.H.ENOENT,e);if(!this.isFile(e))throw new n.J(n.H.EISDIR,e);return this.fileTable[e].length<1?"":(new TextDecoder).decode(await this.readbin(e))}async writebin(e){throw new n.J(n.H.EROFS,e)}async writestr(e){throw new n.J(n.H.EROFS,e)}stat(e){return this.fileTable[e]}toURL(e){return this.origin+(this.origin.endsWith("/")?"":"/")+e}}},5685:(e,t,i)=>{"use strict";i.d(t,{D:()=>n,i:()=>o});const r={txt:"text/plain",js:"text/javascript",html:"text/html",htm:"text/html",png:"image/png",jpg:"image/jpeg",jpeg:"image/jpeg",gif:"image/gif",mp4:"video/mp4",webm:"video/webm",exe:"application/octet-stream",zip:"application/zip",css:"text/css",ttf:"font/ttf",woff:"font/woff",woff2:"font/woff2",mp3:"audio/mpeg",svg:"image/svg+xml",wasm:"application/wasm",pdf:"application/pdf"};function n(e){return null!=r[e]?r[e]:"application/octet-stream"}function o(e){return n(e.substring(e.indexOf(".")+1))}},4876:(e,t,i)=>{"use strict";i.d(t,{R:()=>o});var r=i(6227);function n(e,t){var i=e;i.endsWith("/")||(i+="/");var r=i.split("/"),n=t.split("/");r.pop();for(var o=0;o<n.length;o++)"."!=n[o]&&(".."==n[o]?r.pop():r.push(n[o]));return r.join("/")}class o{constructor(){}static getParentPath(e){if("/"==e)return"/";var t=e.split("/"),i=t[t.length-1],r=e.substring(0,e.length-i.length-1);const n=""!=r.trim()?r:"/";return/^([a-zA-Z]:)/.test(n)&&2===n.length?n+"/":n}static fname(e){var t=e.split("/");return t[t.length-1]}static resolvePath(e,t){return/^([a-zA-Z]:)/.test(t)?t:(t.endsWith("/")&&(t=t.substring(0,t.length-1)),""==t||"/"==t?"/":(t.startsWith("/")?t.includes("..")||t.includes("/.")?(i=n(e,t)).includes("//")&&(i=i.split("//").join("/")):i=t:i=n(e,t),""==i&&(i="/"),i));var i}static deconstructFullPath(e){var t=e.trim();/^([a-zA-Z]:)/.test(t)||(t="C:"+t);var i=t.split(/^([a-zA-Z]:)/)[1].toUpperCase();return{prefix:i,path:t.substring(i.length)}}static getExtension(e,t=!0){const i=e.substring(e.lastIndexOf(".")).trim(),r=(i.includes("/")?this.fname(i):i).toLowerCase();return t?r.toLowerCase():r}static async downloadFile(e){!function(e,t){var i=document.createElement("a");document.body.appendChild(i),i.style="display: none";const r=new Blob([e],{type:"octet/stream"}),n=window.URL.createObjectURL(r);i.href=n,i.download=t,i.click(),window.URL.revokeObjectURL(n),i.remove()}(await r.FS.readbin(e),o.fname(e))}static normalizeDriveLetter(e){return e.replaceAt(0,e[0].toUpperCase())}static fixPath(e){let t=e.replace(/(^\/)|(\/$)/gi,"");return t=t.replace(/(\/){2,}/gi,"/"),t}static combinePath(e,...t){const i=[];3==e.length?i.push(e.substring(0,2)):i.push(o.fixPath(e));for(let e of t)i.push(o.fixPath(e));return i.join("/")}}},6227:(e,t,i)=>{"use strict";i.r(t),i.d(t,{EncryptedFileSystem:()=>c,FS:()=>x,FSUtil:()=>h.R,IFileSystem:()=>d.N,IndexedFileSystem:()=>r.k,LocalStorageFileSystem:()=>o,P3FileSystem:()=>a.b,RemoteReadOnlyFileSystem:()=>s.O,SysROMFileSystem:()=>b,ZipReadOnlyFileSystem:()=>g});var r=i(6499),n=i(5905);class o extends r.k{constructor(e){super(e),this.driverName="localfs",this.store=localStorage}_getItem(e){return new Promise((async(t,i)=>{try{const i=this.store.getItem(this.prefix+e);let r;try{r=JSON.parse(i)}catch(e){r=null}if(i||t(null),i.startsWith("data:")){const e=(0,n.O)(i);t(new Uint8Array(await new Response(e).arrayBuffer()))}else t(r)}catch(e){i(e)}}))}async _setItem(e,t){t instanceof Blob?this.store.setItem(this.prefix+e,`${await(0,n.y)(t)}`):this.store.setItem(this.prefix+e,JSON.stringify(t))}}var s=i(5506),a=i(3513),l=i(1638);class c extends r.k{constructor(e,t){super(e),this.driverName="ecfs",this.password=t,this.key=null,this.enPrefix="$enc"}async _encryptData(e){return await l.$.encrypt(this.key,e)}async _decryptData(e){return e?await l.$.decrypt(this.key,e):e}async _getKey(){let e=await new Promise((e=>localStorageDB.getItem("$encSALT"+this.prefix.toLowerCase(),e)));if(!e)throw new Error("Invalid salt found.");this.key=await l.$.deriveFromKM(await l.$.passwordToKM(this.password),e)}async _testEncryption(){try{return await this._getItem("TEST"+this.prefix.toLowerCase())==="$EncryptionTest1"+this.prefix.toLowerCase()}catch(e){return!1}}_getItem(e){return e="$enc"+e,new Promise(((t,i)=>{let r=async e=>{try{t(await this._decryptData(e))}catch(e){i(e)}};try{localStorageDB.getItem(e,r)}catch(e){i(e)}}))}async _setItem(e,t){e="$enc"+e,localStorageDB.setItem(e,await this._encryptData(t))}async init(e=!1){if(!e){if(await this._getKey(),!await this._testEncryption())throw new Error("Invalid encryption key.")}delete this.password;let t=await this._getItem("$_FileTable_"+this.prefix.toLowerCase());null!=t&&(this._fileTable=t)}}var d=i(4799),h=i(4876),p=i(7619),u=i(5685),f=i(8279);function _(e){let t=e;return t.startsWith("/")&&(t=t.substring(1)),t.endsWith("/")&&(t=t.substring(0,t.length-1)),t}class g extends d.N{constructor(e,t){if(super(e),!t)throw new p.J(p.H.EINVAL,e);this.archive=null,this.archiveData=t,this.readOnly=!0,this.volumeLabel="ZIPFS",this.driverName="zipfs-ro",this.remote=!1,this.features.push(f.f.readOnly)}async init(){this.archive=await JSZip.loadAsync(this.archiveData),this.archiveData=null,this.fileKeys=Object.keys(this.archive.files);const e=[];for(let t of this.fileKeys){if(!t.includes("/"))continue;let i=t.substring(0,t.lastIndexOf("/"));e.includes(i)||(e.push(i),this.fileKeys.push(i),this.fileKeys.includes(i+"/")&&this.fileKeys.splice(this.fileKeys.indexOf(i+"/"),1))}}async uninit(){this.archive=null,this.archiveData=null,this.fileKeys=null}isFile(e){return 0==this.filetype(e)}exists(e){if("/"==e)return!0;const t=_(e);return null!=this.archive.files[t]||this.fileKeys.filter((e=>e.includes(t+"/"))).length>0}filetype(e){if(!this.exists(e))return-1;const t=_(e);return!this.archive.files[t]||this.archive.files[t].dir?1:this.archive.files[t].dir?-1:0}touch(e){throw new p.J(p.H.EROFS,e)}rm(e){throw new p.J(p.H.EROFS,e)}mkdir(e){throw new p.J(p.H.EROFS,e)}readdir(e,t){const i=[],r=this.fileKeys.map((e=>"/"+e)),n=e;if(!this.exists(e))throw new p.J(p.H.ENOENT,e);const o=n.split("/").length;for(let s in r){const a=r[s];if(a==n)continue;if(!this.exists(a))continue;if("/"!=e){if(!a.startsWith(n+"/"))continue;if(!a.startsWith(n))continue}const l=a.split("/").length;"/"==e&&l>o||(l>o+1||(t?i.push({path:a,filetype:this.filetype(a)}):i.push(a)))}return this._fsSort?i.sort((function(e,i){return t?e.path.toLowerCase().localeCompare(i.path.toLowerCase()):e.toLowerCase().localeCompare(i.toLowerCase())})):i}isEmpty(e){if(!this.exists(e))throw new p.J(p.H.ENOENT,e);if(!this.isFile(e))throw new p.J(p.H.EISDIR,e);return 0==this.stat(e).length}async cpdir(e,t){throw new p.J(p.H.EROFS,t)}async mvdir(e,t){throw new p.J(p.H.EROFS,t)}async rmdir(e){throw new p.J(p.H.EROFS,e)}async mvfile(e,t){throw new p.J(p.H.EROFS,t)}async cpfile(e,t){throw new p.J(p.H.EROFS,t)}async readbin(e){if(!this.exists(e))throw new p.J(p.H.ENOENT,e);if(!this.isFile(e))throw new p.J(p.H.EISDIR,e);const t=this.archive.files[_(e)];return t._data.uncompressedSize<1?new Uint8Array(0):await t.async("uint8array")}async readstr(e){if(!this.exists(e))throw new p.J(p.H.ENOENT,e);if(!this.isFile(e))throw new p.J(p.H.EISDIR,e);return this.archive.files[_(e)]._data.uncompressedSize<1?"":(new TextDecoder).decode(await this.readbin(e))}async writebin(e){throw new p.J(p.H.EROFS,e)}async writestr(e){throw new p.J(p.H.EROFS,e)}stat(e){if(!this.exists(e))throw new p.J(p.H.ENOENT,e);const t=this.archive.files[_(e)];let i=0;return t&&(i=t._data.uncompressedSize),{length:i,type:this.filetype(e),readOnly:!0}}async readStrChunk(e,t,i){return this.stat(e).length<1?"":(new TextDecoder).decode(await this.readBinChunk(e,t,i))}async readBinChunk(e,t,i){if(!this.exists(e))throw new p.J(p.H.ENOENT,e);if(!this.isFile(e))throw new p.J(p.H.EISDIR,e);if(this.stat(e).length<1)return new Uint8Array(0);const r=await this.readbin(e);if(!r)return new Uint8Array(0);return r.subarray(t,i)}}var m=i(6167);class b extends d.N{constructor(e){super(e),this.kPrefix="sysrom:",this.driverName="sysrom",this.features=[f.f.readOnly,f.f.hidden],this.volumeLabel="KSP"}getFileMap(){const e=JSON.parse(localStorage.getItem("sysrom:$fm"));return e||localStorage.setItem("sysrom:$fm","[]"),e||[]}exists(e){if("/"==e)return!0;return!!this.getFileMap().find((t=>t.n==e.replace(/\//g,"")))}isFile(e){return"/"!=e}readdir(e,t){return"/"==e?t?this.getFileMap().map((e=>({path:`/${e.n}`,filetype:0}))):this.getFileMap().map((e=>`/${e.n}`)):[]}stat(e){if("/"==e)return{length:0,dateAccessed:null,dateModified:null,dateCreated:null,readOnly:!1,type:1,recordId:"_null_"};const t=this.getFileMap().find((t=>t.n==e.replace(/\//g,"")));if(t)return{length:t.l,dateAccessed:null,dateModified:null,dateCreated:null,readOnly:!1,type:0,recordId:"_null_"};throw new p.J(p.H.ENOENT,e)}readstr(e){if("/"==e)throw new p.J(p.H.EISDIR,e);const t=this.getFileMap().find((t=>t.n==e.replace(/\//g,"")));if(!t)throw new p.J(p.H.ENOENT,e);return localStorage.getItem("sysrom:"+t.n)}readbin(e){return(new TextEncoder).encode(this.readstr(e))}readStrChunk(){return""}}var y=i(5516);let v={},w={};class x{static async mount(e,t=null,i=!1){const r=null!=t?t:e.prefix;if(!(i||e instanceof d.N))throw new p.J(p.H.EINVAL,"(unknown)");if(null!=v[r])throw new Error("Filesystem is already mounted!");await e.init(),y.xP.log.log(`FS mounted at ${r} [${e.volumeLabel}]`,"FS Service","info"),v[r]=e}static async umount(e){if(null==v[e])throw new p.J(p.H.ENODEV,e);let t=v[e];await t.uninit(),y.xP.log.log(`Unmounted FS ${e}`,"FS Service","info"),v[e]=null}static mounts(){const e=[];for(let t of Object.keys(v))null!=v[t]&&e.push(v[t]);return e}static list(){const e=[];for(var t in v)v[t]instanceof d.N&&e.push(t);return e}static nextLetter(){let e=null;for(let t of"CDEFGHIJKLMNOPQRSTUVWXYZ")if(!v[t+":"]){e=t+":";break}return e}static async toBlob(e){var t=await this.readbin(e);return new Blob([t],{type:(0,u.i)(e)})}static get(e){return v[e.toUpperCase()]}static toURL(e){const t=h.R.deconstructFullPath(e);return this._invokeFsFunc(t.path,t.prefix,"toURL",t.path)}static _invokeFsFunc(e,t,i){if(null==v[t])throw new p.J(p.H.ENODEV,e);const r=v[t],n=[];for(let e=3;e<arguments.length;e++)n.push(arguments[e]);return r[i].call(r,...n)}static async isFile(e){const t=h.R.deconstructFullPath(e);return await this._invokeFsFunc(t.path,t.prefix,"isFile",t.path)}static async isEmpty(e){const t=h.R.deconstructFullPath(e);return await this._invokeFsFunc(t.path,t.prefix,"isEmpty",t.path)}static async mkdir(e){const t=h.R.deconstructFullPath(e),i={cancel:!1,path:e};return await m.p.fs.emit("dir-create",i),!i.cancel&&await this._invokeFsFunc(t.path,t.prefix,"mkdir",t.path)}static async rmdir(e){const t=h.R.deconstructFullPath(e),i={cancel:!1,path:e};return await m.p.fs.emit("dir-remove",i),!i.cancel&&await this._invokeFsFunc(t.path,t.prefix,"rmdir",t.path)}static async touch(e){const t=h.R.deconstructFullPath(e),i={cancel:!1,path:e};return await m.p.fs.emit("touch",i),!i.cancel&&await this._invokeFsFunc(t.path,t.prefix,"touch",t.path)}static async rm(e){const t=h.R.deconstructFullPath(e),i={cancel:!1,path:e};return await m.p.fs.emit("rm",i),!i.cancel&&await this._invokeFsFunc(t.path,t.prefix,"rm",t.path)}static async readdir(e,t){const i=h.R.deconstructFullPath(e),r=await this._invokeFsFunc(i.path,i.prefix,"readdir",i.path,t),n=[];for(var o of r)"object"==typeof o?(o.path=i.prefix+o.path,n.push(o)):n.push(i.prefix+o);return n}static async cpdir(e,t){const i=h.R.deconstructFullPath(e),r=h.R.deconstructFullPath(t);if(i.prefix==r.prefix)return await this._invokeFsFunc(i.path,i.prefix,"cpdir",i.path,r.path);const n=t+e.substring(e.length);await x.exists(n)||await x.mkdir(n);for(let i of await x.readdir(e)){const r=t+i.substring(e.length);await x.isFile(i)?await x.cpfile(i,r):await x.cpdir(i,r)}}static async cpfile(e,t){const i=h.R.deconstructFullPath(e),r=h.R.deconstructFullPath(t);if(i.prefix==r.prefix)return await this._invokeFsFunc(i.path,i.prefix,"cpfile",i.path,r.path);{let e=await this._invokeFsFunc(i.path,i.prefix,"readbin",i.path);return await this._invokeFsFunc(r.path,r.prefix,"writebin",r.path,new Uint8Array(e))}}static async mvfile(e,t){const i=h.R.deconstructFullPath(e),r=h.R.deconstructFullPath(t);if(i.prefix==r.prefix)return await this._invokeFsFunc(i.path,i.prefix,"mvfile",i.path,r.path);{let e=null;if(v[i.prefix]&&(e=v[i.prefix]),e&&(e.features.includes("read-only")||e.readOnly))throw new p.J(p.H.EROFS,i.path);const t=await this._invokeFsFunc(i.path,i.prefix,"readbin",i.path),n=await this._invokeFsFunc(r.path,r.prefix,"writebin",r.path,new Uint8Array(t));return await this._invokeFsFunc(i.path,i.prefix,"rm",i.path),n}}static async mvdir(e,t){const i=h.R.deconstructFullPath(e),r=h.R.deconstructFullPath(t);if(i.prefix==r.prefix)return await this._invokeFsFunc(i.path,i.prefix,"mvdir",i.path,r.path);if(v[i.prefix].features.includes(f.f.readOnly))throw new p.J(p.H.EROFS,i.path);const n=t+e.substring(e.length);await x.exists(n)||await x.mkdir(n);for(let i of await x.readdir(e)){const r=t+i.substring(e.length);await x.isFile(i)?await x.mvfile(i,r):await x.mvdir(i,r)}await x.rmdir(e)}static async exists(e){const t=h.R.deconstructFullPath(e);return!!v[t.prefix]&&await this._invokeFsFunc(t.path,t.prefix,"exists",t.path)}static async readstr(e){const t=h.R.deconstructFullPath(e),i=await this._invokeFsFunc(t.path,t.prefix,"readstr",t.path),r={cancel:!1,value:null,data:i.length<10485760?i:"",path:e};if(await m.p.fs.emit("file-read-string",r),r.cancel)throw new Error("Canceled.");return r.value?r.value:i}static async readbin(e){const t=h.R.deconstructFullPath(e),i={cancel:!1,value:null,path:e};if(await m.p.fs.emit("file-read-binary",i),i.cancel)throw new Error("Canceled.");return i.value?i.value:await this._invokeFsFunc(t.path,t.prefix,"readbin",t.path)}static async filetype(e){const t=h.R.deconstructFullPath(e);return await this._invokeFsFunc(t.path,t.prefix,"filetype",t.path)}static async writestr(e,t){const i=h.R.deconstructFullPath(e),r={cancel:!1,value:null,path:e};if(await m.p.fs.emit("file-write-string",r),r.cancel)throw new Error("Canceled.");return r.value?await this._invokeFsFunc(i.path,i.prefix,"writestr",i.path,r.value):await this._invokeFsFunc(i.path,i.prefix,"writestr",i.path,t)}static async writebin(e,t){const i=h.R.deconstructFullPath(e),r={cancel:!1,value:null,path:e};if(await m.p.fs.emit("file-write-binary",r),r.cancel)throw new Error("Canceled.");return r.value?await this._invokeFsFunc(i.path,i.prefix,"writebin",i.path,r.value):await this._invokeFsFunc(i.path,i.prefix,"writebin",i.path,t)}static async walk(e){const t=await this.readdir(e);for(var i of t)if(!await this.isFile(i)){const e=await this.walk(i);t.push(...e)}return[...new Set(t)]}static async stat(e){const t=h.R.deconstructFullPath(e);return await this._invokeFsFunc(t.path,t.prefix,"stat",t.path)}static async rename(e,t){if("/"==e)return"/";const i=h.R.getParentPath(e)+"/"+t;if(e!=i){if(await x.exists(i))throw new p.J(p.H.EEXIST,i);return 0==await x.filetype(e)?await x.mvfile(e,h.R.fixPath(i)):await x.mvdir(e,h.R.fixPath(i))}}static async readBinChunk(e,t,i){const r=h.R.deconstructFullPath(e);return await this._invokeFsFunc(r.path,r.prefix,"readBinChunk",r.path,t,i)}static async readStrChunk(e,t,i){const r=h.R.deconstructFullPath(e);return await this._invokeFsFunc(r.path,r.prefix,"readStrChunk",r.path,t,i)}static async cache(e,t){const i={type:"binary",overwrite:!0,...t};if(!w[e]||i.overwrite)switch(i.type){default:throw new Error("Invalid argument.");case"binary":w[e]=await x.readbin(e);break;case"string":w[e]=await x.readstr(e);break;case"blob":w[e]=await x.toBlob(e)}}static uncache(e){w[e]=void 0}static getFromCache(e){return w[e]}static async hash(e,t="default"){let i="sha256";if(!x.isFile(e))throw new p.J(p.H.EISDIR,e);if(void 0===crypto.subtle&&(i="md5","sha512"==t||"sha256"==t))throw new p.J(p.H.EINVAL,e);let r="default"==t?i:t;switch(r){default:throw new Error("Invalid algorithm.");case"md5":throw new Error("Not implemented");case"sha256":case"sha384":case"sha512":return await crypto.subtle.digest(`SHA-${r.substring(3)}`,await x.readbin(e)).then((e=>Array.prototype.map.call(new Uint8Array(e),(e=>("00"+e.toString(16)).slice(-2))).join("")))}}static async assert(e){let t;if("string"==typeof e){if(await x.exists(e))return;throw new Error(`Assertion failed: Path ${e} does not exist.`)}t="object"!=typeof e||e instanceof Array?e:[e];for(let e of t){if(!await x.exists(e.path))throw new Error(`Assertion failed: Path ${e.path} does not exist.`);if(void 0!==e.length&&(await x.stat(e.path)).length!=e.length)throw new Error(`Assertion failed: Path ${e.path} does not match the requested length.`);if("dir"==e.type&&await x.isFile(e.path))throw new Error(`Assertion failed: Path ${t} is not a directory.`);if("file"==e.type&&!await x.isFile(e.path))throw new Error(`Assertion failed: Path ${t} is not a file.`)}}}},3177:(e,t,i)=>{"use strict";async function r(e){await fetch("system/errpages/bsod.html").then((async t=>{var i=await t.text();i=i.split("${message}").join(e),document.write(i)}))}i.d(t,{A:()=>r})},7460:(e,t,i)=>{"use strict";i.d(t,{E:()=>n});var r=i(6227);class n{constructor(e){this.el=e,this.buf=""}print(e){const t=document.createElement("span");return t.innerHTML=e,this.el.appendChild(t),this.el.scrollTop=this.el.scrollHeight,this.buf+=e,t}print_styled(e,t){this.print(e).setAttribute("style",null==t?"":t),this.el.scrollTop=this.el.scrollHeight}println_styled(e,t){this.print_styled(e+"<br>",t),this.el.scrollTop=this.el.scrollHeight}println(e){this.print(e+"<br>"),this.el.scrollTop=this.el.scrollHeight}error(e){this.print(`<span style="color: red;">[ ! ]: ${e}</span><br>`),this.el.scrollTop=this.el.scrollHeight}warn(e){this.print(`<span style="color: yellow;">[ ! ]: ${e}</span><br>`),this.el.scrollTop=this.el.scrollHeight}async close(){this.el.remove(),r.FS.mounts().find((e=>"B:"===e.prefix))&&await r.FS.writestr("b:/lastboot.html",this.buf)}clear(){for(;this.el.firstChild;)this.el.removeChild(this.el.firstChild)}}},2534:(e,t,i)=>{"use strict";i.d(t,{o:()=>n});class r{constructor(e){this.element=e}group(){}groupEnd(){}trace(){}error(e){const t=this.log(e);return t.classList.add("error"),t.querySelector(".level").innerText=" ERROR ",t}warn(e){const t=this.log(e);return t.classList.add("warn"),t.querySelector(".level").innerText=" WARN ",t}log(e){const t=document.createElement("div");t.classList.add("line");const i=document.createElement("span");i.classList.add("time"),i.innerText=`[${(new Date).toLocaleTimeString()}]`,t.appendChild(i);const r=document.createElement("span");r.classList.add("level"),r.innerText=" INFO ",t.appendChild(r);const n=document.createElement("span");return n.classList.add("text"),n.innerText=new String(e).replace(/\%c/g,""),t.appendChild(n),this.element.appendChild(t),this.element.scrollTop=this.element.scrollHeight,t}}const n={init:function(){const e=document.createElement("div");e.classList.add("kern-debug-console"),window.console=new r(e),document.body.appendChild(e),window.addEventListener("error",(e=>{const t=console.error(new String(e.error)),i=document.createElement("span");i.classList.add("sub"),i.innerText=" EXC ",t.querySelector(".level").appendChild(i)}))}}},6891:(e,t,i)=>{"use strict";i.d(t,{K:()=>r});const r={early_init:async()=>!0,init:async()=>!0,post_init:async()=>!0}},6110:(e,t,i)=>{"use strict";function r(){const e=[];return null!=window.indexedDB&&e.push("IndexedDB"),null!=window.localStorage&&e.push("LocalStorage"),"undefined"!=typeof WebAssembly&&e.push("WebAssembly"),"undefined"!=typeof WebGLProgram&&e.push("WebGL"),e}i.d(t,{o:()=>n});const n={has:function(...e){const t=r();for(let i of e)if(!t.includes(i))return!1;return!0},getAll:r}},8695:(e,t,i)=>{"use strict";i.d(t,{T:()=>E});var r=i(4186),n=i(5690),o=i(9338),s=i(7612),a=i(1350),l=i(1561),c=i(6227),d=i(7362),h=i(6841),p=i(9182),u=i(797),f=i(5516),_=i(9471),g=i(5563),m=i(845);class b extends r.QP{constructor(){super()}async main(e){if(document.querySelector(".recovery-app"))return;super.main(e);let t=!0;await c.FS.exists("x:/system/config/SAM.json")?(0,g.Xr)("x:/system/config/SAM.json"):(0,g.Xr)("c:/system/config/SAM.json");let i="1"===localStorage.getItem("encr-stage");if(await(0,g.Ml)()&&(t=await u.P.displayLogonUIAsync(!0,i)),e.includes("--nofs")&&(t=!1),t&&(window.w96={...m.b,isRecovery:!0}),i)return t?f.xP.execCmd("encrwiz",[]):(localStorage.removeItem("encr-stage"),f.xP.reboot());const r=[{title:"Backup and Restore",description:"Backup or restore your current system.",icon:await s.Q.getIconUrl("apps/backupmgr"),cmd:"backupmgr",requiresFS:!0},{title:"File Explorer",description:"Repair files by browsing your file system",icon:await s.Q.getIconUrl("places/folder"),cmd:"explorer",requiresFS:!0},{title:"Reinstall",description:"Remove everything and start fresh.",icon:await s.Q.getIconUrl("apps/reinstall"),cmd:"reinstall"},{title:"System Flags",description:"Modify system behavior/boot flags",icon:await s.Q.getIconUrl("objects/tools"),cmd:"flags"},{title:"Terminal",description:"Open a terminal where various commands may be executed",icon:await s.Q.getIconUrl("apps/terminal"),cmd:"terminal",requiresFS:!0}],n=this.createWindow({icon:await s.Q.getIconUrl("apps/rcmenu","16x16"),title:"System Recovery Tools",controlBoxStyle:"WS_CBX_CLOSE",taskbar:!1,initialHeight:370,initialWidth:485,center:!0,bodyClass:"recovery-app",body:'\n            <span class="bold-noaa">Choose a recovery tool</span>\n            <p>\n            System Drive: (X:/)\n            </p>\n\n            <div class="items">\n\n            </div>\n            <div class="buttons">\n                <button class="w96-button reboot">Reboot</button>\n            </div>\n            ',resizable:!1},!0),o=n.getBodyContainer(),a=o.querySelector(".items");o.querySelector(".reboot").addEventListener("click",(()=>f.xP.reboot(!0)));for(let e of r){if(e.requiresFS&&!t)continue;const i=_.K.mkElement("div",["item"]),r=_.K.mkElement("div",["icon"]);r.style.backgroundImage=`url(${e.icon})`;const n=_.K.mkElement("div",["text"]),o=_.K.mkElement("span",["bold-noaa"]),s=_.K.mkElement("span",[]);o.innerText=e.title,s.innerText=e.description,n.appendChild(o),n.appendChild(document.createElement("br")),n.appendChild(s),o.addEventListener("click",(()=>f.xP.execCmd(e.cmd,[]))),i.appendChild(r),i.appendChild(n),a.appendChild(i)}await(0,d.kB)(),n.show()}ontermination(){f.xP.reboot(!0)}}var y=i(4101);const v={init:async function(){const e=document.createElement("div");e.style.backgroundColor="#343434",e.style.width="100vw",e.style.height="100vh",e.style.position="absolute",e.style.top="0px",e.style.left="0px",e.style.zIndex="9",e.style.overflow="hidden",document.body.appendChild(e);for(let e of c.FS.list())try{await c.FS.umount(e)}catch(e){console.error(e)}let t="2"===localStorage.getItem("encr-stage");await c.FS.mount(new l.s("c:"));const u=new c.RemoteReadOnlyFileSystem("W:","/system/images/rofs.json");u.features.push("hidden"),u.volumeLabel="System Root",await c.FS.mount(u,"W:"),await s.Q.init(!0),w96.isRecovery=!0,c.FS.get("c:").volumeLabel="Recovery",await(0,h.Dc)(300);for(let e of(0,d.V7)())(0,d.N9)(e);d.nP.setEnv("path","c:/system/local/bin"),document.body.onclick=function(e){null!=e.target&&null!=e.target.classList&&e.target.classList.contains("root-item")||(document.querySelectorAll(".wcontext-menu").forEach((e=>e.remove())),document.querySelectorAll(".w96-menubar>.root-item.selected").forEach((e=>e.classList.remove("selected"))))},document.body.style.height="100%",a.C$.setWindowContainer(e),a.C$.disableAppBar(!0),s.Q.uiVars.maxWindowSizeFormulaH="100%",s.Q.uiVars.maxWindowSizeFormulaW="100%",s.Q.cssa("\n    .titlebar-minbutton {\n        display: none !important;\n    }\n\n    .titlebar-title-disabled {\n        background: gray !important;\n    }\n\n    .window-dlg:not(.ui-sortable-helper) .titlebar {\n        background: linear-gradient(45deg, #181818, dimgrey);\n    }");const _=o.jC.idleProgress("Recovery Environment","Loading data, please wait...");await(0,p.N)("/system/images/rootfs/recovery.zip"),_.closeDialog();let g=!1;if(t){let e=new c.EncryptedFileSystem("c:",null);for(;;){if(e.password=await new Promise((async e=>{n.O.prompt("This computer is configured to require a password in order to start up. If you would like to reinstall, click Cancel.",{title:"Startup Password",noComments:!0,isPassword:!0,maxWidth:"300px",icon:"/system/resource/icons/win96/32x32/devices/computer-alt.png"},e)})),null===e.password){await new Promise((e=>setTimeout(e,100))),g=!0;const e=new l.s("c:");await c.FS.mount(e,"X:");break}if(await e._getKey(),await e._testEncryption()){e.prefix="C:",await c.FS.mount(e,"X:");break}await new Promise((e=>setTimeout(e,300)))}}else{const e=new c.IndexedFileSystem("c:");e.prefix="C:",await c.FS.mount(e,"X:")}try{await y.F.loadAll("X:/system/config/SCM")}catch(e){console.warn("Could not load X:/ SCM.")}(0,d.VG)("rcmenu",[],(function(e){return r.QP.execAsync(new b,e)})),(0,f.RM)("NewTerminalApplication","terminal",[],await Promise.resolve().then(i.bind(i,42))),(0,d.VG)("reinstall",[],(function(e){o.jC.confirm("Press OK to reinstall Windows 96. Your data will be gone forever and cannot be recovered!",(e=>{if(e)if(localStorage.clear(),indexedDB){const e=indexedDB.deleteDatabase(localStorage.getItem("storeid"));e.onsuccess=()=>{console.log("DB clear successful!"),document.location.reload()},e.onerror=()=>{console.error("DB clear failed!"),document.location.reload()},e.onblocked=()=>{console.error("Operation blocked - cannot clear DB."),document.location.reload()}}else document.location.reload()}))})),localStorage.getItem("encr-stage")&&(0,f.RM)("EncryptionWizardApplication","encrwiz",[],await Promise.resolve().then(i.bind(i,1349))),(0,d.lw)("rcmenu",[g?"--nofs":""])}};const w={init:async function(){const e=document.createElement("div");e.style.backgroundImage="url(/system/resource/misc/setup.png)",e.style.width="100%",e.style.height="100%",e.style.position="absolute",e.style.top="0px",e.style.left="0px",e.style.zIndex="9",e.style.overflow="hidden",e.style.backgroundPosition="center",e.style.backgroundRepeat="no-repeat",e.style.backgroundColor="#0d9287",document.body.appendChild(e);const t=new c.RemoteReadOnlyFileSystem("W:","/system/images/rofs.json");t.features.push("hidden"),t.volumeLabel="System Root",await c.FS.mount(t,"W:"),await c.FS.mount(new c.IndexedFileSystem("c:")),await s.Q.init(!0),m.b.isRecovery=!0,await(0,h.Dc)(300),d.nP.setEnv("path","c:/system/local/bin"),document.body.onclick=function(e){null!=e.target&&null!=e.target.classList&&e.target.classList.contains("root-item")||(document.querySelectorAll(".wcontext-menu").forEach((e=>e.remove())),document.querySelectorAll(".w96-menubar>.root-item.selected").forEach((e=>e.classList.remove("selected"))))},document.body.style.height="100%",a.C$.setWindowContainer(e),a.C$.disableAppBar(!0),s.Q.uiVars.maxWindowSizeFormulaH="100%",s.Q.uiVars.maxWindowSizeFormulaW="100%";const i=o.jC.idleProgress("Installer Environment","Loading data, please wait...");await(0,p.N)("/system/images/rootfs/oobe.zip"),i.closeDialog(),await c.FS.rm("C:/system/local/bin/uinit_stage3"),await f.xP.execCmd("oobe",[]),f.xP.reboot()}};let x=!1;function C(e){if(e.altKey&&!x)switch(e.key){case"i":x=!0,S();break;case"o":x=!0,function(){for(;document.body.firstChild;)document.body.removeChild(document.body.firstChild);w.init()}()}}function S(){for(;document.body.firstChild;)document.body.removeChild(document.body.firstChild);v.init()}const E={registerHandler:()=>document.body.addEventListener("keydown",C),deregisterHandler:()=>document.body.removeEventListener("keydown",C),launchIPrompt:S,hasEntered:function(){return x}}},6471:(e,t,i)=>{"use strict";i.d(t,{v:()=>r});const r={branch:"main",status:$96.isSigned?"OFFICIAL":"MODDED",name:"wkern",rootfsUrl:"system/images/rootfs/rootfs.zip"}},9230:(e,t,i)=>{"use strict";i.d(t,{e:()=>r});class r extends Error{constructor(e){super(e),this.name="KernelError"}}},8223:(e,t,i)=>{"use strict";i.d(t,{a:()=>s});var r=i(6227);const n=[],o={};const s={loadTextAsync:async function(e,t=!0){if(o[e])return o[e];const i=await fetch(e);return o[e]=await i.text()},loadlibAsync:function(e){return new Promise(((t,i)=>{try{if(n.includes(e))return t();const i=document.createElement("script");i.onload=()=>{t()},i.src=e,document.head.appendChild(i),n.push(e)}catch(e){i(e)}}))},loadStyleAsync:function(e){return new Promise((t=>{if(n.includes(e))return t();const i=document.createElement("link");i.rel="stylesheet",i.onload=()=>{t()},i.href=e,document.head.appendChild(i),n.push(e)}))},createStyleFromPath:async function(e){const t=await r.FS.readstr(e),i=document.createElement("style");return i.innerText=t,i}}},5563:(e,t,i)=>{"use strict";function r(e){return crypto.subtle.digest("SHA-512",new TextEncoder("utf-8").encode(e)).then((e=>Array.prototype.map.call(new Uint8Array(e),(e=>("00"+e.toString(16)).slice(-2))).join("")))}i.d(t,{Ew:()=>p,E7:()=>l,B1:()=>d,Ml:()=>h,Dj:()=>u,Xr:()=>c,TK:()=>f});var n=i(6227);const o="salted-sha512";let s="c:/system/config/SAM.json",a=!1;function l(){a=!0}function c(e){return!a&&(s=e,!0)}async function d(){try{let e=JSON.parse(await n.FS.readstr(s));return e.alg||(e.alg="md5"),e.needsRehash=o!==e.alg,e}catch(e){return null}}async function h(){return null!==await d()&&(await d()).pwd}async function p(){return await n.FS.rm(s)}async function u(e,t){const i=btoa(Array.from(window.crypto.getRandomValues(new Uint8Array(16))).map((e=>String.fromCharCode(e))).join(""));await n.FS.writestr(s,JSON.stringify({name:e,salt:i,alg:o,pwd:await r(i+t)}))}async function f(e,t){const i=await d();let n=!1;if(i.name!==e)return!1;switch(i.alg){case"md5":n=function(e){function t(e,t){return e<<t|e>>>32-t}function i(e,t){var i,r,n,o,s;return n=2147483648&e,o=2147483648&t,s=(1073741823&e)+(1073741823&t),(i=1073741824&e)&(r=1073741824&t)?2147483648^s^n^o:i|r?1073741824&s?3221225472^s^n^o:1073741824^s^n^o:s^n^o}function r(e,r,n,o,s,a,l){return e=i(e,i(i(function(e,t,i){return e&t|~e&i}(r,n,o),s),l)),i(t(e,a),r)}function n(e,r,n,o,s,a,l){return e=i(e,i(i(function(e,t,i){return e&i|t&~i}(r,n,o),s),l)),i(t(e,a),r)}function o(e,r,n,o,s,a,l){return e=i(e,i(i(function(e,t,i){return e^t^i}(r,n,o),s),l)),i(t(e,a),r)}function s(e,r,n,o,s,a,l){return e=i(e,i(i(function(e,t,i){return t^(e|~i)}(r,n,o),s),l)),i(t(e,a),r)}function a(e){var t,i="",r="";for(t=0;t<=3;t++)i+=(r="0"+(e>>>8*t&255).toString(16)).substr(r.length-2,2);return i}var l,c,d,h,p,u,f,_,g,m=Array();for(e=function(e){e=e.replace(/\r\n/g,"\n");for(var t="",i=0;i<e.length;i++){var r=e.charCodeAt(i);r<128?t+=String.fromCharCode(r):r>127&&r<2048?(t+=String.fromCharCode(r>>6|192),t+=String.fromCharCode(63&r|128)):(t+=String.fromCharCode(r>>12|224),t+=String.fromCharCode(r>>6&63|128),t+=String.fromCharCode(63&r|128))}return t}(e),m=function(e){for(var t,i=e.length,r=i+8,n=16*((r-r%64)/64+1),o=Array(n-1),s=0,a=0;a<i;)s=a%4*8,o[t=(a-a%4)/4]=o[t]|e.charCodeAt(a)<<s,a++;return s=a%4*8,o[t=(a-a%4)/4]=o[t]|128<<s,o[n-2]=i<<3,o[n-1]=i>>>29,o}(e),u=1732584193,f=4023233417,_=2562383102,g=271733878,l=0;l<m.length;l+=16)c=u,d=f,h=_,p=g,u=r(u,f,_,g,m[l+0],7,3614090360),g=r(g,u,f,_,m[l+1],12,3905402710),_=r(_,g,u,f,m[l+2],17,606105819),f=r(f,_,g,u,m[l+3],22,3250441966),u=r(u,f,_,g,m[l+4],7,4118548399),g=r(g,u,f,_,m[l+5],12,1200080426),_=r(_,g,u,f,m[l+6],17,2821735955),f=r(f,_,g,u,m[l+7],22,4249261313),u=r(u,f,_,g,m[l+8],7,1770035416),g=r(g,u,f,_,m[l+9],12,2336552879),_=r(_,g,u,f,m[l+10],17,4294925233),f=r(f,_,g,u,m[l+11],22,2304563134),u=r(u,f,_,g,m[l+12],7,1804603682),g=r(g,u,f,_,m[l+13],12,4254626195),_=r(_,g,u,f,m[l+14],17,2792965006),u=n(u,f=r(f,_,g,u,m[l+15],22,1236535329),_,g,m[l+1],5,4129170786),g=n(g,u,f,_,m[l+6],9,3225465664),_=n(_,g,u,f,m[l+11],14,643717713),f=n(f,_,g,u,m[l+0],20,3921069994),u=n(u,f,_,g,m[l+5],5,3593408605),g=n(g,u,f,_,m[l+10],9,38016083),_=n(_,g,u,f,m[l+15],14,3634488961),f=n(f,_,g,u,m[l+4],20,3889429448),u=n(u,f,_,g,m[l+9],5,568446438),g=n(g,u,f,_,m[l+14],9,3275163606),_=n(_,g,u,f,m[l+3],14,4107603335),f=n(f,_,g,u,m[l+8],20,1163531501),u=n(u,f,_,g,m[l+13],5,2850285829),g=n(g,u,f,_,m[l+2],9,4243563512),_=n(_,g,u,f,m[l+7],14,1735328473),u=o(u,f=n(f,_,g,u,m[l+12],20,2368359562),_,g,m[l+5],4,4294588738),g=o(g,u,f,_,m[l+8],11,2272392833),_=o(_,g,u,f,m[l+11],16,1839030562),f=o(f,_,g,u,m[l+14],23,4259657740),u=o(u,f,_,g,m[l+1],4,2763975236),g=o(g,u,f,_,m[l+4],11,1272893353),_=o(_,g,u,f,m[l+7],16,4139469664),f=o(f,_,g,u,m[l+10],23,3200236656),u=o(u,f,_,g,m[l+13],4,681279174),g=o(g,u,f,_,m[l+0],11,3936430074),_=o(_,g,u,f,m[l+3],16,3572445317),f=o(f,_,g,u,m[l+6],23,76029189),u=o(u,f,_,g,m[l+9],4,3654602809),g=o(g,u,f,_,m[l+12],11,3873151461),_=o(_,g,u,f,m[l+15],16,530742520),u=s(u,f=o(f,_,g,u,m[l+2],23,3299628645),_,g,m[l+0],6,4096336452),g=s(g,u,f,_,m[l+7],10,1126891415),_=s(_,g,u,f,m[l+14],15,2878612391),f=s(f,_,g,u,m[l+5],21,4237533241),u=s(u,f,_,g,m[l+12],6,1700485571),g=s(g,u,f,_,m[l+3],10,2399980690),_=s(_,g,u,f,m[l+10],15,4293915773),f=s(f,_,g,u,m[l+1],21,2240044497),u=s(u,f,_,g,m[l+8],6,1873313359),g=s(g,u,f,_,m[l+15],10,4264355552),_=s(_,g,u,f,m[l+6],15,2734768916),f=s(f,_,g,u,m[l+13],21,1309151649),u=s(u,f,_,g,m[l+4],6,4149444226),g=s(g,u,f,_,m[l+11],10,3174756917),_=s(_,g,u,f,m[l+2],15,718787259),f=s(f,_,g,u,m[l+9],21,3951481745),u=i(u,c),f=i(f,d),_=i(_,h),g=i(g,p);return(a(u)+a(f)+a(_)+a(g)).toLowerCase()}(t)===i.pwd;break;case"salted-sha512":n=await r(i.salt+t)===i.pwd;break;default:n=!1}return n&&i.needsRehash&&await setPassword(e,t),n}},2690:(e,t,i)=>{"use strict";i.d(t,{l:()=>o});var r=i(1561),n=i(6227);i(7460);const o={loadDefinitions:async function(e,t){const i=e.split("\n");let o=0;for(let e of i){let i=e.trim();if(o++,i.startsWith("#"))continue;if(""==i)continue;const s=i.split(" "),a=s[0];if("+"==a){if(s.length<3)throw new Error(o+": 2 arguments needed, only "+(s.length-1)+" present.");const e=s[1],i=s[2].toLowerCase();if(!/[a-zA-Z]\:/.test(e))throw new Error(o+": Invalid drive letter "+e);let a=null;switch(i){default:throw new Error(o+": File system does not exist.");case"idb":a=new n.IndexedFileSystem(e);break;case"lstor":a=new n.LocalStorageFileSystem(e);break;case"ram":a=new r.s(e);break;case"rofs":throw new Error("Not implemented")}null!=s[3]&&(a.volumeLabel=s[3]),await n.FS.mount(a),t.println_styled(">> Mounted drive "+e+" [fs="+i+", label="+a.volumeLabel+"]","color: cyan")}else{if("-"!=a)throw new Error("Invalid FS definition found - please delete line "+o+", `"+i+"`");{if(s.length<2)throw new Error(o+": 1 argument needed, only "+(s.length-1)+" present.");const e=s[1];if(!/[a-zA-Z]\:/.test(e))throw new Error(o+": Invalid drive letter "+e);await n.FS.umount(e)}}}}}},1943:(e,t,i)=>{"use strict";i.d(t,{W:()=>r});const r={isOnline:async function(){await w96.FS.exists("c:/system/temp/swhc")||await w96.FS.writestr("c:/system/temp/swhc","true");const e=await fetch("/_/C/system/temp/swhc");return"true"==await e.text()}}},9150:(e,t,i)=>{"use strict";i.d(t,{f:()=>p});var r=i(4186),n=i(9338),o=i(5690),s=i(9275),a=i(5516);let l=["http://localhost:4096","http://127.0.0.1:4096","https://windows96.net","http://127.0.0.1:8192","http://localhost:8192","https://devel.windows96.net:4096","http://devel.windows96.net:4096","https://etc.windows96.net"],c=[],d=!1,h=new s.v;const p={register:function(){if(d)throw new Error("postMessage() handler already registered.");window.addEventListener("message",(e=>{l.includes(e.origin.trim())?null!=e.data&&null!=e.data.op&&"string"==typeof e.data.op&&null!=e.data.args&&h.emit(e.data.op,{evt:e,args:e.data.args}):c.includes(e.origin)||(console.error("Refusing to accept events from untrusted URL "+e.origin),c.push(e.origin))})),d=!0},registerBasicEvents:function(){h.on("debug",(e=>console.log(e))),h.on("ifr-prompt",(e=>{null==e.args[0]&&null==e.args[1]&&null==e.args[2]&&null==e.args[3]&&null==e.args[4]&&null==e.args[5]||n.jC.prompt(e.args[0],e.args[1],e.args[2],(t=>{const i=e.args[3],n=e.args[4],o=e.args[5];r.zF[o].appFrame.contentWindow.postMessage({op:i,args:{value:t}},n)}))})),h.on("urlopen",(e=>{if(null==e.args[0])return;o.O.create({title:"Open URL",icon:"warning",body:'Are you sure you want to open this URL?<br><br>\nURL: <span class="url"></span><br><br>\nOpening untrusted URLs can put you at risk!',buttons:[{id:"ok",text:"Cancel",action:"$close"},{id:"ok",text:"OK",action:t=>{a.xP.execCmd("internete",[e.args[0]]),t.dlg.close()}}]}).body().querySelector(".url").innerText=e.args[0]}))},trust:function(e){l.includes(e)||l.push(e)},events:h}},6482:(e,t,i)=>{"use strict";i.d(t,{Z:()=>p});var r=i(6227),n=i(5563);const o="c:/system/config/RCON.json";let s,a,l={};async function c(){let e;try{e=JSON.parse(await r.FS.readstr(o))}catch(t){e={enabled:!1}}return e}function d(){a||(a=w96.net.p3.createServer(140,(e=>{l[e.remoteAddress]=e;let t="",i="",r=0,o=!1,a=`Remote Console on ${w96.net.p3.address}`;e.send(["text","┌"+new Array(a.length+2).fill("─").join("")+"┐\n"+`│ ${a} │\n└`+new Array(a.length+2).fill("─").join("")+"┘\n\nUsername: "]),e.on("message",(async([a,l])=>{if("input"==a&&"string"==typeof l){if(l=l.trim(),o){e.send(["text",l+"\n"]);try{let t=String(new Function(`return ${l}`)());e.send(["text",t])}catch(t){let i=t.toString();t.stack.trim().split("\n").forEach((e=>{e.includes("> Function")&&(i+="\n\t"+e)})),e.send(["text",[{color:"#f00",text:i}]])}return void e.send(["text","\nscript> "])}if(!t&&l)return t=l,void e.send(["text",l+"\nPassword: "]);if(!i&&l)if(i=l,e.send(["text","\n"]),await(0,n.TK)(t,i))o=!0,s&&e.send(["text",`\nLast login: ${s.address} at ${s.time.toLocaleString()}.`]),s={address:e.remoteAddress,time:new Date},e.send(["text","\nscript> "]);else{if(r++,e.send(["text","\nWrong username/password."]),3===r)return e.disconnect();e.send(["text","\n\nUsername: "]),t="",i=""}}})),e.on("disconnect",(()=>{delete l[e.remoteAddress]}))})))}function h(){return new Promise((async e=>{(await c()).enabled&&(w96.net&&w96.net.p3?w96.net.p3.connected?(d(),e()):(w96.net.p3.on("connect",(()=>{d(),e()})),await w96.net.p3.connect()):w96.evt.sys.on("unrestrict",(async()=>{await w96.net.p3.connect(),d(),e()})))}))}const p={init:h,getConfig:c,updateConfig:async function(e){let t=await c();t={...t,...e},await r.FS.writestr(o,JSON.stringify(t)),t.enabled?a||h():a&&(a.close(),a=null)}}},2177:(e,t,i)=>{"use strict";i.d(t,{K:()=>r});class r{constructor(){this.events=[],this.limits={eventCount:1e3},this.silenced=!1}log(e,t,i="none"){this.events.length>=this.limits.eventCount||this.silenced||this.events.push({message:e,source:t,severity:i,date:(new Date).toUTCString()})}setSilenced(e){this.silenced=e}}},5293:(e,t,i)=>{"use strict";i.d(t,{c:()=>o});var r=i(4186),n=i(7362);const o={register:function(e){const t={command:null,type:"gui",filters:[],meta:null,cls:null,clsType:"class",...e};if(!t.command)throw new Error("Command was not specified in app registration!");if(!t.cls)throw new Error("No app class specified in app registration!");let i=t.cls;"function"!==t.clsType&&(i=function(e,i){return r.QP.execAsync(new t.cls,e,i)}),(0,n.VG)(t.command,t.filters,i),t.meta&&(0,n.Du)(t.command,t.meta.icon,t.meta.friendlyName),(0,n.rF)(t.command,{type:t.type})}}},3991:(e,t,i)=>{"use strict";i.d(t,{d:()=>l});const r="web";var n=i(6841),o=i(6227);const s="3.0.1";let a=null;var l={getVersionString:function(){return s},getLatestVersion:async function(){return a?a.ver:(a=await fetch("/system/images/bstr.json",{cache:"no-store"}).then((e=>e.json())),(0,n.hd)(a.ver))},getLatestVersionString:async function(){return a||(a=await fetch("/system/images/bstr.json",{cache:"no-store"}).then((e=>e.json()))),a.ver},getBuildId:async function(){return $96.buildId?$96.buildId:a?a.bstr:(a=await fetch("/system/images/bstr.json",{cache:"no-store"}).then((e=>e.json()))).bstr},getLatestBuildId:async function(){return a||(a=await fetch("/system/images/bstr.json",{cache:"no-store"}).then((e=>e.json()))),a.bstr},getVersion:function(){return(0,n.hd)(s)},getReleaseChannel:function(){return"main"},getType:function(){return r},getRootFSBuild:async function(){return await o.FS.exists("c:/system/wupd/rootfs.sys")?parseInt(await o.FS.readstr("c:/system/wupd/rootfs.sys"),10):11584},isLegacyV2:async function(){return"1"==localStorage["social_mv.lock"]&&await o.FS.exists("C:/system/boot/apps")}}},7733:(e,t,i)=>{"use strict";i.d(t,{D:()=>r});class r{constructor(e){const t={id:null,friendlyName:null,autostart:!1,...e};if(null==t.id)throw new Error("Service ID cannot be null");if(null==t.friendlyName)throw new Error("Service must provide friendly name");this.id=t.id,this.friendlyName=t.friendlyName,this.autostart=!0,this.running=!1}async start(){this.running=!0}async stop(){this.running=!1}}},8918:(e,t,i)=>{"use strict";i.d(t,{W:()=>s});var r=i(2110),n=i(6227),o=i(7733);class s{constructor(){this.services=[]}find(e){return this.services.find((t=>t.id==e))}async register(e){if(e){if(!(e instanceof o.D))throw new Error("Object must be a service.");if(this.find(e.id))throw new Error("This service is already registered.");this.services.push(e)}}async parse(e){const t=await n.FS.readstr(e);return await r.D.run(`\n            const Service = this.boxedEnv.svc;\n\n            ${t}\n        `,{boxedEnv:{svc:o.D}})}async start(e,t){if(!e)return;let i=null;if("string"==typeof e){if(i=this.find(e),!i)return;await i.start(t),i.running=!0}else await e.start(t),e.running=!0}async stop(e,t){if(!e)return;let i=null;if("string"==typeof e){if(i=this.find(e),!i)return;await i.stop(t),i.running=!1}else await e.stop(t),e.running=!1}getAll(){return this.services}}},6640:(e,t,i)=>{"use strict";i.d(t,{P:()=>a});var r=i(7619),n=i(5685),o=i(6227);let s;const a={init:function(){try{if(null==window.serviceWorker)throw new Error}catch(e){return void console.warn("Cannot access service worker!")}"serviceWorker"in navigator&&(window.addEventListener("load",(function(){navigator.serviceWorker.register("/sw.js",{scope:"/"}).then((e=>{s=e,console.log("FS HTTP proxy registered, scope is "+e.scope)})).catch((e=>console.log("service worker not registered",e)))})),navigator.serviceWorker.addEventListener("message",(async e=>{if(!Array.isArray(e.data))return;const[t,i,...s]=e.data;switch(i){case"get":let[i]=s;try{if("/"===i){e.source.postMessage([t,"disks",o.FS.list()]);break}i.endsWith("/")&&!/^[a-z]:\/$/i.test(i)&&(i=i.slice(0,-1));const s=await o.FS.stat(i);void 0===s?e.source.postMessage([t,"error",r.H.ENOENT.id,r.H.ENOENT.message]):1===s.type?e.source.postMessage([t,"dir",await o.FS.readdir(i)]):e.source.postMessage([t,"data",await o.FS.readbin(i),(0,n.i)(i)])}catch(r){console.error("Can't fetch "+i+"!",r),r.errno?e.source.postMessage([t,"error",r.errno.id,r.errno.message]):e.source.postMessage([t,"error",String(r)])}}})))},unregisterServiceWorkers:async function(){const e=await navigator.serviceWorker.getRegistrations();e.length>0&&(e.forEach((e=>e.unregister())),window.location.reload())}}},7362:(e,t,i)=>{"use strict";i.d(t,{Du:()=>h,FN:()=>y,K2:()=>u,N9:()=>p,V7:()=>_,VG:()=>c,kB:()=>m,lw:()=>f,nP:()=>o,rF:()=>d,rr:()=>b});var r=i(6227);let n={};const o={setEnv:function(e,t){n[e]=t},getEnv:function(e){return n[e]},envKeys:function(){return Object.keys(n)}};let s={},a={},l={};function c(e,t,i,r,n={}){if(null!=s[e])throw Error("App already registered!");s[e]={supportedFileTypes:t,launchCallback:i},r&&(a[e]=r),l[e]=n}function d(e,t){l[e]=t}function h(e,t,i){a[e]={icon:t,friendlyName:i}}function p(e){s[e]=null}function u(e){return null!=s[e]}function f(e,t,i){if(!u(e))throw new Error(`App \`${e}\` does not exist.`);let r={term:null,session:n,...i};return l[e]&&"cli"===l[e].type&&!r.term?f("terminal",[e,...t],{}):s[e].launchCallback(t,r)}function _(){var e=[];for(var t of Object.keys(s))null!=s[t]&&e.push(t);return e}let g=[];async function m(){await r.FS.exists("c:/system/etc/apps.json")?g=JSON.parse(await r.FS.readstr("c:/system/etc/apps.json")):console.warn("Nothing to reload: App registry is missing!")}function b(e){const t=[],i=(e.includes(".")?e.substring(e.lastIndexOf(".")+1):"*").toLowerCase();for(const e of g)e.assoc.includes(i)&&t.push(e.exec);return t}function y(){return g}},117:(e,t,i)=>{"use strict";i.r(t),i.d(t,{SetupWizardApplication:()=>n});var r=i(3516);class n extends r.p{constructor(){super()}async main(e){await super.main(e);const t=this.findPage("intro");t.titleText="Welcome to Setup.",t.body="This wizard will help you install Windows 96.",this.openPage("intro",[]),this.mainwnd.setTitle("Setup"),this.mainwnd.setControlBoxStyle("WS_CBX_NONE"),this.mainwnd.center(),this.mainwnd.onclose=()=>{alert("Shutdown")}}}},6051:(e,t,i)=>{"use strict";i.d(t,{H:()=>a});var r=i(7612),n=i(6167),o=i(1350),s=i(5516);async function a(e){const t=document.createElement("style");t.innerText=".user-desktop {\n        height: 100vh;\n        width: 100vw;\n        position: absolute;\n        top: 0;\n        left: 0;\n        overflow: hidden;\n        user-select: none;\n    }\n\n    .titlebar-minbutton {\n        display: none !important;\n    }",document.body.appendChild(t);const i=document.createElement("div");i.classList.add("user-desktop"),i.addEventListener("click",(e=>{e.target==i&&w96.WindowSystem.deactivateAllWindows()})),e.appendChild(i),r.Q.uiVars.maxWindowSizeFormulaH="100vh",r.Q.uiVars.maxWindowSizeFormulaW="100vw",o.C$.setWindowContainer(i),o.C$.disableAppBar(!0);const a=document.createElement("div");let l=$96.buildId;l&&"undefined"!=l||(l=(await fetch("/system/images/bstr.json",{cache:"no-store"}).then((e=>e.json()))).bstr),a.classList.add("build-info"),a.style.textAlign="right",a.style.fontFamily="monospace";a.innerHTML=`<span class="bright">Windows 96 main${$96.isSigned?"":"<br>This kernel is not genuine"}<br>Build ${l}</span>`,a.style.bottom=0,s.xP.bootFlags.includes("no_build_info")&&(a.style.opacity="0%"),i.appendChild(a),n.p.sys.on("init-complete",(()=>w96.sys.execCmd("w96-setup",[]))),window.onkeydown=e=>{"F10"==e.code&&e.shiftKey&&(e.preventDefault(),w96.sys.execCmd("terminal",[]))}}},5516:(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{RM:()=>importApp,ek:()=>kmain,xP:()=>System});var _index__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(845),_gui_wndsystem__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(1350),_boot_gfxboot__WEBPACK_IMPORTED_MODULE_49__=__webpack_require__(8313),_kernel_bsod__WEBPACK_IMPORTED_MODULE_47__=__webpack_require__(3177),_kernel_console__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(7460),_kernel_kerror__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(9230),_fs_webfs__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(6227),_registry__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__(7362),_os_reg_app__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__(5293),_sys_os_wpa__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__(9703),_wasm_wasm__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__(9110),_gui_commdlg__WEBPACK_IMPORTED_MODULE_9__=__webpack_require__(9338),_kernel_volmgr__WEBPACK_IMPORTED_MODULE_10__=__webpack_require__(2690),_kernel_kerninfo__WEBPACK_IMPORTED_MODULE_11__=__webpack_require__(6471),_kernel_events__WEBPACK_IMPORTED_MODULE_12__=__webpack_require__(6891),_os_release__WEBPACK_IMPORTED_MODULE_13__=__webpack_require__(3991),_events__WEBPACK_IMPORTED_MODULE_14__=__webpack_require__(6167),_shell_executor__WEBPACK_IMPORTED_MODULE_15__=__webpack_require__(254),_gui_shell_theme_theme__WEBPACK_IMPORTED_MODULE_16__=__webpack_require__(7612),_util_std__WEBPACK_IMPORTED_MODULE_48__=__webpack_require__(6841),_fs_features__WEBPACK_IMPORTED_MODULE_17__=__webpack_require__(8279),_sys_net_p3_import_w96__WEBPACK_IMPORTED_MODULE_18__=__webpack_require__(7839),_net_crossifr__WEBPACK_IMPORTED_MODULE_19__=__webpack_require__(9150),_api_wrt_wrt__WEBPACK_IMPORTED_MODULE_20__=__webpack_require__(2110),_gui_compositor_wincomp__WEBPACK_IMPORTED_MODULE_21__=__webpack_require__(674),_pwa__WEBPACK_IMPORTED_MODULE_22__=__webpack_require__(6640),_fs_filesystems_fs_ram__WEBPACK_IMPORTED_MODULE_23__=__webpack_require__(1561),_kernel_iip__WEBPACK_IMPORTED_MODULE_24__=__webpack_require__(8695),_util_zip__WEBPACK_IMPORTED_MODULE_25__=__webpack_require__(9182),_os_svc_servicemgr__WEBPACK_IMPORTED_MODULE_26__=__webpack_require__(8918),_kernel_debug_conoverlay__WEBPACK_IMPORTED_MODULE_27__=__webpack_require__(2534),_dev_profilemgr__WEBPACK_IMPORTED_MODULE_28__=__webpack_require__(9807),_dev_battery__WEBPACK_IMPORTED_MODULE_29__=__webpack_require__(66),_bios_bios__WEBPACK_IMPORTED_MODULE_30__=__webpack_require__(1865),_bios_rom__WEBPACK_IMPORTED_MODULE_31__=__webpack_require__(5624),_flags__WEBPACK_IMPORTED_MODULE_32__=__webpack_require__(6226),_shell_taskbar__WEBPACK_IMPORTED_MODULE_33__=__webpack_require__(8423),_apps_system_p3_settings__WEBPACK_IMPORTED_MODULE_34__=__webpack_require__(4821),_kernel_sam__WEBPACK_IMPORTED_MODULE_35__=__webpack_require__(5563),_setup_installerShell__WEBPACK_IMPORTED_MODULE_36__=__webpack_require__(6051),_gui_dlgcreator__WEBPACK_IMPORTED_MODULE_37__=__webpack_require__(5690),_sec_av_anti_virus_svc__WEBPACK_IMPORTED_MODULE_38__=__webpack_require__(7390),_gui_ui_logon_logonui__WEBPACK_IMPORTED_MODULE_39__=__webpack_require__(797),_apps_system_ctrl_panel_applets_uam__WEBPACK_IMPORTED_MODULE_40__=__webpack_require__(2565),_conf_scm__WEBPACK_IMPORTED_MODULE_41__=__webpack_require__(4101),_sys_net_rcon__WEBPACK_IMPORTED_MODULE_42__=__webpack_require__(6482),_kernel_host_host_features__WEBPACK_IMPORTED_MODULE_43__=__webpack_require__(6110),_boot_rescue_krescue__WEBPACK_IMPORTED_MODULE_44__=__webpack_require__(119),_os_log__WEBPACK_IMPORTED_MODULE_46__=__webpack_require__(2177),_fs_fake_localstorage__WEBPACK_IMPORTED_MODULE_45__=__webpack_require__(3451);console.group("[ boot ]");const currentVersion=_os_release__WEBPACK_IMPORTED_MODULE_13__.d.getVersion(),currentVersionStr=_os_release__WEBPACK_IMPORTED_MODULE_13__.d.getVersionString(),kEnv={kmainCalled:!1,usesLocalStorage:!1,lsExtractIgnoreExts:[".jpg",".png"],installMode:!1,customRootfsImage:localStorage.getItem("rootfs-name")||null,useFastBoot:localStorage.getItem("fastboot")||!1,systemType:_os_release__WEBPACK_IMPORTED_MODULE_13__.d.getType(),displayDebugConsole:"true"==localStorage.getItem("debug-console")||null,usp:new URLSearchParams(window.location.search)};try{if(!window.localStorage)throw new Error;if("1"==kEnv.usp.get("fake_lstor"))throw new Error}catch(e){Object.defineProperty(window,"localStorage",{value:new _fs_fake_localstorage__WEBPACK_IMPORTED_MODULE_45__.O}),console.warn("No valid local storage has been found!")}"1"==kEnv.usp.get("disable_idb")&&(Object.defineProperty(window,"indexedDB",{value:null}),Object.defineProperty(window,"localStorageDB",{value:{removeItem:()=>{},getItem:()=>{},setItem:()=>{},setItemAsync:()=>{}}})),"1"==kEnv.usp.get("disable_wasm")&&Object.defineProperty(window,"WebAssembly",{value:null}),null==localStorage.fastboot&&(localStorage.fastboot=!0);const svcMgr=new _os_svc_servicemgr__WEBPACK_IMPORTED_MODULE_26__.W,sysLog=new _os_log__WEBPACK_IMPORTED_MODULE_46__.K;let coverElem=null,biosConfig;const sleep=e=>new Promise((t=>setTimeout(t,e)));function kpause(e){return new Promise(((t,i)=>{if(kEnv.useFastBoot&&!(0,_flags__WEBPACK_IMPORTED_MODULE_32__.yE)("no_fastboot"))return t();setTimeout((function(){t()}),e)}))}function fetchResourceAsBinary(t){return new Promise(((i,r)=>{try{fetch(t,{cache:"no-cache"}).catch((t=>{i({success:!1,data:null,error:e})})).then((async e=>{200!=e.status?i({success:!1,data:null,error:e.status}):i({success:!0,data:await e.arrayBuffer(),error:null})}))}catch(e){i({success:!1,data:null,error:e})}}))}async function importApp(e,t,i,r,n,o={}){_os_reg_app__WEBPACK_IMPORTED_MODULE_6__.c.register({command:t,filters:i,cls:r[e],meta:n,type:o.type||"gui"})}async function kmain(kargs){if((kEnv.displayDebugConsole||"1"==kEnv.usp.get("debug"))&&_kernel_debug_conoverlay__WEBPACK_IMPORTED_MODULE_27__.o.init(),kargs=null==kargs?{boot_type:"normal"}:kargs,kEnv.kmainCalled)throw new _kernel_kerror__WEBPACK_IMPORTED_MODULE_3__.e("kmain() has already been called.");kEnv.kmainCalled=!0,kEnv.installMode||_kernel_iip__WEBPACK_IMPORTED_MODULE_24__.T.registerHandler();let convga=document.getElementById("convga");switch(kEnv.installMode&&(convga.style.display="none"),kargs.boot_type){default:console.error("Invalid boot type! Defaulting to normal..."),kargs.boot_type="normal";break;case"normal":break;case"mini":return void kinitGui(new _kernel_console__WEBPACK_IMPORTED_MODULE_2__.E(convga),!1)}if(!window.localStorage)return void await(0,_kernel_bsod__WEBPACK_IMPORTED_MODULE_47__.A)("Your browser does not support localStorage, a required feature for storing data.");if(!await _kernel_events__WEBPACK_IMPORTED_MODULE_12__.K.early_init(kargs,{versionInfo:{currentVer:currentVersion}}))return;(0,_flags__WEBPACK_IMPORTED_MODULE_32__.yE)("disable_sw")?await _pwa__WEBPACK_IMPORTED_MODULE_22__.P.unregisterServiceWorkers():_pwa__WEBPACK_IMPORTED_MODULE_22__.P.init(),(0,_flags__WEBPACK_IMPORTED_MODULE_32__.yE)("simulate_missing_idb")&&Object.defineProperty(window,"indexedDB",{get:function(){}}),(0,_flags__WEBPACK_IMPORTED_MODULE_32__.yE)("simulate_no_wasm")&&Object.defineProperty(window,"WebAssembly",{get:function(){}}),showIntro();const klog=new _kernel_console__WEBPACK_IMPORTED_MODULE_2__.E(convga),newBootscreen=!(0,_flags__WEBPACK_IMPORTED_MODULE_32__.yE)("disable_new_bootscreen");newBootscreen?(klog.el.classList.add("boot-new"),klog.println_styled(`<span class="con-bold con-sysinfo-wrap"><div class="con-line"></div><br><div class="con-sysinfo">MIKESOFT Windows 96 Kernel version ${currentVersionStr} (${_os_release__WEBPACK_IMPORTED_MODULE_13__.d.getReleaseChannel()}/${kEnv.systemType}).<br>Copyright (C) Windows 96 Team 2022.<br></div><div class="con-line"></div></span><br>`,"color: cyan;")):klog.println_styled(`<span class="con-bold">▄▀▄▀▄▀▄▀▄▀▄▀▄▀▄▀▄▀▄▀▄▀▄▀▄▀▄▀▄▀▄▀▄▀▄▀▄▀▄▀▄▀<br>MIKESOFT Windows 96 Kernel version ${currentVersionStr} (${_os_release__WEBPACK_IMPORTED_MODULE_13__.d.getReleaseChannel()}/${kEnv.systemType}).<br>Copyright (C) Windows 96 Team 2022.<br>▄▀▄▀▄▀▄▀▄▀▄▀▄▀▄▀▄▀▄▀▄▀▄▀▄▀▄▀▄▀▄▀▄▀▄▀▄▀▄▀▄▀</span><br>`,"color: crimson;"),(0,_flags__WEBPACK_IMPORTED_MODULE_32__.yE)("disable_syslog")&&sysLog.setSilenced(!0),sysLog.log("Boot Started with environment "+JSON.stringify(kEnv),"Kernel","info"),localStorage.setItem("w96ver",currentVersion),sysLog.log("Set current OS version to "+currentVersion,"Kernel","info"),window.onerror=function(e){klog.error(e),sysLog.log("Exception Caught: "+new String(e),"System","error")},klog.println_styled("User-Agent: "+navigator.userAgent,"color: yellow"),klog.println_styled("Hash: "+(""==window.location.hash?"None":window.location.hash),"color: yellow"),klog.println_styled("Server: "+window.location.href,"color: yellow"),klog.println_styled("Kernel: "+_kernel_kerninfo__WEBPACK_IMPORTED_MODULE_11__.v.name+" ("+_kernel_kerninfo__WEBPACK_IMPORTED_MODULE_11__.v.branch+"-"+_kernel_kerninfo__WEBPACK_IMPORTED_MODULE_11__.v.status+")<br>","color: yellow");const fstr=_kernel_host_host_features__WEBPACK_IMPORTED_MODULE_43__.o.getAll().join(", ");if(klog.println_styled("Detected Features: "+fstr,"color: dodgerblue"),klog.println_styled("JSCL: "+kutil.cl.determineCL()+"<br>","color: dodgerblue"),"1"===localStorage.getItem("encr-stage")&&"true"!=localStorage.getItem("backup_mode_reboot"))return _kernel_iip__WEBPACK_IMPORTED_MODULE_24__.T.launchIPrompt();if(klog.println_styled('Press <span class="con-bold">[ALT + I]</span> to start recovery mode, <span class="con-bold">[ALT + O]</span> to trigger OS installer.<br>',"color: lime;"),kEnv.installMode||"1"===kEnv.usp.get("faster")||await(0,_util_std__WEBPACK_IMPORTED_MODULE_48__.Dc)(1200),_kernel_iip__WEBPACK_IMPORTED_MODULE_24__.T.deregisterHandler(),_kernel_iip__WEBPACK_IMPORTED_MODULE_24__.T.hasEntered())return;await kpause(500);const cryptoMode="2"===localStorage.getItem("encr-stage");klog.println("[kmain] Mounting C:/ system drive...");try{if("1"==kEnv.usp.get("live"))sysLog.log("Live mode engaged!","Kernel","info"),klog.println("[kmain] Live mode has been engaged."),_kernel_kerninfo__WEBPACK_IMPORTED_MODULE_11__.v.rootfsUrl="system/images/rootfs/rootfs.zip",await _fs_webfs__WEBPACK_IMPORTED_MODULE_4__.FS.mount(new _fs_filesystems_fs_ram__WEBPACK_IMPORTED_MODULE_23__.s("c:")),await _fs_webfs__WEBPACK_IMPORTED_MODULE_4__.FS.mount(new _fs_filesystems_fs_ram__WEBPACK_IMPORTED_MODULE_23__.s("b:"));else if(kEnv.installMode)await _fs_webfs__WEBPACK_IMPORTED_MODULE_4__.FS.mount(new _fs_filesystems_fs_ram__WEBPACK_IMPORTED_MODULE_23__.s("c:"));else if(window.indexedDB){if(cryptoMode){const e=document.createElement("div");e.style.backgroundColor="#0008",e.style.width="100vw",e.style.height="100vh",e.style.position="absolute",e.style.top="0px",e.style.left="0px",e.style.zIndex="8",e.style.overflow="hidden",e.classList.add("w96-predesk-ui"),document.body.appendChild(e),_gui_wndsystem__WEBPACK_IMPORTED_MODULE_1__.C$.setWindowContainer(e);let t=new _fs_webfs__WEBPACK_IMPORTED_MODULE_4__.EncryptedFileSystem("c:",null);for(;;){if(t.password=await new Promise((async e=>{_gui_dlgcreator__WEBPACK_IMPORTED_MODULE_37__.O.prompt("This computer is configured to require a password in order to start up. Please enter the Startup Password below.",{title:"Startup Password",noComments:!0,isPassword:!0,maxWidth:"300px",icon:"/system/resource/icons/win96/32x32/devices/computer-alt.png"},e)})),null===t.password)return await sleep(300),reboot();await t._getKey();let e=await t._testEncryption();if(e)break;await sleep(300)}await _fs_webfs__WEBPACK_IMPORTED_MODULE_4__.FS.mount(t),document.body.removeChild(e)}else await _fs_webfs__WEBPACK_IMPORTED_MODULE_4__.FS.mount(new _fs_webfs__WEBPACK_IMPORTED_MODULE_4__.IndexedFileSystem("c:"));await _fs_webfs__WEBPACK_IMPORTED_MODULE_4__.FS.mount(new _fs_webfs__WEBPACK_IMPORTED_MODULE_4__.IndexedFileSystem("b:"))}else klog.warn("WARNING: Your browser does not support IndexedDB\n         --\x3e This may have negative implications during your session and will not let you install complex applications.\n         --\x3e LocalStorage will be used as a fallback, which only holds up to 10 megabytes per origin (aka website).\n         --\x3e Please upgrade your browser for a better experience."),await _fs_webfs__WEBPACK_IMPORTED_MODULE_4__.FS.mount(new _fs_webfs__WEBPACK_IMPORTED_MODULE_4__.LocalStorageFileSystem("c:")),await _fs_webfs__WEBPACK_IMPORTED_MODULE_4__.FS.mount(new _fs_webfs__WEBPACK_IMPORTED_MODULE_4__.LocalStorageFileSystem("b:")),kEnv.usesLocalStorage=!0,sysLog.log("indexedDB FS initialization failure","Kernel","warning")}catch(e){return klog.error(new String(e)),void klog.error("[kmain] Could not mount C:/, system halted.")}await _os_release__WEBPACK_IMPORTED_MODULE_13__.d.isLegacyV2()&&(_kernel_kerninfo__WEBPACK_IMPORTED_MODULE_11__.v.rootfsUrl="/system/images/rootfs/oobe.zip"),kEnv.usp.has("rootfs")&&(_kernel_kerninfo__WEBPACK_IMPORTED_MODULE_11__.v.rootfsUrl=kEnv.usp.get("rootfs"));let ramfs=new _fs_filesystems_fs_ram__WEBPACK_IMPORTED_MODULE_23__.s("z:");if(await _fs_webfs__WEBPACK_IMPORTED_MODULE_4__.FS.mount(ramfs),ramfs.features.push(_fs_features__WEBPACK_IMPORTED_MODULE_17__.f.hidden),await _fs_webfs__WEBPACK_IMPORTED_MODULE_4__.FS.mount(new _fs_webfs__WEBPACK_IMPORTED_MODULE_4__.SysROMFileSystem("X:")),_fs_webfs__WEBPACK_IMPORTED_MODULE_4__.FS.get("b:")&&_fs_webfs__WEBPACK_IMPORTED_MODULE_4__.FS.get("b:").features.push(_fs_features__WEBPACK_IMPORTED_MODULE_17__.f.hidden),"true"!=localStorage.getItem("backup_mode_reboot")||kEnv.installMode){if(null!=localStorage.getItem("restore_image")){const e=URL.createObjectURL(await _fs_webfs__WEBPACK_IMPORTED_MODULE_4__.FS.toBlob(localStorage.getItem("restore_image")));try{let e=await _fs_webfs__WEBPACK_IMPORTED_MODULE_4__.FS.readdir("c:/");for(let t of e)if(await _fs_webfs__WEBPACK_IMPORTED_MODULE_4__.FS.isFile(t))await _fs_webfs__WEBPACK_IMPORTED_MODULE_4__.FS.rm(t);else{if(t.toLowerCase()==localStorage.getItem("restore_image").toLowerCase())continue;await _fs_webfs__WEBPACK_IMPORTED_MODULE_4__.FS.rmdir(t)}}catch(e){console.error(e)}localStorage.clear(),(0,_boot_gfxboot__WEBPACK_IMPORTED_MODULE_49__.U6)(klog.el,newBootscreen),(0,_boot_gfxboot__WEBPACK_IMPORTED_MODULE_49__.H6)(0),klog.println_styled("[ i ]: System restore mode has been engaged. Do NOT restart, you WILL lose your data!","color: cyan"),klog.println_styled("       -> Restore will proceed in 5 seconds.\n","color: cyan"),await(0,_util_std__WEBPACK_IMPORTED_MODULE_48__.Dc)(5e3),klog.println("Restoring, this may take a while...\n");try{await(0,_util_zip__WEBPACK_IMPORTED_MODULE_25__.N)(e)}catch(e){return klog.error("Error reading ZIP file. Restore aborted."),void localStorage.removeItem("restore_image")}localStorage.removeItem("restore_image");const t=JSON.parse(await _fs_webfs__WEBPACK_IMPORTED_MODULE_4__.FS.readstr("c:/local-storage"));for(let e of Reflect.ownKeys(t))localStorage[e]=t[e];klog.println_styled("\n\nRestore finished! Rebooting in 5 seconds...");for(var i=0;i<500;i++)(0,_boot_gfxboot__WEBPACK_IMPORTED_MODULE_49__.H6)(100-i/5),await sleep(10);(0,_boot_gfxboot__WEBPACK_IMPORTED_MODULE_49__.H6)(0),document.location.reload()}}else{localStorage.setItem("backup_mode_reboot",""),(0,_boot_gfxboot__WEBPACK_IMPORTED_MODULE_49__.U6)(klog.el,newBootscreen),(0,_boot_gfxboot__WEBPACK_IMPORTED_MODULE_49__.H6)(0),klog.println_styled("[ i ]: System backup mode has been engaged. It is recommended to let the backup finish cleanly.","color: cyan"),klog.println_styled("       -> The backup result log will be stored in B:/backprg.log","color: cyan"),klog.println_styled("       -> The generated ZIP file will be available upon completion.","color: cyan"),klog.println_styled("       -> Backup will proceed in 5 seconds.\n","color: cyan"),await(0,_util_std__WEBPACK_IMPORTED_MODULE_48__.Dc)(5e3),klog.println("Backing up C:/...\n");const e=new JSZip,t=(await _fs_webfs__WEBPACK_IMPORTED_MODULE_4__.FS.walk("c:/")).map((e=>e.substring(3,e.length)));let r=t.length,n=0;for(let i of t){const t="c:/"+i;if(n++,await _fs_webfs__WEBPACK_IMPORTED_MODULE_4__.FS.isFile(t))try{await e.file(i,await _fs_webfs__WEBPACK_IMPORTED_MODULE_4__.FS.readbin(t)),klog.println_styled(`+ [ ${n} / ${r} ]: Added ${t}`,"color: lime"),(0,_boot_gfxboot__WEBPACK_IMPORTED_MODULE_49__.H6)(n/r*100*.9)}catch(e){console.log("Error zipping contents.")}}klog.println_styled("+ [ storing local storage ]","color: lime");try{const t=JSON.stringify(localStorage);await e.file("local-storage",t)}catch(e){klog.error(new String(e))}klog.println_styled("\nGenerating ZIP file - this may take a long time! Do NOT close this window during generation and download of backup ZIP.");const o=await e.generateAsync({type:"blob"}),s=URL.createObjectURL(o),a=document.createElement("a");a.href=s,a.click(),(0,_boot_gfxboot__WEBPACK_IMPORTED_MODULE_49__.H6)(100);for(var i=0;i<600;i++)100==i&&klog.println_styled("\n\nBackup complete! Please allow your download to finish or you will experience corruption! Continuing boot in 5 seconds..."),(0,_boot_gfxboot__WEBPACK_IMPORTED_MODULE_49__.H6)(100-i/6),await sleep(10);if((0,_boot_gfxboot__WEBPACK_IMPORTED_MODULE_49__.H6)(0),"1"===localStorage.getItem("encr-stage"))return localStorage.setItem("encr-bkp-done",1),reboot()}localStorage.removeItem("encr-bkp-done"),klog.println("[kmain] Mounting W:/ root drive...");try{if(!(0,_flags__WEBPACK_IMPORTED_MODULE_32__.yE)("sys_ignore_mount")||kEnv.installMode){const e=new _fs_webfs__WEBPACK_IMPORTED_MODULE_4__.RemoteReadOnlyFileSystem("w:","/system/images/rofs.json");e.volumeLabel="Win96",await _fs_webfs__WEBPACK_IMPORTED_MODULE_4__.FS.mount(e)}}catch(e){klog.warn("Could not mount W:/, continuing anyway...")}let fs_root=_fs_webfs__WEBPACK_IMPORTED_MODULE_4__.FS.get("c:");if(fs_root.volumeLabel="System",!await _kernel_events__WEBPACK_IMPORTED_MODULE_12__.K.init(klog,fs_root))return;if(await _conf_scm__WEBPACK_IMPORTED_MODULE_41__.F.loadAll(),await fs_root.exists("/system/etc/volmgr.cfg")&&"true"!=localStorage.getItem("volmgr_bypass")&&(klog.println("[kmain] Initializing volumes..."),await _kernel_volmgr__WEBPACK_IMPORTED_MODULE_10__.l.loadDefinitions(await fs_root.readstr("/system/etc/volmgr.cfg"),klog),fs_root=_fs_webfs__WEBPACK_IMPORTED_MODULE_4__.FS.get("c:"),null==fs_root))return void klog.error("[!] System root is not mounted. Please set `volmgr_bypass` to `true` in local storage to disable the volume manager.");let rfsBuild=await _os_release__WEBPACK_IMPORTED_MODULE_13__.d.getRootFSBuild(),firstBoot=!await fs_root.exists("/system");if(!firstBoot&&rfsBuild<=11700&&await fs_root.exists("/system/wupd/sys_dl.lock")&&await fs_root.rm("/system/wupd/sys_dl.lock"),await fs_root.exists("/system/wupd/sys_dl.lock")||kEnv.installMode)klog.println("[kmain] Rootfs already unpacked, no need to unpack it again.");else{let e;null!=(e=localStorage.getItem("ot-update-url"))?(_kernel_kerninfo__WEBPACK_IMPORTED_MODULE_11__.v.rootfsUrl=e,localStorage.removeItem("ot-update-url")):null!=kEnv.customRootfsImage&&(_kernel_kerninfo__WEBPACK_IMPORTED_MODULE_11__.v.rootfsUrl="system/images/"+kEnv.customRootfsImage+".zip"),klog.println(`[kmain] Downloading latest rootfs from ${_kernel_kerninfo__WEBPACK_IMPORTED_MODULE_11__.v.rootfsUrl} (this could take a while)`);var rootfsReq=await fetchResourceAsBinary(_kernel_kerninfo__WEBPACK_IMPORTED_MODULE_11__.v.rootfsUrl);if(!rootfsReq.success)return void klog.error("Could not fetch rootfs from remote, system halted.");klog.println("[kmain] Rootfs downloaded, unpacking to C:/...<br>")}if(await fs_root.exists("/system/temp")?(await fs_root.rmdir("/system/temp"),await fs_root.mkdir("/system/temp")):await fs_root.mkdir("/system/temp"),(0,_boot_gfxboot__WEBPACK_IMPORTED_MODULE_49__.U6)(klog.el,newBootscreen),(0,_boot_gfxboot__WEBPACK_IMPORTED_MODULE_49__.H6)(0),!await fs_root.exists("/system/wupd/sys_dl.lock")&&!kEnv.installMode){try{if(null!=localStorage.getItem("break_boot"))throw new Error;await async function(){const e=await JSZip.loadAsync(rootfsReq.data),t=Object.keys(e.files);for(let i=0;i<t.length;i++){const r=t[i],n=e.files[r];let o=n.name;if(o.startsWith("/")||(o="/"+o),o.endsWith("/")&&(o=o.substring(0,o.length-1)),!kEnv.usesLocalStorage||!kEnv.lsExtractIgnoreExts.includes(o.substring(o.indexOf(".")))){if(n.dir)await fs_root.mkdir(o),klog.println_styled("[kmain:rootfs] Mkdir C:"+o,"color: #0fa");else{const e=await n.async("uint8array"),t=_fs_webfs__WEBPACK_IMPORTED_MODULE_4__.FSUtil.getParentPath(o);await fs_root.exists(t)||await fs_root.mkdir(t),await fs_root.writebin(o,e);let i=e.length;i>=1024?i=~~(i/1024)+"KB":i+="B",klog.println_styled("[kmain:rootfs] Extracted C:"+o+" ("+i+")","color: #0fa")}(0,_boot_gfxboot__WEBPACK_IMPORTED_MODULE_49__.H6)(.8*Math.floor(i/t.length*100))}}}()}catch(e){return(0,_boot_gfxboot__WEBPACK_IMPORTED_MODULE_49__.lE)("system/resource/boot/logo_broken.png"),console.error(e),klog.el.classList.remove("logo-shown"),void klog.println_styled("\n --&gt; An error occured whilst trying to extract the root file system layout to C:/. <br> --&gt; Please try to clear site data or check your internet connection to see if it fixes the problem.<br> --&gt; If that does not work, please tell a developer at <a href='https://discord.gg/KCTaM75'>https://discord.gg/KCTaM75</a><br> --&gt; Have a good day!<br><br>System halted.","color: red")}klog.println("<br><br>&gt;&gt; File system successfully extracted.")}if(!firstBoot&&await fs_root.exists("/system/wupd/post"))for(let psName of await fs_root.readdir("/system/wupd/post"))if(rfsBuild<parseInt(_fs_webfs__WEBPACK_IMPORTED_MODULE_4__.FSUtil.fname(psName).split(".")[0],10)){let postScript=await fs_root.readstr(psName);klog.println("Running post-upgrade script "+psName,"color: #af0"),await eval(`(async function(oldBuild, klog){${postScript}})`)(rfsBuild,klog)}(0,_boot_gfxboot__WEBPACK_IMPORTED_MODULE_49__.H6)(80),await kpause(1500),await kmain_stage2(klog,fs_root)}async function showCover(){coverElem=document.createElement("div"),coverElem.style.background="#000",coverElem.style.opacity="0%",coverElem.style.position="absolute",coverElem.style.top="0px",coverElem.style.left="0px",coverElem.style.width="100%",coverElem.style.height="100%",coverElem.style.zIndex="15000000000",coverElem.style.transition=".3s opacity",document.body.appendChild(coverElem),kEnv.installMode||(await sleep(10),coverElem.style.opacity="100%",await sleep(280))}async function hideCover(){if(coverElem){coverElem.style.opacity="0%",await sleep(300);try{document.body.removeChild(coverElem)}catch(e){}}}async function kinitGui(e){const t=document.getElementById("maingfx");if(t.style.display="none",await showCover(),await _fs_webfs__WEBPACK_IMPORTED_MODULE_4__.FS.exists("c:/system/local/bin/uinit_stage2")){if(!await _api_wrt_wrt__WEBPACK_IMPORTED_MODULE_20__.D.runFile("c:/system/local/bin/uinit_stage2",{boxedEnv:{kernel:{maingfx:t,log:e,hideCover,showCover}}}))return}if(_conf_scm__WEBPACK_IMPORTED_MODULE_41__.F.get("System/Session/Shell")||await _conf_scm__WEBPACK_IMPORTED_MODULE_41__.F.setAndSync("System/Session/Shell",{exec:"default"}),await _fs_webfs__WEBPACK_IMPORTED_MODULE_4__.FS.exists("c:/system/local/bin/uinit_stage3")){await _api_wrt_wrt__WEBPACK_IMPORTED_MODULE_20__.D.runFile("c:/system/local/bin/uinit_stage3",{boxedEnv:{kernel:{maingfx:t,log:e,hideCover,showCover}}})||(console.log("Kern interrupt requested by stage3"),await new Promise((e=>{})))}try{e.println("[gui] Initializing theming engine..."),await _gui_shell_theme_theme__WEBPACK_IMPORTED_MODULE_16__.Q.init()}catch(t){e.error(":: [ ! ] Theming engine failed to initialize."),console.error(t)}try{e.println("[gui] Checking logon sequence..."),await execCmd("logon",[],{klog:e,gfxEl:t,coverUtil:{showCover,hideCover},requiresCredentials:_kernel_sam__WEBPACK_IMPORTED_MODULE_35__.Ml,WinLogon:_gui_ui_logon_logonui__WEBPACK_IMPORTED_MODULE_39__.P,askSetPassword:_apps_system_ctrl_panel_applets_uam__WEBPACK_IMPORTED_MODULE_40__.c,setSAMPath:_kernel_sam__WEBPACK_IMPORTED_MODULE_35__.Xr})}catch(t){console.error(t),hideCover(),e.println_styled("\n| An error occured whilst launching the logon program (C:/system/local/bin/logon)\n| The system will not start if this program is not present.\n|\n| System halted.","color: red"),(0,_boot_gfxboot__WEBPACK_IMPORTED_MODULE_49__.lE)("system/resource/boot/logo_broken.png"),await new Promise((()=>{}))}try{e.println("[gui] Reading session config...");const i={exec:"shell36",..._conf_scm__WEBPACK_IMPORTED_MODULE_41__.F.get("System/Session/Shell")};kEnv.installMode?(importApp("SetupWizardApplication","w96-setup",[],await Promise.resolve().then(__webpack_require__.bind(__webpack_require__,117))),await(0,_setup_installerShell__WEBPACK_IMPORTED_MODULE_36__.H)(t)):"default"==i.exec?(e.println("[gui] Init default shell..."),await new Promise((i=>{execCmd("shell36",[],{klog:e,gfxEl:t,shellCompleteCb:i,cover:{show:showCover,hide:hideCover}})}))):await new Promise((r=>{execCmd(i.exec,[],{klog:e,gfxEl:t,shellCompleteCb:r,cover:{show:showCover,hide:hideCover}})}))}catch(t){e.error("Failed to load shell."),console.error(t)}e.println("[gui] Reading Window Manager config...");try{_conf_scm__WEBPACK_IMPORTED_MODULE_41__.F.get("System/WndMan")||await _conf_scm__WEBPACK_IMPORTED_MODULE_41__.F.setAndSync("System/WndMan",_gui_wndsystem__WEBPACK_IMPORTED_MODULE_1__.C$.getConfig()),_gui_wndsystem__WEBPACK_IMPORTED_MODULE_1__.C$.setConfig(_conf_scm__WEBPACK_IMPORTED_MODULE_41__.F.get("System/WndMan"))}catch(t){e.error(":: [ ! ] Unable to read window system configuration!")}(0,_flags__WEBPACK_IMPORTED_MODULE_32__.yE)("disable_wcomp")||_gui_compositor_wincomp__WEBPACK_IMPORTED_MODULE_21__.u.enable(!0),document.body.style.overflow="hidden",await e.close(),t.classList.add("mgfx-main"),t.style.display="block",hideCover()}function showIntro(){console.log(`\n                ########\n              ################\n##          ######..####..######\n##  ##  ########....####....####        Windows 96 v${currentVersionStr} main\n    ############....####....####        --------------------\n..          ####..########..####        http://windows96.net\n..  ..  ....####################\n    ........######..####..######\n..          ####....####....####        Discord: https://discord.gg/KCTaM75\n..  ..  ....####....####....####\n    ........####..########..####        %c[!] Do not paste random code from other users,\n%c##          ####################            %c99/100 times you will be executing something\n%c##  ##  ##########        ######            %cmalicious!\n%c    ##########                ##`,"color: red;","","color: red;","","color: red;","")}async function kmain_stage2(e,t){if(_registry__WEBPACK_IMPORTED_MODULE_5__.nP.setEnv("path","C:/system/local/bin;C:/user/bin;C:/local/bin"),_registry__WEBPACK_IMPORTED_MODULE_5__.nP.setEnv("username","user"),_registry__WEBPACK_IMPORTED_MODULE_5__.nP.setEnv("hostname","computer"),_registry__WEBPACK_IMPORTED_MODULE_5__.nP.setEnv("home","c:/user"),_registry__WEBPACK_IMPORTED_MODULE_5__.nP.setEnv("os_ver",currentVersion),_registry__WEBPACK_IMPORTED_MODULE_5__.nP.setEnv("boot_kernEnv",JSON.stringify(kEnv)),_registry__WEBPACK_IMPORTED_MODULE_5__.nP.setEnv("boot_sysFlags",JSON.stringify((0,_flags__WEBPACK_IMPORTED_MODULE_32__.zM)())),svcMgr){await _fs_webfs__WEBPACK_IMPORTED_MODULE_4__.FS.exists("c:/system/etc/services")||await _fs_webfs__WEBPACK_IMPORTED_MODULE_4__.FS.mkdir("c:/system/etc/services");for(let t of await _fs_webfs__WEBPACK_IMPORTED_MODULE_4__.FS.readdir("c:/system/etc/services"))if(t.endsWith(".js"))try{const i=await svcMgr.parse(t);e.println_styled("[stage2] Registering service "+i.id+"...","color: orchid"),await svcMgr.register(i),i.autostart&&await svcMgr.start(i,{kernel:{log:e,env:kEnv}})}catch(i){console.error("Error whilst loading service: "+String(i)),e.println_styled("[stage2 error] Script Error in ["+t+"] --\x3e "+String(i),"color: red")}}if("true"!==localStorage.getItem("no_apps")&&({}.terminal||importApp("NewTerminalApplication","terminal",[],await Promise.resolve().then(__webpack_require__.bind(__webpack_require__,42)))),"true"===localStorage.getItem("no_apps")||kEnv.installMode||({}.p3fs||importApp("P3FileSystemSettingsApplication","p3fs",[],await Promise.resolve().then(__webpack_require__.bind(__webpack_require__,6796))),importApp("KeyManagementApplication","keymgr",[],await Promise.resolve().then(__webpack_require__.bind(__webpack_require__,3872))),{}.pkmgr||importApp("PackageManagerApplication","pkmgr",[],await Promise.resolve().then(__webpack_require__.bind(__webpack_require__,3361))),{}.ctrl||importApp("CtrlApplication","ctrl",[],await Promise.resolve().then(__webpack_require__.bind(__webpack_require__,5910))),{}.p3||_os_reg_app__WEBPACK_IMPORTED_MODULE_6__.c.register({command:"p3",filters:[],cls:_apps_system_p3_settings__WEBPACK_IMPORTED_MODULE_34__.h}),{}.scanwiz||importApp("ScanWizardApp","scanwiz",[],await Promise.resolve().then(__webpack_require__.bind(__webpack_require__,8887))),_os_reg_app__WEBPACK_IMPORTED_MODULE_6__.c.register({command:"__conhost",cls:async function(e,t){let i=t.term;if(i&&e[0]&&_index__WEBPACK_IMPORTED_MODULE_0__.b.wmem.conSH&&_index__WEBPACK_IMPORTED_MODULE_0__.b.wmem.conSH.get(e[0])&&"function"==typeof _index__WEBPACK_IMPORTED_MODULE_0__.b.wmem.conSH.get(e[0]).res)return await new Promise((t=>{let r=_index__WEBPACK_IMPORTED_MODULE_0__.b.wmem.conSH.get(e[0]);r.props&&(r.props.title&&i.wnd.setTitle(r.props.title),r.props.icon&&i.wnd.setWindowIcon(r.props.icon)),r.res({stopHost:t,terminal:i})}))},clsType:"function",type:"cli"})),(0,_boot_gfxboot__WEBPACK_IMPORTED_MODULE_49__.H6)(90),await kpause(500),(0,_boot_gfxboot__WEBPACK_IMPORTED_MODULE_49__.H6)(95),!await _kernel_events__WEBPACK_IMPORTED_MODULE_12__.K.post_init(e))return;_index__WEBPACK_IMPORTED_MODULE_0__.b.evt.sys.on("logon",(async()=>{if(!(0,_flags__WEBPACK_IMPORTED_MODULE_32__.yE)("no_boot_scripts")){if(e.println("[stage2] Reading boot scripts from /system/boot..."),!await t.exists("/system/boot")||await t.isFile("/system/boot"))e.warn("/system/boot is either missing or corrupted, ignoring...");else{await t.exists("/system/boot/sys-auto.js")&&(e.println_styled("[stage2] Reading sys auto script...","color: orchid"),await _api_wrt_wrt__WEBPACK_IMPORTED_MODULE_20__.D.runFile("c:/system/boot/sys-auto.js"));const n=[".js",".wasm",".css"];for(var i of await t.readdir("/system/boot"))try{if(!await t.isFile(i))continue;if("/system/boot/sys-auto.js"==i)continue;const o=_fs_webfs__WEBPACK_IMPORTED_MODULE_4__.FSUtil.getExtension(i);if(!n.includes(o))continue;e.println_styled("[stage2] Reading script "+i+"...","color: orchid");var r="";switch(o){case".js":await _api_wrt_wrt__WEBPACK_IMPORTED_MODULE_20__.D.runFile(i,{envType:"kernel",boxedEnv:{log:e}});break;case".css":r=await t.readstr(i);const n=document.createElement("style");n.innerText=r,n.setAttribute("script",i),document.body.appendChild(n);break;case".wasm":_wasm_wasm__WEBPACK_IMPORTED_MODULE_8__.K.execPrgm(i)}}catch(t){e.println_styled("[stage2 error] Script Error in ["+i+"] --\x3e "+String(t),"color: red")}}e.println("[stage2] Finished reading scripts.")}})),await kinitGui(e);let i={autoconnect:!1};try{await _fs_webfs__WEBPACK_IMPORTED_MODULE_4__.FS.exists(_apps_system_p3_settings__WEBPACK_IMPORTED_MODULE_34__.p)&&(i=JSON.parse(await _fs_webfs__WEBPACK_IMPORTED_MODULE_4__.FS.readstr(_apps_system_p3_settings__WEBPACK_IMPORTED_MODULE_34__.p)))}catch(e){console.error("P3 config parse error",e)}if(_index__WEBPACK_IMPORTED_MODULE_0__.b.net.p3=new _sys_net_p3_import_w96__WEBPACK_IMPORTED_MODULE_18__.d8(i),_sys_net_rcon__WEBPACK_IMPORTED_MODULE_42__.Z.init(),_index__WEBPACK_IMPORTED_MODULE_0__.b.evt.sys.emit("unrestrict"),"undefined"!=typeof FontFace){await t.exists("/system/local/share/fonts")||await t.mkdir("/system/local/share/fonts");const i=[".ttf",".woff",".woff2"];let r=await _fs_webfs__WEBPACK_IMPORTED_MODULE_4__.FS.readdir("c:/system/local/share/fonts");for(let t of r)if(i.includes(_fs_webfs__WEBPACK_IMPORTED_MODULE_4__.FSUtil.getExtension(t).toLowerCase()))try{const i=_fs_webfs__WEBPACK_IMPORTED_MODULE_4__.FSUtil.fname(t),r=i.substring(0,i.indexOf("."));e.println_styled("[stage2] Loading font "+t+" as "+r+"...","color: orchid");const n=new FontFace(r,`url(${URL.createObjectURL(await _fs_webfs__WEBPACK_IMPORTED_MODULE_4__.FS.toBlob(t))})`);n.load().then((()=>document.fonts.add(n)))}catch(t){e.error(new String(t))}}else e.warn("Environment does not support FontFace, will not load fonts.");if(localStorage["product-key"]){(await(0,_sys_os_wpa__WEBPACK_IMPORTED_MODULE_7__.Tn)(localStorage["product-key"])).valid||localStorage.removeItem("product-key")}await _fs_webfs__WEBPACK_IMPORTED_MODULE_4__.FS.exists("c:/system/boot/runonce")||await _fs_webfs__WEBPACK_IMPORTED_MODULE_4__.FS.mkdir("c:/system/boot/runonce");let r=await _fs_webfs__WEBPACK_IMPORTED_MODULE_4__.FS.readdir("c:/system/boot/runonce");for(let e of r)try{_shell_executor__WEBPACK_IMPORTED_MODULE_15__.l.execFile(e)}catch(e){console.error("RunOnce error: "+String(e))}setTimeout((async function(){await _fs_webfs__WEBPACK_IMPORTED_MODULE_4__.FS.rmdir("c:/system/boot/runonce"),await _fs_webfs__WEBPACK_IMPORTED_MODULE_4__.FS.mkdir("c:/system/boot/runonce")}),2e3),await(0,_registry__WEBPACK_IMPORTED_MODULE_5__.kB)(),console.groupEnd(),await _fs_webfs__WEBPACK_IMPORTED_MODULE_4__.FS.exists("c:/system/etc/devprofiles/current.json")&&await _dev_profilemgr__WEBPACK_IMPORTED_MODULE_28__.a.loadProfile("c:/system/etc/devprofiles/current.json"),_gui_shell_theme_theme__WEBPACK_IMPORTED_MODULE_16__.Q.playSound("start"),_events__WEBPACK_IMPORTED_MODULE_14__.p.sys.emit("init-complete");try{_net_crossifr__WEBPACK_IMPORTED_MODULE_19__.f.register(),_net_crossifr__WEBPACK_IMPORTED_MODULE_19__.f.registerBasicEvents()}catch(e){console.error("Failed to register cross iframe communication bridge."),console.error(e)}"true"!=localStorage["ignore-post-sys-checks"]&&("undefined"==typeof indexedDB&&"true"!=localStorage["idb-ignore"]&&(_gui_commdlg__WEBPACK_IMPORTED_MODULE_9__.jC.warning("Storage Error",'<span class="bold-noaa">IndexedDB storage is not available!</span><br><br>\n            This will have negative implications on your Windows 96 experience.<br>\n            <br>\n            Please upgrade to a browser that supports IndexedDB or manually enable it yourself to ensure you get the best experience possible.<br>\n            <br>\n            If you choose to continue, expect performance to suffer greatly and the amount of file storage to be limited.',"I acknowledge").setSize(400,240).dlg.center(),localStorage.setItem("idb-ignore","true")),window.WebAssembly||"true"==localStorage["wasm-ignore"]||(_gui_dlgcreator__WEBPACK_IMPORTED_MODULE_37__.O.alert('<span class="bold-noaa">WebAssembly is not available.</span><br><br>\n            Certain apps such as Monaco will refuse to run, due to their dependence of WebAssembly.<br><br>\n            Other apps may fall back to asm.js, which is <span class="bold-noaa">significantly slower</span> than WASM.<br><br>\n            Please consider upgrading your browser to allow you to use all available apps.',{title:"WebAssembly Error"}),localStorage.setItem("wasm-ignore","true"))),(0,_flags__WEBPACK_IMPORTED_MODULE_32__.yE)("av_svc_disabled")||await _sec_av_anti_virus_svc__WEBPACK_IMPORTED_MODULE_38__.h.initialize(),"undefined"==typeof BatteryManager||void 0===navigator.getBattery||(0,_flags__WEBPACK_IMPORTED_MODULE_32__.yE)("disable_battery_api")||(console.log("Battery API present, will report battery information."),_dev_battery__WEBPACK_IMPORTED_MODULE_29__.q.begin()),kEnv.installMode||execCmd("p3",["--tray"]),(0,_kernel_sam__WEBPACK_IMPORTED_MODULE_35__.E7)()}async function reboot(e){if(e)return document.location.reload();_gui_wndsystem__WEBPACK_IMPORTED_MODULE_1__.C$.closeAllWindows(!1);try{document.querySelector(".user-taskbar").remove();const e=document.querySelector(".user-desktop");for(;e.firstChild;)e.removeChild(e.firstChild);const t=_index__WEBPACK_IMPORTED_MODULE_0__.b.ui.MsgBoxSimple.status("Windows 96","Please wait.."),i=t.wndObject.querySelector("#msg");_index__WEBPACK_IMPORTED_MODULE_0__.b.net.p3&&_index__WEBPACK_IMPORTED_MODULE_0__.b.net.p3.connected&&(i.textContent="Closing open ports and connections..",await _index__WEBPACK_IMPORTED_MODULE_0__.b.net.p3.disconnect()),i.textContent="Windows 96 is shutting down...",t.close()}catch(e){}document.location.reload()}async function execCmd(e,t=[],i=null,r=null){if(!(t instanceof Array))throw new Error("argv must be an array.");if((0,_registry__WEBPACK_IMPORTED_MODULE_5__.K2)(e))return await(0,_registry__WEBPACK_IMPORTED_MODULE_5__.lw)(e,t);const n=r||_registry__WEBPACK_IMPORTED_MODULE_5__.nP.getEnv("path").split(";");for(let r of n){if(!await _fs_webfs__WEBPACK_IMPORTED_MODULE_4__.FS.exists(r))continue;const n=r+"/"+e;if(await _fs_webfs__WEBPACK_IMPORTED_MODULE_4__.FS.exists(n)){const r={boxedEnv:{args:[e,...t],...i||{}},cwd:_fs_webfs__WEBPACK_IMPORTED_MODULE_4__.FSUtil.getParentPath(n)};return i&&i.cwd&&(r.cwd=i.cwd),await _api_wrt_wrt__WEBPACK_IMPORTED_MODULE_20__.D.runFile(n,r)}}throw new Error("Cannot find required command executable.")}async function setKernImage(e){if(null===e)return void localStorage.removeItem("kernel-image");const t=await _fs_webfs__WEBPACK_IMPORTED_MODULE_4__.FS.readstr(e);localStorage.setItem("kernel-image",t)}window.addEventListener("beforeunload",(()=>{_index__WEBPACK_IMPORTED_MODULE_0__.b.net&&_index__WEBPACK_IMPORTED_MODULE_0__.b.net.p3&&_index__WEBPACK_IMPORTED_MODULE_0__.b.net.p3.connected&&_index__WEBPACK_IMPORTED_MODULE_0__.b.net.p3.disconnect()}));const System={execCmd,reboot,setKernImage,latestVersion:_os_release__WEBPACK_IMPORTED_MODULE_13__.d.getLatestVersion,currentVersion:()=>currentVersion,currentVersionStr:()=>currentVersionStr,wmem:{eCachedMetadata:{},clockInt:0},bootFlags:(0,_flags__WEBPACK_IMPORTED_MODULE_32__.zM)(),services:svcMgr,log:sysLog}},120:(e,t,i)=>{"use strict";i.d(t,{A:()=>r});const r={parse:function(e){for(var t=[],i="",r=0,n=0;n<e.length;n++){var o=e[n];switch(r){case 0:if(" "==o){if(""==i)continue;t.push(i),i="";continue}if('"'==o){r=1;continue}i+=o;break;case 1:if('"'==o&&n>0&&"\\"!=e[n-1]){t.push(i),r=0,i="";continue}i+=o}}return""!=i&&t.push(i),t},stripOptions:function(e,t,i){return!!t&&(t.forEach(((r,n)=>{n<e||i.includes(r)&&t.splice(n,1)})),!0)}}},5905:(e,t,i)=>{"use strict";function r(e){for(var t=atob(e.split(",")[1]),i=e.split(",")[0].split(":")[1].split(";")[0],r=new ArrayBuffer(t.length),n=new Uint8Array(r),o=0;o<t.length;o++)n[o]=t.charCodeAt(o);return new Blob([r],{type:i})}function n(e){return new Promise((t=>{var i=new FileReader;i.readAsDataURL(e),i.onloadend=function(){var e=i.result;t(e)}}))}i.d(t,{O:()=>r,y:()=>n})},1602:(e,t,i)=>{"use strict";i.d(t,{X:()=>n});var r=i(5516);function n(e,t,i=!1){return new Promise((n=>{let o=(Math.random()*Number.MAX_SAFE_INTEGER).toString();w96.wmem.conSH||(w96.wmem.conSH=new Map),w96.wmem.conSH.set(o,{res:n,props:{title:e,icon:t,noCBX:i}}),r.xP.execCmd("terminal",[i?"--no-ctrl":"__conhost",i?"__conhost":o,o])}))}},9326:(e,t,i)=>{"use strict";i.d(t,{x:()=>n});const r=[],n=(e,t)=>{r.includes(e)||(r.push(e),console.trace("%c[deprecated]%c %s","font-weight: bold; color: #ffa","color: #ffa",t))}},9471:(e,t,i)=>{"use strict";i.d(t,{K:()=>r});const r={mkElement:function(e,t=[]){const i=document.createElement(e);for(let e of t)i.classList.add(e);return i}}},3978:(e,t,i)=>{"use strict";i.d(t,{V:()=>r});const r={escapeHtml:function(e){return e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#039;")}}},2430:(e,t,i)=>{"use strict";i.d(t,{p:()=>n});const r=["bytes","KB","MB","GB","TB","PB","EB","ZB","YB"];const n={SIZE_MAP:r,getSizeStringFromLength:function(e,t={}){if(1==e)return"1 byte";const i={divisor:1024,precision:1,stopSize:r[r.length-1],...t};let n=parseInt(e,10),o=0;for(;n>=i.divisor&&o<=r.length&&o<r.indexOf(i.stopSize);)n/=i.divisor,o++;return`${o>0?n.toFixed(i.precision):n} ${r[o]}`}}},6841:(e,t,i)=>{"use strict";function r(e,t){return(e||t)&&!(e&&t)}function n(e,t){return Math.floor(Math.random()*t)+e}function o(e){return new Promise((t=>{setTimeout((()=>t()),e)}))}function s(e){return e.startsWith("data:")}function a(e,t,i){return i>t?t:i<e?e:i}function l(e){return!!new RegExp("^(https?:\\/\\/)?((([a-z\\d]([a-z\\d-]*[a-z\\d])*)\\.)+[a-z]{2,}|((\\d{1,3}\\.){3}\\d{1,3}))(\\:\\d+)?(\\/[-a-z\\d%_.~+]*)*(\\?[;&a-z\\d%_.~+=-]*)?(\\#[-a-z\\d_]*)?$","i").test(e)}function c(e){try{let t=e.split(".");return Number(1e4*t[0]+1e3*t[1]+t[2])}catch(e){return-1}}i.d(t,{Dc:()=>o,N5:()=>a,PX:()=>l,TN:()=>n,b2:()=>s,dl:()=>r,hd:()=>c})},3078:(e,t,i)=>{"use strict";i.d(t,{e:()=>a});var r=i(1350),n=i(5690),o=i(3978);let s=!1;const a={cfxRound:(e,t=10,i=8)=>(e/t-e%t/t)*t+i,async p3Connect(){const{p3:e}=w96.net;let t;if(e.connected)return!0;if(!s){t=new r.DI({resizable:!1,center:!0,initialWidth:320,initialHeight:140,title:"Dialing..",taskbar:!1,bodyClass:"p3-dialing",controlBoxStyle:"WS_CBX_NONE"});t.getBodyContainer().innerHTML=`\n                <div class="p3-dialing-header">\n                    <img src="/system/resource/misc/dialing.gif" width="227" height="55">\n                </div>\n                <span>Connecting to ${o.V.escapeHtml(e.server)}..</span>\n            `,t.show(),s=!0;let i=!1;try{await w96.net.p3.connect(),i=!0}catch(e){n.O.alert(e.message,{title:"P3 Connection error",icon:"error"})}return t.close(),s=!1,i}try{return await w96.net.p3.connect(),!0}catch(e){return!1}}}},3080:(e,t,i)=>{"use strict";i.d(t,{$:()=>n});var r=i(2589);const n=r.template.constructor({level:3})},9182:(t,i,r)=>{"use strict";r.d(i,{N:()=>o});var n=r(6227);async function o(t){const i=await function(t){return new Promise(((i,r)=>{try{fetch(t).catch((t=>{i({success:!1,data:null,error:e})})).then((async e=>{200!=e.status?i({success:!1,data:null,error:e.status}):i({success:!0,data:await e.arrayBuffer(),error:null})}))}catch(e){i({success:!1,data:null,error:e})}}))}(t),r=n.FS.get("c:");var o=await JSZip.loadAsync(i.data);const s=Object.keys(o.files);for(var a=0;a<s.length;a++){var l=s[a],c=o.files[l],d=c.name;if(d.startsWith("/")||(d="/"+d),d.endsWith("/")&&(d=d.substring(0,d.length-1)),console.log("Write c:"+d),c.dir)await r.mkdir(d);else{var h=await c.async("uint8array"),p=n.FSUtil.getParentPath(d);await r.exists(p)||await r.mkdir(p),await r.writebin(d,h)}}}},1709:(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{S:()=>W96_WASM_IMPORTS_STD});var buf_str=[];function reboot(){document.location.reload()}const strtools={s_reset:function(){buf_str=[]},s_putc:function(e){buf_str.push(String.fromCharCode(e))},s_len:function(){return buf_str.length},buf2str:function(){return buf_str.join("")}},conio={print:function(){console.log(strtools.buf2str())},cls:function(){console.clear()}},misc=function(){return{js_eval:function(){eval(strtools.buf2str())}}}(),W96_WASM_IMPORTS_STD={imports:{reboot,print:conio.print,cls:conio.cls,js_eval:misc.js_eval,s_reset:strtools.s_reset,s_putc:strtools.s_putc,s_len:strtools.s_len}}},9110:(e,t,i)=>{"use strict";i.d(t,{K:()=>s});var r=i(6227),n=i(1709);async function o(e,t=!0){const i=await r.FS.readbin(e);return t?await WebAssembly.instantiate(i,n.S):await WebAssembly.instantiate(i,{imports:{}})}const s={loadLocal:o,execPrgm:async function(e,t=!1){const i=await o(e);if(null==i.instance.exports.main){if(t)return;throw new Error("No valid entry point was found!")}return await i.instance.exports.main()},util:{strconst2wat:function(e,t=!1){var i="call $s_reset\n";for(let t=0;t<e.length;t++)i+="i32.const "+e.charCodeAt(t)+"\ncall $s_putc\n";return t?i:";; == Original String = ["+e+"] ==\n"+i+"\n;; ====================================="}}}},2589:(e,t,i)=>{"use strict";const r=i(3150),n=i(6434),o=i(8555).stdout,s=i(6864),a="win32"===process.platform&&!(process.env.TERM||"").toLowerCase().startsWith("xterm"),l=["ansi","ansi","ansi256","ansi16m"],c=new Set(["gray"]),d=Object.create(null);function h(e,t){t=t||{};const i=o?o.level:0;e.level=void 0===t.level?i:t.level,e.enabled="enabled"in t?t.enabled:e.level>0}function p(e){if(!this||!(this instanceof p)||this.template){const t={};return h(t,e),t.template=function(){const e=[].slice.call(arguments);return g.apply(null,[t.template].concat(e))},Object.setPrototypeOf(t,p.prototype),Object.setPrototypeOf(t.template,t),t.template.constructor=p,t.template}h(this,e)}a&&(n.blue.open="[94m");for(const e of Object.keys(n))n[e].closeRe=new RegExp(r(n[e].close),"g"),d[e]={get(){const t=n[e];return f.call(this,this._styles?this._styles.concat(t):[t],this._empty,e)}};d.visible={get(){return f.call(this,this._styles||[],!0,"visible")}},n.color.closeRe=new RegExp(r(n.color.close),"g");for(const e of Object.keys(n.color.ansi))c.has(e)||(d[e]={get(){const t=this.level;return function(){const i=n.color[l[t]][e].apply(null,arguments),r={open:i,close:n.color.close,closeRe:n.color.closeRe};return f.call(this,this._styles?this._styles.concat(r):[r],this._empty,e)}}});n.bgColor.closeRe=new RegExp(r(n.bgColor.close),"g");for(const e of Object.keys(n.bgColor.ansi)){if(c.has(e))continue;d["bg"+e[0].toUpperCase()+e.slice(1)]={get(){const t=this.level;return function(){const i=n.bgColor[l[t]][e].apply(null,arguments),r={open:i,close:n.bgColor.close,closeRe:n.bgColor.closeRe};return f.call(this,this._styles?this._styles.concat(r):[r],this._empty,e)}}}}const u=Object.defineProperties((()=>{}),d);function f(e,t,i){const r=function(){return _.apply(r,arguments)};r._styles=e,r._empty=t;const n=this;return Object.defineProperty(r,"level",{enumerable:!0,get:()=>n.level,set(e){n.level=e}}),Object.defineProperty(r,"enabled",{enumerable:!0,get:()=>n.enabled,set(e){n.enabled=e}}),r.hasGrey=this.hasGrey||"gray"===i||"grey"===i,r.__proto__=u,r}function _(){const e=arguments,t=e.length;let i=String(arguments[0]);if(0===t)return"";if(t>1)for(let r=1;r<t;r++)i+=" "+e[r];if(!this.enabled||this.level<=0||!i)return this._empty?"":i;const r=n.dim.open;a&&this.hasGrey&&(n.dim.open="");for(const e of this._styles.slice().reverse())i=e.open+i.replace(e.closeRe,e.open)+e.close,i=i.replace(/\r?\n/g,`${e.close}$&${e.open}`);return n.dim.open=r,i}function g(e,t){if(!Array.isArray(t))return[].slice.call(arguments,1).join(" ");const i=[].slice.call(arguments,2),r=[t.raw[0]];for(let e=1;e<t.length;e++)r.push(String(i[e-1]).replace(/[{}\\]/g,"\\$&")),r.push(String(t.raw[e]));return s(e,r.join(""))}Object.defineProperties(p.prototype,d),e.exports=p(),e.exports.supportsColor=o,e.exports.default=e.exports},6864:e=>{"use strict";const t=/(?:\\(u[a-f\d]{4}|x[a-f\d]{2}|.))|(?:\{(~)?(\w+(?:\([^)]*\))?(?:\.\w+(?:\([^)]*\))?)*)(?:[ \t]|(?=\r?\n)))|(\})|((?:.|[\r\n\f])+?)/gi,i=/(?:^|\.)(\w+)(?:\(([^)]*)\))?/g,r=/^(['"])((?:\\.|(?!\1)[^\\])*)\1$/,n=/\\(u[a-f\d]{4}|x[a-f\d]{2}|.)|([^\\])/gi,o=new Map([["n","\n"],["r","\r"],["t","\t"],["b","\b"],["f","\f"],["v","\v"],["0","\0"],["\\","\\"],["e",""],["a",""]]);function s(e){return"u"===e[0]&&5===e.length||"x"===e[0]&&3===e.length?String.fromCharCode(parseInt(e.slice(1),16)):o.get(e)||e}function a(e,t){const i=[],o=t.trim().split(/\s*,\s*/g);let a;for(const t of o)if(isNaN(t)){if(!(a=t.match(r)))throw new Error(`Invalid Chalk template style argument: ${t} (in style '${e}')`);i.push(a[2].replace(n,((e,t,i)=>t?s(t):i)))}else i.push(Number(t));return i}function l(e){i.lastIndex=0;const t=[];let r;for(;null!==(r=i.exec(e));){const e=r[1];if(r[2]){const i=a(e,r[2]);t.push([e].concat(i))}else t.push([e])}return t}function c(e,t){const i={};for(const e of t)for(const t of e.styles)i[t[0]]=e.inverse?null:t.slice(1);let r=e;for(const e of Object.keys(i))if(Array.isArray(i[e])){if(!(e in r))throw new Error(`Unknown Chalk style: ${e}`);r=i[e].length>0?r[e].apply(r,i[e]):r[e]}return r}e.exports=(e,i)=>{const r=[],n=[];let o=[];if(i.replace(t,((t,i,a,d,h,p)=>{if(i)o.push(s(i));else if(d){const t=o.join("");o=[],n.push(0===r.length?t:c(e,r)(t)),r.push({inverse:a,styles:l(d)})}else if(h){if(0===r.length)throw new Error("Found extraneous } in Chalk template literal");n.push(c(e,r)(o.join(""))),o=[],r.pop()}else o.push(p)})),n.push(o.join("")),r.length>0){const e=`Chalk template literal is missing ${r.length} closing bracket${1===r.length?"":"s"} (\`}\`)`;throw new Error(e)}return n.join("")}},8168:(e,t,i)=>{var r=i(8874),n={};for(var o in r)r.hasOwnProperty(o)&&(n[r[o]]=o);var s=e.exports={rgb:{channels:3,labels:"rgb"},hsl:{channels:3,labels:"hsl"},hsv:{channels:3,labels:"hsv"},hwb:{channels:3,labels:"hwb"},cmyk:{channels:4,labels:"cmyk"},xyz:{channels:3,labels:"xyz"},lab:{channels:3,labels:"lab"},lch:{channels:3,labels:"lch"},hex:{channels:1,labels:["hex"]},keyword:{channels:1,labels:["keyword"]},ansi16:{channels:1,labels:["ansi16"]},ansi256:{channels:1,labels:["ansi256"]},hcg:{channels:3,labels:["h","c","g"]},apple:{channels:3,labels:["r16","g16","b16"]},gray:{channels:1,labels:["gray"]}};for(var a in s)if(s.hasOwnProperty(a)){if(!("channels"in s[a]))throw new Error("missing channels property: "+a);if(!("labels"in s[a]))throw new Error("missing channel labels property: "+a);if(s[a].labels.length!==s[a].channels)throw new Error("channel and label counts mismatch: "+a);var l=s[a].channels,c=s[a].labels;delete s[a].channels,delete s[a].labels,Object.defineProperty(s[a],"channels",{value:l}),Object.defineProperty(s[a],"labels",{value:c})}s.rgb.hsl=function(e){var t,i,r=e[0]/255,n=e[1]/255,o=e[2]/255,s=Math.min(r,n,o),a=Math.max(r,n,o),l=a-s;return a===s?t=0:r===a?t=(n-o)/l:n===a?t=2+(o-r)/l:o===a&&(t=4+(r-n)/l),(t=Math.min(60*t,360))<0&&(t+=360),i=(s+a)/2,[t,100*(a===s?0:i<=.5?l/(a+s):l/(2-a-s)),100*i]},s.rgb.hsv=function(e){var t,i,r,n,o,s=e[0]/255,a=e[1]/255,l=e[2]/255,c=Math.max(s,a,l),d=c-Math.min(s,a,l),h=function(e){return(c-e)/6/d+.5};return 0===d?n=o=0:(o=d/c,t=h(s),i=h(a),r=h(l),s===c?n=r-i:a===c?n=1/3+t-r:l===c&&(n=2/3+i-t),n<0?n+=1:n>1&&(n-=1)),[360*n,100*o,100*c]},s.rgb.hwb=function(e){var t=e[0],i=e[1],r=e[2];return[s.rgb.hsl(e)[0],100*(1/255*Math.min(t,Math.min(i,r))),100*(r=1-1/255*Math.max(t,Math.max(i,r)))]},s.rgb.cmyk=function(e){var t,i=e[0]/255,r=e[1]/255,n=e[2]/255;return[100*((1-i-(t=Math.min(1-i,1-r,1-n)))/(1-t)||0),100*((1-r-t)/(1-t)||0),100*((1-n-t)/(1-t)||0),100*t]},s.rgb.keyword=function(e){var t=n[e];if(t)return t;var i,o,s,a=1/0;for(var l in r)if(r.hasOwnProperty(l)){var c=r[l],d=(o=e,s=c,Math.pow(o[0]-s[0],2)+Math.pow(o[1]-s[1],2)+Math.pow(o[2]-s[2],2));d<a&&(a=d,i=l)}return i},s.keyword.rgb=function(e){return r[e]},s.rgb.xyz=function(e){var t=e[0]/255,i=e[1]/255,r=e[2]/255;return[100*(.4124*(t=t>.04045?Math.pow((t+.055)/1.055,2.4):t/12.92)+.3576*(i=i>.04045?Math.pow((i+.055)/1.055,2.4):i/12.92)+.1805*(r=r>.04045?Math.pow((r+.055)/1.055,2.4):r/12.92)),100*(.2126*t+.7152*i+.0722*r),100*(.0193*t+.1192*i+.9505*r)]},s.rgb.lab=function(e){var t=s.rgb.xyz(e),i=t[0],r=t[1],n=t[2];return r/=100,n/=108.883,i=(i/=95.047)>.008856?Math.pow(i,1/3):7.787*i+16/116,[116*(r=r>.008856?Math.pow(r,1/3):7.787*r+16/116)-16,500*(i-r),200*(r-(n=n>.008856?Math.pow(n,1/3):7.787*n+16/116))]},s.hsl.rgb=function(e){var t,i,r,n,o,s=e[0]/360,a=e[1]/100,l=e[2]/100;if(0===a)return[o=255*l,o,o];t=2*l-(i=l<.5?l*(1+a):l+a-l*a),n=[0,0,0];for(var c=0;c<3;c++)(r=s+1/3*-(c-1))<0&&r++,r>1&&r--,o=6*r<1?t+6*(i-t)*r:2*r<1?i:3*r<2?t+(i-t)*(2/3-r)*6:t,n[c]=255*o;return n},s.hsl.hsv=function(e){var t=e[0],i=e[1]/100,r=e[2]/100,n=i,o=Math.max(r,.01);return i*=(r*=2)<=1?r:2-r,n*=o<=1?o:2-o,[t,100*(0===r?2*n/(o+n):2*i/(r+i)),100*((r+i)/2)]},s.hsv.rgb=function(e){var t=e[0]/60,i=e[1]/100,r=e[2]/100,n=Math.floor(t)%6,o=t-Math.floor(t),s=255*r*(1-i),a=255*r*(1-i*o),l=255*r*(1-i*(1-o));switch(r*=255,n){case 0:return[r,l,s];case 1:return[a,r,s];case 2:return[s,r,l];case 3:return[s,a,r];case 4:return[l,s,r];case 5:return[r,s,a]}},s.hsv.hsl=function(e){var t,i,r,n=e[0],o=e[1]/100,s=e[2]/100,a=Math.max(s,.01);return r=(2-o)*s,i=o*a,[n,100*(i=(i/=(t=(2-o)*a)<=1?t:2-t)||0),100*(r/=2)]},s.hwb.rgb=function(e){var t,i,r,n,o,s,a,l=e[0]/360,c=e[1]/100,d=e[2]/100,h=c+d;switch(h>1&&(c/=h,d/=h),r=6*l-(t=Math.floor(6*l)),0!=(1&t)&&(r=1-r),n=c+r*((i=1-d)-c),t){default:case 6:case 0:o=i,s=n,a=c;break;case 1:o=n,s=i,a=c;break;case 2:o=c,s=i,a=n;break;case 3:o=c,s=n,a=i;break;case 4:o=n,s=c,a=i;break;case 5:o=i,s=c,a=n}return[255*o,255*s,255*a]},s.cmyk.rgb=function(e){var t=e[0]/100,i=e[1]/100,r=e[2]/100,n=e[3]/100;return[255*(1-Math.min(1,t*(1-n)+n)),255*(1-Math.min(1,i*(1-n)+n)),255*(1-Math.min(1,r*(1-n)+n))]},s.xyz.rgb=function(e){var t,i,r,n=e[0]/100,o=e[1]/100,s=e[2]/100;return i=-.9689*n+1.8758*o+.0415*s,r=.0557*n+-.204*o+1.057*s,t=(t=3.2406*n+-1.5372*o+-.4986*s)>.0031308?1.055*Math.pow(t,1/2.4)-.055:12.92*t,i=i>.0031308?1.055*Math.pow(i,1/2.4)-.055:12.92*i,r=r>.0031308?1.055*Math.pow(r,1/2.4)-.055:12.92*r,[255*(t=Math.min(Math.max(0,t),1)),255*(i=Math.min(Math.max(0,i),1)),255*(r=Math.min(Math.max(0,r),1))]},s.xyz.lab=function(e){var t=e[0],i=e[1],r=e[2];return i/=100,r/=108.883,t=(t/=95.047)>.008856?Math.pow(t,1/3):7.787*t+16/116,[116*(i=i>.008856?Math.pow(i,1/3):7.787*i+16/116)-16,500*(t-i),200*(i-(r=r>.008856?Math.pow(r,1/3):7.787*r+16/116))]},s.lab.xyz=function(e){var t,i,r,n=e[0];t=e[1]/500+(i=(n+16)/116),r=i-e[2]/200;var o=Math.pow(i,3),s=Math.pow(t,3),a=Math.pow(r,3);return i=o>.008856?o:(i-16/116)/7.787,t=s>.008856?s:(t-16/116)/7.787,r=a>.008856?a:(r-16/116)/7.787,[t*=95.047,i*=100,r*=108.883]},s.lab.lch=function(e){var t,i=e[0],r=e[1],n=e[2];return(t=360*Math.atan2(n,r)/2/Math.PI)<0&&(t+=360),[i,Math.sqrt(r*r+n*n),t]},s.lch.lab=function(e){var t,i=e[0],r=e[1];return t=e[2]/360*2*Math.PI,[i,r*Math.cos(t),r*Math.sin(t)]},s.rgb.ansi16=function(e){var t=e[0],i=e[1],r=e[2],n=1 in arguments?arguments[1]:s.rgb.hsv(e)[2];if(0===(n=Math.round(n/50)))return 30;var o=30+(Math.round(r/255)<<2|Math.round(i/255)<<1|Math.round(t/255));return 2===n&&(o+=60),o},s.hsv.ansi16=function(e){return s.rgb.ansi16(s.hsv.rgb(e),e[2])},s.rgb.ansi256=function(e){var t=e[0],i=e[1],r=e[2];return t===i&&i===r?t<8?16:t>248?231:Math.round((t-8)/247*24)+232:16+36*Math.round(t/255*5)+6*Math.round(i/255*5)+Math.round(r/255*5)},s.ansi16.rgb=function(e){var t=e%10;if(0===t||7===t)return e>50&&(t+=3.5),[t=t/10.5*255,t,t];var i=.5*(1+~~(e>50));return[(1&t)*i*255,(t>>1&1)*i*255,(t>>2&1)*i*255]},s.ansi256.rgb=function(e){if(e>=232){var t=10*(e-232)+8;return[t,t,t]}var i;return e-=16,[Math.floor(e/36)/5*255,Math.floor((i=e%36)/6)/5*255,i%6/5*255]},s.rgb.hex=function(e){var t=(((255&Math.round(e[0]))<<16)+((255&Math.round(e[1]))<<8)+(255&Math.round(e[2]))).toString(16).toUpperCase();return"000000".substring(t.length)+t},s.hex.rgb=function(e){var t=e.toString(16).match(/[a-f0-9]{6}|[a-f0-9]{3}/i);if(!t)return[0,0,0];var i=t[0];3===t[0].length&&(i=i.split("").map((function(e){return e+e})).join(""));var r=parseInt(i,16);return[r>>16&255,r>>8&255,255&r]},s.rgb.hcg=function(e){var t,i=e[0]/255,r=e[1]/255,n=e[2]/255,o=Math.max(Math.max(i,r),n),s=Math.min(Math.min(i,r),n),a=o-s;return t=a<=0?0:o===i?(r-n)/a%6:o===r?2+(n-i)/a:4+(i-r)/a+4,t/=6,[360*(t%=1),100*a,100*(a<1?s/(1-a):0)]},s.hsl.hcg=function(e){var t=e[1]/100,i=e[2]/100,r=1,n=0;return(r=i<.5?2*t*i:2*t*(1-i))<1&&(n=(i-.5*r)/(1-r)),[e[0],100*r,100*n]},s.hsv.hcg=function(e){var t=e[1]/100,i=e[2]/100,r=t*i,n=0;return r<1&&(n=(i-r)/(1-r)),[e[0],100*r,100*n]},s.hcg.rgb=function(e){var t=e[0]/360,i=e[1]/100,r=e[2]/100;if(0===i)return[255*r,255*r,255*r];var n,o=[0,0,0],s=t%1*6,a=s%1,l=1-a;switch(Math.floor(s)){case 0:o[0]=1,o[1]=a,o[2]=0;break;case 1:o[0]=l,o[1]=1,o[2]=0;break;case 2:o[0]=0,o[1]=1,o[2]=a;break;case 3:o[0]=0,o[1]=l,o[2]=1;break;case 4:o[0]=a,o[1]=0,o[2]=1;break;default:o[0]=1,o[1]=0,o[2]=l}return n=(1-i)*r,[255*(i*o[0]+n),255*(i*o[1]+n),255*(i*o[2]+n)]},s.hcg.hsv=function(e){var t=e[1]/100,i=t+e[2]/100*(1-t),r=0;return i>0&&(r=t/i),[e[0],100*r,100*i]},s.hcg.hsl=function(e){var t=e[1]/100,i=e[2]/100*(1-t)+.5*t,r=0;return i>0&&i<.5?r=t/(2*i):i>=.5&&i<1&&(r=t/(2*(1-i))),[e[0],100*r,100*i]},s.hcg.hwb=function(e){var t=e[1]/100,i=t+e[2]/100*(1-t);return[e[0],100*(i-t),100*(1-i)]},s.hwb.hcg=function(e){var t=e[1]/100,i=1-e[2]/100,r=i-t,n=0;return r<1&&(n=(i-r)/(1-r)),[e[0],100*r,100*n]},s.apple.rgb=function(e){return[e[0]/65535*255,e[1]/65535*255,e[2]/65535*255]},s.rgb.apple=function(e){return[e[0]/255*65535,e[1]/255*65535,e[2]/255*65535]},s.gray.rgb=function(e){return[e[0]/100*255,e[0]/100*255,e[0]/100*255]},s.gray.hsl=s.gray.hsv=function(e){return[0,0,e[0]]},s.gray.hwb=function(e){return[0,100,e[0]]},s.gray.cmyk=function(e){return[0,0,0,e[0]]},s.gray.lab=function(e){return[e[0],0,0]},s.gray.hex=function(e){var t=255&Math.round(e[0]/100*255),i=((t<<16)+(t<<8)+t).toString(16).toUpperCase();return"000000".substring(i.length)+i},s.rgb.gray=function(e){return[(e[0]+e[1]+e[2])/3/255*100]}},2085:(e,t,i)=>{var r=i(8168),n=i(4111),o={};Object.keys(r).forEach((function(e){o[e]={},Object.defineProperty(o[e],"channels",{value:r[e].channels}),Object.defineProperty(o[e],"labels",{value:r[e].labels});var t=n(e);Object.keys(t).forEach((function(i){var r=t[i];o[e][i]=function(e){var t=function(t){if(null==t)return t;arguments.length>1&&(t=Array.prototype.slice.call(arguments));var i=e(t);if("object"==typeof i)for(var r=i.length,n=0;n<r;n++)i[n]=Math.round(i[n]);return i};return"conversion"in e&&(t.conversion=e.conversion),t}(r),o[e][i].raw=function(e){var t=function(t){return null==t?t:(arguments.length>1&&(t=Array.prototype.slice.call(arguments)),e(t))};return"conversion"in e&&(t.conversion=e.conversion),t}(r)}))})),e.exports=o},4111:(e,t,i)=>{var r=i(8168);function n(e){var t=function(){for(var e={},t=Object.keys(r),i=t.length,n=0;n<i;n++)e[t[n]]={distance:-1,parent:null};return e}(),i=[e];for(t[e].distance=0;i.length;)for(var n=i.pop(),o=Object.keys(r[n]),s=o.length,a=0;a<s;a++){var l=o[a],c=t[l];-1===c.distance&&(c.distance=t[n].distance+1,c.parent=n,i.unshift(l))}return t}function o(e,t){return function(i){return t(e(i))}}function s(e,t){for(var i=[t[e].parent,e],n=r[t[e].parent][e],s=t[e].parent;t[s].parent;)i.unshift(t[s].parent),n=o(r[t[s].parent][s],n),s=t[s].parent;return n.conversion=i,n}e.exports=function(e){for(var t=n(e),i={},r=Object.keys(t),o=r.length,a=0;a<o;a++){var l=r[a];null!==t[l].parent&&(i[l]=s(l,t))}return i}},8874:e=>{"use strict";e.exports={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]}},4680:(e,t,i)=>{"use strict";i.d(t,{Z:()=>a});var r=i(8081),n=i.n(r),o=i(3645),s=i.n(o)()(n());s.push([e.id,'.app-update-ui{font-family:px_sans_serif;font-size:11px;padding:10px}.troll-not-genuine{user-select:none;color:#fff;position:fixed;top:0;left:0;z-index:10000;pointer-events:none}.troll-not-genuine>.right{position:fixed;right:0;top:0}.troll-not-genuine>.bleft{position:fixed;left:0;bottom:28px}.troll-not-genuine>.bright{position:fixed;right:3px;bottom:30px}.cdlg-ofd .exp-file-view,:not(.prompt)>input[type=text],:not(.prompt)>input[type=number],:not(.prompt)>textarea{border-top:1px solid gray;border-left:1px solid gray;border-right:1px solid #dfdfdf;border-bottom:1px solid #dfdfdf;box-shadow:1px 1px #fff,1px 0 #fff,0 1px #fff,inset 1px 1px #000,inset 1px 0 #000,inset 0 1px #000}.wexplorer-app .w96-toolbar>.item>.icon,.titlebar-icon,.start_button,.titlebar-minbutton,.titlebar-maxbutton,.titlebar-closebutton,.notify-icon,.app-mbprograms .item>button,.ctrl-app>.view>.p2>.item>.icon,.devcfg-applet .w96-groupbox>.dp,.w96-tree details>summary>.icon,.w96-tree .item>.icon,.openwith-app>.box>.appbox>.item>.icon{image-rendering:crisp-edges;image-rendering:pixelated}.p3-dialing .p3-dialing-header,.p3-dialing>span{display:flex;align-items:center;justify-content:center;height:50%}.p3-dialing>.p3-dialing-header{background:#b8b8b8}.keymgr,.p3fs-app{display:flex !important;flex-direction:row !important;width:100% !important;padding:0 4px}.p3fs-app{flex-direction:column !important}.keymgr .keymgr-output,.p3fs-app .p3fs-console{display:flex;height:100%;flex-direction:column;width:430px;margin-left:4px;margin-right:4px}.p3fs-app .p3fs-console{width:calc(100% - 8px);overflow:hidden}.p3fs-app .p3fs-console .p3fs-console-out{margin-left:-4px;margin-bottom:4px;margin-top:4px}.keymgr .keymgr-output textarea{height:50%}.keymgr-register{box-sizing:border-box}.keymgr .w96-menubar{margin-bottom:4px}.keymgr .keymgr-main img,.p3fs-app .p3fs-main img{float:left;height:32px}.keymgr>.keymgr-main>span.line{display:block;margin-bottom:4px}.keymgr>.keymgr-main>span:not(.line),.p3fs-app>.p3fs-main>span{display:inline-flex;flex-direction:column;width:calc(50% - 5px - 4px);margin-right:6px;margin-bottom:6px}.keymgr>.keymgr-main>span>select,.keymgr>.keymgr-main>span>input,.p3fs-app>.p3fs-main>span>select,.p3fs-app>.p3fs-main>span>input{height:23px;padding:3px;box-sizing:border-box;margin-top:2px;width:100%}.keymgr>.keymgr-main>.km-buttons{display:flex;width:calc(100% - 8px);justify-content:flex-end;margin-top:2px}.keymgr>.keymgr-main>.km-buttons button{width:73px}.keymgr textarea,.p3fs-app .p3fs-console-out{padding:4px;margin-top:2px;width:100%;height:100%;box-sizing:border-box;resize:none;line-height:inherit;color:lime;line-height:1.1;outline:0;font-size:13px;font-family:fixed_bmp,monospace;background:#000}.p3fs-app .p3fs-console-out{overflow-y:scroll;overflow-x:hidden;height:188px}.keymgr .km-keyinput{height:226px;background:linear-gradient(20deg, #200, #220, #020, #022, #002)}.keymgr .km-register{display:block;margin-top:4px;margin-left:auto}.p3fs-app>.p3fs-main>span>input:focus,.p3fs-app>.p3fs-main>span>select:focus{outline-style:dotted;outline-width:1px;outline-offset:-4px}.dropzone.hlight{outline-style:dotted;outline-offset:-3px;outline-width:1px}.wmsm-app .w96-groupbox{margin-bottom:16px}h2{font-size:22px}.devmgr-app>.w96-tree{height:100%;margin-bottom:2px}.wasmtools-app .readonly-tbox{padding:3px;background:#fff;overflow-y:auto;height:100%;width:100%;line-height:1.35em;box-sizing:border-box}.wasmtools-app .readonly-tbox .line{display:block;width:100%;line-height:1.35em}.password-protected{display:flex;align-items:center;margin-bottom:8px}.password-protected img{height:16px;width:16px;margin-right:8px}.security-app .sec-indented-options{padding-left:20px;box-sizing:border-box}.matrix-app>iframe{height:100%;width:100%;border:none}.matrix-app>iframe{pointer-events:none}.winmp-app{padding:10px;box-sizing:border-box}.winmp-app>.bgrp{margin-left:auto}.winmp-app>.status{margin-top:4px;margin-bottom:16px}.winmp-app>.status>.bold-noaa.success{color:green}.winmp-app>.status>.bold-noaa.idle{color:olive}.winmp-app>.status>.bold-noaa.error{color:maroon}.wmp-notif{position:fixed;bottom:28px;z-index:100000000;font-family:px_sans_serif;font-size:11px;line-height:1.35;pointer-events:none;height:320px;font-size:8px;width:480px}.wmp-notif>.join-msg{width:100%;background-color:rgba(0,192,0,.7);color:#fff;padding:5px;border-style:solid;border-width:1px;border-color:#000;margin:10px;box-sizing:border-box;margin-top:0px}.wmp-notif>.leave-msg{width:100%;background-color:rgba(192,0,0,.7);color:#fff;padding:5px;border-style:solid;border-width:1px;border-color:#000;margin:10px;box-sizing:border-box;margin-top:0px}.wmp-cursor{position:absolute;top:100px;left:100px;font-family:px_sans_serif;font-size:11px;color:#fff;display:flex;flex-direction:row;z-index:100000000;pointer-events:none}.wmp-cursor>.image{background:url(/system/resource/cursors/default.png);height:21px;width:12px}.wmp-cursor>.nick{margin-top:auto;margin-bottom:auto;margin-left:10px;background-color:rgba(0,192,0,.5);padding:5px;border-style:solid;border-color:#00c000;border-width:1px}.winmp-usr-window{background-color:#000}.winmp-usr-window{color:#fff;display:block;padding:20px;box-sizing:border-box}.container-3d{position:absolute;pointer-events:none;display:flex}.container-3d .d3d{transform-style:preserve-3d;transform-origin:center}.container-3d .d3d.text{transform:rotateY(45deg) translateZ(0px)}.app-devtools>.w96-tab-control{height:100%;width:100%}.css3d-test-app{background:#000}.css3d-test-app>.container-3d{height:100%;width:100%}.app-mbprograms{display:flex;flex-direction:column;padding:10px;box-sizing:border-box;overflow-y:auto}.app-mbprograms>.title{font-size:22px;text-align:center;line-height:3;margin-bottom:10px}.app-mbprograms>.icons-aux{flex:1}.app-mbprograms>.icons-aux,.app-mbprograms>.icons{text-align:center}.app-mbprograms .item>button{height:48px;width:48px;background-position:center;background-repeat:no-repeat}.app-mbprograms .item{vertical-align:top;display:inline-block;max-width:48px;margin-bottom:10px;margin-right:10px}.app-mbprograms .item>.text{text-overflow:ellipsis;text-align:center;overflow:hidden;margin-top:5px}.uam-applet,.rcon-applet{padding:10px;box-sizing:border-box}.uam-applet .status.fail{color:red}.uam-applet .status.success{color:green}.uam-applet .pwd-input,.rcon-applet .buttons{margin-top:8px;margin-bottom:16px}.uam-applet .pwd-input>input{width:100%;box-sizing:border-box}.uam-applet .buttons>button:not(:first-child),.rcon-applet .buttons>button{float:right;margin-left:5px}.applet-base,.propwnd-base{box-sizing:border-box}.applet-base>.w96-tab-control,.propwnd-base>.w96-tab-control{flex:1;width:100%;height:100%}.applet-base>.buttons,.propwnd-base>.buttons{padding:5px;width:100%;box-sizing:border-box}.applet-base>.buttons>button,.propwnd-base>.buttons>button{float:right;margin-left:5px;height:23px;width:75px}.applet-base .icon-box,.propwnd-base .icon-box{width:100%;margin-bottom:24px}.applet-base .icon-box .icon,.propwnd-base .icon-box .icon{height:32px;width:32px;display:inline-block;vertical-align:top;margin-right:10px}.applet-base .icon-box .text,.propwnd-base .icon-box .text{display:inline-block;max-width:calc(100% - 48px);word-break:break-word}.applet-base hr,.applet-base .w96-ui-inset-separator,.propwnd-base hr,.propwnd-base .w96-ui-inset-separator{margin-top:10px;margin-bottom:10px}.wizard-app>.container{height:100%;box-sizing:border-box;display:flex;flex-direction:column}.wizard-app>.container>.box{flex:1;height:100%;width:100%;display:flex;flex-direction:row}.wizard-app>.container.page>.box{flex-direction:column}.wizard-app>.container.page>.box>.top{padding:10px;box-sizing:border-box;height:58px;border-bottom:1px solid gray;box-shadow:0px 1px #fff;background-color:#fff;background-repeat:no-repeat;background-position:right}.wizard-app>.container.page>.box>.top>.description{padding-left:10px}.wizard-app>.container.page>.box>.content{padding:22px 44px;padding-bottom:0px}.wizard-app>.container.intro>.box{background-color:#fff}.wizard-app>.container.intro>.box>.graphic{width:163px;height:100%}.wizard-app>.container>.box>.content{padding:10px;box-sizing:border-box;flex:1}.wizard-app>.container.intro>.box>.content>.explain{position:absolute;bottom:58px}.wizard-app>.container.intro>.box>.content>.title{font-size:22px;text-shadow:-1px 0px #000;letter-spacing:1px;margin-bottom:10px}.wizard-app>.container>.buttons{padding:12px;box-sizing:border-box;border-top:1px solid gray;box-shadow:inset 0px 1px #fff;text-align:right}.wizard-app>.container>.buttons>button{width:75px;height:23px}.wizard-app>.container>.buttons>button.cancel{margin-left:10px}@font-face{font-family:"px_sans_serif";src:url("system/resource/fonts/ms_sans_serif.woff") format("woff");src:url("system/resource/fonts/ms_sans_serif.woff") format("woff2");font-weight:normal;font-style:normal}@font-face{font-family:"px_sans_serif";src:url("system/resource/fonts/ms_sans_serif_bold.woff") format("woff");src:url("system/resource/fonts/ms_sans_serif_bold.woff") format("woff2");font-weight:bold;font-style:normal}@font-face{font-family:"tahomapx";src:url("system/resource/fonts/fs-tahoma-8px.woff2") format("woff2")}@font-face{font-family:"fixed_bmp";src:url("system/resource/fonts/fixed_bmp.ttf")}.winsnap-panel{position:fixed;top:5px;right:5px;height:calc(100% - 44px);width:calc(50% - 15px);border-style:solid;border-width:1px;border-color:#000;background:rgba(0,0,0,.1);pointer-events:none;z-index:100000}.winsnap-panel.left{left:5px;right:auto}.winsnap-panel.top{position:fixed;top:5px;height:calc(100% - 44px);width:calc(100% - 14px);left:5px;right:auto}.ui-resizable-e,.ui-resizable-w{cursor:url("system/resource/cursors/rsz_h.png") 10 4,auto !important}.ui-resizable-s,.ui-resizable-n{cursor:url("system/resource/cursors/rsz_v.png") 4 10,auto !important}.ui-resizable-se,.ui-resizable-nw{cursor:url("system/resource/cursors/rsz_d.png") 7 7,auto !important}.ui-resizable-sw,.ui-resizable-ne{cursor:url("system/resource/cursors/rsz_d2.png") 7 7,auto !important}.ui-rotatable-handle{background:url("https://cdn.jsdelivr.net/jquery.ui.rotatable/1.0.1/rotate.png");background-repeat:no-repeat;background-size:100% 100%;height:25px;width:25px;position:absolute}.ui-rotatable-handle-sw{bottom:-27px;left:-27px}.ui-rotatable-handle-nw{top:-27px;left:-27px}.ui-rotatable-handle-se{bottom:-27px;right:-27px}.ui-rotatable-handle-ne{top:-27px;right:-27px}.ui-icon-gripsmall-diagonal-se{background:none}@keyframes close1{0%{transform:scaleY(1)}100%{transform:scaleY(0)}}@keyframes open1{0%{transform:scaleY(0)}100%{transform:scaleY(1)}}.wm-anim-close1{animation:75ms close1 linear}.wm-anim-open1{animation:75ms open1 linear}@keyframes fade-in{0%{opacity:0}100%{opacity:1}}@keyframes fade-out{0%{opacity:1}100%{opacity:0}}.wm-anim-fadein{animation:150ms fade-in linear}.wm-anim-fadeout{animation:150ms fade-out linear}@keyframes rotate-in{0%{opacity:0;transform:rotate(0deg) scale(0)}50%{opacity:0}100%{opacity:1;transform:rotate(360deg) scale(1)}}@keyframes rotate-out{0%{opacity:1;transform:rotate(360deg) scale(1)}50%{opacity:0}100%{opacity:0;transform:rotate(0deg) scale(0)}}.wm-anim-rotatein{animation:300ms rotate-in linear}.wm-anim-rotateout{animation:300ms rotate-out linear}.window-dlg:not(.ui-sortable-helper){display:none;position:absolute;top:100px;left:100px;min-height:19px;min-width:100px;width:640px;height:480px;background-color:var(--3d-obj-color-primary);z-index:10;padding:2px;border:none;border-left:1px solid #dfdfdf;border-top:1px solid #dfdfdf;border-right:1px solid #000;border-bottom:1px solid #000;box-shadow:inset -1px -1px 0px gray,inset 1px 1px 0px #fff;flex-direction:column}.window-dlg:not(.ui-sortable-helper):not(.active).ifr iframe{pointer-events:none !important}.window-dlg:not(.ui-sortable-helper).maximized{border:none;padding:0 !important;box-shadow:none}.window-dlg:not(.ui-sortable-helper).maximized .titlebar-icon{left:3px !important;top:2px !important}.window-dlg:not(.ui-sortable-helper).dragging{background:rgba(0,0,0,0);border-style:solid;box-shadow:none;border-color:#fff;border-width:4px;mix-blend-mode:difference}.window-dlg:not(.ui-sortable-helper).dragging>*{visibility:hidden !important}.window-dlg:not(.ui-sortable-helper).dragging .titlebar>*{visibility:hidden !important}.window-dlg:not(.ui-sortable-helper).winmaximize{-webkit-animation-duration:.1s;animation-duration:.1s}.window-dlg:not(.ui-sortable-helper) .busy{cursor:url("system/resource/cursors/busy.png") 7 11,auto}.window-dlg:not(.ui-sortable-helper) .busy>*{cursor:url("system/resource/cursors/busy.png") 7 11,auto !important;color:gray !important;text-shadow:1px 1px #fff !important;pointer-events:none !important}.window-html{width:100%;height:100%;box-sizing:border-box;padding:0;padding-top:1px;flex:1;overflow:hidden}.window-html-content{width:100%;height:100%;overflow:hidden;display:flex;flex-direction:column;line-height:1.35;font-family:px_sans_serif;font-size:11px}.window-html-content.busy{cursor:url("system/resource/cursors/busy.png") 7 11,auto}.titlebar{background:linear-gradient(to right, #01517D, #539A64);color:#fff;font-family:px_sans_serif;font-size:11px;padding:3px;padding-bottom:2px;font-weight:100;line-height:1.3;box-sizing:border-box;user-select:none}.titlebar-title-disabled{color:silver;background:linear-gradient(to right, #808080, #C0C0C0)}.titlebar-title-disabled .titlebar-comments-btn{color:#fff}.titlebar-icon{background-size:contain;display:inline-block;position:absolute;top:3px;left:4px;height:16px;width:16px}.titlebar-title{display:inline-block;text-overflow:ellipsis;overflow:hidden;white-space:nowrap;max-width:calc(100% - 55px);position:relative;top:2px;text-shadow:-1px 0;letter-spacing:1px;font-weight:400;margin-top:-3px;padding-left:3px;box-sizing:border-box;line-height:1em;height:12px}.titlebar-comments-btn{cursor:url("system/resource/cursors/hand.png") 6 0,auto;position:relative;left:1px;display:inline-block;text-decoration:underline;float:right;margin-right:3px}.titlebar-closebutton{display:inline-block;height:14px;width:16px;float:right;border-style:none;background:url("system/resource/shell/window-ui/close.png");cursor:url("system/resource/cursors/default.png"),auto;position:relative;left:1px}.titlebar-closebutton:active{background:url("system/resource/shell/window-ui/close_off.png")}.titlebar-maxbutton:active{background:url("system/resource/shell/window-ui/maxbutton_off.png")}.titlebar-minbutton:active{background:url("system/resource/shell/window-ui/minbutton_off.png")}.titlebar-maxxed:active{background:url("system/resource/shell/window-ui/maxbutton_maxxed_off.png")}.titlebar-maxbutton{cursor:url("system/resource/cursors/default.png"),auto;position:relative;left:1px;display:inline-block;height:14px;width:18px;float:right;background:url("system/resource/shell/window-ui/maxbutton.png")}.titlebar-maxbutton.wm-cbx-disabled{background-image:url("system/resource/shell/window-ui/maxbutton_disabled.png")}.titlebar-maxxed{background:url("system/resource/shell/window-ui/maxbutton_maxxed.png")}.titlebar-minbutton{cursor:url("system/resource/cursors/default.png"),auto;position:relative;left:1px;display:inline-block;height:14px;width:16px;float:right;background:url("system/resource/shell/window-ui/minbutton.png")}.f-smdrag .window-dlg.dragging{border-style:dotted;border-width:1px;border-color:#202020;mix-blend-mode:normal}.ui-minimize-tempbox{background:rgba(32,32,32,.5);border-style:solid;border-color:#000;border-width:1px;position:absolute}.window-dlg:not(.ui-sortable-helper){padding:3px}.window-dlg:not(.ui-sortable-helper):not(.ui-resizable){padding:2px}.window-dlg:not(.ui-sortable-helper):not(.ui-resizable) .titlebar-icon{top:3px;left:4px}.titlebar-icon{top:4px;left:5px}.w96-panel{background:var(--3d-obj-color-primary);font:11px px_sans_serif}.w96-selection-box-container{height:100%;width:100%;position:absolute;z-index:10}.w96-selection-box-container>.select-box{outline-width:1px;outline-style:dotted;outline-color:invert;position:absolute;pointer-events:none;z-index:10}.desktop-select .window-dlg,.desktop-select .wcontext-menu{pointer-events:none}::-webkit-scrollbar{width:16px}::-webkit-scrollbar:horizontal{height:17px}::-webkit-scrollbar-corner{background:#dfdfdf}::-webkit-scrollbar-track{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width=\'2\' height=\'2\' fill=\'none\' xmlns=\'http://www.w3.org/2000/svg\'%3E%3Cpath fill-rule=\'evenodd\' clip-rule=\'evenodd\' d=\'M1 0H0v1h1v1h1V1H1V0z\' fill=\'silver\'/%3E%3Cpath fill-rule=\'evenodd\' clip-rule=\'evenodd\' d=\'M2 0H1v1H0v1h1V1h1V0z\' fill=\'%23fff\'/%3E%3C/svg%3E")}::-webkit-scrollbar-thumb{background-color:#dfdfdf;box-shadow:inset -1px -1px #0a0a0a,inset 1px 1px #fff,inset -2px -2px gray,inset 2px 2px #dfdfdf}::-webkit-scrollbar-button:horizontal:end:increment,::-webkit-scrollbar-button:horizontal:start:decrement,::-webkit-scrollbar-button:vertical:end:increment,::-webkit-scrollbar-button:vertical:start:decrement{display:block}::-webkit-scrollbar-button:vertical:start{height:17px;background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width=\'16\' height=\'17\' fill=\'none\' xmlns=\'http://www.w3.org/2000/svg\'%3E%3Cpath fill-rule=\'evenodd\' clip-rule=\'evenodd\' d=\'M15 0H0v16h1V1h14V0z\' fill=\'%23DFDFDF\'/%3E%3Cpath fill-rule=\'evenodd\' clip-rule=\'evenodd\' d=\'M2 1H1v14h1V2h12V1H2z\' fill=\'%23fff\'/%3E%3Cpath fill-rule=\'evenodd\' clip-rule=\'evenodd\' d=\'M16 17H0v-1h15V0h1v17z\' fill=\'%23000\'/%3E%3Cpath fill-rule=\'evenodd\' clip-rule=\'evenodd\' d=\'M15 1h-1v14H1v1h14V1z\' fill=\'gray\'/%3E%3Cpath fill=\'silver\' d=\'M2 2h12v13H2z\'/%3E%3Cpath fill-rule=\'evenodd\' clip-rule=\'evenodd\' d=\'M8 6H7v1H6v1H5v1H4v1h7V9h-1V8H9V7H8V6z\' fill=\'%23000\'/%3E%3C/svg%3E")}::-webkit-scrollbar-button:vertical:end{height:17px;background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width=\'16\' height=\'17\' fill=\'none\' xmlns=\'http://www.w3.org/2000/svg\'%3E%3Cpath fill-rule=\'evenodd\' clip-rule=\'evenodd\' d=\'M15 0H0v16h1V1h14V0z\' fill=\'%23DFDFDF\'/%3E%3Cpath fill-rule=\'evenodd\' clip-rule=\'evenodd\' d=\'M2 1H1v14h1V2h12V1H2z\' fill=\'%23fff\'/%3E%3Cpath fill-rule=\'evenodd\' clip-rule=\'evenodd\' d=\'M16 17H0v-1h15V0h1v17z\' fill=\'%23000\'/%3E%3Cpath fill-rule=\'evenodd\' clip-rule=\'evenodd\' d=\'M15 1h-1v14H1v1h14V1z\' fill=\'gray\'/%3E%3Cpath fill=\'silver\' d=\'M2 2h12v13H2z\'/%3E%3Cpath fill-rule=\'evenodd\' clip-rule=\'evenodd\' d=\'M11 6H4v1h1v1h1v1h1v1h1V9h1V8h1V7h1V6z\' fill=\'%23000\'/%3E%3C/svg%3E")}::-webkit-scrollbar-button:horizontal:start{width:16px;background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width=\'16\' height=\'17\' fill=\'none\' xmlns=\'http://www.w3.org/2000/svg\'%3E%3Cpath fill-rule=\'evenodd\' clip-rule=\'evenodd\' d=\'M15 0H0v16h1V1h14V0z\' fill=\'%23DFDFDF\'/%3E%3Cpath fill-rule=\'evenodd\' clip-rule=\'evenodd\' d=\'M2 1H1v14h1V2h12V1H2z\' fill=\'%23fff\'/%3E%3Cpath fill-rule=\'evenodd\' clip-rule=\'evenodd\' d=\'M16 17H0v-1h15V0h1v17z\' fill=\'%23000\'/%3E%3Cpath fill-rule=\'evenodd\' clip-rule=\'evenodd\' d=\'M15 1h-1v14H1v1h14V1z\' fill=\'gray\'/%3E%3Cpath fill=\'silver\' d=\'M2 2h12v13H2z\'/%3E%3Cpath fill-rule=\'evenodd\' clip-rule=\'evenodd\' d=\'M9 4H8v1H7v1H6v1H5v1h1v1h1v1h1v1h1V4z\' fill=\'%23000\'/%3E%3C/svg%3E")}::-webkit-scrollbar-button:horizontal:end{width:16px;background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width=\'16\' height=\'17\' fill=\'none\' xmlns=\'http://www.w3.org/2000/svg\'%3E%3Cpath fill-rule=\'evenodd\' clip-rule=\'evenodd\' d=\'M15 0H0v16h1V1h14V0z\' fill=\'%23DFDFDF\'/%3E%3Cpath fill-rule=\'evenodd\' clip-rule=\'evenodd\' d=\'M2 1H1v14h1V2h12V1H2z\' fill=\'%23fff\'/%3E%3Cpath fill-rule=\'evenodd\' clip-rule=\'evenodd\' d=\'M16 17H0v-1h15V0h1v17z\' fill=\'%23000\'/%3E%3Cpath fill-rule=\'evenodd\' clip-rule=\'evenodd\' d=\'M15 1h-1v14H1v1h14V1z\' fill=\'gray\'/%3E%3Cpath fill=\'silver\' d=\'M2 2h12v13H2z\'/%3E%3Cpath fill-rule=\'evenodd\' clip-rule=\'evenodd\' d=\'M7 4H6v7h1v-1h1V9h1V8h1V7H9V6H8V5H7V4z\' fill=\'%23000\'/%3E%3C/svg%3E")}::-webkit-scrollbar-button:vertical:start:increment,::-webkit-scrollbar-button:vertical:end:decrement,::-webkit-scrollbar-button:horizontal:start:increment,::-webkit-scrollbar-button:horizontal:end:decrement{display:none}a{cursor:url("system/resource/cursors/hand.png") 6 0,auto}select{cursor:url("system/resource/cursors/default.png"),auto}input[type=text],.w96-textbox{cursor:url("system/resource/cursors/i-beam.png") 4 9,auto}.w96-inset,.w96-ui-inset-deep{border-top:1px solid gray;border-left:1px solid gray;border-right:1px solid #dfdfdf;border-bottom:1px solid #dfdfdf;box-shadow:1px 1px #fff,1px 0 #fff,0 1px #fff,inset 1px 1px #000,inset 1px 0 #000,inset 0 1px #000}.bold-noaa{text-shadow:-1px 0;letter-spacing:1px;font-weight:400;margin-left:1px}.w96-ui-inset{border:1px solid #787878;box-shadow:0 1px #fff,1px 1px #fff,1px 0 #fff,inset 0 1px #fff,inset 1px 0 #fff;margin:1px}.w96-ui-inset-separator{display:block;width:100%;border-top:1px solid #787878;border-bottom:1px solid #fff}.shell-icon{z-index:2;position:absolute;left:15px;top:15px;width:70px;display:inline-block;user-select:none;image-rendering:crisp-edges;image-rendering:pixelated}.shell-icon .icon-image{margin:0 auto;margin-bottom:3px;display:flex;height:32px;width:32px;background:none;background-size:contain !important}.shell-icon .icon-image .icon-shortcut-emblem{height:100%;width:100%;position:relative;pointer-events:none;background-size:contain}.shell-icon .icon-text{border-style:dashed;border-width:1px;border-color:rgba(0,0,0,0);left:-5px;max-width:62px;text-shadow:1px 1px #000;text-align:center;word-wrap:break-word;font-family:tahomapx;color:#fff;user-select:none;margin-left:auto;margin-right:auto;font-size:16px;line-height:.7;text-overflow:ellipsis;overflow-wrap:normal;overflow:hidden;padding:2px;padding-top:1px;padding-left:3px}.shell-icon .rename-box{appearance:none;border:1px solid #000;text-align:center;margin-left:auto;margin-right:auto;max-width:62px;outline:none;font-family:tahomapx;font-size:16px;line-height:1em;max-height:18px;box-sizing:border-box}.shell-icon.selected .icon-image{filter:brightness(0.4) contrast(0.8) sepia(100%) hue-rotate(185deg) saturate(4)}.shell-icon.selected .icon-text{border-style:dotted;border-width:1px;border-color:var(--select-color-secondary);background-color:var(--select-color-primary);text-shadow:none;text-overflow:none}.shell-icon.clone-icon{z-index:1000000;pointer-events:none}.shell-icon.clone-icon>.icon-text,.shell-icon.clone-icon>.icon-image{pointer-events:none}.shell-icon.clone-icon>.icon-image{opacity:.6}.w96-listbox{background:#fff;color:#000;font:11px px_sans_serif;border-left:1px solid #9a9a9a;border-top:1px solid #9a9a9a;border-right:1px solid #eee;border-bottom:1px solid #eee;user-select:none;box-sizing:border-box;overflow:auto;line-height:16px}.w96-listbox>.item{text-overflow:ellipsis;width:100%;overflow:hidden;padding:0 5px;box-sizing:border-box}.w96-listbox>.item.selected{background-color:var(--select-color-primary);color:var(--select-color-secondary)}.window-dlg:not(.active) .w96-listbox>.item.selected{background-color:gray}.exp-file-view{box-sizing:border-box;background-color:#fff;position:relative;overflow:auto;display:flex;margin-bottom:3px;margin-top:3px;flex:1;outline:0}.exp-file-view .shell-icon{position:absolute}.exp-file-view .shell-icon.special>.icon-text{color:blue}.exp-file-view .shell-icon.special.selected>.icon-text{color:#fff}.exp-file-view .shell-icon.selected>.icon-text{color:#fff;text-shadow:none}.exp-file-view .shell-icon.inactive>.icon-image{filter:brightness(0.7) contrast(0.9)}.exp-file-view .shell-icon.inactive>.icon-text{background:#b1b1b1}.exp-file-view .shell-icon.ghost{opacity:.5}.exp-file-view.fdrag-box{outline-style:dotted;outline-offset:-3px;outline-width:1px}.exp-file-view.dropzone.hlight{cursor:url("system/resource/cursors/folder-drop.png") 10 15,auto}.exp-file-view.dropzone.hlight .shell-icon[ent="0"]{pointer-events:none}.exp-file-view.view-details{flex-direction:column !important}.exp-file-view.view-details>.shell-icon{flex-direction:row !important;display:flex !important;width:100%;position:static !important}.exp-file-view.view-details>.shell-icon>.icon-image{height:16px;width:16px;margin-left:0;margin-right:1px;margin-top:1px;margin-bottom:1px}.exp-file-view.view-details>.shell-icon>.icon-text{text-align:left;margin-left:0;margin-right:0;flex:1;width:100%;max-width:none;padding-top:2px}.exp-file-view:not(.user-desktop) .icon-text{color:#000;text-shadow:none}.w96-tree{font:11px px_sans_serif;background-color:#fff;overflow-y:auto}.w96-tree details:not(.w96-tree>details){margin-left:24px}.w96-tree details>summary{min-height:18px;line-height:2.2;max-height:18px}.w96-tree details>summary::marker{content:"+ ";font-family:monospace;font-size:11px;line-height:1em}.w96-tree details>summary:not(.w96-tree>details>summary){margin-left:-10px}.w96-tree details>summary>.icon{display:inline-block;height:16px;width:16px;vertical-align:middle;background-image:url(/system/resource/themes/default/icons/small/folder.png);margin-right:4px}.w96-tree details[open]>summary::marker{content:"- "}.w96-tree .item{min-height:18px;line-height:2.2;max-height:18px;margin-left:26px}.w96-tree .item>.icon{display:inline-block;height:16px;width:16px;vertical-align:middle;background-image:url(/system/resource/themes/default/icons/small/folder.png);margin-right:4px}.w96-tree .item:not(.w96-tree>details>.item){margin-left:16px}.w96-graph{position:relative}.w96-graph>canvas{width:100%;height:100%;image-rendering:pixelated}.w96-graph>div{width:100px;height:100%;background:linear-gradient(90deg, #000 0%, #000 60%, rgba(0, 0, 0, 0) 80%, rgba(0, 0, 0, 0) 100%);color:#fff}.w96-graph .w96-graph-el{position:unset;padding:5px}.w96-graph .w96-graph-top{font-size:18px}.w96-graph>*{position:absolute;top:0;left:0}.w96-checkbox{cursor:url("system/resource/cursors/default.png"),auto;margin-bottom:5px;display:inline-block}.w96-checkbox>input[type=checkbox]{appearance:none;appearance:none;-moz-appearance:none;-webkit-appearance:none;vertical-align:text-bottom;margin-right:6px;box-shadow:inset -1px -1px #fff,inset 1px 1px gray,inset -2px -2px #dfdfdf,inset 2px 2px #0a0a0a;height:13px;width:13px;background-color:#fff;image-rendering:pixelated;image-rendering:crisp-edges;background-position:center;background-repeat:no-repeat;cursor:url("system/resource/cursors/default.png"),auto}.w96-checkbox>input[type=checkbox]:checked{background-image:url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAkAAAAJCAQAAABKmM6bAAAAK0lEQVQI12P4z4AOMbhoQiACTIIohAaoEEI5VAqhE0k1sgBcCUIAwxEgCAAIH1CwjD78FAAAAABJRU5ErkJggg==")}.w96-checkbox>input[type=checkbox]:active,.w96-checkbox>input[type=checkbox]:disabled{background-color:var(--3d-obj-color-primary)}.w96-checkbox:last-child{margin-bottom:0px}.w96-radiobox>.option{padding-top:3px;padding-bottom:3px}.w96-radiobox>.option>label{display:inline-block;vertical-align:middle;cursor:inherit}.w96-radiobox>.option>input[type=radio]{border-top:solid 1px #000;border-left:solid 1px #000;border-bottom:solid 1px #bfb7af;border-right:solid 1px #bfb7af;background:#fff;appearance:none;-moz-appearance:none;-webkit-appearance:none;height:12px;width:12px;border-radius:100%;display:inline-block;box-sizing:border-box;vertical-align:middle;cursor:inherit;margin-right:5px}.w96-radiobox>.option>input[type=radio]:checked{background:#000;box-shadow:inset 0px 0px 0px 2px #fff;padding:2px}.wcontext-menu{background:var(--3d-obj-color-primary);border-left:1px solid #dfdfdf;border-top:1px solid #dfdfdf;border-right:1px solid #000;border-bottom:1px solid #000;box-shadow:inset -1px -1px 0px gray,inset 1px 1px 0px #fff;font:11px px_sans_serif;display:inline-block;position:absolute;display:flex;flex-direction:column;min-width:115px;max-width:225px;padding:2px}.wcontext-menu>.item{color:#000;text-overflow:ellipsis;overflow:hidden;padding-right:32px;padding-left:24px;padding-top:1px;line-height:16px}.wcontext-menu>.item.disabled,.wcontext-menu>.item[disabled]{text-shadow:1px 1px #fff;color:#6d6d6d}.wcontext-menu>.item:not([disabled]):hover,.wcontext-menu>.item.selected{color:var(--select-color-secondary);background-color:var(--select-color-primary)}.wcontext-menu>.item.checked{background-image:url("system/resource/ui/controls/menu-check.png");background-position-x:6px;background-position-y:5px;background-repeat:no-repeat}.wcontext-menu>.item.checked:hover{background-image:url("system/resource/ui/controls/menu-check-inverse.png")}.wcontext-menu>.item.hs{padding-right:15px}.wcontext-menu>.item.hs::after{content:url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAQAAAAHCAYAAAAvZezQAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAAAArSURBVBhXYwCC/yACBpigNFwQJgACYEFGGAMGkFWAACOyAEg1GCBpYWAAAGi8BQegB+eXAAAAAElFTkSuQmCC");transform:translateY(-1px);text-align:right;right:7px;position:absolute;text-shadow:-1px 0px #000}.wcontext-menu>.item.hs.selected::after,.wcontext-menu>.item.hs:hover::after{content:url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAQAAAAHCAYAAAAvZezQAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAAAAuSURBVBhXXc3RCgAABEPRzf//M7YouSV1HmB2ANjjYrbQLSjjBZUfeMGHF+YLUK7aBwvYrDVnAAAAAElFTkSuQmCC")}.wcontext-menu>.item.wi{padding-left:22px;background-size:16px 16px;line-height:20px;background-position-x:2px;background-position-y:2px;background-repeat:no-repeat}.wcontext-menu.mbar .item{padding-right:24px;padding-left:24px}.wcontext-menu.mbar .item.hs{padding-left:32px !important}.wcontext-menu.mbar .item.no-icon{padding-left:24px !important}.wcontext-menu>.separator{border-width:1px;margin-left:1px;margin-right:1px;margin-top:3px;margin-bottom:3px;border-left:1px solid #9a9a9a;border-top:1px solid #9a9a9a;border-right:1px solid #eee;border-bottom:1px solid #eee}.w96-menubar{width:100%;height:fit-content;color:#000;line-height:8px}.w96-menubar>.root-item{font-family:px_sans_serif;font-size:11px;padding-left:6px;padding-right:5px;display:inline-block;user-select:none;-moz-user-select:none;-ms-user-select:none;-webkit-user-select:none;cursor:url("system/resource/cursors/default.png"),auto;line-height:18px;margin-bottom:1px;margin-top:1px}.w96-menubar>.root-item:hover{box-shadow:inset -1px -1px gray,inset 1px 1px #fff}.w96-menubar>.root-item.selected{box-shadow:inset -1px -1px #fff,inset 1px 1px gray}.w96-textbox{border-top:1px solid gray;border-left:1px solid gray;border-right:1px solid #dfdfdf;border-bottom:1px solid #dfdfdf;box-shadow:1px 1px #fff,1px 0 #fff,0 1px #fff,inset 1px 1px #000,inset 1px 0 #000,inset 0 1px #000;background-color:#fff;font:11px px_sans_serif;padding:2px;cursor:url("system/resource/cursors/i-beam.png") 4 9,auto;line-height:15px;border-radius:0}.w96-textbox[readonly],.w96-textbox[disabled],.w96-textbox.disabled{background:#d3d3d3;color:gray}.w96-textbox:focus{outline:0}.w96-select{border-top:1px solid gray;border-left:1px solid gray;border-right:1px solid #dfdfdf;border-bottom:1px solid #dfdfdf;box-shadow:1px 1px #fff,1px 0 #fff,0 1px #fff,inset 1px 1px #000,inset 1px 0 #000,inset 0 1px #000;box-sizing:border-box;cursor:url("system/resource/cursors/default.png"),auto;height:20px}.w96-select:focus{outline:0}.w96-button{line-height:1.35;padding:5px;background-color:rgba(0,0,0,0);font-family:px_sans_serif;font-size:11px;padding-top:4px;padding-bottom:3px;padding-left:10px;padding-right:10px;cursor:url("system/resource/cursors/default.png"),auto;background:var(--3d-obj-color-primary);box-shadow:inset -1px -1px #0a0a0a,inset 1px 1px #fff,inset -2px -2px gray,inset 2px 2px #dfdfdf;border:none;outline:0;border-radius:0px}.w96-button[disabled]{text-shadow:1px 1px #fff}.w96-button:not([disabled]):active{box-shadow:inset -1px -1px #fff,inset 1px 1px #0a0a0a,inset -2px -2px #dfdfdf,inset 2px 2px gray}.w96-button:focus{outline-style:dotted;outline-width:1px;outline-offset:-4px}.w96-progressbar{width:100%;height:18px;padding:1px;box-sizing:border-box;border-top:gray solid 1px;border-left:gray solid 1px;border-bottom:#fff solid 1px;border-right:#fff solid 1px}.w96-progressbar>.progress{height:100%;width:10%;background:var(--select-color-primary);display:inline-block;margin-left:0px;animation-name:progress-idle;animation-duration:1s;animation-direction:alternate;animation-iteration-count:infinite;animation-timing-function:linear}@keyframes progress-idle{0%{margin-left:0px}100%{margin-left:90%}}.w96-tab-control{display:flex;flex-direction:column;min-height:100px;min-width:100px}.w96-tab-control>.pages{padding:0px;margin-left:5px;line-height:8px;margin-top:5px;margin-right:5px;font-size:0px}.w96-tab-control>.pages>button{border-top:1px solid #fff;border-left:1px solid #fff;border-right:1px solid gray;border-bottom:1px solid gray;box-shadow:inset 1px 1px #dfdfdf,1px 0 #000,0 1px rgba(0,0,0,0),1px 1px #000;margin-bottom:0px;margin-right:1px;padding:2px;padding-top:3px;padding-bottom:1px;height:19px;font-size:11px;font-family:px_sans_serif;background:rgba(0,0,0,0);border-top-right-radius:3px;border-top-left-radius:3px;padding-left:8px;padding-right:8px;position:relative;top:1px;outline:0;cursor:url(/system/resource/cursors/default.png),auto}.w96-tab-control>.pages>button:not(.active){top:2px;height:calc(100% - 1px);border-bottom-color:#000 !important}.w96-tab-control>.pages>button:not(.active)::after{content:" ";position:absolute;background:#f5f5f5;height:2px;left:-1px;width:calc(100% - 1px);bottom:-2px;z-index:10;border-left-style:solid;border-left-color:#fff;border-left-width:2px;border-right-style:solid;border-right-color:#fff;border-right-width:2px}.w96-tab-control>.pages>button:not(.active):not(:first-child){left:-2px;top:2px}.w96-tab-control>.pages>button.active{border-bottom-color:rgba(0,0,0,0) !important;z-index:1}.w96-tab-control>.pages>button.active::after{content:" ";position:absolute;background:var(--3d-obj-color-primary);height:2px;left:-1px;width:calc(100% - 1px);bottom:-2px;z-index:10;border-left-style:solid;border-left-color:#fff;border-left-width:2px;border-right-style:solid;border-right-color:#fff;border-right-width:2px}.w96-tab-control>.pages>button:not(:first-child){left:-2px}.w96-tab-control>.content{flex:1;border-top:1px solid #fff;border-left:1px solid #fff;border-right:1px solid gray;border-bottom:1px solid gray;box-shadow:inset 1px 1px #dfdfdf,1px 0 #000,0 1px #000,1px 1px #000;margin:5px;margin-top:0px;padding:3px;box-sizing:border-box}.w96-toolbar{width:100%;font-family:px_sans_serif;font-size:11px;box-shadow:inset 0px 1px gray,inset 0px 2px #fff;padding-top:2px;box-sizing:border-box;user-select:none;overflow:hidden}.w96-toolbar>.item{display:inline-flex;vertical-align:top;flex-direction:column}.w96-toolbar>.item>.icon{background-repeat:no-repeat;background-position:center;margin-left:auto;margin-right:auto;margin-top:1px}.w96-toolbar>.item>.text{box-sizing:border-box;text-align:center;line-height:1;text-overflow:ellipsis;overflow:hidden;padding:4px;padding-bottom:3px}.w96-toolbar>.item:not([disabled]):hover{box-shadow:inset -1px -1px #85898d,inset 1px 1px #fff}.w96-toolbar>.item:not([disabled]):active{box-shadow:inset -1px -1px #fff,inset 1px 1px #85898d}.w96-toolbar>.item.item-right{flex-direction:row;padding:2px;margin:1px}.w96-toolbar .vseparator{height:100%;border:none;border-left:1px solid gray;margin-left:4px;margin-right:4px;margin-top:2px;margin-bottom:2px;height:calc(100% - 4px);display:inline-block;box-shadow:1px 0px #fff}.w96-toolbar.compact .vseparator{margin-right:2px;margin-left:1px}.w96-groupbox{border:1px solid #9a9a9a;box-shadow:1px 1px #fff,1px 1px #fff inset;padding:5px;box-sizing:border-box;margin-bottom:8px}.w96-groupbox>.title{transform:translateY(-13px);background:var(--3d-obj-color-primary);display:inline-block;position:absolute}.w96-groupbox>.content{box-sizing:border-box;padding:5px}.icon-opt-select>.option{margin-top:10px}.icon-opt-select>.option>.btn{height:48px;width:48px;display:inline-block;background-position:center;background-repeat:no-repeat}.icon-opt-select>.option>.text{display:inline-block;vertical-align:top;margin-left:5px;max-width:calc(100% - 60px)}.icon-opt-select>.option>.text>.title{display:block;margin-bottom:3px}.w96-footer{border-left:1px solid #9a9a9a;border-top:1px solid #9a9a9a;border-right:1px solid #eee;border-bottom:1px solid #eee;margin-bottom:1px;height:18px;box-sizing:border-box;line-height:16px;display:flex;padding:0;border:none}.w96-footer .cell{padding-left:2px;padding-right:2px;border-left:1px solid gray;border-bottom:1px solid #fff;border-top:1px solid gray;border-right:1px solid #fff;width:100%}.w96-footer .cell:not(:last-child){margin-right:3px;border-right:1px solid #fff}.window-dlg.ui-resizable .w96-footer::after{content:" ";display:block;position:absolute;height:13px;width:13px;background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAA0AAAANCAMAAABFNRROAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAMUExURf///8DAwHt7ewAAAKUp0vgAAAAEdFJOU////wBAKqn0AAAACXBIWXMAAA7DAAAOwwHHb6hkAAAANElEQVQYV03KwQ0AMAgCQLD771y1RSH6uADOBjQhTAhTYdSN1NDy4UtoTVMa5BnyHbndkBeDnQE9KME74wAAAABJRU5ErkJggg==);right:3px;bottom:4px}.w96-table{border-top:1px solid gray;border-left:1px solid gray;border-right:1px solid #dfdfdf;border-bottom:1px solid #dfdfdf;box-shadow:1px 1px #fff,1px 0 #fff,0 1px #fff,inset 1px 1px #000,inset 1px 0 #000,inset 0 1px #000;background:#fff;text-align:left;overflow:auto;box-sizing:border-box;padding:1px;user-select:none}.w96-table table{border-spacing:0;min-width:100%}.w96-table tr{height:17px;white-space:nowrap}.w96-table tr.header{background:var(--3d-obj-color-primary);box-shadow:0px -2px #000;position:sticky;top:0;z-index:2}.w96-table tr.header th{font-weight:normal;box-shadow:inset -1px -1px #404040,inset 1px 1px #fff,inset -2px -2px gray}.w96-table tr.header th:active{box-shadow:inset 1px 1px gray,inset -1px -1px gray}.w96-table tr th{padding:1px;padding-left:5px;padding-right:5px}.w96-table tr td{padding:0;padding-left:3px;padding-right:3px}.w96-table .bbox{display:inline-block;padding-left:2px;padding-right:2px;vertical-align:top;height:17px;line-height:17px}.w96-table .icon{height:16px;width:16px;display:inline-block;vertical-align:top;background-image:url(/system/resource/icons/win96/16x16/places/folder.png)}.w96-table tr.selected .icon{filter:brightness(0.4) contrast(0.8) sepia(100%) hue-rotate(185deg) saturate(4)}.w96-table.a-fbb tr.selected td:first-child>.bbox{color:var(--select-color-secondary);background-color:var(--select-color-primary);outline:1px dotted #f5db95;outline-offset:-1px}.w96-table.a-full tr.selected{outline:1px dotted #f5db95;outline-offset:-1px}.w96-table.a-full tr.selected td{color:var(--select-color-secondary);background-color:var(--select-color-primary)}.window-dlg:not(.active) .w96-table.a-fbb tr.selected td:first-child>.bbox{outline:none;background-color:gray}.window-dlg:not(.active) .w96-table.a-full tr.selected{outline:none}.window-dlg:not(.active) .w96-table.a-full tr.selected td{background-color:gray}.window-dlg:not(.active) .w96-table tr.selected .icon{filter:brightness(0.7) contrast(0.9)}.w96-link{color:blue;text-decoration:underline;cursor:url("system/resource/cursors/hand.png") 6 0,auto;user-select:none}.w96-link:active{color:purple}::selection{color:var(--select-color-secondary);background:var(--select-color-primary)}.fieldset-dlg .ui-spacer{height:10px;width:100%}.fieldset-dlg .buttons{text-align:right !important;padding-right:10px;padding-bottom:10px}.fieldset-dlg>.mbox>.content>.text{margin-right:10px}.fieldset-container>.fld.text{margin-top:2px;box-sizing:border-box}.fieldset-container>.fld:not(:last-child){margin-bottom:8px}.commdlg-operation>.animation{height:60px;background-repeat:no-repeat;background-position-x:9px}.commdlg-operation>.status{white-space:pre-line;padding-left:12px;padding-top:5px;padding-bottom:10px;height:2rem}.commdlg-operation>.dlg-progress{flex-direction:row;display:flex}.commdlg-operation>.dlg-progress>.p-cnt{flex:1;padding-left:10px;padding-right:10px;box-sizing:border-box}.commdlg-operation>.dlg-progress>.p-cnt>.w96-progressbar{box-shadow:none;border-top:1px solid #999;border-left:1px solid #999;border-bottom:1px solid #fff;border-right:1px solid #fff;height:13px}.commdlg-operation>.dlg-progress>.p-cnt>.w96-progressbar>.progress{display:block}.commdlg-operation>.dlg-progress>.b-cnt{padding-right:10px}.dlg-except{padding:10px;box-sizing:border-box}.dlg-except>.top{margin-bottom:10px}.dlg-except>.top>.std-message{display:inline-block;vertical-align:top;width:300px}.dlg-except>.top>.std-message>.icon{height:32px;width:32px;margin-right:10px;display:inline-block;vertical-align:top;background-repeat:no-repeat;background-size:contain}.dlg-except>.top>.std-message>.text{display:inline-block;vertical-align:top;width:250px}.dlg-except>.top>.buttons{display:inline-block;vertical-align:top;width:80px}.dlg-except>.top>.buttons>button{width:75px;height:22px;float:right}.dlg-except>.ex{height:100%;flex:1;resize:none;background:var(--3d-obj-color-primary);overflow-y:scroll;line-height:1.35;color:#000}.prompt-container,.fieldset-container{width:100%;height:100%;display:flex;padding:10px;box-sizing:border-box;flex-direction:column}.mbox .prompt-container,.mbox .fieldset-container{padding:0px 0px 0px 10px}.prompt-container>.message,.fieldset-container>.message{flex:1}.prompt-container>.buttons,.fieldset-container>.buttons{display:flex;justify-content:center;padding:5px;padding-top:10px;padding-bottom:0px}.prompt-container>.buttons>button,.fieldset-container>.buttons>button{margin-right:5px;min-width:65px}.window-html-content>.mbox{display:flex;flex-direction:column;width:100%;height:100%}.window-html-content>.mbox>.content{width:100%;height:100%;display:flex;flex-direction:row}.window-html-content>.mbox>.content>.icon{height:32px;width:32px;min-width:32px;margin-left:16px;margin-right:16px;margin-top:16px;background-size:contain;background-repeat:no-repeat;background-position:center}.window-html-content>.mbox>.content>.text{width:100%;margin-right:16px;margin-top:16px;margin-bottom:16px;font-family:px_sans_serif;font-size:11px;user-select:text}.window-html-content>.mbox>.buttons{text-align:center}.window-html-content>.mbox>.buttons>button{min-width:74px;min-height:22px;margin-left:4px;margin-bottom:4px}.window-html-content.d>.mbox>.content{min-height:62px;min-width:318px;max-width:95vw;max-height:95vh}.window-html-content.d>.mbox>.buttons>button{margin-left:3px}.notify-battery-dlg .icon{background-image:url("system/resource/status/battery/battery_status32.png") !important;background-position-x:0 !important;background-position-y:0 !important;background-repeat:no-repeat !important;background-size:cover !important}.notify-battery-dlg.icn-full .icon{background-position-x:0 !important;background-position-y:0 !important}.notify-battery-dlg.icn-half .icon{background-position-x:-32px !important;background-position-y:0 !important}.notify-battery-dlg.icn-low .icon{background-position-x:-64px !important;background-position-y:0 !important}.notify-battery-dlg.icn-critical .icon{background-position-x:-96px !important;background-position-y:0 !important}.progress-dlg .message{margin-bottom:5px}.progress-dlg .w96-progressbar{margin-bottom:10px}@keyframes progressAnim{to{background-position:225%}}.vga_console_container{width:100%;height:100%;background-color:#000;color:#fff;box-sizing:border-box;padding:10px;white-space:pre-wrap;font-size:8px;overflow:hidden;letter-spacing:1px;font-family:fixed_bmp,monospace;font-size:13px;line-height:1.1}.vga_console_container .con-bold{text-shadow:-1px 0;letter-spacing:1px;padding-left:1px}.vga_console_container.logo-shown span{opacity:.5}.vga_console_container.boot-new{background:#00182e;background-position:calc(100% - 12px) calc(100% - 8px - 12px);background-repeat:no-repeat;background-size:125px;line-height:1}.vga_console_container.boot-new .con-sysinfo-wrap{display:inline-block;width:100%;max-width:520px}.vga_console_container.boot-new .con-sysinfo{display:block;width:470px;margin:0 auto}.vga_console_container.boot-new .con-line{display:inline-block;height:1px;width:100%;border-top:1px solid currentColor;margin:10px 0;margin-top:12px}.vga_console_container.boot-new .progress-indicator{width:0%;height:100%;background:linear-gradient(90deg, #83f887, #8385fc, #83f887);background-size:150vw;animation:progressAnim 1s linear infinite}.rescue-terminal{height:100%;width:100%}.logon-app>.logo{height:93px;width:100%;background-image:url("system/resource/ui/logon/logon.png");background-position:center;background-repeat:no-repeat}.logon-app>.content{padding:10px;padding-top:15px}.logon-app>.content>.field{display:flex;box-sizing:border-box}.logon-app>.content>.field>span{padding-top:3px;padding-right:10px;min-width:54px}.logon-app>.content>.field>.w96-textbox{box-sizing:border-box;width:100%;min-width:54px}.logon-app>.content>.field>input[type=password]{letter-spacing:2px}.logon-app>.content>.field.pwd{padding-top:10px}.logon-app>.buttons{padding-top:7px;padding-bottom:10px;padding-left:74px;padding-right:10px;display:flex;height:100%;flex:1}.logon-app>.buttons>button{min-width:80px;height:21px;padding:0;padding-top:1px}.slideInUp{animation:k_slideInUp 150ms linear}@keyframes k_slideInUp{0%{opacity:.5;transform:translateY(100%)}100%{opacity:1;transform:translateY(0)}}.zoomIn{animation:k_zoomIn 100ms linear}@keyframes k_zoomIn{0%{opacity:0;transform:scale(0.4)}100%{opacity:1;transform:scale(1)}}.zoomOut{animation:k_zoomOut 100ms linear}@keyframes k_zoomOut{0%{opacity:1;transform:scale(1)}100%{opacity:0;transform:scale(0.4)}}.winmaximize{animation-name:winmaximize;-webkit-animation-name:winmaximize;-moz-animation-name:winmaximize;-o-animation-name:winmaximize}@keyframes winmaximize{to{left:0px;top:0px;width:calc(100% - 8px);height:calc(100% - 36px)}}.windowMinimize{animation-name:wMinimize;animation-duration:.1s}@keyframes wMinimize{100%{top:120%;opacity:0}}.anim-null{animation-name:anim-null;animation-duration:3ms}@keyframes anim-null{0%{display:none}100%{display:none}}.center{text-align:center}.wordspacing-2{word-spacing:-2px}.super-player-app{font:11px px_sans_serif}.super-player-app>iframe{border:none;height:100%;width:100%}.eyeframe-app{font:11px px_sans_serif}.eyeframe-app>iframe{border:none;height:100%;width:100%}.nes-app{font:11px px_sans_serif}.nes-app>iframe{border:none;height:100%;width:100%}.dosbox-app{font:11px px_sans_serif}.dosbox-app>iframe{border:none;height:100%;width:100%}.wiki96-app{font:11px px_sans_serif}.wiki96-app>iframe{border:none;height:100%;width:100%}.win96chat-app{font:11px px_sans_serif}.win96chat-app>iframe{border:none;height:100%;width:100%}.gameing-app{font:11px px_sans_serif}.gameing-app>iframe{border:none;height:100%;width:100%}.blocks-app{font:11px px_sans_serif}.blocks-app>iframe{border:none;height:100%;width:100%}.bassoon-app{font:11px px_sans_serif}.bassoon-app>iframe{border:none;height:100%;width:100%}.if-app{font:11px px_sans_serif}.if-app>iframe{border:none;height:100%;width:100%}.monaco-app{font:11px px_sans_serif}.monaco-app>iframe{border:none;height:100%;width:100%}.pdf-reader-app>iframe{height:100%;width:100%;border:none;overflow:hidden;flex:1}.pdf-reader-app{overflow:hidden}.mdview-container{height:100%;width:100%;overflow-y:auto;background:#fff;font-family:sans-serif;font-size:12px;padding:5px;box-sizing:border-box;user-select:text;line-height:1.6em;border-top:1px solid gray;border-left:1px solid gray;border-right:1px solid #dfdfdf;border-bottom:1px solid #dfdfdf;box-shadow:1px 1px #fff,1px 0 #fff,0 1px #fff,inset 1px 1px #000,inset 1px 0 #000,inset 0 1px #000}.mdview-container>pre{white-space:pre-wrap}.showdown-code{background-color:wheat;padding:2px;border-radius:2px}.hub-app{background-image:url(/system/resource/app/welcome/background.png);background-size:cover}.hub-app>.top{padding:10px;box-sizing:border-box}.hub-app>.top>.brand>.logo>.title{font-size:22px;display:inline-block;vertical-align:middle}.hub-app>.top>.brand>.logo>.icon{height:32px;width:32px;display:inline-block;vertical-align:top;margin-right:5px}.hub-app>.top>.brand>.subtext{font-style:oblique;margin-left:40px}.hub-app>.grad-line{height:1px;background:linear-gradient(to right, #007c73, #1db182, transparent)}.hub-app>.content{flex:1;padding:10px;box-sizing:border-box;display:flex;flex-direction:row;overflow:hidden}.hub-app>.content>.left{width:170px}.hub-app>.content>.left>.header{background-color:#000;color:#fff;padding-left:15px;padding-right:15px;letter-spacing:1px;text-transform:uppercase;line-height:16px}.hub-app>.content>.left>.list{margin-bottom:16px}.hub-app>.content>.left>.list>.item{border-left:2px solid #000;border-bottom:1px solid #000;padding:4px;box-sizing:border-box}.hub-app>.content>.left>.list>.item:hover{background:var(--select-color-primary);color:var(--select-color-secondary)}.hub-app>.content>.left>.list>.item:last-child{border-bottom:none}.hub-app>.content>.left>.list>.item.selected{background-color:#000;color:#fff}.hub-app>.content>.right{flex:1;margin-left:8px;overflow:auto;user-select:text}.hub-app>.content>.right .title{font-size:22px}.hub-app>.content>.right .expand-img{border:1px solid #000;cursor:url("system/resource/cursors/hand.png") 6 0,auto}.hub-app>.bottom{padding:10px;box-sizing:border-box}.hub-app>.bottom>button{float:right;height:22px;width:76px}.hub-app.busy *{pointer-events:none}.hub-app.busy>.content>.left>.list>.item{color:gray;text-shadow:1px 1px #fff}.hub-app table{border-collapse:collapse}.hub-app table tr,.hub-app table th,.hub-app table td{border:1px solid #000}.hub-app table th{font-weight:100;letter-spacing:1px;text-shadow:1px 0 #000;text-align:left;padding-left:2px}.hub-app-info-wnd{padding:10px;padding-bottom:0;box-sizing:border-box;flex-direction:column}.hub-app-info-wnd>textarea{flex:1;resize:none;letter-spacing:1px}.hub-app-info-wnd>.buttons{text-align:center;padding:10px;box-sizing:border-box}.hub-app-info-wnd>.buttons>button{min-width:65px}.textpad-app>.main-editor{outline:0;font-family:monospace;font-size:13px;flex:1;border-width:1px;border-style:inset;resize:none;border-top:1px solid gray;border-left:1px solid gray;border-right:1px solid #dfdfdf;border-bottom:1px solid #dfdfdf;box-shadow:1px 1px #fff,1px 0 #fff,0 1px #fff,inset 1px 1px #000,inset 1px 0 #000,inset 0 1px #000;margin-bottom:3px;overflow-y:scroll;overflow-x:scroll}.textpad-app>.main-editor.word-wrap{overflow-x:hidden}.app-winver>.header{height:77px;background:url(/system/resource/app/ver/banner.png)}.app-winver>.body{flex:1;box-sizing:border-box;padding-top:15px;padding-left:54px;padding-right:15px;white-space:pre-line}.app-winver>.buttons{text-align:right;padding:10px;box-sizing:border-box}.app-winver>.buttons>button{width:76px;height:22px}.support-us-ui{font:11px px_sans_serif}.support-us-ui>.w96-tab-control{height:100%}.support-us-ui>.w96-tab-control>.content>.container{display:flex;flex-direction:column;height:100%}.support-us-ui>.w96-tab-control>.content>.container>.p1{padding:10px;height:100%;flex:1}.support-us-ui>.w96-tab-control>.content>.container>.p2{height:100%}.support-us-ui>.w96-tab-control>.content>.container>.p2>.cryptos{padding:10px;box-sizing:border-box;overflow-y:auto}.support-us-ui>.w96-tab-control>.content>.container>.p2>.cryptos>.currency{float:left;margin-right:8px}.support-us-ui>.w96-tab-control>.content>.container>.p2>.cryptos>.currency>button{height:72px;width:72px;display:block;background-position:center;background-repeat:no-repeat}.support-us-ui>.w96-tab-control>.content>.container>.p2>.cryptos>.currency>.title{text-align:center;margin-top:4px}.support-us-ui>.w96-tab-control>.content>.container>.p2>.cryptos>.currency.doge>button{background-image:url("/system/resource/app/support/currency/doge.png")}.support-us-ui>.w96-tab-control>.content>.container>.p2>.cryptos>.currency.eth>button{background-image:url("/system/resource/app/support/currency/ethereum.png")}.support-us-ui>.w96-tab-control>.content>.container>.p2>.cryptos>.currency.btc>button{background-image:url("/system/resource/app/support/currency/btc.png")}.support-us-ui>.w96-tab-control>.content>.container>.p2>.cryptos>.currency.ltc>button{background-image:url("/system/resource/app/support/currency/litecoin.png")}.support-us-ui iframe{border:none;height:100%;width:100%}.crypto-info-dlg>.qr{height:200px;width:200px;margin-left:auto;margin-right:auto;margin-top:auto;margin-bottom:16px;background-color:#fff;background-size:contain;box-sizing:border-box}.crypto-info-dlg>.address{text-align:center;margin-bottom:auto;user-select:all;margin-right:8px;margin-left:8px;overflow-wrap:break-word}.iexploder-app iframe{height:100%;width:100%;box-sizing:border-box;flex:1;background-color:#fff;border-top:1px solid gray;border-left:1px solid gray;border-right:1px solid #dfdfdf;border-bottom:1px solid #dfdfdf;box-shadow:1px 1px #fff,1px 0 #fff,0 1px #fff,inset 1px 1px #000,inset 1px 0 #000,inset 0 1px #000}.iexploder-app .header{box-sizing:border-box}.iexploder-app .header>.toolbar{height:28px;box-sizing:border-box}.iexploder-app .header>.toolbar>.nav{height:22px;width:22px;vertical-align:top;float:left;background-position:center;background-repeat:no-repeat}.iexploder-app .header>.toolbar>.nav.back{background-image:url("system/resource/app/iexploder/back.png")}.iexploder-app .header>.toolbar>.nav.forward{background-image:url("system/resource/app/iexploder/forward.png")}.iexploder-app .header>.toolbar>.nav.reload{background-image:url("system/resource/app/iexploder/reload.png")}.iexploder-app .header>.toolbar .bookmarks-bar{display:inline-block;vertical-align:top;height:100%;width:auto}.iexploder-app .header>.toolbar .bookmarks-bar>.root-item{line-height:24px}.iexploder-app .header>.toolbar .bookmarks-bar>.root-item>.image{height:16px;width:16px;margin-right:4px;margin-top:3px;display:inline-block;vertical-align:top}.iexploder-app .header>.navbar{padding:2px;box-sizing:border-box;width:100%;display:flex}.iexploder-app .header>.navbar>.navbox{width:100%;flex:1;margin-right:5px}.iexploder-app .header>.navbar>.text{padding:4px}.notron-app>.container{height:100%;width:100%;flex:1;background-image:url(/system/resource/app/notron/bg.jpg);background-repeat:no-repeat;background-color:#fff}.notron-app>.container>.htext{position:relative;top:105px;left:25px;text-shadow:-1px 0 #000;letter-spacing:1px}.notron-app>.container>.nav-options{position:relative;width:calc(100% - 50px);top:125px;left:25px}.notron-app>.container>.nav-options>.option{height:32px;display:flex;flex-direction:row;margin-bottom:5px;padding:5px}.notron-app>.container>.nav-options>.option>.icon{height:32px;width:32px;margin-right:8px}.notron-app>.container>.nav-options>.option>.text{flex:1;width:100%;padding-top:2px}.notron-app>.container>.nav-options>.option>.text>.title{text-shadow:1px 0 0;letter-spacing:1px;width:100%;display:block}.notron-app>.container>.nav-options>.option:hover{background-color:var(--select-color-primary);color:var(--select-color-secondary)}.notron-app>.container.busy{pointer-events:none;filter:grayscale(1)}.notron-app>.container:not(.busy)>.progress-box{display:none}.notron-app>.container>.progress-box{position:absolute;width:240px;height:60px;padding:20px;box-sizing:border-box;background:#d3d3d3;border:3px double gray;left:25%;top:calc(25% + 60px);z-index:10}.uploader-app{padding:10px;box-sizing:border-box;display:flex}.uploader-app>input[type=file]{width:100%;box-sizing:border-box;margin-top:5px;height:22px;padding:0}.uploader-app>.start{margin-left:auto;width:71px;margin-top:auto}.imgviewer-app{background-image:url("system/resource/app/iviewer/checker.png")}.imgviewer-app>.controls{position:absolute;bottom:0;width:100%;display:flex;justify-content:center;box-sizing:border-box;padding:10px}.imgviewer-app>.controls>button{height:22px;width:22px;padding:0px;background-color:silver;background-repeat:no-repeat;background-position:center}.imgviewer-app>.controls>button.center{background-image:url("system/resource/app/iviewer/center-image.png")}.imgviewer-app>.controls>button.zoom{background-image:url("system/resource/app/iviewer/zoom-image.png")}.imgviewer-app>.controls>button.view-pixelated{background-image:url("system/resource/app/iviewer/pixelated.png")}.imgviewer-app>.controls>button.view-quality{background-image:url("system/resource/app/iviewer/quality.png")}.imgviewer-app>.image-container{height:100%;width:100%;background-repeat:no-repeat;background-size:contain;background-position:center}.imgviewer-app>.image-container.pixelated{image-rendering:crisp-edges;image-rendering:pixelated}.imgviewer-app>.image-container.centered{background-repeat:no-repeat !important;background-position:center !important;background-size:auto !important}.shell36-start-menu{left:2px;position:fixed;background-color:var(--3d-obj-color-primary);z-index:10000000;border-top:1px solid #dfdfdf;border-left:1px solid #dfdfdf;box-shadow:inset 1px 1px #fff,1px 0 #000,0 1px #000,1px 1px #000;border-right:1px solid gray;border-bottom:1px solid gray;-webkit-animation-duration:.5s;animation-duration:.5s;font-size:11px;font-family:px_sans_serif;animation-duration:.25s !important;display:flex;padding:1px}.shell36-start-menu .sidebar{width:21px;text-orientation:sideways;writing-mode:vertical-lr;transform:rotate(180deg);color:#fff;font-weight:900;font-family:arial,sans-serif;font-size:15px;background:linear-gradient(to bottom, rgb(0, 128, 128), black);padding-left:2px;padding-top:5px;box-sizing:border-box}.shell36-start-menu>.item-container{flex:1}.shell36-start-menu>.item-container>.item{height:36px;min-width:148px}.shell36-start-menu>.item-container>.item:hover,.shell36-start-menu>.item-container>.item.active{background-color:var(--select-color-primary);color:var(--select-color-secondary)}.shell36-start-menu>.item-container>.item:hover.sub::after,.shell36-start-menu>.item-container>.item.active.sub::after{content:url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAQAAAAHCAYAAAAvZezQAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAAAAuSURBVBhXXc3RCgAABEPRzf//M7YouSV1HmB2ANjjYrbQLSjjBZUfeMGHF+YLUK7aBwvYrDVnAAAAAElFTkSuQmCC") !important}.shell36-start-menu>.item-container>.item.sub::after{content:url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAQAAAAHCAYAAAAvZezQAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAAAArSURBVBhXYwCC/yACBpigNFwQJgACYEFGGAMGkFWAACOyAEg1GCBpYWAAAGi8BQegB+eXAAAAAElFTkSuQmCC");transform:translateY(-1px);right:8px;text-shadow:-1px 0 0 #000;position:absolute;margin-top:13px}.shell36-start-menu>.item-container>.item>.icon{height:24px;width:24px;margin-top:6px;margin-left:9px;display:inline-block;vertical-align:middle}.shell36-start-menu>.item-container>.item>.text{display:inline-block;vertical-align:sub;margin-left:6px;position:relative;top:1px}.shell36-start-menu>.item-container>.w96-ui-inset-separator{margin:3px 2px;max-width:calc(100% - 3px)}.ui-bg-iframe{height:100%;width:100%;pointer-events:none;z-index:1;border:none;position:absolute;top:0}.user-desktop{margin:0 !important;height:100%;width:100%;box-sizing:border-box;user-select:none;position:fixed;outline:0;overflow:hidden !important;background-size:auto;background-position:center;background-image:linear-gradient(to right top, rgb(0, 0, 64), rgb(0, 170, 130));z-index:2}.user-desktop>.build-info{font-family:monospace;color:#fff;position:fixed;bottom:30px;right:0;z-index:1;opacity:30%;transition:opacity 1s}.user-desktop>.build-info:hover{transition:opacity .5s;opacity:100% !important}.user-taskbar{height:28px;width:100%;z-index:10000000;box-sizing:border-box;background:var(--3d-obj-color-primary);border-style:ridge;border-top-color:#fff;border-left-width:0px;border-right-width:0px;border-bottom-width:0px;display:flex;max-height:28px;flex-direction:row-reverse;position:fixed;bottom:0;border-top:1px solid silver;padding-top:2px;box-shadow:inset 0 1px 0 #fff}.user-taskbar .separator{background:gray;width:1px;border-right:1px solid #fff;margin-left:1px;margin-top:1px;height:calc(100% - 3px);margin-right:2px}.user-taskbar .notify-battery{background-image:url("system/resource/status/battery/battery_status16.png") !important;background-position-x:0;background-position-y:0;background-repeat:no-repeat;background-size:cover !important}.user-taskbar .notify-battery.icn-full{background-position-x:0;background-position-y:0}.user-taskbar .notify-battery.icn-half{background-position-x:-16px;background-position-y:0}.user-taskbar .notify-battery.icn-low{background-position-x:-32px;background-position-y:0}.user-taskbar .notify-battery.icn-critical{background-position-x:-48px;background-position-y:0}.start_button{height:22px;margin-top:1px;margin-left:2px;margin-right:2px;display:inline-block;border-radius:0px;cursor:url("system/resource/cursors/default.png"),auto;background-image:url("system/resource/shell/start-icn.png");background-repeat:no-repeat;background-position-y:center;width:54px;background-position-x:4px}.start_button.sb-active{box-shadow:inset -1px -1px #fff,inset 1px 1px #0a0a0a,inset -2px -2px #dfdfdf,inset 2px 2px gray !important}.start_button::after{content:"Start";position:relative;line-height:2.1;right:-11px;top:-4px;letter-spacing:1px;text-shadow:-1px 0 #000}.taskbar-tasks{width:100%;height:100%;box-sizing:border-box;flex:1;padding:1px;display:flex;overflow:hidden}.taskbar-task{display:inline-flex;min-width:160px;user-select:none;cursor:url("system/resource/cursors/default.png"),auto;margin-right:4px;vertical-align:top;height:calc(100% - 2px);width:fit-content;border-style:ridge;background-repeat:repeat;font-family:px_sans_serif;font-size:11px;box-sizing:border-box;border-radius:0px;border-top:1px solid #fff;border-left:1px solid #fff;border-right:1px solid gray;border-bottom:1px solid gray;box-shadow:inset 1px 1px #dfdfdf,1px 0 #000,0 1px #000,1px 1px #000;max-width:160px;word-break:break-all;padding-left:0px;padding-right:0px;text-align:left;outline:0;background-color:var(--3d-obj-color-primary);min-width:0px;flex:1}.taskbar-task:focus{outline-style:dotted;outline-width:1px;outline-offset:-1px}.taskbar-task_active{background-image:url("system/resource/shell/task-active-bg.png");border-top:1px solid #000;border-left:1px solid #000;border-right:1px solid #dfdfdf;border-bottom:1px solid #dfdfdf;box-shadow:inset 1px 1px gray,1px 0 #fff,0 1px #fff,1px 1px #fff}.taskbar-task_active .taskbar-task-text{text-shadow:1px 0 #000;letter-spacing:1px}.taskbar-task-icon{height:16px;width:16px;margin-top:auto;margin-bottom:auto;margin-left:3px;background-size:contain !important}.taskbar-task-text{margin-top:1px;margin-bottom:auto;margin-left:5px;margin-right:4px;flex:1;line-height:1.5em;text-overflow:ellipsis;overflow:hidden;word-break:break-all;white-space:nowrap;max-height:16px}.taskbar-notify{height:calc(100% - 2px);display:flex;float:right;font-family:px_sans_serif;font-size:11px;border-left:1px solid #7b7b7b;border-top:1px solid #7b7b7b;border-right:1px solid #fff;border-bottom:1px solid #fff;margin-right:2px;height:calc(100% - 5px);margin-top:1px}.taskbar-notify .notify-item{margin-top:auto;margin-bottom:auto;margin-left:3px;margin-right:3px}.taskbar-notify .notify-icon{height:16px;width:16px;background-image:none;background-size:contain;margin-right:0px;image-rendering:crisp-edges;image-rendering:pixelated}.taskbar-notify .notify-time{margin-right:10px;margin-left:10px}.dlg-newshortcut{flex-direction:row !important}.dlg-newshortcut>.p1{flex-direction:row}.dlg-newshortcut>.p1>.icon-box{background-position:center;background-repeat:no-repeat;height:48px;width:48px;margin:10px}.dlg-newshortcut>.p2{text-align:right;width:100%;box-sizing:border-box;flex:1;padding:10px}.dlg-newshortcut>.p2>.field{display:flex;margin-bottom:5px;line-height:1.35}.dlg-newshortcut>.p2>.field>input.w96-textbox{width:100%;flex:1}.dlg-newshortcut>.p2>.field>span{width:53px;line-height:1.35em;padding-top:3px;text-align:left}.dlg-newshortcut>.p2>button{width:65px;margin-left:5px}.pkmgr-app footer .cell{width:100%}.pkmgr-app>.content{flex:1;width:100%;display:flex;flex-direction:row;padding:1px;box-sizing:border-box;overflow:hidden;margin-bottom:2px}.pkmgr-app>.content>.aside{min-width:120px;width:12%;height:100%;display:flex;flex-direction:column;margin-right:5px}.pkmgr-app>.content>.aside>.w96-listbox{width:100%;height:100%;flex:1}.pkmgr-app>.content>.aside>.w96-listbox>.item{display:flex;line-height:2.2;align-items:center}.pkmgr-app>.content>.aside>.w96-listbox>.item>.icon{height:16px;width:16px;display:inline-block;margin-right:1em}.pkmgr-app>.content>.view{flex:1;width:100%;height:100%;display:flex;flex-direction:column}.pkmgr-app>.content>.view>.packages{width:100%;height:100%;flex:1;border-left:1px solid #9a9a9a;border-top:1px solid #9a9a9a;border-right:1px solid #eee;border-bottom:1px solid #eee;margin-bottom:5px;background-color:#fff;box-sizing:border-box;overflow-y:auto}.pkmgr-app>.content>.view>.packages>.item{padding:5px;box-sizing:border-box;display:flex;flex-direction:row}.pkmgr-app>.content>.view>.packages>.item>span{display:block;line-height:1.8}.pkmgr-app>.content>.view>.packages>.item>.icon{height:32px;width:32px;background-size:contain;background-repeat:no-repeat;background-position:center}.pkmgr-app>.content>.view>.packages>.item>.content{display:block;flex:1;margin-left:5px}.pkmgr-app>.content>.view>.packages>.item>.content>*{display:block;line-height:1.5}.pkmgr-app>.content>.view>.packages>.item.installed{background-color:#90ee90}.pkmgr-app>.content>.view>.packages>.item.broken{background-color:#f08080}.pkmgr-app>.content>.view>.packages>.item.upgradeable{background-color:#add8e6}.pkmgr-app>.content>.view>.packages>.item.selected{background-color:var(--select-color-primary)}.pkmgr-app>.content>.view>.info{width:100%;min-height:145px;height:33%;border-left:1px solid #9a9a9a;border-top:1px solid #9a9a9a;border-right:1px solid #eee;border-bottom:1px solid #eee;background-color:#dedede;box-sizing:border-box;user-select:text;overflow-y:auto}.pkmgr-app>.content>.view>.info .w96-tab-control{height:100%}.pkmgr-app>.content>.view>.info .w96-tab-control .pages{margin:0;background:var(--3d-obj-color-primary)}.pkmgr-app>.content>.view>.info .w96-tab-control .content{margin:0;border-top:2px solid #fff}.pkmgr-app>.content>.view>.info .w96-tab-control .info-page{padding:5px}.pkmgr-app>.content>.view>.info .w96-tab-control .desc-page{padding:0}.pkmgr-app>.content>.view>.info .w96-tab-control .desc-page>iframe{height:100%;width:100%;border:none}.pkmgr-app>.content>.view>.info .hdr{display:block;margin-bottom:5px;margin-top:5px}.pkmgr-app>.content>.view>.info .hdr:first-child{margin-top:0}.pkmgr-app>.content>.view>.info .field{display:block}.pkmgr-app>.content>.view>.info .field:not(:last-child){margin-bottom:4px}.pkmgr-app>.content>.view>.info .field>.key{color:blue}.pkmgr-app.busy>.content{pointer-events:none}.pkmgr-app.busy .w96-menubar,.pkmgr-app.busy .w96-listbox,.pkmgr-app.busy .bold-noaa{color:gray;text-shadow:1px 1px #fff;pointer-events:none}.pkmgr-app .aside>.bold-noaa,.pkmgr-app .view>.bold-noaa{display:block;line-height:1.8}.pkmgr-app.view-compact>.content>.view>.packages>.item{padding:3px}.pkmgr-app.view-compact>.content>.view>.packages>.item>.icon{height:16px;width:16px}.pkmgr-app.view-compact>.content>.view>.packages>.item>.content>.desc{display:none}.pkmgr-app .w96-toolbar{height:26px}.pmdlg-status{display:flex !important;flex-direction:row !important}.pmdlg-status>.icon{margin:16px;width:32px;height:32px;background-repeat:no-repeat;background-size:contain}.pmdlg-status>.content{flex:1;width:100%;height:100%;margin:16px;margin-left:0px;margin-top:0;margin-bottom:0;padding-top:16px;padding-bottom:16px;box-sizing:border-box;display:flex;flex-direction:column;overflow:hidden}.pmdlg-status>.content>.status-text{margin-bottom:1em}.pmdlg-status>.content>.log{margin-top:1em;height:100%;width:100%;box-sizing:border-box;flex:1;overflow-y:scroll;background:#dcdcdc;line-height:1.4;user-select:text;white-space:pre-wrap}.pmdlg-status>.content>.log>.line:nth-child(2n+2){background:#f1f1f1}.dynwp-app{padding:5px;box-sizing:border-box}.dynwp-app>.preview{margin-top:4px;margin-bottom:4px;border-left:1px solid #9a9a9a;border-top:1px solid #9a9a9a;border-right:1px solid #eee;border-bottom:1px solid #eee;width:100%;height:150px;pointer-events:none}.dynwp-app>.field{width:100%;margin-bottom:4px}.dynwp-app>.field>.bold-noaa{margin-bottom:2px;display:block}.dynwp-app>.field>*{width:100%}.dynwp-app>.field.custom>div{display:flex;flex-direction:row}.dynwp-app>.field.custom>div>input{flex:1;margin-right:2px}.dynwp-app>.buttons{margin-top:4px;text-align:right}.dynwp-app>.buttons>.left{float:left}.mplayer-main{display:flex;flex:1;flex-direction:column}.mplayer-main>.w96-ui-inset-separator{margin:0 auto;width:calc(100% - 2px);border-top-color:#000}.mplayer-button-group{display:inline-block;font-size:0}.mplayer-buttons{display:flex;flex-wrap:wrap;gap:8px;padding:4px}.mplayer-buttons button{min-height:22px;min-width:23px;padding:0;padding-top:2px}.mplayer-buttons button[disabled] img{filter:contrast(0) drop-shadow(1px 1px #fff)}.mplayer-status{background:inherit;flex:1;color:initial !important;cursor:url(/system/resource/cursors/default.png),default !important}.mplayer-progress{flex:1}.mplayer-progress .mplayer-timestamps,.mplayer-progress-bar{position:relative;width:calc(100% - 32px);margin:0 16px}.mplayer-progress-bar{margin-top:4px;height:12px;background:#fff;border-top:1px solid gray;border-left:1px solid gray;border-right:1px solid #dfdfdf;border-bottom:1px solid #dfdfdf;box-shadow:1px 1px #fff,1px 0 #fff,0 1px #fff,inset 1px 1px #000,inset 1px 0 #000,inset 0 1px #000}.mplayer-progress-bar .slider{position:absolute;top:-4px;left:-5px;width:11px;height:23px;pointer-events:none}.mplayer-progress .mplayer-timestamps{width:calc(100% - 31px);height:4px;margin-top:7px;margin-left:17px}.mplayer-progress .mplayer-timestamps .ts{position:absolute;width:1px;height:100%;background:#000}.mplayer-progress .mplayer-timestamps .ts-start{left:0}.mplayer-progress .mplayer-timestamps .ts-end{right:0}.mplayer-video{display:flex;justify-content:center;align-items:center;width:100%;height:100%;background:#000;border-top:1px solid gray;border-left:1px solid gray;border-right:1px solid #dfdfdf;border-bottom:1px solid #dfdfdf;box-shadow:1px 1px #fff,1px 0 #fff,0 1px #fff,inset 1px 1px #000,inset 1px 0 #000,inset 0 1px #000}.mplayer-video video{width:100%;height:100%}.welcome96-app{background-color:#fff;background-image:url(/system/resource/app/welcome/background.png);background-position:bottom right,top left;background-repeat:no-repeat,no-repeat}.welcome96-hr{height:1px;background:linear-gradient(to right, #ff3100 96px, #ffce00 96px 192px, #63ce31 192px 288px, #009cff 288px 371px, rgb(255, 255, 255))}.welcome96-body{display:flex;gap:15px;flex:1}.welcome96-sidebar{width:180px}.welcome96-sidebar>.welcome96-sidebar-item{padding-left:13px;font-size:11px;border-bottom:2px solid silver;height:24px;line-height:24px}.welcome96-sidebar>.welcome96-sidebar-header{background-color:#000;color:#fff;height:15px;line-height:16px}.welcome96-sidebar>.welcome96-sidebar-item:not(.welcome96-sidebar-header){cursor:url(/system/resource/cursors/hand.cur) 6 0,auto}.welcome96-sidebar>.welcome96-sidebar-item:not(.welcome96-sidebar-header):nth-child(4n+2){box-shadow:4px 0 0 0 #009cff inset}.welcome96-sidebar>.welcome96-sidebar-item:not(.welcome96-sidebar-header):nth-child(4n+2):hover{background:linear-gradient(to right, #84ceff, rgb(255, 255, 255))}.welcome96-sidebar>.welcome96-sidebar-item:not(.welcome96-sidebar-header):nth-child(4n+2):active{background:linear-gradient(to right, #009cff, rgb(255, 255, 255))}.welcome96-sidebar>.welcome96-sidebar-item:not(.welcome96-sidebar-header):nth-child(4n+3){box-shadow:4px 0 0 0 #ff3100 inset}.welcome96-sidebar>.welcome96-sidebar-item:not(.welcome96-sidebar-header):nth-child(4n+3):hover{background:linear-gradient(to right, #ff9c84, rgb(255, 255, 255))}.welcome96-sidebar>.welcome96-sidebar-item:not(.welcome96-sidebar-header):nth-child(4n+3):active{background:linear-gradient(to right, #ff3100, rgb(255, 255, 255))}.welcome96-sidebar>.welcome96-sidebar-item:not(.welcome96-sidebar-header):nth-child(4n+4){box-shadow:4px 0 0 0 #6bce39 inset}.welcome96-sidebar>.welcome96-sidebar-item:not(.welcome96-sidebar-header):nth-child(4n+4):hover{background:linear-gradient(to right, #b5e79c, rgb(255, 255, 255))}.welcome96-sidebar>.welcome96-sidebar-item:not(.welcome96-sidebar-header):nth-child(4n+4):active{background:linear-gradient(to right, #6bce39, rgb(255, 255, 255))}.welcome96-sidebar>.welcome96-sidebar-item:not(.welcome96-sidebar-header):nth-child(4n+5){box-shadow:4px 0 0 0 #ffce00 inset}.welcome96-sidebar>.welcome96-sidebar-item:not(.welcome96-sidebar-header):nth-child(4n+5):hover{background:linear-gradient(to right, #ffe784, rgb(255, 255, 255))}.welcome96-sidebar>.welcome96-sidebar-item:not(.welcome96-sidebar-header):nth-child(4n+5):active{background:linear-gradient(to right, #ffce00, rgb(255, 255, 255))}.welcome96-content{flex:1}.welcome96-content>h1{font-weight:100;font-size:22px;text-shadow:1px 0 0 #000;letter-spacing:1px}.welcome96-footer{padding:6px}.welcome96-footer>.welcome96-close-btn{height:22px;width:74px;float:right}.welcome96-footer>.w96-checkbox{vertical-align:sub}.w96-chkbox{display:flex}.w96-chkbox .box{height:9px;width:9px;margin-right:2px;background-color:#fff;border-style:inset;border-width:2px;border-top-color:gray;border-left-color:gray;margin-top:auto;margin-bottom:auto}.w96-chkbox .text{margin-left:3px}.w96-chkbox .checked{background-image:url(/system/resource/shell/checkbox.png);background-position:center;background-repeat:no-repeat;background-size:contain}.p3-app input[type=text],.p3-app input[type=password]{width:calc(100% - 7px);padding-left:3px}.p3-app .w96-button{min-width:70px}.p3-app p.bold-noaa{margin:3px 0}.p3-app .content{padding:6px;box-sizing:border-box}.p3-app .p3-status-div{display:block;margin:6px 0}.p3-app .p3-status,.status-dot{display:inline-block;width:6px;height:6px;background-color:currentColor;border-radius:100%;position:relative;top:-1px;margin-right:2px}.p3-app .p3-combo-btn-wrap{display:inline-flex;width:100%;margin-top:2px;margin-bottom:6px}.p3-app .p3-combo-btn-wrap button{margin-left:4px;position:relative;top:1px}.p3-message .text{white-space:pre-wrap}.p3-port-list{border-width:2px;border-style:inset;border-top-color:#000;border-left-color:#000;background-color:#fff;height:135px;overflow-y:auto}.p3-port-list.p3-peers{height:149px}.p3-port-list .legend,.p3-port-list .port-row{display:flex;width:100%;padding:2px 4px;box-sizing:border-box}.p3-port-list .legend{text-shadow:-1px 0;border-bottom:1px dotted #aaa;letter-spacing:1px}.p3-port-list .legend span,.p3-port-list .port-row span{display:inline-flex;justify-content:flex-start;width:calc(33.33% - 6px);padding:0 1px;margin:0 3px;overflow:hidden;text-overflow:ellipsis}.p3-port-list .address{user-select:text;width:110px !important}.p3-port-list .port{width:30px !important}.p3-port-list .public{background-color:#dfd}.p3-port-list .private{background-color:#fdd}.internete-app .w96-toolbar{height:42px}.internete-app .w96-toolbar .item{height:40px;min-width:55px}.internete-app .w96-toolbar .item[disabled]{text-shadow:1px 1px #fff;color:#6d6d6d}.internete-app .w96-toolbar .item[disabled]>.icon{filter:contrast(0) drop-shadow(1px 1px #fff)}.internete-app .w96-toolbar .item>.icon{background-position:center;filter:grayscale(100%)}.internete-app .w96-toolbar .item:not([disabled]):hover>.icon{filter:none}.internete-app .nav-box{display:flex;flex-direction:row;border-top:1px solid #787878;box-shadow:inset 0 1px #fff}.internete-app .nav-box .text{padding-right:4px;padding-top:5px;padding-left:4px}.internete-app .nav-box input{width:100%;height:19px;margin:2px;box-sizing:border-box}.internete-app .w96-footer .cell.status{flex:1}.internete-app .w96-footer .cell.zone{width:120px}.internete-app .combo-panel{margin-top:3px;margin-bottom:2px;background:#fff;flex:1;overflow:hidden;display:flex;flex-direction:row}.internete-app .combo-panel .left{display:flex;width:202px;background-color:var(--3d-obj-color-primary)}.internete-app .combo-panel .left .pane-container{flex:1;margin-right:4px}.internete-app .combo-panel .left .pane-container.favorites .content{background-color:#fff;background-image:url("system/resource/shell/task-active-bg.png");margin:3px;border-top:1px solid gray;border-left:1px solid gray;border-bottom:1px solid #fff;border-right:1px solid #fff;overflow-y:auto;max-height:calc(100% - 28px);padding:0}.internete-app .combo-panel .left .pane-container.favorites .content .favorite{padding-left:5px;line-height:23px;height:23px;cursor:url("system/resource/cursors/hand.png") 6 0,auto}.internete-app .combo-panel .left .pane-container.favorites .content .favorite .image{height:16px;width:16px;display:inline-block;vertical-align:sub;margin-right:2px}.internete-app .combo-panel .left .pane-container.favorites .content .favorite .text{display:inline-block}.internete-app .combo-panel .left .pane-container.favorites .content .favorite .text:hover{text-decoration:underline}.internete-app .combo-panel .left .pane-container.favorites .content .favorite:focus,.internete-app .combo-panel .left .pane-container.favorites .content .favorite.active{background-color:gray;color:#fff}.internete-app .combo-panel .left .pane-bar{width:100%;display:flex;flex-direction:row;padding:2px;height:23px;box-sizing:border-box;border-bottom:1px solid gray;box-shadow:0px 1px #fff}.internete-app .combo-panel .left .pane-bar .title{width:100%;margin-right:5px;padding-left:9px;padding-top:3px;flex:1}.internete-app .combo-panel .left .pane-bar .close{height:17px;width:20px;margin-top:1px;background-position:center;background-repeat:no-repeat;background-image:url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAgAAAAHCAYAAAA1WQxeAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAAAA4SURBVBhXY2RgYPgPxCAAYiMDmDgYgDjIAnA+si4UHUCAbiIYoJtEvAnoOuF8kCqYBLqdQHEGBgAx7A/5GaSbcgAAAABJRU5ErkJggg==")}.internete-app .combo-panel .left .pane-bar .close:hover{box-shadow:inset -1px -1px #85898d,inset 1px 1px #fff}.internete-app .combo-panel .left .pane-bar .close:active{box-shadow:inset -1px -1px #fff,inset 1px 1px #85898d}.internete-app .combo-panel .left .content{box-sizing:border-box;padding:2px;border-top:none}.internete-app .combo-panel .right{flex:1;padding:1px;border-top:1px solid gray;border-left:1px solid gray;border-right:1px solid #dfdfdf;border-bottom:1px solid #dfdfdf;box-shadow:1px 1px #fff,1px 0 #fff,0 1px #fff,inset 1px 1px #000,inset 1px 0 #000,inset 0 1px #000;height:calc(100% - 3px);width:calc(100% - 3px)}.internete-app .combo-panel .right>iframe{border:none;height:100%;width:100%;background:#fff}.scm-app .w96-toolbar>.item{min-width:54px}.wnd-ie-inet-options .icon-box{margin-bottom:0}.wnd-ie-inet-options .icon-box .text{width:calc(100% - 48px)}.wnd-ie-inet-options .addr-box{margin-top:8px;display:flex}.wnd-ie-inet-options .addr-box span{padding-top:2px;margin-right:20px}.wnd-ie-inet-options .addr-box input{flex:1;line-height:14px}.wnd-ie-inet-options .ic-buttons{margin-top:10px;text-align:right}.wnd-ie-inet-options .ic-buttons button{height:23px;min-width:79px}.wnd-ie-inet-options .w96-groupbox:not(:first-child){margin-top:15px}.taskmgr-app .w96-menubar{border-bottom:1px solid #787878;box-shadow:0px 1px #fff}.taskmgr-app .w96-tab-control{flex:1}.taskmgr-app .w96-tab-control .content{padding:15px;display:flex;flex-direction:column;overflow:hidden}.taskmgr-app .w96-tab-control .content .w96-table{height:100%;width:100%}.taskmgr-app .w96-tab-control .content.tab-processes .buttons{margin-top:10px;text-align:right}.taskmgr-app .w96-tab-control .content.tab-processes .buttons>button{width:100px;height:23px}.taskmgr-app .w96-tab-control .content.tab-applications .buttons{margin-top:10px;text-align:right}.taskmgr-app .w96-tab-control .content.tab-applications .buttons>button{width:80px;height:23px;margin-left:4px}.taskmgr-app .w96-tab-control .content.tab-performance .w96-groupbox .content{padding:2px}.taskmgr-app .w96-tab-control .content.tab-performance .w96-graph{border-top:1px solid gray;border-left:1px solid gray;border-right:1px solid #dfdfdf;border-bottom:1px solid #dfdfdf;box-shadow:1px 1px #fff,1px 0 #fff,0 1px #fff,inset 1px 1px #000,inset 1px 0 #000,inset 0 1px #000}.taskmgr-app .w96-tab-control .content.tab-performance .w96-graph>div{display:none}.taskmgr-app footer .cell{width:100%}.taskmgr-app footer .cell.mem{max-width:130px}.systemlog-app .content{flex:1;display:flex;flex-direction:row;overflow:hidden}.systemlog-app .content .w96-table{flex:1;margin-bottom:2px}.systemlog-app .content .description{width:170px;margin-left:2px;margin-bottom:2px;color:#000;white-space:pre-line;word-break:break-all}.wflags-app{display:flex}.wflags-app>.container{flex:1;display:flex;flex-direction:row;overflow:hidden;margin-bottom:2px}.wflags-app>.container>.w96-listbox{flex:1;overflow-y:auto;border-top:1px solid gray;border-left:1px solid gray;border-right:1px solid #dfdfdf;border-bottom:1px solid #dfdfdf;box-shadow:1px 1px #fff,1px 0 #fff,0 1px #fff,inset 1px 1px #000,inset 1px 0 #000,inset 0 1px #000}.wflags-app>.container>.w96-listbox>.enabled:not(.selected){background-color:#90ee90}.wflags-app>.container>.w96-listbox>.item{padding-top:5px;padding-bottom:5px;line-height:1.35}.wflags-app>.container>.buttons{padding-left:5px;padding-right:5px}.wflags-app>.container>.buttons button{display:block;width:68px;margin-bottom:5px}.dlg-run-box{padding:15px;box-sizing:border-box;justify-content:space-between}.dlg-run-box>.exp>.icon{display:inline-block;vertical-align:top;height:32px;width:32px}.dlg-run-box>.exp>.text{display:inline-block;vertical-align:top;margin-left:12px;margin-top:1px;position:absolute}.dlg-run-box>.pbox{display:flex;align-items:center;box-sizing:border-box}.dlg-run-box>.pbox>.text{margin-right:16px}.dlg-run-box>.pbox>.cmd{width:100%}.dlg-run-box>.buttons{text-align:right}.dlg-run-box>.buttons>button{width:80px}.credits-ui>.bg{height:100%;width:100%;color:#fff;background:#000;display:flex;flex-direction:column;background-image:url(http://cdn.windows96.net/credits/default.png);user-select:none}.credits-ui>.bg>.avatar{height:128px;width:128px;border-radius:100%;background-size:cover;margin-left:auto;margin-right:auto;margin-top:48px;margin-bottom:32px}.credits-ui>.bg>.name{text-align:center;line-height:2.4;font-family:px_sans_serif;font-size:22px;font-weight:bold}.credits-ui>.bg>.position{text-align:center;font-family:monospace;font-size:14px}.credits-ui>.bg .buttons{margin-top:auto;text-align:right;padding:10px}.credits-ui>.bg .buttons>button{background:none;border:1px solid #fff;color:#fff;font-family:px_sans_serif;font-size:11px;padding:6px;padding-top:7px;margin-left:2px;min-width:63px;outline:0}.credits-ui>.bg .buttons>button:hover{background:#fff;color:#000;cursor:url("system/resource/cursors/hand.png") 6 0,auto}.credits-ui>.bg .buttons>button.disabled{border:1px solid gray;color:gray;pointer-events:none}.credits-ui>.bg .socials{margin-left:auto;margin-right:auto;margin-top:32px}.credits-ui>.bg .socials a{text-decoration:none;height:16px;width:16px;background-repeat:no-repeat;background-position:center;background-size:contain;display:inline-block;vertical-align:top;margin-right:5px}.credits-ui>.bg .socials a.twitter{background-image:url("/system/resource/misc/twitter.png")}.credits-ui>.bg .socials a.youtube{background-image:url("/system/resource/misc/youtube.png")}.credits-ui>.bg .socials a.reddit{background-image:url("/system/resource/misc/reddit.png")}.credits-ui>.bg .socials a.github{background-image:url("/system/resource/misc/github.png")}.credits-ui>.bg .socials a.gitlab{background-image:url("/system/resource/misc/gitlab.png")}.credits-ui>.bg .socials a.discord{background-image:url("/system/resource/misc/discord.png")}.credits-ui>.bg .socials a.steam{background-image:url("/system/resource/misc/steam.png")}.credits-ui>.bg .socials a.site{background-image:url("/system/resource/misc/site.png")}.credits-ui>.bg .socials a:visited{color:#fff}.terminal-new{height:100%;overflow:hidden !important}.wex-terminal-wnd>.terminal{white-space:pre-wrap;flex:1;overflow-y:auto;background:#000;color:#fff;font-size:13px;font-family:fixed_bmp,monospace;word-break:break-word;overflow-wrap:break-word;user-select:text;line-height:1.1}.openwith-app{padding:10px;display:flex;flex-direction:column;box-sizing:border-box;image-rendering:crisp-edges;image-rendering:pixelated}.openwith-app>.top,.openwith-app>.box{margin-bottom:8px}.openwith-app>.top>.icon{height:32px;width:32px;vertical-align:top;display:inline-block;margin-right:10px}.openwith-app>.top>.text{vertical-align:top;display:inline-block;line-height:11px}.openwith-app>.bottom>.dlg-buttons{margin-top:8px}.openwith-app>.bottom>.dlg-buttons>button{float:right;width:65px;margin-left:4px}.openwith-app>.bottom>.cmd-box{width:100%}.openwith-app>.bottom>.cmd-box>.bold-noaa{display:block;margin-bottom:4px}.openwith-app>.bottom>.cmd-box>.w96-textbox{width:100%;box-sizing:border-box;margin-bottom:4px}.openwith-app>.box{flex:1;overflow:auto;background:#fff;border-left:1px solid #9a9a9a;border-top:1px solid #9a9a9a;border-right:1px solid #eee;border-bottom:1px solid #eee}.openwith-app>.box>.appbox{width:100%}.openwith-app>.box>.appbox>.item{width:50%;display:inline-block;box-sizing:border-box;padding:4px}.openwith-app>.box>.appbox>.item>.icon{height:32px;width:32px;background-size:32px 32px;display:inline-block;vertical-align:top}.openwith-app>.box>.appbox>.item>.text{display:inline-block;vertical-align:top;margin-left:5px;margin-top:9px;overflow:hidden;width:calc(100% - 32px - 5px);white-space:pre;text-overflow:ellipsis}.openwith-app>.box>.appbox>.item.selected{background:var(--select-color-primary);color:var(--select-color-secondary)}.window-dlg:not(.active) .openwith-app>.box>.appbox>.item.selected{background:gray}.app-dlg-recycle>.buttons{padding:10px;box-sizing:border-box;text-align:right}.app-dlg-recycle>.buttons>button{width:79px;height:23px}.app-dlg-recycle>.content{padding:15px;box-sizing:border-box;flex:1}.app-dlg-recycle>.content>.text{display:inline-block;vertical-align:top;max-width:calc(100% - 50px);margin-left:10px}.app-dlg-recycle>.content>.icon{height:32px;width:32px;display:inline-block}.ctrl-app>.view{height:100%;width:100%;display:flex;flex-direction:row;overflow:hidden}.ctrl-app>.view>.p1{width:155px;background:linear-gradient(to bottom, #01517D, #539A64);color:#fff;padding:5px;box-sizing:border-box}.ctrl-app>.view>.p1>.box{border:1px solid gray;margin-bottom:5px}.ctrl-app>.view>.p1>.box>.title{padding:5px;box-sizing:border-box;text-shadow:-1px 0 0 #fff;letter-spacing:1px;margin-left:1px}.ctrl-app>.view>.p1>.box>.items{background:#fff;color:#000040;padding:5px;box-sizing:border-box}.ctrl-app>.view>.p1>.box>.items>.item{display:block;margin-bottom:5px}.ctrl-app>.view>.p1>.box>.items>.item:last-child{margin-bottom:0px}.ctrl-app>.view>.p1>.box>.items>.item:hover{text-decoration:underline;cursor:url("system/resource/cursors/hand.png") 6 0,auto}.ctrl-app>.view>.p2{width:100%;flex:1;padding:10px;box-sizing:border-box;background:#fff;overflow-y:auto}.ctrl-app>.view>.p2>.item{width:170px;margin-bottom:10px;display:inline-block}.ctrl-app>.view>.p2>.item>.icon{height:32px;width:32px;display:inline-block;vertical-align:middle;padding-right:5px;background-size:contain;background-repeat:no-repeat}.ctrl-app>.view>.p2>.item>.title{display:inline-block;margin-left:3px;letter-spacing:1px;text-shadow:1px 0 #000}.ctrl-app>.view>.p2>.item:hover{cursor:url("system/resource/cursors/hand.png") 6 0,auto}.ctrl-app>.view>.p2>.item:hover>.title{text-decoration:underline;cursor:url("system/resource/cursors/hand.png") 6 0,auto}.ctrl-app>.view>.p2>.cat-marker{text-shadow:1px 0 0 #000;letter-spacing:1px;width:40%;margin-bottom:15px;transform:translateX(-10px);padding-left:10px}.ctrl-app>.view>.p2>.cat-marker::after{display:block;position:absolute;width:100%;height:2px;content:" ";background:linear-gradient(45deg, black, transparent);transform:translateX(-10px) translateY(3px)}.ctrl-app .w96-footer{margin-top:2px}.w96-ui-themewait{position:absolute;top:0;left:0;height:100%;width:100%;display:flex;background:rgba(0,0,0,.4);z-index:10000000}.w96-ui-themewait>.box{background-color:silver;margin:auto;font-family:"tahomapx";padding:20px;line-height:16px;text-shadow:1px 0 #000;letter-spacing:1px;border-left:1px solid #dfdfdf;border-top:1px solid #dfdfdf;border-right:1px solid #000;border-bottom:1px solid #000;box-shadow:inset -1px -1px 0px gray,inset 1px 1px 0px #fff;user-select:none}.laf-applet .th .w96-textbox{width:100%;box-sizing:border-box}.laf-applet .th .theme-preview{width:100%;border:1px solid gray;height:225px;background-size:contain;background-repeat:no-repeat;background-position:center}.laf-applet .th .theme-preview>iframe{pointer-events:none;border:none;height:100%;width:100%}.laf-applet .wp .wp-box{height:150px;width:100%;display:flex;margin-bottom:8px}.laf-applet .wp .wp-box>.preview{border:1px solid gray;height:100%;width:240px;margin:auto;background-size:contain;background-repeat:no-repeat;background-position:center}.laf-applet .wp .w96-listbox{display:inline-block;vertical-align:top;width:calc(100% - 80px);height:174px}.laf-applet .wp .w96-listbox>.item{padding-top:2px}.laf-applet .wp .w96-listbox>.item>.icon{background-image:none;height:16px;width:16px;display:inline-block;vertical-align:middle;margin-bottom:2px;margin-right:2px}.laf-applet .wp .actions{margin-left:10px;display:inline-block}.laf-applet .wp .actions>.browse{margin-bottom:8px}.devcfg-applet{padding:10px;box-sizing:border-box}.devcfg-applet .w96-groupbox>.dp{height:56px;width:56px;background-position:center;background-repeat:no-repeat;padding:0;line-height:13em;padding-right:1px}.devcfg-applet .buttons>button{float:right;margin-left:5px;height:23px;width:75px}.pkmgr-applet .repos-tab{display:flex;flex-direction:row}.pkmgr-applet .repos-tab>.w96-listbox{flex:1}.pkmgr-applet .repos-tab .buttons{margin-left:5px}.pkmgr-applet .repos-tab .buttons>button{display:block;width:64px}.wexplorer-app{padding:0}.wexplorer-app .nav-bar{display:flex;align-items:center;box-shadow:inset 0px 1px gray,inset 0px 2px #fff;height:24px}.wexplorer-app .nav-bar.compact-toolbar{padding:2px 0;padding-right:5px}.wexplorer-app .label-address{margin-left:7px}.cdlg-ofd.wexplorer-app .label-address{margin-left:13px;margin-right:4px}.wexplorer-app .nav-bar>.nav{width:100%;flex:1;outline:0;box-sizing:border-box;border-width:1px;line-height:14px;padding-left:5px;margin-left:3px;margin-right:3px;padding-top:2px}.wexplorer-app footer .cell{width:100%}.cdlg-ofd.wexplorer-app .nav-bar>.nav{width:203px}.wexplorer-app .nav-bar>.w96-button{background-position:center;height:16px;width:16px}.nav-bar.compact-toolbar .btn-up,.nav-bar.compact-toolbar .btn-desktop,.nav-bar.compact-toolbar .btn-new-folder{background-repeat:no-repeat}.wexplorer-app .nav-bar>.up{background-image:url("system/resource/app/explorer/up.png");margin-left:1px}.wexplorer-app .nav-bar>.go,.nav-bar.compact-toolbar button.w96-button{border:none;margin-right:2px;margin-top:1px;padding:0;height:18px;width:18px;outline:0}.nav-bar.compact-toolbar{margin-top:2px}.nav-bar.compact-toolbar button.w96-button{margin-left:8px;width:22px;height:22px}.nav-bar.compact-toolbar .btn-up{background-image:url("system/resource/app/explorer/toolbar/compact/up.png");background-position:3px 4px}.nav-bar.compact-toolbar .btn-desktop{background-image:url("system/resource/app/explorer/toolbar/compact/desktop.png");background-position:3px 2px}.nav-bar.compact-toolbar .btn-new-folder{background-image:url("system/resource/app/explorer/toolbar/compact/new-folder.png");background-position:3px 3px}.wexplorer-app .nav-bar>.go{background-image:url("system/resource/app/explorer/go.png")}.wexplorer-app:not(.cdlg-ofd) .nav-bar:not(.compact-toolbar)>.go{box-shadow:inset -1px -1px #85898d,inset 1px 1px #fff}.wexplorer-app .nav-bar>.go:active{box-shadow:inset -1px -1px #fff,inset 1px 1px #85898d}.wexplorer-app .w96-menubar{margin-top:1px;margin-left:1px}.wexplorer-app .w96-toolbar>.item{min-width:54px}.wexplorer-app .w96-toolbar>.item[disabled]{text-shadow:1px 1px #fff;color:#6d6d6d}.wexplorer-app .w96-toolbar>.item[disabled]>.icon{filter:contrast(0) drop-shadow(1px 1px #fff)}.wexplorer-app .w96-toolbar>.item>.icon{background-position:center;filter:grayscale(100%)}.wexplorer-app .w96-toolbar>.item:not([disabled]):hover>.icon{filter:none}.cdlg-ofd .nav-bar{box-shadow:none;width:calc(100% - 12px)}.cdlg-ofd>.bp{display:flex;padding:7px}.cdlg-ofd>.bp>.buttons{display:flex;flex-direction:column;justify-content:center;align-items:center;box-sizing:border-box;margin-left:auto}.cdlg-ofd>.bp>.input-area{display:flex;flex-direction:row;margin-left:10px;margin-right:20px;width:100%}.cdlg-ofd>.bp>.input-area>input{height:12px;width:100%}.cdlg-ofd>.bp>.input-area>span{margin-top:2px;margin-right:5px;min-width:70px}.cdlg-ofd>.bp>.buttons>button{width:71px}.cdlg-ofd>.bp>.buttons>button:not(:last-child){margin-bottom:6px}.cdlg-ofd .exp-file-view{margin:6px;width:calc(100% - 12px) !important}.wexplorer-app>.view-box{height:100%;box-sizing:border-box;flex:1;display:flex;flex-direction:revert;margin-top:2px;margin-bottom:2px;padding:1px;border-top:1px solid gray;border-left:1px solid gray;border-right:1px solid #dfdfdf;border-bottom:1px solid #dfdfdf;box-shadow:1px 1px #fff,1px 0 #fff,0 1px #fff,inset 1px 1px #000,inset 1px 0 #000,inset 0 1px #000;overflow:hidden}.wexplorer-app>.view-box>.sidebar{width:150px;height:100%;background-color:#fff;background-image:url("system/resource/app/explorer/side_pane.jpg");background-repeat:no-repeat}.wexplorer-app>.view-box>.exp-file-view{margin-top:0px;margin-bottom:0px;border:none}.wexplorer-app>.view-box>.sidebar>.file-box{box-sizing:border-box;padding:15px}.wexplorer-app>.view-box>.sidebar>.file-box>.desc{margin-top:15px;line-height:1.25}.wexplorer-app>.view-box>.sidebar>.file-box>.icon{height:32px;width:32px}.wexplorer-app>.view-box>.sidebar>.file-box>.name{line-height:1.5;text-shadow:-1px 0 #000;letter-spacing:1px;padding-top:8px;padding-bottom:15px;position:relative;left:1px}.wexplorer-app>.view-box>.sidebar>.file-box>.line{height:1px;background-color:#000;position:relative;left:-15px;width:0px;border-left:solid 66px #02527d;border-right:solid 66px #539a64}.wexplorer-app .w96-toolbar{height:45px}.wexplorer-app-propdlg .tab-general .p1>.icon{height:32px;width:32px;margin-right:40px;display:inline-block;vertical-align:top}.wexplorer-app-propdlg .tab-general .p1>.namebox{display:inline-block;vertical-align:middle;margin-top:5px;width:calc(100% - 83px)}.wexplorer-app-propdlg .tab-version .w96-groupbox{margin-top:20px}.wexplorer-app-propdlg .tab-version .vinfo-table{display:flex;flex-direction:row;height:145px}.wexplorer-app-propdlg .tab-version .vinfo-table .right,.wexplorer-app-propdlg .tab-version .vinfo-table .left{flex:1}.wexplorer-app-propdlg .tab-version .vinfo-table .right>*,.wexplorer-app-propdlg .tab-version .vinfo-table .left>*{display:block;width:100%;height:100%;box-sizing:border-box}.wexplorer-app-propdlg .tab-version .vinfo-table .left .w96-listbox{border-top:1px solid gray;border-left:1px solid gray;border-right:1px solid #dfdfdf;border-bottom:1px solid #dfdfdf;box-shadow:1px 1px #fff,1px 0 #fff,0 1px #fff,inset 1px 1px #000,inset 1px 0 #000,inset 0 1px #000}.wexplorer-app-propdlg .tab-version .vinfo-table .right{margin-left:9px}.wexplorer-app-propdlg .tab-version .vinfo-table .right textarea{resize:none;overflow-y:scroll}.wexplorer-app-propdlg .w96-tab-control>.content{padding:10px}.wexplorer-app-propdlg .field{display:flex;margin-bottom:10px}.wexplorer-app-propdlg .field>span{display:inline-block}.wexplorer-app-propdlg .field>.name{min-width:71px;margin-left:5px}.wexplorer-app-propdlg .field>.value{display:block;width:calc(100% - 71px);overflow:hidden;user-select:text;word-break:break-word}.sysupd-notif-wnd{display:flex;flex-direction:column}.sysupd-notif-wnd .top{flex:1;display:flex;flex-direction:row}.sysupd-notif-wnd .top .winlogo{width:72px;background-position:11px 11px;background-image:url(/system/resource/app/sysupdate/winicon.png);background-repeat:no-repeat}.sysupd-notif-wnd .top .text{flex:1;padding:12px;box-sizing:border-box}.sysupd-notif-wnd .bottom{text-align:right;padding:12px;box-sizing:border-box}.sysupd-notif-wnd .bottom button{width:118px;height:23px}.gameing-launcher-app{overflow:hidden;padding:10px;box-sizing:border-box}.gameing-launcher-app>.intro{margin-bottom:3em}.gameing-launcher-app>.main{flex:1}.gameing-launcher-app>.main .field>.name{margin-bottom:1em;display:inline-block;width:75px}.gameing-launcher-app>.main .field>select{width:calc(100% - 80px)}.gameing-launcher-app>.main .mk-shortcut{text-align:right;width:100%;display:block}.gameing-launcher-app>.buttons button{height:23px;min-width:75px}.gameing-launcher-app>.buttons button:not(.quit){float:right}.gameing-launcher-app>.buttons button:last-child{margin-right:5px}.gameing-launcher-app.busy{color:gray;text-shadow:1px 1px #fff;cursor:url(../cursors/busy.png) 7 11,auto}.health-app{display:flex;flex-direction:column;overflow:hidden}.health-app>.top{padding:18px;box-sizing:border-box}.health-app>.top>.title{padding-top:9px;padding-bottom:9px;font-size:22px}.health-app>.mid{padding:18px;box-sizing:border-box;flex:1;display:flex;flex-direction:row;padding-top:0;overflow-y:auto}.health-app>.mid>.left{width:165px;height:100%;margin-right:5px}.health-app>.mid>.left>.device{height:100px;width:100px;background-image:url(/system/apps/pc-health-check/pc.png);background-position:center;background-repeat:no-repeat;margin-bottom:10px}.health-app>.mid>.left>.device-title{font-size:11px;text-shadow:-1px 0px;letter-spacing:1px;margin-bottom:10px}.health-app>.mid>.left>.specs>.spec{margin-bottom:8px;color:#2f4f4f}.health-app>.mid>.content{flex:1;height:100%;width:100%}.health-app>.mid>.content .upgrade-notify-box{padding:15px;background:#d2d2d2;box-shadow:inset -1px -1px #0a0a0a,inset 1px 1px #fff,inset -2px -2px gray,inset 2px 2px #dfdfdf}.health-app>.mid>.content .upgrade-notify-box>.ex{margin-top:10px;margin-bottom:10px}.health-app>.mid>.content>.check-items>.item{margin-top:15px;background:#d2d2d2;box-sizing:border-box;padding:15px}.health-app>.mid>.content>.check-items>.item>.top>.title{display:inline-block}.health-app>.mid>.content>.check-items>.item>.top>.action{float:right;vertical-align:top}.health-app>.mid>.content>.check-items>.item>.top>.action.alert::before{content:url(/system/resource/icons/win96/16x16/status/warning.png);vertical-align:sub;margin-right:5px}.health-app>.mid>.content>.check-items>.item>.explanation>.title{display:block;margin-bottom:5px;margin-top:5px}.health-app>.bottom{padding:18px;box-sizing:border-box;background:#d2d2d2}.health-app>.bottom>.text{vertical-align:sub}.health-app .right{float:right}@keyframes fx-hue{0%{filter:hue-rotate(0deg)}100%{filter:hue-rotate(360deg)}}@keyframes fx-spin{0%{transform:rotate(0deg)}100%{transform:rotate(360deg)}}@keyframes fx-zoom{0%{transform:scale(1)}100%{transform:scale(2)}}.fx-zoom{animation-direction:alternate;animation-name:fx-zoom;animation-duration:.3s;animation-fill-mode:both;animation-timing-function:linear;animation-play-state:running;animation-iteration-count:infinite}.fx-hue{animation:fx-hue 1s linear infinite}.fx-spin{animation:fx-spin 7s linear infinite}.fx-upside-down{transform:rotate(180deg);transition:transform .5s}.fx-deepfryer{filter:saturate(10000000000)}.fx-grayscale{filter:grayscale(1)}.fx-invert{filter:invert(1)}.fx-blur{filter:blur(2px)}.fx-sepia{filter:sepia()}.fx-bright{filter:brightness(1.5)}.fx-bw{filter:contrast(1.4) sepia() saturate(100) brightness(100) grayscale(1) contrast(1.4)}.fx-desk-overlay{height:100%;width:100%;position:absolute;top:0px;left:0px;z-index:-100;pointer-events:none;background:linear-gradient(217deg, rgba(255, 0, 0, 0.8), rgba(255, 0, 0, 0.1) 70.71%),linear-gradient(127deg, rgba(0, 255, 0, 0.8), rgba(0, 255, 0, 0) 70.71%),linear-gradient(336deg, rgba(0, 0, 255, 0.8), rgba(0, 0, 255, 0) 70.71%);filter:contrast(1.5)}.meme-man{background-image:url(/system/resource/app/meme-man/meme-man-front.png);height:180px;width:180px;display:block;position:absolute;top:0px;left:0px;background-repeat:no-repeat;background-size:contain}.jsguirepl-app>.view{flex:1;height:100%;width:100%;background-color:#fff;overflow:hidden;display:flex;flex-direction:column;box-sizing:border-box;padding:1px;user-select:text;margin-bottom:2px}.jsguirepl-app>.view>.history{box-sizing:border-box;flex:1;height:100%;width:100%;white-space:pre-wrap;overflow:hidden;overflow-y:auto;display:flex;flex-direction:column}.jsguirepl-app>.view>.history .js-number{color:blue}.jsguirepl-app>.view>.history .js-string{color:brown}.jsguirepl-app>.view>.history .js-undefined{color:gray}.jsguirepl-app>.view>.history .js-symbol{color:#5f7a5a}.jsguirepl-app>.view>.history .js-bool{color:purple}.jsguirepl-app>.view>.history>.line{padding:5px;box-sizing:border-box}.jsguirepl-app>.view>.history>.line.error{color:maroon !important;background-color:#ffd2d2 !important}.jsguirepl-app>.view>.history>.line.error::before{color:maroon;text-shadow:1px 0 maroon !important;content:" !" !important}.jsguirepl-app>.view>.history>.line.error.exception>.name{text-shadow:1px 0 maroon;letter-spacing:1px}.jsguirepl-app>.view>.history>.line.caller-user{color:#8a2be2;background-color:#f0dfff}.jsguirepl-app>.view>.history>.line.caller-user::before{content:">> ";text-shadow:1px 0 0 #8a2be2;letter-spacing:1px;color:#8a2be2;width:14px;display:inline-block}.jsguirepl-app>.view>.history>.line.caller-code::before{content:"<< ";text-shadow:1px 0 0 #000;letter-spacing:1px;width:14px;display:inline-block;color:#000}.jsguirepl-app>.view>.history>.line:nth-child(even):not(.caller-user){background-color:#f0f0f0}.jsguirepl-app>.view>.history>.line:first-child{margin-top:auto}.jsguirepl-app>.view>.input{box-sizing:border-box;background-color:#e6f8ff;border-top:1px solid #606060;padding:5px}.jsguirepl-app>.view>.input>input{width:100%;height:100%;box-sizing:border-box;background:rgba(0,0,0,0);border:none !important;box-shadow:none !important;padding:0}.jsguirepl-app>.statbar{box-sizing:border-box}.jsguirepl-app>.statbar>.item{float:right;margin-right:5px;box-sizing:border-box;padding:2px}.jsguirepl-app>.statbar>.item>.icon{height:16px;width:16px;display:inline-block;vertical-align:middle;margin-right:5px}.jsguirepl-app>.statbar>.item:hover{background-color:navy;color:#fff}.zbuild-cfg{background:#333;color:#eee;font-family:fixed_bmp,monospace;font-size:13px;white-space:pre-wrap;line-height:1.3;padding:5px;box-sizing:border-box;overflow:auto}.zbuild-cfg .line{display:flex}.zbuild-cfg .eq{color:#666;white-space:pre}.dzdc-app>.header{height:58px;background-image:url("system/resource/app/dzdcon/header.png");border-bottom:1px solid #848284;box-shadow:0px 1px #fff}.dzdc-app>.content{flex:1}.dzdc-app>.content>.container{padding:10px 15px;box-sizing:border-box}.dzdc-app>.content.address .address-box{width:100%;box-sizing:border-box}.dzdc-app>.buttons{border-top:1px solid #fff;box-shadow:0px -1px #848284;padding:8px;box-sizing:border-box;text-align:right}.dzdc-app>.buttons>button{width:88px;height:22px}.dzdc-app>.buttons>button.cancel{margin-left:7px}.app-delivery-wnd>.ad-status>.app-item{display:flex;flex-direction:row;padding:5px;box-sizing:border-box}.app-delivery-wnd>.ad-status>.app-item>.icon{height:32px;width:32px;margin-right:5px}.app-delivery-wnd>.ad-status>.app-item>.stat-container{flex:1}.app-delivery-wnd>.ad-status>.app-item>.stat-container>*{width:100%;box-sizing:border-box}.dzdsvc-status-box{border:1px solid #000;background:wheat;width:250px;height:290px;position:fixed;bottom:28px;right:0;z-index:10;font:11px px_sans_serif;display:flex;flex-direction:column}.dzdsvc-status-box>.header{background-image:url(/system/resource/app/dzdcon/tray-header.png);height:48px;width:100%}.dzdsvc-status-box>.box{padding:5px;box-sizing:border-box;flex:1}.dzdsvc-status-box>.footer{padding:2px;background:#000;color:#fff}.superterm{box-sizing:border-box}.superterm-activity{display:inline-block;width:8px;height:8px;margin-top:5px;margin-right:5px;background:gray;box-shadow:1px 1px #000;float:right}.superterm .term{background:#000;line-height:1;padding:4px;box-sizing:border-box;color:lime;font-family:fixed_bmp,monospace;font-size:13px;height:100%;width:100%;white-space:pre-wrap;overflow-y:auto;overflow-x:hidden;user-select:text;cursor:url("system/resource/cursors/i-beam.png") 4 9,auto}.superterm .term span{display:inline;word-wrap:break-word;white-space:pre-wrap}.superterm .term span.clickable{user-select:none;cursor:url("system/resource/cursors/hand.png") 6 0,auto}.superterm .input{margin-top:3px;margin-bottom:2px;outline:0}.superterm .mbox{height:50px}.superterm .inputs{padding:4px;box-sizing:border-box}.superterm .inputs span,.superterm .inputs input{display:block;width:100%}.superterm .inputs input{margin-bottom:7px;margin-top:2px;padding-left:4px;box-sizing:border-box;width:100%;outline:0}.superterm .buttons{margin-top:6px;text-align:right;margin-right:4px}.superterm .buttons button{width:66px}.wmbox-vm-settings-dlg>.buttons{text-align:right;padding:5px;padding-top:0px;box-sizing:border-box}.wmbox-vm-settings-dlg>.buttons>button{min-width:65px}.wmbox-vm-settings-dlg>.w96-tab-control{flex:1}.wmbox-app{overflow:hidden}.wmbox-app>.vm-view{flex:1;display:flex;flex-direction:row;overflow:hidden}.wmbox-app>.vm-view>.overview{flex:1;display:flex;flex-direction:column}.wmbox-app>.vm-view>.overview>.title-box{padding:5px;box-sizing:border-box;border-bottom:1px solid gray;box-shadow:0px 1px #fff}.wmbox-app>.vm-view>.overview>.title-box>.icon{vertical-align:middle;display:inline-block;height:32px;width:32px;margin-right:5px}.wmbox-app>.vm-view>.overview>.title-box>.title{vertical-align:middle;display:inline-block}.wmbox-app>.vm-view>.overview>.ts-container{flex:1;display:flex;flex-direction:row;overflow:hidden}.wmbox-app>.vm-view>.overview>.ts-container>.p1{width:220px;border-right:1px solid gray;box-shadow:1px 0px #fff;padding:5px;box-sizing:border-box}.wmbox-app>.vm-view>.overview>.ts-container>.p1>.actions{margin-bottom:16px}.wmbox-app>.vm-view>.overview>.ts-container>.p1>.actions>button{min-width:66px}.wmbox-app>.vm-view>.overview>.ts-container>.p1 .attachments-gbx>.attachment:not(:last-child){margin-bottom:1px}.wmbox-app>.vm-view>.overview>.ts-container>.p1 .attachments-gbx>.attachment>.icon{height:16px;width:16px;display:inline-block;vertical-align:middle;margin-right:5px}.wmbox-app>.vm-view>.overview>.ts-container>.p1 .attachments-gbx>.attachment>.text{display:inline-block;vertical-align:middle}.wmbox-app>.vm-view>.overview>.ts-container>.p2{width:100%;flex:1;padding:5px;box-sizing:border-box}.wmbox-app>.vm-view>.overview>.ts-container>.p2>.preview-container{display:flex}.wmbox-app>.vm-view>.overview>.ts-container>.p2>.preview-container>.preview-box{margin-top:40px;margin-bottom:40px;margin:auto;display:flex}.wmbox-app>.vm-view>.overview>.ts-container>.p2>.preview-container>.preview-box>.preview{height:240px;width:320px;background:#000;border-left:1px solid #7b7b7b !important;border-top:1px solid #7b7b7b !important;border-right:1px solid #fff !important;border-bottom:1px solid #fff !important;box-shadow:inset -1px -1px 0px #dedede,inset 1px 1px 0px #000 !important;margin:auto}.wmbox-app>.vm-view>.path-pane{width:200px}.wmbox-app>.vm-view>.path-pane>.item{padding:5px}.wmbox-app>.vm-view>.path-pane>.item .icon{background-image:url(/system/resource/app/wmbox/icons/generic.png);height:32px;width:32px;display:inline-block;vertical-align:middle}.wmbox-app>.vm-view>.path-pane>.item .label{display:inline-block;vertical-align:middle;margin-left:5px}.wmbx-runner-app{overflow:hidden}.wmbx-runner-app>.vm{flex:1;border:none;background:#000}.wmbx-runner-app footer{margin-top:2px}.verbrowser-app .split-panel{flex:1;margin-bottom:2px;display:flex;flex-direction:row}.verbrowser-app .split-panel .w96-table{flex:1}.verbrowser-app .split-panel .preview{width:200px;padding:0 10px;box-sizing:border-box}.verbrowser-app .split-panel .preview .preview-container{margin-bottom:5px;width:184px;height:169px;background:url(/system/resource/misc/monitor.png)}.verbrowser-app .split-panel .preview .img-container{position:relative;top:17px;left:16px;width:152px;height:112px;image-rendering:crisp-edges;image-rendering:-moz-crisp-edges;image-rendering:pixelated}.recovery-app{box-sizing:border-box;padding:15px}.recovery-app>.items{width:100%}.recovery-app>.items>.item{width:100%;margin-bottom:15px;box-sizing:border-box}.recovery-app>.items>.item:first-child{margin-top:10px}.recovery-app>.items>.item>.icon{height:32px;width:32px;display:inline-block;background-image:none;vertical-align:top;margin-right:10px}.recovery-app>.items>.item>.text{display:inline-block}.recovery-app>.items>.item>.text>.bold-noaa{color:blue;text-decoration:underline;cursor:url("system/resource/cursors/hand.png") 6 0,auto}.recovery-app>.buttons{margin-top:auto;text-align:right}.recovery-app>.buttons>button{width:80px;height:23px}.msgroom-about-dlg{padding:10px;box-sizing:border-box;flex-direction:row !important}.msgroom-about-dlg>.icon{height:100%;width:64px;background-size:contain;background-repeat:no-repeat;image-rendering:pixelated;margin-right:16px}.msgroom-about-dlg>.p2{width:100%;height:100%;flex:1;display:flex;flex-direction:column}.msgroom-about-dlg>.p2>.title{font-size:16px}.msgroom-about-dlg>.p2>.buttons{text-align:right;margin-top:16px}.debug-feedback-wnd{padding:10px;box-sizing:border-box}.debug-feedback-wnd .field>input.fvalue{box-sizing:border-box}.debug-feedback-wnd .field>.description{box-sizing:border-box;resize:none;width:100%;height:100px}.debug-feedback-wnd .explanation,.debug-feedback-wnd .field{margin-bottom:10px}.debug-feedback-wnd .field>.contact,.debug-feedback-wnd .field>.textbox,.debug-feedback-wnd .field>.titlebox{width:100%}.debug-feedback-wnd .buttons{display:inline-block;width:100%;box-sizing:border-box}.debug-feedback-wnd .buttons button{float:right;margin-left:5px;height:23px;width:75px}.debug-feedback-wnd .title{letter-spacing:1px;text-shadow:-1px 0 #000;position:relative;left:1px}.debug-feedback-wnd.busy>*{pointer-events:none}.debug-feedback-wnd.busy button{text-shadow:1px 1px #fff}.debug-feedback-wnd.busy input,.debug-feedback-wnd.busy textarea{background:#d3d3d3 !important}.dbg-fps-counter{position:fixed;top:0;left:0;background-color:rgba(0,0,0,.8);color:#fff;font-family:monospace;padding:5px;box-sizing:border-box;pointer-events:none;z-index:10000000}.kern-debug-console{position:absolute;color:#fff;top:0;right:0;font-family:monospace;white-space:pre-wrap;line-height:1.3;background-color:rgba(0,0,0,.85);box-sizing:border-box;border:1px solid #fff;border-top:none;border-right:none;overflow-y:auto;max-height:300px;max-width:750px;z-index:1000000000000000}.kern-debug-console .line{border-bottom:1px solid rgba(255,255,255,.2392156863);padding:5px;box-sizing:border-box}.kern-debug-console .line.error{color:red}.kern-debug-console .line.error>.level{background:#900}.kern-debug-console .line.warn{color:#ff0}.kern-debug-console .line.warn>.level{background:#949900}.kern-debug-console .line>.time{color:gray}.kern-debug-console .line>.level{background:#000;color:#fff;margin-left:5px;margin-right:5px}.kern-debug-console .line>.level>.sub{background:purple}@media screen and (max-width: 700px){.kern-debug-console{width:100%}}html{cursor:url("system/resource/cursors/default.png"),auto;overflow:hidden;height:100%;width:100%}body{margin:0px;background-color:#000;perspective:1000px;height:100%;width:100%}#maingfx{overflow:hidden;height:100%;width:100%;background:#000}.w96-predesk-ui *:not(input){user-select:none;-moz-user-select:none;-ms-user-select:none;-webkit-user-select:none}:root{--select-color-primary: rgb(0, 0, 128);--select-color-secondary: white;--3d-obj-color-primary: rgb(192, 192, 192);--3d-obj-color-text: black}',""]);const a=s},3645:e=>{"use strict";e.exports=function(e){var t=[];return t.toString=function(){return this.map((function(t){var i="",r=void 0!==t[5];return t[4]&&(i+="@supports (".concat(t[4],") {")),t[2]&&(i+="@media ".concat(t[2]," {")),r&&(i+="@layer".concat(t[5].length>0?" ".concat(t[5]):""," {")),i+=e(t),r&&(i+="}"),t[2]&&(i+="}"),t[4]&&(i+="}"),i})).join("")},t.i=function(e,i,r,n,o){"string"==typeof e&&(e=[[null,e,void 0]]);var s={};if(r)for(var a=0;a<this.length;a++){var l=this[a][0];null!=l&&(s[l]=!0)}for(var c=0;c<e.length;c++){var d=[].concat(e[c]);r&&s[d[0]]||(void 0!==o&&(void 0===d[5]||(d[1]="@layer".concat(d[5].length>0?" ".concat(d[5]):""," {").concat(d[1],"}")),d[5]=o),i&&(d[2]?(d[1]="@media ".concat(d[2]," {").concat(d[1],"}"),d[2]=i):d[2]=i),n&&(d[4]?(d[1]="@supports (".concat(d[4],") {").concat(d[1],"}"),d[4]=n):d[4]="".concat(n)),t.push(d))}},t}},8081:e=>{"use strict";e.exports=function(e){return e[1]}},3150:e=>{"use strict";var t=/[|\\{}()[\]^$+*?.]/g;e.exports=function(e){if("string"!=typeof e)throw new TypeError("Expected a string");return e.replace(t,"\\$&")}},3379:e=>{"use strict";var t=[];function i(e){for(var i=-1,r=0;r<t.length;r++)if(t[r].identifier===e){i=r;break}return i}function r(e,r){for(var o={},s=[],a=0;a<e.length;a++){var l=e[a],c=r.base?l[0]+r.base:l[0],d=o[c]||0,h="".concat(c," ").concat(d);o[c]=d+1;var p=i(h),u={css:l[1],media:l[2],sourceMap:l[3],supports:l[4],layer:l[5]};if(-1!==p)t[p].references++,t[p].updater(u);else{var f=n(u,r);r.byIndex=a,t.splice(a,0,{identifier:h,updater:f,references:1})}s.push(h)}return s}function n(e,t){var i=t.domAPI(t);i.update(e);return function(t){if(t){if(t.css===e.css&&t.media===e.media&&t.sourceMap===e.sourceMap&&t.supports===e.supports&&t.layer===e.layer)return;i.update(e=t)}else i.remove()}}e.exports=function(e,n){var o=r(e=e||[],n=n||{});return function(e){e=e||[];for(var s=0;s<o.length;s++){var a=i(o[s]);t[a].references--}for(var l=r(e,n),c=0;c<o.length;c++){var d=i(o[c]);0===t[d].references&&(t[d].updater(),t.splice(d,1))}o=l}}},569:e=>{"use strict";var t={};e.exports=function(e,i){var r=function(e){if(void 0===t[e]){var i=document.querySelector(e);if(window.HTMLIFrameElement&&i instanceof window.HTMLIFrameElement)try{i=i.contentDocument.head}catch(e){i=null}t[e]=i}return t[e]}(e);if(!r)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");r.appendChild(i)}},9216:e=>{"use strict";e.exports=function(e){var t=document.createElement("style");return e.setAttributes(t,e.attributes),e.insert(t,e.options),t}},3565:(e,t,i)=>{"use strict";e.exports=function(e){var t=i.nc;t&&e.setAttribute("nonce",t)}},7795:e=>{"use strict";e.exports=function(e){var t=e.insertStyleElement(e);return{update:function(i){!function(e,t,i){var r="";i.supports&&(r+="@supports (".concat(i.supports,") {")),i.media&&(r+="@media ".concat(i.media," {"));var n=void 0!==i.layer;n&&(r+="@layer".concat(i.layer.length>0?" ".concat(i.layer):""," {")),r+=i.css,n&&(r+="}"),i.media&&(r+="}"),i.supports&&(r+="}");var o=i.sourceMap;o&&"undefined"!=typeof btoa&&(r+="\n/*# sourceMappingURL=data:application/json;base64,".concat(btoa(unescape(encodeURIComponent(JSON.stringify(o))))," */")),t.styleTagTransform(r,e,t.options)}(t,e,i)},remove:function(){!function(e){if(null===e.parentNode)return!1;e.parentNode.removeChild(e)}(t)}}}},4589:e=>{"use strict";e.exports=function(e,t){if(t.styleSheet)t.styleSheet.cssText=e;else{for(;t.firstChild;)t.removeChild(t.firstChild);t.appendChild(document.createTextNode(e))}}},8555:e=>{"use strict";e.exports={stdout:!1,stderr:!1}},2617:e=>{self,e.exports=(()=>{"use strict";var e={775:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.FitAddon=void 0;var i=function(){function e(){}return e.prototype.activate=function(e){this._terminal=e},e.prototype.dispose=function(){},e.prototype.fit=function(){var e=this.proposeDimensions();if(e&&this._terminal){var t=this._terminal._core;this._terminal.rows===e.rows&&this._terminal.cols===e.cols||(t._renderService.clear(),this._terminal.resize(e.cols,e.rows))}},e.prototype.proposeDimensions=function(){if(this._terminal&&this._terminal.element&&this._terminal.element.parentElement){var e=this._terminal._core;if(0!==e._renderService.dimensions.actualCellWidth&&0!==e._renderService.dimensions.actualCellHeight){var t=window.getComputedStyle(this._terminal.element.parentElement),i=parseInt(t.getPropertyValue("height")),r=Math.max(0,parseInt(t.getPropertyValue("width"))),n=window.getComputedStyle(this._terminal.element),o=i-(parseInt(n.getPropertyValue("padding-top"))+parseInt(n.getPropertyValue("padding-bottom"))),s=r-(parseInt(n.getPropertyValue("padding-right"))+parseInt(n.getPropertyValue("padding-left")))-e.viewport.scrollBarWidth;return{cols:Math.max(2,Math.floor(s/e._renderService.dimensions.actualCellWidth)),rows:Math.max(1,Math.floor(o/e._renderService.dimensions.actualCellHeight))}}}},e}();t.FitAddon=i}},t={};return function i(r){if(t[r])return t[r].exports;var n=t[r]={exports:{}};return e[r](n,n.exports,i),n.exports}(775)})()},292:e=>{self,e.exports=(()=>{"use strict";var e={965:(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.GlyphRenderer=void 0;var r=i(381),n=i(310),o=i(455),s=i(259),a=i(855),l=i(147),c=10,d=c*Float32Array.BYTES_PER_ELEMENT,h=function(){function e(e,t,i,n){this._terminal=e,this._colors=t,this._gl=i,this._dimensions=n,this._activeBuffer=0,this._vertices={count:0,attributes:new Float32Array(0),attributesBuffers:[new Float32Array(0),new Float32Array(0)],selectionAttributes:new Float32Array(0)};var o=this._gl,s=(0,r.throwIfFalsy)((0,r.createProgram)(o,"#version 300 es\nlayout (location = 0) in vec2 a_unitquad;\nlayout (location = 1) in vec2 a_cellpos;\nlayout (location = 2) in vec2 a_offset;\nlayout (location = 3) in vec2 a_size;\nlayout (location = 4) in vec2 a_texcoord;\nlayout (location = 5) in vec2 a_texsize;\n\nuniform mat4 u_projection;\nuniform vec2 u_resolution;\n\nout vec2 v_texcoord;\n\nvoid main() {\n  vec2 zeroToOne = (a_offset / u_resolution) + a_cellpos + (a_unitquad * a_size);\n  gl_Position = u_projection * vec4(zeroToOne, 0.0, 1.0);\n  v_texcoord = a_texcoord + a_unitquad * a_texsize;\n}","#version 300 es\nprecision lowp float;\n\nin vec2 v_texcoord;\n\nuniform sampler2D u_texture;\n\nout vec4 outColor;\n\nvoid main() {\n  outColor = texture(u_texture, v_texcoord);\n}"));this._program=s,this._projectionLocation=(0,r.throwIfFalsy)(o.getUniformLocation(this._program,"u_projection")),this._resolutionLocation=(0,r.throwIfFalsy)(o.getUniformLocation(this._program,"u_resolution")),this._textureLocation=(0,r.throwIfFalsy)(o.getUniformLocation(this._program,"u_texture")),this._vertexArrayObject=o.createVertexArray(),o.bindVertexArray(this._vertexArrayObject);var a=new Float32Array([0,0,1,0,0,1,1,1]),l=o.createBuffer();o.bindBuffer(o.ARRAY_BUFFER,l),o.bufferData(o.ARRAY_BUFFER,a,o.STATIC_DRAW),o.enableVertexAttribArray(0),o.vertexAttribPointer(0,2,this._gl.FLOAT,!1,0,0);var c=new Uint8Array([0,1,3,0,2,3]),h=o.createBuffer();o.bindBuffer(o.ELEMENT_ARRAY_BUFFER,h),o.bufferData(o.ELEMENT_ARRAY_BUFFER,c,o.STATIC_DRAW),this._attributesBuffer=(0,r.throwIfFalsy)(o.createBuffer()),o.bindBuffer(o.ARRAY_BUFFER,this._attributesBuffer),o.enableVertexAttribArray(2),o.vertexAttribPointer(2,2,o.FLOAT,!1,d,0),o.vertexAttribDivisor(2,1),o.enableVertexAttribArray(3),o.vertexAttribPointer(3,2,o.FLOAT,!1,d,2*Float32Array.BYTES_PER_ELEMENT),o.vertexAttribDivisor(3,1),o.enableVertexAttribArray(4),o.vertexAttribPointer(4,2,o.FLOAT,!1,d,4*Float32Array.BYTES_PER_ELEMENT),o.vertexAttribDivisor(4,1),o.enableVertexAttribArray(5),o.vertexAttribPointer(5,2,o.FLOAT,!1,d,6*Float32Array.BYTES_PER_ELEMENT),o.vertexAttribDivisor(5,1),o.enableVertexAttribArray(1),o.vertexAttribPointer(1,2,o.FLOAT,!1,d,8*Float32Array.BYTES_PER_ELEMENT),o.vertexAttribDivisor(1,1),this._atlasTexture=(0,r.throwIfFalsy)(o.createTexture()),o.bindTexture(o.TEXTURE_2D,this._atlasTexture),o.texImage2D(o.TEXTURE_2D,0,o.RGBA,1,1,0,o.RGBA,o.UNSIGNED_BYTE,new Uint8Array([0,0,255,255])),o.texParameteri(o.TEXTURE_2D,o.TEXTURE_WRAP_S,o.CLAMP_TO_EDGE),o.texParameteri(o.TEXTURE_2D,o.TEXTURE_WRAP_T,o.CLAMP_TO_EDGE),o.enable(o.BLEND),o.blendFunc(o.SRC_ALPHA,o.ONE_MINUS_SRC_ALPHA),this.onResize()}return e.prototype.beginFrame=function(){return!this._atlas||this._atlas.beginFrame()},e.prototype.updateCell=function(e,t,i,r,n,o){this._updateCell(this._vertices.attributes,e,t,i,r,n,o)},e.prototype._updateCell=function(e,t,i,r,n,s,l){var d,h=(i*this._terminal.cols+t)*c;r!==a.NULL_CELL_CODE&&void 0!==r?this._atlas&&((d=l&&l.length>1?this._atlas.getRasterizedGlyphCombinedChar(l,n,s):this._atlas.getRasterizedGlyph(r,n,s))?(e[h]=-d.offset.x+this._dimensions.scaledCharLeft,e[h+1]=-d.offset.y+this._dimensions.scaledCharTop,e[h+2]=d.size.x/this._dimensions.scaledCanvasWidth,e[h+3]=d.size.y/this._dimensions.scaledCanvasHeight,e[h+4]=d.texturePositionClipSpace.x,e[h+5]=d.texturePositionClipSpace.y,e[h+6]=d.sizeClipSpace.x,e[h+7]=d.sizeClipSpace.y):(0,o.fill)(e,0,h,h+c-1-2)):(0,o.fill)(e,0,h,h+c-1-2)},e.prototype.updateSelection=function(e){var t=this._terminal;this._vertices.selectionAttributes=(0,s.slice)(this._vertices.attributes,0);var i=this._colors.selectionOpaque.rgba>>>8|50331648;if(e.selection.columnSelectMode)for(var r=e.selection.startCol,n=e.selection.endCol-r,o=e.selection.viewportCappedEndRow-e.selection.viewportCappedStartRow+1,a=e.selection.viewportCappedStartRow;a<e.selection.viewportCappedStartRow+o;a++)this._updateSelectionRange(r,r+n,a,e,i);else{r=e.selection.viewportStartRow===e.selection.viewportCappedStartRow?e.selection.startCol:0;var l=e.selection.viewportCappedStartRow===e.selection.viewportCappedEndRow?e.selection.endCol:t.cols;this._updateSelectionRange(r,l,e.selection.viewportCappedStartRow,e,i);var c=Math.max(e.selection.viewportCappedEndRow-e.selection.viewportCappedStartRow-1,0);for(a=e.selection.viewportCappedStartRow+1;a<=e.selection.viewportCappedStartRow+c;a++)this._updateSelectionRange(0,l,a,e,i);if(e.selection.viewportCappedStartRow!==e.selection.viewportCappedEndRow){var d=e.selection.viewportEndRow===e.selection.viewportCappedEndRow?e.selection.endCol:t.cols;this._updateSelectionRange(0,d,e.selection.viewportCappedEndRow,e,i)}}},e.prototype._updateSelectionRange=function(e,t,i,r,o){for(var s,a=this._terminal,c=i+a.buffer.active.viewportY,d=e;d<t;d++){var h=(i*this._terminal.cols+d)*n.RENDER_MODEL_INDICIES_PER_CELL,p=r.cells[h],u=r.cells[h+n.RENDER_MODEL_FG_OFFSET];if(67108864&u){var f=new l.AttributeData;switch(f.fg=u,f.bg=r.cells[h+n.RENDER_MODEL_BG_OFFSET],u&=-134217728,f.getBgColorMode()){case 16777216:case 33554432:var _=this._getColorFromAnsiIndex(f.getBgColor()).rgba;u|=_>>8&16711680|_>>8&65280|_>>8&255;case 50331648:var g=l.AttributeData.toColorRGB(f.getBgColor());u|=g[0]<<16|g[1]<<8|g[2]<<0;default:var m=this._colors.background.rgba;u|=m>>8&16711680|m>>8&65280|m>>8&255}u|=50331648}if(p&n.COMBINED_CHAR_BIT_MASK){s||(s=a.buffer.active.getLine(c));var b=s.getCell(d).getChars();this._updateCell(this._vertices.selectionAttributes,d,i,r.cells[h],o,u,b)}else this._updateCell(this._vertices.selectionAttributes,d,i,r.cells[h],o,u)}},e.prototype._getColorFromAnsiIndex=function(e){if(e>=this._colors.ansi.length)throw new Error("No color found for idx "+e);return this._colors.ansi[e]},e.prototype.onResize=function(){var e=this._terminal,t=this._gl;t.viewport(0,0,t.canvas.width,t.canvas.height);var i=e.cols*e.rows*c;if(this._vertices.count!==i){this._vertices.count=i,this._vertices.attributes=new Float32Array(i);for(var r=0;r<this._vertices.attributesBuffers.length;r++)this._vertices.attributesBuffers[r]=new Float32Array(i);for(var n=0,o=0;o<e.rows;o++)for(var s=0;s<e.cols;s++)this._vertices.attributes[n+8]=s/e.cols,this._vertices.attributes[n+9]=o/e.rows,n+=c}},e.prototype.setColors=function(){},e.prototype.render=function(e,t){if(this._atlas){var i=this._gl;i.useProgram(this._program),i.bindVertexArray(this._vertexArrayObject),this._activeBuffer=(this._activeBuffer+1)%2;for(var n=this._vertices.attributesBuffers[this._activeBuffer],o=0,s=0;s<e.lineLengths.length;s++){var a=s*this._terminal.cols*c,l=(t?this._vertices.selectionAttributes:this._vertices.attributes).subarray(a,a+e.lineLengths[s]*c);n.set(l,o),o+=l.length}i.bindBuffer(i.ARRAY_BUFFER,this._attributesBuffer),i.bufferData(i.ARRAY_BUFFER,n.subarray(0,o),i.STREAM_DRAW),this._atlas.hasCanvasChanged&&(this._atlas.hasCanvasChanged=!1,i.uniform1i(this._textureLocation,0),i.activeTexture(i.TEXTURE0+0),i.bindTexture(i.TEXTURE_2D,this._atlasTexture),i.texImage2D(i.TEXTURE_2D,0,i.RGBA,i.RGBA,i.UNSIGNED_BYTE,this._atlas.cacheCanvas),i.generateMipmap(i.TEXTURE_2D)),i.uniformMatrix4fv(this._projectionLocation,!1,r.PROJECTION_MATRIX),i.uniform2f(this._resolutionLocation,i.canvas.width,i.canvas.height),i.drawElementsInstanced(i.TRIANGLES,6,i.UNSIGNED_BYTE,0,o/c)}},e.prototype.setAtlas=function(e){var t=this._gl;this._atlas=e,t.bindTexture(t.TEXTURE_2D,this._atlasTexture),t.texImage2D(t.TEXTURE_2D,0,t.RGBA,t.RGBA,t.UNSIGNED_BYTE,e.cacheCanvas),t.generateMipmap(t.TEXTURE_2D)},e.prototype.setDimensions=function(e){this._dimensions=e},e}();t.GlyphRenderer=h},344:(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.RectangleRenderer=void 0;var r=i(381),n=i(455),o=i(310),s=8*Float32Array.BYTES_PER_ELEMENT,a=function(){function e(e,t,i,n){this._terminal=e,this._colors=t,this._gl=i,this._dimensions=n,this._vertices={count:0,attributes:new Float32Array(160),selection:new Float32Array(24)};var o=this._gl;this._program=(0,r.throwIfFalsy)((0,r.createProgram)(o,"#version 300 es\nlayout (location = 0) in vec2 a_position;\nlayout (location = 1) in vec2 a_size;\nlayout (location = 2) in vec4 a_color;\nlayout (location = 3) in vec2 a_unitquad;\n\nuniform mat4 u_projection;\nuniform vec2 u_resolution;\n\nout vec4 v_color;\n\nvoid main() {\n  vec2 zeroToOne = (a_position + (a_unitquad * a_size)) / u_resolution;\n  gl_Position = u_projection * vec4(zeroToOne, 0.0, 1.0);\n  v_color = a_color;\n}","#version 300 es\nprecision lowp float;\n\nin vec4 v_color;\n\nout vec4 outColor;\n\nvoid main() {\n  outColor = v_color;\n}")),this._resolutionLocation=(0,r.throwIfFalsy)(o.getUniformLocation(this._program,"u_resolution")),this._projectionLocation=(0,r.throwIfFalsy)(o.getUniformLocation(this._program,"u_projection")),this._vertexArrayObject=o.createVertexArray(),o.bindVertexArray(this._vertexArrayObject);var a=new Float32Array([0,0,1,0,0,1,1,1]),l=o.createBuffer();o.bindBuffer(o.ARRAY_BUFFER,l),o.bufferData(o.ARRAY_BUFFER,a,o.STATIC_DRAW),o.enableVertexAttribArray(3),o.vertexAttribPointer(3,2,this._gl.FLOAT,!1,0,0);var c=new Uint8Array([0,1,3,0,2,3]),d=o.createBuffer();o.bindBuffer(o.ELEMENT_ARRAY_BUFFER,d),o.bufferData(o.ELEMENT_ARRAY_BUFFER,c,o.STATIC_DRAW),this._attributesBuffer=(0,r.throwIfFalsy)(o.createBuffer()),o.bindBuffer(o.ARRAY_BUFFER,this._attributesBuffer),o.enableVertexAttribArray(0),o.vertexAttribPointer(0,2,o.FLOAT,!1,s,0),o.vertexAttribDivisor(0,1),o.enableVertexAttribArray(1),o.vertexAttribPointer(1,2,o.FLOAT,!1,s,2*Float32Array.BYTES_PER_ELEMENT),o.vertexAttribDivisor(1,1),o.enableVertexAttribArray(2),o.vertexAttribPointer(2,4,o.FLOAT,!1,s,4*Float32Array.BYTES_PER_ELEMENT),o.vertexAttribDivisor(2,1),this._updateCachedColors()}return e.prototype.render=function(){var e=this._gl;e.useProgram(this._program),e.bindVertexArray(this._vertexArrayObject),e.uniformMatrix4fv(this._projectionLocation,!1,r.PROJECTION_MATRIX),e.uniform2f(this._resolutionLocation,e.canvas.width,e.canvas.height),e.bindBuffer(e.ARRAY_BUFFER,this._attributesBuffer),e.bufferData(e.ARRAY_BUFFER,this._vertices.attributes,e.DYNAMIC_DRAW),e.drawElementsInstanced(this._gl.TRIANGLES,6,e.UNSIGNED_BYTE,0,this._vertices.count),e.bindBuffer(e.ARRAY_BUFFER,this._attributesBuffer),e.bufferData(e.ARRAY_BUFFER,this._vertices.selection,e.DYNAMIC_DRAW),e.drawElementsInstanced(this._gl.TRIANGLES,6,e.UNSIGNED_BYTE,0,3)},e.prototype.onResize=function(){this._updateViewportRectangle()},e.prototype.setColors=function(){this._updateCachedColors(),this._updateViewportRectangle()},e.prototype._updateCachedColors=function(){this._bgFloat=this._colorToFloat32Array(this._colors.background),this._selectionFloat=this._colorToFloat32Array(this._colors.selectionOpaque)},e.prototype._updateViewportRectangle=function(){this._addRectangleFloat(this._vertices.attributes,0,0,0,this._terminal.cols*this._dimensions.scaledCellWidth,this._terminal.rows*this._dimensions.scaledCellHeight,this._bgFloat)},e.prototype.updateSelection=function(e){var t=this._terminal;if(e.hasSelection)if(e.columnSelectMode){var i=e.startCol,r=e.endCol-i,o=e.viewportCappedEndRow-e.viewportCappedStartRow+1;this._addRectangleFloat(this._vertices.selection,0,i*this._dimensions.scaledCellWidth,e.viewportCappedStartRow*this._dimensions.scaledCellHeight,r*this._dimensions.scaledCellWidth,o*this._dimensions.scaledCellHeight,this._selectionFloat),(0,n.fill)(this._vertices.selection,0,8)}else{i=e.viewportStartRow===e.viewportCappedStartRow?e.startCol:0;var s=e.viewportCappedStartRow===e.viewportEndRow?e.endCol:t.cols;this._addRectangleFloat(this._vertices.selection,0,i*this._dimensions.scaledCellWidth,e.viewportCappedStartRow*this._dimensions.scaledCellHeight,(s-i)*this._dimensions.scaledCellWidth,this._dimensions.scaledCellHeight,this._selectionFloat);var a=Math.max(e.viewportCappedEndRow-e.viewportCappedStartRow-1,0);if(this._addRectangleFloat(this._vertices.selection,8,0,(e.viewportCappedStartRow+1)*this._dimensions.scaledCellHeight,t.cols*this._dimensions.scaledCellWidth,a*this._dimensions.scaledCellHeight,this._selectionFloat),e.viewportCappedStartRow!==e.viewportCappedEndRow){var l=e.viewportEndRow===e.viewportCappedEndRow?e.endCol:t.cols;this._addRectangleFloat(this._vertices.selection,16,0,e.viewportCappedEndRow*this._dimensions.scaledCellHeight,l*this._dimensions.scaledCellWidth,this._dimensions.scaledCellHeight,this._selectionFloat)}else(0,n.fill)(this._vertices.selection,0,16)}else(0,n.fill)(this._vertices.selection,0,0)},e.prototype.updateBackgrounds=function(e){for(var t=this._terminal,i=this._vertices,r=1,n=0;n<t.rows;n++){for(var s=-1,a=0,l=0,c=!1,d=0;d<t.cols;d++){var h=(n*t.cols+d)*o.RENDER_MODEL_INDICIES_PER_CELL,p=e.cells[h+o.RENDER_MODEL_BG_OFFSET],u=e.cells[h+o.RENDER_MODEL_FG_OFFSET],f=!!(67108864&u);if(p!==a||u!==l&&(c||f)){if(0!==a||c&&0!==l){var _=8*r++;this._updateRectangle(i,_,l,a,s,d,n)}s=d,a=p,l=u,c=f}}(0!==a||c&&0!==l)&&(_=8*r++,this._updateRectangle(i,_,l,a,s,t.cols,n))}i.count=r},e.prototype._updateRectangle=function(e,t,i,n,o,s,a){var l;if(67108864&i)switch(50331648&i){case 16777216:case 33554432:l=this._colors.ansi[255&i].rgba;break;case 50331648:l=(16777215&i)<<8;break;default:l=this._colors.foreground.rgba}else switch(50331648&n){case 16777216:case 33554432:l=this._colors.ansi[255&n].rgba;break;case 50331648:l=(16777215&n)<<8;break;default:l=this._colors.background.rgba}e.attributes.length<t+4&&(e.attributes=(0,r.expandFloat32Array)(e.attributes,this._terminal.rows*this._terminal.cols*8));var c=o*this._dimensions.scaledCellWidth,d=a*this._dimensions.scaledCellHeight,h=(l>>24&255)/255,p=(l>>16&255)/255,u=(l>>8&255)/255;this._addRectangle(e.attributes,t,c,d,(s-o)*this._dimensions.scaledCellWidth,this._dimensions.scaledCellHeight,h,p,u,1)},e.prototype._addRectangle=function(e,t,i,r,n,o,s,a,l,c){e[t]=i,e[t+1]=r,e[t+2]=n,e[t+3]=o,e[t+4]=s,e[t+5]=a,e[t+6]=l,e[t+7]=c},e.prototype._addRectangleFloat=function(e,t,i,r,n,o,s){e[t]=i,e[t+1]=r,e[t+2]=n,e[t+3]=o,e[t+4]=s[0],e[t+5]=s[1],e[t+6]=s[2],e[t+7]=s[3]},e.prototype._colorToFloat32Array=function(e){return new Float32Array([(e.rgba>>24&255)/255,(e.rgba>>16&255)/255,(e.rgba>>8&255)/255,(255&e.rgba)/255])},e}();t.RectangleRenderer=a},310:(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.RenderModel=t.COMBINED_CHAR_BIT_MASK=t.RENDER_MODEL_FG_OFFSET=t.RENDER_MODEL_BG_OFFSET=t.RENDER_MODEL_INDICIES_PER_CELL=void 0;var r=i(455);t.RENDER_MODEL_INDICIES_PER_CELL=3,t.RENDER_MODEL_BG_OFFSET=1,t.RENDER_MODEL_FG_OFFSET=2,t.COMBINED_CHAR_BIT_MASK=2147483648;var n=function(){function e(){this.cells=new Uint32Array(0),this.lineLengths=new Uint32Array(0),this.selection={hasSelection:!1,columnSelectMode:!1,viewportStartRow:0,viewportEndRow:0,viewportCappedStartRow:0,viewportCappedEndRow:0,startCol:0,endCol:0}}return e.prototype.resize=function(e,i){var r=e*i*t.RENDER_MODEL_INDICIES_PER_CELL;r!==this.cells.length&&(this.cells=new Uint32Array(r),this.lineLengths=new Uint32Array(i))},e.prototype.clear=function(){(0,r.fill)(this.cells,0,0),(0,r.fill)(this.lineLengths,0,0)},e.prototype.clearSelection=function(){this.selection.hasSelection=!1,this.selection.viewportStartRow=0,this.selection.viewportEndRow=0,this.selection.viewportCappedStartRow=0,this.selection.viewportCappedEndRow=0,this.selection.startCol=0,this.selection.endCol=0},e}();t.RenderModel=n},259:(e,t)=>{function i(e,t,i){void 0===t&&(t=0),void 0===i&&(i=e.length),t<0&&(t=(e.length+t)%e.length),i=i>=e.length?e.length:(e.length+i)%e.length,t=Math.min(t,i);for(var r=new e.constructor(i-t),n=0;n<i-t;++n)r[n]=e[n+t];return r}Object.defineProperty(t,"__esModule",{value:!0}),t.sliceFallback=t.slice=void 0,t.slice=function(e,t,r){return e.slice?e.slice(t,r):i(e,t,r)},t.sliceFallback=i},666:function(e,t,i){var r,n=this&&this.__extends||(r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])},r(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function i(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)});Object.defineProperty(t,"__esModule",{value:!0}),t.JoinedCellData=t.WebglRenderer=void 0;var o=i(965),s=i(733),a=i(461),l=i(713),c=i(344),d=i(310),h=i(859),p=i(855),u=i(345),f=i(782),_=i(820),g=i(147),m=function(e){function t(t,i,r,n){var l=e.call(this)||this;l._terminal=t,l._colors=i,l._characterJoinerService=r,l._model=new d.RenderModel,l._workCell=new f.CellData,l._onRequestRedraw=new u.EventEmitter,l._onContextLoss=new u.EventEmitter,l._core=l._terminal._core,l._renderLayers=[new s.LinkRenderLayer(l._core.screenElement,2,l._colors,l._core),new a.CursorRenderLayer(t,l._core.screenElement,3,l._colors,l._core,l._onRequestRedraw)],l.dimensions={scaledCharWidth:0,scaledCharHeight:0,scaledCellWidth:0,scaledCellHeight:0,scaledCharLeft:0,scaledCharTop:0,scaledCanvasWidth:0,scaledCanvasHeight:0,canvasWidth:0,canvasHeight:0,actualCellWidth:0,actualCellHeight:0},l._devicePixelRatio=window.devicePixelRatio,l._updateDimensions(),l._canvas=document.createElement("canvas");var h={antialias:!1,depth:!1,preserveDrawingBuffer:n};if(l._gl=l._canvas.getContext("webgl2",h),!l._gl)throw new Error("WebGL2 not supported "+l._gl);return l.register((0,_.addDisposableDomListener)(l._canvas,"webglcontextlost",(function(e){l._onContextLoss.fire(e)}))),l._core.screenElement.appendChild(l._canvas),l._rectangleRenderer=new c.RectangleRenderer(l._terminal,l._colors,l._gl,l.dimensions),l._glyphRenderer=new o.GlyphRenderer(l._terminal,l._colors,l._gl,l.dimensions),l.onCharSizeChanged(),l._isAttached=document.body.contains(l._core.screenElement),l}return n(t,e),Object.defineProperty(t.prototype,"onRequestRedraw",{get:function(){return this._onRequestRedraw.event},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"onContextLoss",{get:function(){return this._onContextLoss.event},enumerable:!1,configurable:!0}),t.prototype.dispose=function(){for(var t,i=0,r=this._renderLayers;i<r.length;i++)r[i].dispose();null===(t=this._canvas.parentElement)||void 0===t||t.removeChild(this._canvas),e.prototype.dispose.call(this)},Object.defineProperty(t.prototype,"textureAtlas",{get:function(){var e;return null===(e=this._charAtlas)||void 0===e?void 0:e.cacheCanvas},enumerable:!1,configurable:!0}),t.prototype.setColors=function(e){this._colors=e;for(var t=0,i=this._renderLayers;t<i.length;t++){var r=i[t];r.setColors(this._terminal,this._colors),r.reset(this._terminal)}this._rectangleRenderer.setColors(),this._glyphRenderer.setColors(),this._refreshCharAtlas(),this._model.clear()},t.prototype.onDevicePixelRatioChange=function(){this._devicePixelRatio!==window.devicePixelRatio&&(this._devicePixelRatio=window.devicePixelRatio,this.onResize(this._terminal.cols,this._terminal.rows))},t.prototype.onResize=function(e,t){this._updateDimensions(),this._model.resize(this._terminal.cols,this._terminal.rows);for(var i=0,r=this._renderLayers;i<r.length;i++)r[i].resize(this._terminal,this.dimensions);this._canvas.width=this.dimensions.scaledCanvasWidth,this._canvas.height=this.dimensions.scaledCanvasHeight,this._canvas.style.width=this.dimensions.canvasWidth+"px",this._canvas.style.height=this.dimensions.canvasHeight+"px",this._core.screenElement.style.width=this.dimensions.canvasWidth+"px",this._core.screenElement.style.height=this.dimensions.canvasHeight+"px",this._rectangleRenderer.onResize(),this._model.selection.hasSelection&&this._rectangleRenderer.updateSelection(this._model.selection),this._glyphRenderer.setDimensions(this.dimensions),this._glyphRenderer.onResize(),this._refreshCharAtlas(),this._model.clear()},t.prototype.onCharSizeChanged=function(){this.onResize(this._terminal.cols,this._terminal.rows)},t.prototype.onBlur=function(){for(var e=0,t=this._renderLayers;e<t.length;e++)t[e].onBlur(this._terminal)},t.prototype.onFocus=function(){for(var e=0,t=this._renderLayers;e<t.length;e++)t[e].onFocus(this._terminal)},t.prototype.onSelectionChanged=function(e,t,i){for(var r=0,n=this._renderLayers;r<n.length;r++)n[r].onSelectionChanged(this._terminal,e,t,i);this._updateSelectionModel(e,t,i),this._onRequestRedraw.fire({start:0,end:this._terminal.rows-1})},t.prototype.onCursorMove=function(){for(var e=0,t=this._renderLayers;e<t.length;e++)t[e].onCursorMove(this._terminal)},t.prototype.onOptionsChanged=function(){for(var e=0,t=this._renderLayers;e<t.length;e++)t[e].onOptionsChanged(this._terminal);this._updateDimensions(),this._refreshCharAtlas()},t.prototype._refreshCharAtlas=function(){if(this.dimensions.scaledCharWidth<=0&&this.dimensions.scaledCharHeight<=0)this._isAttached=!1;else{var e=(0,l.acquireCharAtlas)(this._terminal,this._colors,this.dimensions.scaledCellWidth,this.dimensions.scaledCellHeight,this.dimensions.scaledCharWidth,this.dimensions.scaledCharHeight);if(!("getRasterizedGlyph"in e))throw new Error("The webgl renderer only works with the webgl char atlas");this._charAtlas=e,this._charAtlas.warmUp(),this._glyphRenderer.setAtlas(this._charAtlas)}},t.prototype.clearCharAtlas=function(){var e;null===(e=this._charAtlas)||void 0===e||e.clearTexture(),this._model.clear(),this._updateModel(0,this._terminal.rows-1),this._onRequestRedraw.fire({start:0,end:this._terminal.rows-1})},t.prototype.clear=function(){for(var e=0,t=this._renderLayers;e<t.length;e++)t[e].reset(this._terminal)},t.prototype.registerCharacterJoiner=function(e){return-1},t.prototype.deregisterCharacterJoiner=function(e){return!1},t.prototype.renderRows=function(e,t){if(!this._isAttached){if(!(document.body.contains(this._core.screenElement)&&this._core._charSizeService.width&&this._core._charSizeService.height))return;this._updateDimensions(),this._refreshCharAtlas(),this._isAttached=!0}for(var i=0,r=this._renderLayers;i<r.length;i++)r[i].onGridChanged(this._terminal,e,t);this._glyphRenderer.beginFrame()&&(this._model.clear(),this._updateSelectionModel(void 0,void 0)),this._updateModel(e,t),this._rectangleRenderer.render(),this._glyphRenderer.render(this._model,this._model.selection.hasSelection)},t.prototype._updateModel=function(e,t){for(var i=this._core,r=this._workCell,n=e;n<=t;n++){var o=n+i.buffer.ydisp,s=i.buffer.lines.get(o);this._model.lineLengths[n]=0;for(var a=this._characterJoinerService.getJoinedCharacters(o),l=0;l<i.cols;l++){s.loadCell(l,r);var c=!1,h=l;if(a.length>0&&l===a[0][0]){c=!0;var u=a.shift();r=new b(r,s.translateToString(!0,u[0],u[1]),u[1]-u[0]),h=u[1]-1}var f=r.getChars(),_=r.getCode(),g=(n*i.cols+l)*d.RENDER_MODEL_INDICIES_PER_CELL;if(_!==p.NULL_CELL_CODE&&(this._model.lineLengths[n]=l+1),(this._model.cells[g]!==_||this._model.cells[g+d.RENDER_MODEL_BG_OFFSET]!==r.bg||this._model.cells[g+d.RENDER_MODEL_FG_OFFSET]!==r.fg)&&(f.length>1&&(_|=d.COMBINED_CHAR_BIT_MASK),this._model.cells[g]=_,this._model.cells[g+d.RENDER_MODEL_BG_OFFSET]=r.bg,this._model.cells[g+d.RENDER_MODEL_FG_OFFSET]=r.fg,this._glyphRenderer.updateCell(l,n,_,r.bg,r.fg,f),c))for(r=this._workCell,l++;l<h;l++){var m=(n*i.cols+l)*d.RENDER_MODEL_INDICIES_PER_CELL;this._glyphRenderer.updateCell(l,n,p.NULL_CELL_CODE,0,0,p.NULL_CELL_CHAR),this._model.cells[m]=p.NULL_CELL_CODE,this._model.cells[m+d.RENDER_MODEL_BG_OFFSET]=this._workCell.bg,this._model.cells[m+d.RENDER_MODEL_FG_OFFSET]=this._workCell.fg}}}this._rectangleRenderer.updateBackgrounds(this._model),this._model.selection.hasSelection&&this._glyphRenderer.updateSelection(this._model)},t.prototype._updateSelectionModel=function(e,t,i){void 0===i&&(i=!1);var r=this._terminal;if(!e||!t||e[0]===t[0]&&e[1]===t[1])return this._model.clearSelection(),void this._rectangleRenderer.updateSelection(this._model.selection);var n=e[1]-r.buffer.active.viewportY,o=t[1]-r.buffer.active.viewportY,s=Math.max(n,0),a=Math.min(o,r.rows-1);if(s>=r.rows||a<0)return this._model.clearSelection(),void this._rectangleRenderer.updateSelection(this._model.selection);this._model.selection.hasSelection=!0,this._model.selection.columnSelectMode=i,this._model.selection.viewportStartRow=n,this._model.selection.viewportEndRow=o,this._model.selection.viewportCappedStartRow=s,this._model.selection.viewportCappedEndRow=a,this._model.selection.startCol=e[0],this._model.selection.endCol=t[0],this._rectangleRenderer.updateSelection(this._model.selection)},t.prototype._updateDimensions=function(){this._core._charSizeService.width&&this._core._charSizeService.height&&(this.dimensions.scaledCharWidth=Math.floor(this._core._charSizeService.width*this._devicePixelRatio),this.dimensions.scaledCharHeight=Math.ceil(this._core._charSizeService.height*this._devicePixelRatio),this.dimensions.scaledCellHeight=Math.floor(this.dimensions.scaledCharHeight*this._terminal.getOption("lineHeight")),this.dimensions.scaledCharTop=1===this._terminal.getOption("lineHeight")?0:Math.round((this.dimensions.scaledCellHeight-this.dimensions.scaledCharHeight)/2),this.dimensions.scaledCellWidth=this.dimensions.scaledCharWidth+Math.round(this._terminal.getOption("letterSpacing")),this.dimensions.scaledCharLeft=Math.floor(this._terminal.getOption("letterSpacing")/2),this.dimensions.scaledCanvasHeight=this._terminal.rows*this.dimensions.scaledCellHeight,this.dimensions.scaledCanvasWidth=this._terminal.cols*this.dimensions.scaledCellWidth,this.dimensions.canvasHeight=Math.round(this.dimensions.scaledCanvasHeight/this._devicePixelRatio),this.dimensions.canvasWidth=Math.round(this.dimensions.scaledCanvasWidth/this._devicePixelRatio),this.dimensions.actualCellHeight=this.dimensions.scaledCellHeight/this._devicePixelRatio,this.dimensions.actualCellWidth=this.dimensions.scaledCellWidth/this._devicePixelRatio)},t}(h.Disposable);t.WebglRenderer=m;var b=function(e){function t(t,i,r){var n=e.call(this)||this;return n.content=0,n.combinedData="",n.fg=t.fg,n.bg=t.bg,n.combinedData=i,n._width=r,n}return n(t,e),t.prototype.isCombined=function(){return 2097152},t.prototype.getWidth=function(){return this._width},t.prototype.getChars=function(){return this.combinedData},t.prototype.getCode=function(){return 2097151},t.prototype.setFromCharData=function(e){throw new Error("not implemented")},t.prototype.getAsCharData=function(){return[this.fg,this.getChars(),this.getWidth(),this.getCode()]},t}(g.AttributeData);t.JoinedCellData=b},381:(e,t)=>{function i(e,t,i){var n=r(e.createShader(t));if(e.shaderSource(n,i),e.compileShader(n),e.getShaderParameter(n,e.COMPILE_STATUS))return n;console.error(e.getShaderInfoLog(n)),e.deleteShader(n)}function r(e){if(!e)throw new Error("value must not be falsy");return e}Object.defineProperty(t,"__esModule",{value:!0}),t.throwIfFalsy=t.expandFloat32Array=t.createShader=t.createProgram=t.PROJECTION_MATRIX=void 0,t.PROJECTION_MATRIX=new Float32Array([2,0,0,0,0,-2,0,0,0,0,1,0,-1,1,0,1]),t.createProgram=function(e,t,n){var o=r(e.createProgram());if(e.attachShader(o,r(i(e,e.VERTEX_SHADER,t))),e.attachShader(o,r(i(e,e.FRAGMENT_SHADER,n))),e.linkProgram(o),e.getProgramParameter(o,e.LINK_STATUS))return o;console.error(e.getProgramInfoLog(o)),e.deleteProgram(o)},t.createShader=i,t.expandFloat32Array=function(e,t){for(var i=Math.min(2*e.length,t),r=new Float32Array(i),n=0;n<e.length;n++)r[n]=e[n];return r},t.throwIfFalsy=r},713:(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.removeTerminalFromCache=t.acquireCharAtlas=void 0;var r=i(433),n=i(167),o=[];t.acquireCharAtlas=function(e,t,i,s,a,l){for(var c=(0,r.generateConfig)(i,s,a,l,e,t),d=0;d<o.length;d++){var h=(p=o[d]).ownedBy.indexOf(e);if(h>=0){if((0,r.configEquals)(p.config,c))return p.atlas;1===p.ownedBy.length?(p.atlas.dispose(),o.splice(d,1)):p.ownedBy.splice(h,1);break}}for(d=0;d<o.length;d++){var p=o[d];if((0,r.configEquals)(p.config,c))return p.ownedBy.push(e),p.atlas}var u={atlas:new n.WebglCharAtlas(document,c),config:c,ownedBy:[e]};return o.push(u),u.atlas},t.removeTerminalFromCache=function(e){for(var t=0;t<o.length;t++){var i=o[t].ownedBy.indexOf(e);if(-1!==i){1===o[t].ownedBy.length?(o[t].atlas.dispose(),o.splice(t,1)):o[t].ownedBy.splice(i,1);break}}}},433:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.is256Color=t.configEquals=t.generateConfig=void 0;var i={css:"",rgba:0};t.generateConfig=function(e,t,r,n,o,s){var a={foreground:s.foreground,background:s.background,cursor:i,cursorAccent:i,selectionTransparent:i,selectionOpaque:i,ansi:s.ansi.slice(),contrastCache:s.contrastCache};return{customGlyphs:o.getOption("customGlyphs"),devicePixelRatio:window.devicePixelRatio,letterSpacing:o.getOption("letterSpacing"),lineHeight:o.getOption("lineHeight"),scaledCellWidth:e,scaledCellHeight:t,scaledCharWidth:r,scaledCharHeight:n,fontFamily:o.getOption("fontFamily"),fontSize:o.getOption("fontSize"),fontWeight:o.getOption("fontWeight"),fontWeightBold:o.getOption("fontWeightBold"),allowTransparency:o.getOption("allowTransparency"),drawBoldTextInBrightColors:o.getOption("drawBoldTextInBrightColors"),minimumContrastRatio:o.getOption("minimumContrastRatio"),colors:a}},t.configEquals=function(e,t){for(var i=0;i<e.colors.ansi.length;i++)if(e.colors.ansi[i].rgba!==t.colors.ansi[i].rgba)return!1;return e.devicePixelRatio===t.devicePixelRatio&&e.customGlyphs===t.customGlyphs&&e.lineHeight===t.lineHeight&&e.letterSpacing===t.letterSpacing&&e.fontFamily===t.fontFamily&&e.fontSize===t.fontSize&&e.fontWeight===t.fontWeight&&e.fontWeightBold===t.fontWeightBold&&e.allowTransparency===t.allowTransparency&&e.scaledCharWidth===t.scaledCharWidth&&e.scaledCharHeight===t.scaledCharHeight&&e.drawBoldTextInBrightColors===t.drawBoldTextInBrightColors&&e.minimumContrastRatio===t.minimumContrastRatio&&e.colors.foreground===t.colors.foreground&&e.colors.background===t.colors.background},t.is256Color=function(e){return 16777216==(50331648&e)||33554432==(50331648&e)}},167:(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.WebglCharAtlas=void 0;var r=i(499),n=i(855),o=i(381),s=i(147),a=i(742),l=i(14),c=1024,d=1024,h=Math.floor(819.2),p={css:"rgba(0, 0, 0, 0)",rgba:0},u={offset:{x:0,y:0},texturePosition:{x:0,y:0},texturePositionClipSpace:{x:0,y:0},size:{x:0,y:0},sizeClipSpace:{x:0,y:0}},f=function(){function e(e,t){this._config=t,this._didWarmUp=!1,this._cacheMap={},this._cacheMapCombined={},this._currentRowY=0,this._currentRowX=0,this._currentRowHeight=0,this.hasCanvasChanged=!1,this._workBoundingBox={top:0,left:0,bottom:0,right:0},this._workAttributeData=new s.AttributeData,this.cacheCanvas=e.createElement("canvas"),this.cacheCanvas.width=c,this.cacheCanvas.height=d,this._cacheCtx=(0,o.throwIfFalsy)(this.cacheCanvas.getContext("2d",{alpha:!0})),this._tmpCanvas=e.createElement("canvas"),this._tmpCanvas.width=4*this._config.scaledCellWidth+4,this._tmpCanvas.height=this._config.scaledCellHeight+4,this._tmpCtx=(0,o.throwIfFalsy)(this._tmpCanvas.getContext("2d",{alpha:this._config.allowTransparency}))}return e.prototype.dispose=function(){this.cacheCanvas.parentElement&&this.cacheCanvas.parentElement.removeChild(this.cacheCanvas)},e.prototype.warmUp=function(){this._didWarmUp||(this._doWarmUp(),this._didWarmUp=!0)},e.prototype._doWarmUp=function(){for(var e,t,i=33;i<126;i++){var r=this._drawToCache(i,n.DEFAULT_COLOR,n.DEFAULT_COLOR);this._cacheMap[i]=((e={})[n.DEFAULT_COLOR]=((t={})[n.DEFAULT_COLOR]=r,t),e)}},e.prototype.beginFrame=function(){return this._currentRowY>h&&(this.clearTexture(),this.warmUp(),!0)},e.prototype.clearTexture=function(){0===this._currentRowX&&0===this._currentRowY||(this._cacheCtx.clearRect(0,0,c,d),this._cacheMap={},this._cacheMapCombined={},this._currentRowHeight=0,this._currentRowX=0,this._currentRowY=0,this._didWarmUp=!1)},e.prototype.getRasterizedGlyphCombinedChar=function(e,t,i){var r,n=this._cacheMapCombined[e];n||(n={},this._cacheMapCombined[e]=n);var o=n[t];return o&&(r=o[i]),r||(r=this._drawToCache(e,t,i),n[t]||(n[t]={}),n[t][i]=r),r},e.prototype.getRasterizedGlyph=function(e,t,i){var r,n=this._cacheMap[e];n||(n={},this._cacheMap[e]=n);var o=n[t];return o&&(r=o[i]),r||(r=this._drawToCache(e,t,i),n[t]||(n[t]={}),n[t][i]=r),r},e.prototype._getColorFromAnsiIndex=function(e){if(e>=this._config.colors.ansi.length)throw new Error("No color found for idx "+e);return this._config.colors.ansi[e]},e.prototype._getBackgroundColor=function(e,t,i){if(this._config.allowTransparency)return p;switch(e){case 16777216:case 33554432:return this._getColorFromAnsiIndex(t);case 50331648:var r=s.AttributeData.toColorRGB(t);return{rgba:t<<8,css:"#"+g(r[0])+g(r[1])+g(r[2])};default:return i?this._config.colors.foreground:this._config.colors.background}},e.prototype._getForegroundCss=function(e,t,i,r,n,o,l,c){var d=this._getMinimumContrastCss(e,t,i,r,n,o,l,c);if(d)return d;switch(n){case 16777216:case 33554432:return this._config.drawBoldTextInBrightColors&&c&&o<8&&(o+=8),this._getColorFromAnsiIndex(o).css;case 50331648:var h=s.AttributeData.toColorRGB(o);return a.channels.toCss(h[0],h[1],h[2]);default:if(l){var p=this._config.colors.background.css;return 9===p.length?p.substr(0,7):p}return this._config.colors.foreground.css}},e.prototype._resolveBackgroundRgba=function(e,t,i){switch(e){case 16777216:case 33554432:return this._getColorFromAnsiIndex(t).rgba;case 50331648:return t<<8;default:return i?this._config.colors.foreground.rgba:this._config.colors.background.rgba}},e.prototype._resolveForegroundRgba=function(e,t,i,r){switch(e){case 16777216:case 33554432:return this._config.drawBoldTextInBrightColors&&r&&t<8&&(t+=8),this._getColorFromAnsiIndex(t).rgba;case 50331648:return t<<8;default:return i?this._config.colors.background.rgba:this._config.colors.foreground.rgba}},e.prototype._getMinimumContrastCss=function(e,t,i,r,n,o,s,l){if(1!==this._config.minimumContrastRatio){var c=this._config.colors.contrastCache.getCss(e,r);if(void 0!==c)return c||void 0;var d=this._resolveBackgroundRgba(t,i,s),h=this._resolveForegroundRgba(n,o,s,l),p=a.rgba.ensureContrastRatio(d,h,this._config.minimumContrastRatio);if(p){var u=a.channels.toCss(p>>24&255,p>>16&255,p>>8&255);return this._config.colors.contrastCache.setCss(e,r,u),u}this._config.colors.contrastCache.setCss(e,r,null)}},e.prototype._drawToCache=function(e,t,i){var n="number"==typeof e?String.fromCharCode(e):e;this.hasCanvasChanged=!0;var o=this._config.scaledCharWidth*Math.max(n.length,2)+4;if(this._tmpCanvas.width<o&&(this._tmpCanvas.width=o),this._tmpCtx.save(),this._workAttributeData.fg=i,this._workAttributeData.bg=t,this._workAttributeData.isInvisible())return u;var s=!!this._workAttributeData.isBold(),a=!!this._workAttributeData.isInverse(),h=!!this._workAttributeData.isDim(),p=!!this._workAttributeData.isItalic(),f=!!this._workAttributeData.isUnderline(),g=!!this._workAttributeData.isStrikethrough(),m=this._workAttributeData.getFgColor(),b=this._workAttributeData.getFgColorMode(),y=this._workAttributeData.getBgColor(),v=this._workAttributeData.getBgColorMode();if(a){var w=m;m=y,y=w;var x=b;b=v,v=x}var C=this._getBackgroundColor(v,y,a);this._tmpCtx.globalCompositeOperation="copy",this._tmpCtx.fillStyle=C.css,this._tmpCtx.fillRect(0,0,this._tmpCanvas.width,this._tmpCanvas.height),this._tmpCtx.globalCompositeOperation="source-over";var S=s?this._config.fontWeightBold:this._config.fontWeight,E=p?"italic":"";this._tmpCtx.font=E+" "+S+" "+this._config.fontSize*this._config.devicePixelRatio+"px "+this._config.fontFamily,this._tmpCtx.textBaseline=r.TEXT_BASELINE,this._tmpCtx.fillStyle=this._getForegroundCss(t,v,y,i,b,m,a,s),h&&(this._tmpCtx.globalAlpha=r.DIM_OPACITY);var k=!1;if(1===n.length){var L=n.charCodeAt(0);L>=57504&&L<=57558&&(k=!0)}var A=k?0:2,O=!1;if(!1!==this._config.customGlyphs&&(O=(0,l.tryDrawCustomChar)(this._tmpCtx,n,A,A,this._config.scaledCellWidth,this._config.scaledCellHeight)),O||this._tmpCtx.fillText(n,A,A+this._config.scaledCharHeight),"_"===n&&!this._config.allowTransparency){var M=_(this._tmpCtx.getImageData(A,A,this._config.scaledCellWidth,this._config.scaledCellHeight),C);if(M)for(var P=1;P<=5&&(this._tmpCtx.clearRect(0,0,this._tmpCanvas.width,this._tmpCanvas.height),this._tmpCtx.fillText(n,A,A+this._config.scaledCharHeight-P),M=_(this._tmpCtx.getImageData(A,A,this._config.scaledCellWidth,this._config.scaledCellHeight),C));P++);}if(f||g){var R=Math.max(1,Math.floor(this._config.fontSize/10)),D=this._tmpCtx.lineWidth%2==1?.5:0;this._tmpCtx.lineWidth=R,this._tmpCtx.strokeStyle=this._tmpCtx.fillStyle,this._tmpCtx.beginPath(),f&&(this._tmpCtx.moveTo(A,A+this._config.scaledCharHeight-D),this._tmpCtx.lineTo(A+this._config.scaledCharWidth,A+this._config.scaledCharHeight-D)),g&&(this._tmpCtx.moveTo(A,A+Math.floor(this._config.scaledCharHeight/2)-D),this._tmpCtx.lineTo(A+this._config.scaledCharWidth,A+Math.floor(this._config.scaledCharHeight/2)-D)),this._tmpCtx.stroke(),this._tmpCtx.closePath()}this._tmpCtx.restore();var T=this._tmpCtx.getImageData(0,0,this._tmpCanvas.width,this._tmpCanvas.height);if(_(T,C))return u;var I=this._findGlyphBoundingBox(T,this._workBoundingBox,o,k,O),B=this._clipImageData(T,this._workBoundingBox);return this._currentRowX+I.size.x>c&&(this._currentRowX=0,this._currentRowY+=this._currentRowHeight,this._currentRowHeight=0),I.texturePosition.x=this._currentRowX,I.texturePosition.y=this._currentRowY,I.texturePositionClipSpace.x=this._currentRowX/c,I.texturePositionClipSpace.y=this._currentRowY/d,this._currentRowHeight=Math.max(this._currentRowHeight,I.size.y),this._currentRowX+=I.size.x,this._cacheCtx.putImageData(B,I.texturePosition.x,I.texturePosition.y),I},e.prototype._findGlyphBoundingBox=function(e,t,i,r,n){t.top=0;for(var o=r?this._config.scaledCharHeight:this._tmpCanvas.height,s=r?this._config.scaledCharWidth:i,a=!1,l=0;l<o;l++){for(var h=0;h<s;h++){var p=l*this._tmpCanvas.width*4+4*h+3;if(0!==e.data[p]){t.top=l,a=!0;break}}if(a)break}for(t.left=0,a=!1,h=0;h<s;h++){for(l=0;l<o;l++)if(p=l*this._tmpCanvas.width*4+4*h+3,0!==e.data[p]){t.left=h,a=!0;break}if(a)break}for(t.right=s,a=!1,h=s-1;h>=0;h--){for(l=0;l<o;l++)if(p=l*this._tmpCanvas.width*4+4*h+3,0!==e.data[p]){t.right=h,a=!0;break}if(a)break}for(t.bottom=o,a=!1,l=o-1;l>=0;l--){for(h=0;h<s;h++)if(p=l*this._tmpCanvas.width*4+4*h+3,0!==e.data[p]){t.bottom=l,a=!0;break}if(a)break}return{texturePosition:{x:0,y:0},texturePositionClipSpace:{x:0,y:0},size:{x:t.right-t.left+1,y:t.bottom-t.top+1},sizeClipSpace:{x:(t.right-t.left+1)/c,y:(t.bottom-t.top+1)/d},offset:{x:-t.left+(r?0:2)+(n?Math.floor(this._config.letterSpacing/2):0),y:-t.top+(r?0:2)+(n?1===this._config.lineHeight?0:Math.round((this._config.scaledCellHeight-this._config.scaledCharHeight)/2):0)}}},e.prototype._clipImageData=function(e,t){for(var i=t.right-t.left+1,r=t.bottom-t.top+1,n=new Uint8ClampedArray(i*r*4),o=t.top;o<=t.bottom;o++)for(var s=t.left;s<=t.right;s++){var a=o*this._tmpCanvas.width*4+4*s,l=(o-t.top)*i*4+4*(s-t.left);n[l]=e.data[a],n[l+1]=e.data[a+1],n[l+2]=e.data[a+2],n[l+3]=e.data[a+3]}return new ImageData(n,i,r)},e}();function _(e,t){for(var i=!0,r=t.rgba>>>24,n=t.rgba>>>16&255,o=t.rgba>>>8&255,s=0;s<e.data.length;s+=4)e.data[s]===r&&e.data[s+1]===n&&e.data[s+2]===o?e.data[s+3]=0:i=!1;return i}function g(e){var t=e.toString(16);return t.length<2?"0"+t:t}t.WebglCharAtlas=f},592:(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.BaseRenderLayer=void 0;var r=i(713),n=i(499),o=i(381),s=function(){function e(e,t,i,r,n){this._container=e,this._alpha=r,this._colors=n,this._scaledCharWidth=0,this._scaledCharHeight=0,this._scaledCellWidth=0,this._scaledCellHeight=0,this._scaledCharLeft=0,this._scaledCharTop=0,this._canvas=document.createElement("canvas"),this._canvas.classList.add("xterm-"+t+"-layer"),this._canvas.style.zIndex=i.toString(),this._initCanvas(),this._container.appendChild(this._canvas)}return e.prototype.dispose=function(){this._container.removeChild(this._canvas),this._charAtlas&&this._charAtlas.dispose()},e.prototype._initCanvas=function(){this._ctx=(0,o.throwIfFalsy)(this._canvas.getContext("2d",{alpha:this._alpha})),this._alpha||this._clearAll()},e.prototype.onOptionsChanged=function(e){},e.prototype.onBlur=function(e){},e.prototype.onFocus=function(e){},e.prototype.onCursorMove=function(e){},e.prototype.onGridChanged=function(e,t,i){},e.prototype.onSelectionChanged=function(e,t,i,r){void 0===r&&(r=!1)},e.prototype.setColors=function(e,t){this._refreshCharAtlas(e,t)},e.prototype._setTransparency=function(e,t){if(t!==this._alpha){var i=this._canvas;this._alpha=t,this._canvas=this._canvas.cloneNode(),this._initCanvas(),this._container.replaceChild(this._canvas,i),this._refreshCharAtlas(e,this._colors),this.onGridChanged(e,0,e.rows-1)}},e.prototype._refreshCharAtlas=function(e,t){this._scaledCharWidth<=0&&this._scaledCharHeight<=0||(this._charAtlas=(0,r.acquireCharAtlas)(e,t,this._scaledCellWidth,this._scaledCellHeight,this._scaledCharWidth,this._scaledCharHeight),this._charAtlas.warmUp())},e.prototype.resize=function(e,t){this._scaledCellWidth=t.scaledCellWidth,this._scaledCellHeight=t.scaledCellHeight,this._scaledCharWidth=t.scaledCharWidth,this._scaledCharHeight=t.scaledCharHeight,this._scaledCharLeft=t.scaledCharLeft,this._scaledCharTop=t.scaledCharTop,this._canvas.width=t.scaledCanvasWidth,this._canvas.height=t.scaledCanvasHeight,this._canvas.style.width=t.canvasWidth+"px",this._canvas.style.height=t.canvasHeight+"px",this._alpha||this._clearAll(),this._refreshCharAtlas(e,this._colors)},e.prototype._fillCells=function(e,t,i,r){this._ctx.fillRect(e*this._scaledCellWidth,t*this._scaledCellHeight,i*this._scaledCellWidth,r*this._scaledCellHeight)},e.prototype._fillBottomLineAtCells=function(e,t,i){void 0===i&&(i=1),this._ctx.fillRect(e*this._scaledCellWidth,(t+1)*this._scaledCellHeight-window.devicePixelRatio-1,i*this._scaledCellWidth,window.devicePixelRatio)},e.prototype._fillLeftLineAtCell=function(e,t,i){this._ctx.fillRect(e*this._scaledCellWidth,t*this._scaledCellHeight,window.devicePixelRatio*i,this._scaledCellHeight)},e.prototype._strokeRectAtCell=function(e,t,i,r){this._ctx.lineWidth=window.devicePixelRatio,this._ctx.strokeRect(e*this._scaledCellWidth+window.devicePixelRatio/2,t*this._scaledCellHeight+window.devicePixelRatio/2,i*this._scaledCellWidth-window.devicePixelRatio,r*this._scaledCellHeight-window.devicePixelRatio)},e.prototype._clearAll=function(){this._alpha?this._ctx.clearRect(0,0,this._canvas.width,this._canvas.height):(this._ctx.fillStyle=this._colors.background.css,this._ctx.fillRect(0,0,this._canvas.width,this._canvas.height))},e.prototype._clearCells=function(e,t,i,r){this._alpha?this._ctx.clearRect(e*this._scaledCellWidth,t*this._scaledCellHeight,i*this._scaledCellWidth,r*this._scaledCellHeight):(this._ctx.fillStyle=this._colors.background.css,this._ctx.fillRect(e*this._scaledCellWidth,t*this._scaledCellHeight,i*this._scaledCellWidth,r*this._scaledCellHeight))},e.prototype._fillCharTrueColor=function(e,t,i,r){this._ctx.font=this._getFont(e,!1,!1),this._ctx.textBaseline=n.TEXT_BASELINE,this._clipRow(e,r),this._ctx.fillText(t.getChars(),i*this._scaledCellWidth+this._scaledCharLeft,r*this._scaledCellHeight+this._scaledCharTop+this._scaledCharHeight)},e.prototype._clipRow=function(e,t){this._ctx.beginPath(),this._ctx.rect(0,t*this._scaledCellHeight,e.cols*this._scaledCellWidth,this._scaledCellHeight),this._ctx.clip()},e.prototype._getFont=function(e,t,i){return(i?"italic":"")+" "+(t?e.getOption("fontWeightBold"):e.getOption("fontWeight"))+" "+e.getOption("fontSize")*window.devicePixelRatio+"px "+e.getOption("fontFamily")},e}();t.BaseRenderLayer=s},461:function(e,t,i){var r,n=this&&this.__extends||(r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])},r(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function i(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)});Object.defineProperty(t,"__esModule",{value:!0}),t.CursorRenderLayer=void 0;var o=i(592),s=i(782),a=600,l=function(e){function t(t,i,r,n,o,a){var l=e.call(this,i,"cursor",r,!0,n)||this;return l._terminal=o,l._onRequestRefreshRowsEvent=a,l._cell=new s.CellData,l._state={x:0,y:0,isFocused:!1,style:"",width:0},l._cursorRenderers={bar:l._renderBarCursor.bind(l),block:l._renderBlockCursor.bind(l),underline:l._renderUnderlineCursor.bind(l)},l.onOptionsChanged(t),l}return n(t,e),t.prototype.resize=function(t,i){e.prototype.resize.call(this,t,i),this._state={x:0,y:0,isFocused:!1,style:"",width:0}},t.prototype.reset=function(e){var t;this._clearCursor(),null===(t=this._cursorBlinkStateManager)||void 0===t||t.restartBlinkAnimation(e),this.onOptionsChanged(e)},t.prototype.onBlur=function(e){var t;null===(t=this._cursorBlinkStateManager)||void 0===t||t.pause(),this._onRequestRefreshRowsEvent.fire({start:e.buffer.active.cursorY,end:e.buffer.active.cursorY})},t.prototype.onFocus=function(e){var t;null===(t=this._cursorBlinkStateManager)||void 0===t||t.resume(e),this._onRequestRefreshRowsEvent.fire({start:e.buffer.active.cursorY,end:e.buffer.active.cursorY})},t.prototype.onOptionsChanged=function(e){var t,i=this;e.getOption("cursorBlink")?this._cursorBlinkStateManager||(this._cursorBlinkStateManager=new c(e,(function(){i._render(e,!0)}))):(null===(t=this._cursorBlinkStateManager)||void 0===t||t.dispose(),this._cursorBlinkStateManager=void 0),this._onRequestRefreshRowsEvent.fire({start:e.buffer.active.cursorY,end:e.buffer.active.cursorY})},t.prototype.onCursorMove=function(e){var t;null===(t=this._cursorBlinkStateManager)||void 0===t||t.restartBlinkAnimation(e)},t.prototype.onGridChanged=function(e,t,i){!this._cursorBlinkStateManager||this._cursorBlinkStateManager.isPaused?this._render(e,!1):this._cursorBlinkStateManager.restartBlinkAnimation(e)},t.prototype._render=function(e,t){if(this._terminal.coreService.isCursorInitialized&&!this._terminal.coreService.isCursorHidden){var i=e.buffer.active.baseY+e.buffer.active.cursorY,r=i-e.buffer.active.viewportY,n=Math.min(e.buffer.active.cursorX,e.cols-1);if(r<0||r>=e.rows)this._clearCursor();else if(e._core.buffer.lines.get(i).loadCell(n,this._cell),void 0!==this._cell.content){if(!d(e)){this._clearCursor(),this._ctx.save(),this._ctx.fillStyle=this._colors.cursor.css;var o=e.getOption("cursorStyle");return o&&"block"!==o?this._cursorRenderers[o](e,n,r,this._cell):this._renderBlurCursor(e,n,r,this._cell),this._ctx.restore(),this._state.x=n,this._state.y=r,this._state.isFocused=!1,this._state.style=o,void(this._state.width=this._cell.getWidth())}if(!this._cursorBlinkStateManager||this._cursorBlinkStateManager.isCursorVisible){if(this._state){if(this._state.x===n&&this._state.y===r&&this._state.isFocused===d(e)&&this._state.style===e.getOption("cursorStyle")&&this._state.width===this._cell.getWidth())return;this._clearCursor()}this._ctx.save(),this._cursorRenderers[e.getOption("cursorStyle")||"block"](e,n,r,this._cell),this._ctx.restore(),this._state.x=n,this._state.y=r,this._state.isFocused=!1,this._state.style=e.getOption("cursorStyle"),this._state.width=this._cell.getWidth()}else this._clearCursor()}}else this._clearCursor()},t.prototype._clearCursor=function(){this._state&&(window.devicePixelRatio<1?this._clearAll():this._clearCells(this._state.x,this._state.y,this._state.width,1),this._state={x:0,y:0,isFocused:!1,style:"",width:0})},t.prototype._renderBarCursor=function(e,t,i,r){this._ctx.save(),this._ctx.fillStyle=this._colors.cursor.css,this._fillLeftLineAtCell(t,i,e.getOption("cursorWidth")),this._ctx.restore()},t.prototype._renderBlockCursor=function(e,t,i,r){this._ctx.save(),this._ctx.fillStyle=this._colors.cursor.css,this._fillCells(t,i,r.getWidth(),1),this._ctx.fillStyle=this._colors.cursorAccent.css,this._fillCharTrueColor(e,r,t,i),this._ctx.restore()},t.prototype._renderUnderlineCursor=function(e,t,i,r){this._ctx.save(),this._ctx.fillStyle=this._colors.cursor.css,this._fillBottomLineAtCells(t,i),this._ctx.restore()},t.prototype._renderBlurCursor=function(e,t,i,r){this._ctx.save(),this._ctx.strokeStyle=this._colors.cursor.css,this._strokeRectAtCell(t,i,r.getWidth(),1),this._ctx.restore()},t}(o.BaseRenderLayer);t.CursorRenderLayer=l;var c=function(){function e(e,t){this._renderCallback=t,this.isCursorVisible=!0,d(e)&&this._restartInterval()}return Object.defineProperty(e.prototype,"isPaused",{get:function(){return!(this._blinkStartTimeout||this._blinkInterval)},enumerable:!1,configurable:!0}),e.prototype.dispose=function(){this._blinkInterval&&(window.clearInterval(this._blinkInterval),this._blinkInterval=void 0),this._blinkStartTimeout&&(window.clearTimeout(this._blinkStartTimeout),this._blinkStartTimeout=void 0),this._animationFrame&&(window.cancelAnimationFrame(this._animationFrame),this._animationFrame=void 0)},e.prototype.restartBlinkAnimation=function(e){var t=this;this.isPaused||(this._animationTimeRestarted=Date.now(),this.isCursorVisible=!0,this._animationFrame||(this._animationFrame=window.requestAnimationFrame((function(){t._renderCallback(),t._animationFrame=void 0}))))},e.prototype._restartInterval=function(e){var t=this;void 0===e&&(e=a),this._blinkInterval&&(window.clearInterval(this._blinkInterval),this._blinkInterval=void 0),this._blinkStartTimeout=window.setTimeout((function(){if(t._animationTimeRestarted){var e=a-(Date.now()-t._animationTimeRestarted);if(t._animationTimeRestarted=void 0,e>0)return void t._restartInterval(e)}t.isCursorVisible=!1,t._animationFrame=window.requestAnimationFrame((function(){t._renderCallback(),t._animationFrame=void 0})),t._blinkInterval=window.setInterval((function(){if(t._animationTimeRestarted){var e=a-(Date.now()-t._animationTimeRestarted);return t._animationTimeRestarted=void 0,void t._restartInterval(e)}t.isCursorVisible=!t.isCursorVisible,t._animationFrame=window.requestAnimationFrame((function(){t._renderCallback(),t._animationFrame=void 0}))}),a)}),e)},e.prototype.pause=function(){this.isCursorVisible=!0,this._blinkInterval&&(window.clearInterval(this._blinkInterval),this._blinkInterval=void 0),this._blinkStartTimeout&&(window.clearTimeout(this._blinkStartTimeout),this._blinkStartTimeout=void 0),this._animationFrame&&(window.cancelAnimationFrame(this._animationFrame),this._animationFrame=void 0)},e.prototype.resume=function(e){this.pause(),this._animationTimeRestarted=void 0,this._restartInterval(),this.restartBlinkAnimation(e)},e}();function d(e){return document.activeElement===e.textarea&&document.hasFocus()}},733:function(e,t,i){var r,n=this&&this.__extends||(r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])},r(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function i(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)});Object.defineProperty(t,"__esModule",{value:!0}),t.LinkRenderLayer=void 0;var o=i(592),s=i(499),a=i(433),l=function(e){function t(t,i,r,n){var o=e.call(this,t,"link",i,!0,r)||this;return n.linkifier.onShowLinkUnderline((function(e){return o._onShowLinkUnderline(e)})),n.linkifier.onHideLinkUnderline((function(e){return o._onHideLinkUnderline(e)})),n.linkifier2.onShowLinkUnderline((function(e){return o._onShowLinkUnderline(e)})),n.linkifier2.onHideLinkUnderline((function(e){return o._onHideLinkUnderline(e)})),o}return n(t,e),t.prototype.resize=function(t,i){e.prototype.resize.call(this,t,i),this._state=void 0},t.prototype.reset=function(e){this._clearCurrentLink()},t.prototype._clearCurrentLink=function(){if(this._state){this._clearCells(this._state.x1,this._state.y1,this._state.cols-this._state.x1,1);var e=this._state.y2-this._state.y1-1;e>0&&this._clearCells(0,this._state.y1+1,this._state.cols,e),this._clearCells(0,this._state.y2,this._state.x2,1),this._state=void 0}},t.prototype._onShowLinkUnderline=function(e){if(e.fg===s.INVERTED_DEFAULT_COLOR?this._ctx.fillStyle=this._colors.background.css:void 0!==e.fg&&(0,a.is256Color)(e.fg)?this._ctx.fillStyle=this._colors.ansi[e.fg].css:this._ctx.fillStyle=this._colors.foreground.css,e.y1===e.y2)this._fillBottomLineAtCells(e.x1,e.y1,e.x2-e.x1);else{this._fillBottomLineAtCells(e.x1,e.y1,e.cols-e.x1);for(var t=e.y1+1;t<e.y2;t++)this._fillBottomLineAtCells(0,t,e.cols);this._fillBottomLineAtCells(0,e.y2,e.x2)}this._state=e},t.prototype._onHideLinkUnderline=function(e){this._clearCurrentLink()},t}(o.BaseRenderLayer);t.LinkRenderLayer=l},742:(e,t)=>{var i,r,n,o;function s(e){var t=e.toString(16);return t.length<2?"0"+t:t}function a(e,t){return e<t?(t+.05)/(e+.05):(e+.05)/(t+.05)}Object.defineProperty(t,"__esModule",{value:!0}),t.contrastRatio=t.toPaddedHex=t.rgba=t.rgb=t.css=t.color=t.channels=void 0,function(e){e.toCss=function(e,t,i,r){return void 0!==r?"#"+s(e)+s(t)+s(i)+s(r):"#"+s(e)+s(t)+s(i)},e.toRgba=function(e,t,i,r){return void 0===r&&(r=255),(e<<24|t<<16|i<<8|r)>>>0}}(i=t.channels||(t.channels={})),(r=t.color||(t.color={})).blend=function(e,t){var r=(255&t.rgba)/255;if(1===r)return{css:t.css,rgba:t.rgba};var n=t.rgba>>24&255,o=t.rgba>>16&255,s=t.rgba>>8&255,a=e.rgba>>24&255,l=e.rgba>>16&255,c=e.rgba>>8&255,d=a+Math.round((n-a)*r),h=l+Math.round((o-l)*r),p=c+Math.round((s-c)*r);return{css:i.toCss(d,h,p),rgba:i.toRgba(d,h,p)}},r.isOpaque=function(e){return 255==(255&e.rgba)},r.ensureContrastRatio=function(e,t,i){var r=o.ensureContrastRatio(e.rgba,t.rgba,i);if(r)return o.toColor(r>>24&255,r>>16&255,r>>8&255)},r.opaque=function(e){var t=(255|e.rgba)>>>0,r=o.toChannels(t),n=r[0],s=r[1],a=r[2];return{css:i.toCss(n,s,a),rgba:t}},r.opacity=function(e,t){var r=Math.round(255*t),n=o.toChannels(e.rgba),s=n[0],a=n[1],l=n[2];return{css:i.toCss(s,a,l,r),rgba:i.toRgba(s,a,l,r)}},r.toColorRGB=function(e){return[e.rgba>>24&255,e.rgba>>16&255,e.rgba>>8&255]},(t.css||(t.css={})).toColor=function(e){switch(e.length){case 7:return{css:e,rgba:(parseInt(e.slice(1),16)<<8|255)>>>0};case 9:return{css:e,rgba:parseInt(e.slice(1),16)>>>0}}throw new Error("css.toColor: Unsupported css format")},function(e){function t(e,t,i){var r=e/255,n=t/255,o=i/255;return.2126*(r<=.03928?r/12.92:Math.pow((r+.055)/1.055,2.4))+.7152*(n<=.03928?n/12.92:Math.pow((n+.055)/1.055,2.4))+.0722*(o<=.03928?o/12.92:Math.pow((o+.055)/1.055,2.4))}e.relativeLuminance=function(e){return t(e>>16&255,e>>8&255,255&e)},e.relativeLuminance2=t}(n=t.rgb||(t.rgb={})),function(e){function t(e,t,i){for(var r=e>>24&255,o=e>>16&255,s=e>>8&255,l=t>>24&255,c=t>>16&255,d=t>>8&255,h=a(n.relativeLuminance2(l,d,c),n.relativeLuminance2(r,o,s));h<i&&(l>0||c>0||d>0);)l-=Math.max(0,Math.ceil(.1*l)),c-=Math.max(0,Math.ceil(.1*c)),d-=Math.max(0,Math.ceil(.1*d)),h=a(n.relativeLuminance2(l,d,c),n.relativeLuminance2(r,o,s));return(l<<24|c<<16|d<<8|255)>>>0}function r(e,t,i){for(var r=e>>24&255,o=e>>16&255,s=e>>8&255,l=t>>24&255,c=t>>16&255,d=t>>8&255,h=a(n.relativeLuminance2(l,d,c),n.relativeLuminance2(r,o,s));h<i&&(l<255||c<255||d<255);)l=Math.min(255,l+Math.ceil(.1*(255-l))),c=Math.min(255,c+Math.ceil(.1*(255-c))),d=Math.min(255,d+Math.ceil(.1*(255-d))),h=a(n.relativeLuminance2(l,d,c),n.relativeLuminance2(r,o,s));return(l<<24|c<<16|d<<8|255)>>>0}e.ensureContrastRatio=function(e,i,o){var s=n.relativeLuminance(e>>8),l=n.relativeLuminance(i>>8);if(a(s,l)<o)return l<s?t(e,i,o):r(e,i,o)},e.reduceLuminance=t,e.increaseLuminance=r,e.toChannels=function(e){return[e>>24&255,e>>16&255,e>>8&255,255&e]},e.toColor=function(e,t,r){return{css:i.toCss(e,t,r),rgba:i.toRgba(e,t,r)}}}(o=t.rgba||(t.rgba={})),t.toPaddedHex=s,t.contrastRatio=a},820:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.addDisposableDomListener=void 0,t.addDisposableDomListener=function(e,t,i,r){e.addEventListener(t,i,r);var n=!1;return{dispose:function(){n||(n=!0,e.removeEventListener(t,i,r))}}}},14:(e,t,i)=>{var r,n,o,s,a,l,c,d,h,p,u,f,_,g,m,b,y,v,w,x,C,S,E,k,L,A,O,M,P,R,D,T,I,B,F,W,H,U,j,z,N,q,K,$,V,J,G,X,Q,Y,Z,ee,te,ie,re,ne,oe,se,ae,le,ce,de,he,pe,ue,fe,_e,ge,me,be,ye,ve,we,xe,Ce,Se,Ee,ke,Le,Ae,Oe,Me,Pe,Re,De,Te,Ie,Be,Fe,We,He,Ue,je,ze,Ne,qe,Ke,$e,Ve,Je,Ge,Xe,Qe,Ye,Ze,et,tt,it,rt,nt,ot,st,at,lt,ct,dt,ht,pt,ut,ft,_t,gt,mt,bt,yt,vt,wt,xt;Object.defineProperty(t,"__esModule",{value:!0}),t.tryDrawCustomChar=t.boxDrawingDefinitions=t.blockElementDefinitions=void 0;var Ct=i(634);t.blockElementDefinitions={"▀":[{x:0,y:0,w:8,h:4}],"▁":[{x:0,y:7,w:8,h:1}],"▂":[{x:0,y:6,w:8,h:2}],"▃":[{x:0,y:5,w:8,h:3}],"▄":[{x:0,y:4,w:8,h:4}],"▅":[{x:0,y:3,w:8,h:5}],"▆":[{x:0,y:2,w:8,h:6}],"▇":[{x:0,y:1,w:8,h:7}],"█":[{x:0,y:0,w:8,h:8}],"▉":[{x:0,y:0,w:7,h:8}],"▊":[{x:0,y:0,w:6,h:8}],"▋":[{x:0,y:0,w:5,h:8}],"▌":[{x:0,y:0,w:4,h:8}],"▍":[{x:0,y:0,w:3,h:8}],"▎":[{x:0,y:0,w:2,h:8}],"▏":[{x:0,y:0,w:1,h:8}],"▐":[{x:4,y:0,w:4,h:8}],"▔":[{x:0,y:0,w:9,h:1}],"▕":[{x:7,y:0,w:1,h:8}],"▖":[{x:0,y:4,w:4,h:4}],"▗":[{x:4,y:4,w:4,h:4}],"▘":[{x:0,y:0,w:4,h:4}],"▙":[{x:0,y:0,w:4,h:8},{x:0,y:4,w:8,h:4}],"▚":[{x:0,y:0,w:4,h:4},{x:4,y:4,w:4,h:4}],"▛":[{x:0,y:0,w:4,h:8},{x:0,y:0,w:4,h:8}],"▜":[{x:0,y:0,w:8,h:4},{x:4,y:0,w:4,h:8}],"▝":[{x:4,y:0,w:4,h:4}],"▞":[{x:4,y:0,w:4,h:4},{x:0,y:4,w:4,h:4}],"▟":[{x:4,y:0,w:4,h:8},{x:0,y:4,w:8,h:4}],"🭰":[{x:1,y:0,w:1,h:8}],"🭱":[{x:2,y:0,w:1,h:8}],"🭲":[{x:3,y:0,w:1,h:8}],"🭳":[{x:4,y:0,w:1,h:8}],"🭴":[{x:5,y:0,w:1,h:8}],"🭵":[{x:6,y:0,w:1,h:8}],"🭶":[{x:0,y:1,w:8,h:1}],"🭷":[{x:0,y:2,w:8,h:1}],"🭸":[{x:0,y:3,w:8,h:1}],"🭹":[{x:0,y:4,w:8,h:1}],"🭺":[{x:0,y:5,w:8,h:1}],"🭻":[{x:0,y:6,w:8,h:1}],"🭼":[{x:0,y:0,w:1,h:8},{x:0,y:7,w:8,h:1}],"🭽":[{x:0,y:0,w:1,h:8},{x:0,y:0,w:8,h:1}],"🭾":[{x:7,y:0,w:1,h:8},{x:0,y:0,w:8,h:1}],"🭿":[{x:7,y:0,w:1,h:8},{x:0,y:7,w:8,h:1}],"🮀":[{x:0,y:0,w:8,h:1},{x:0,y:7,w:8,h:1}],"🮁":[{x:0,y:0,w:8,h:1},{x:0,y:2,w:8,h:1},{x:0,y:4,w:8,h:1},{x:0,y:7,w:8,h:1}],"🮂":[{x:0,y:0,w:8,h:2}],"🮃":[{x:0,y:0,w:8,h:3}],"🮄":[{x:0,y:0,w:8,h:5}],"🮅":[{x:0,y:0,w:8,h:6}],"🮆":[{x:0,y:0,w:8,h:7}],"🮇":[{x:6,y:0,w:2,h:8}],"🮈":[{x:5,y:0,w:3,h:8}],"🮉":[{x:3,y:0,w:5,h:8}],"🮊":[{x:2,y:0,w:6,h:8}],"🮋":[{x:1,y:0,w:7,h:8}],"🮕":[{x:0,y:0,w:2,h:2},{x:4,y:0,w:2,h:2},{x:2,y:2,w:2,h:2},{x:6,y:2,w:2,h:2},{x:0,y:4,w:2,h:2},{x:4,y:4,w:2,h:2},{x:2,y:6,w:2,h:2},{x:6,y:6,w:2,h:2}],"🮖":[{x:2,y:0,w:2,h:2},{x:6,y:0,w:2,h:2},{x:0,y:2,w:2,h:2},{x:4,y:2,w:2,h:2},{x:2,y:4,w:2,h:2},{x:6,y:4,w:2,h:2},{x:0,y:6,w:2,h:2},{x:4,y:6,w:2,h:2}],"🮗":[{x:0,y:2,w:8,h:2},{x:0,y:6,w:8,h:2}]};var St={"░":[[1,0,0,0],[0,0,0,0],[0,0,1,0],[0,0,0,0]],"▒":[[1,0],[0,0],[0,1],[0,0]],"▓":[[0,1],[1,1],[1,0],[1,1]]};t.boxDrawingDefinitions={"─":(r={},r[1]="M0,.5 L1,.5",r),"━":(n={},n[3]="M0,.5 L1,.5",n),"│":(o={},o[1]="M.5,0 L.5,1",o),"┃":(s={},s[3]="M.5,0 L.5,1",s),"┌":(a={},a[1]="M0.5,1 L.5,.5 L1,.5",a),"┏":(l={},l[3]="M0.5,1 L.5,.5 L1,.5",l),"┐":(c={},c[1]="M0,.5 L.5,.5 L.5,1",c),"┓":(d={},d[3]="M0,.5 L.5,.5 L.5,1",d),"└":(h={},h[1]="M.5,0 L.5,.5 L1,.5",h),"┗":(p={},p[3]="M.5,0 L.5,.5 L1,.5",p),"┘":(u={},u[1]="M.5,0 L.5,.5 L0,.5",u),"┛":(f={},f[3]="M.5,0 L.5,.5 L0,.5",f),"├":(_={},_[1]="M.5,0 L.5,1 M.5,.5 L1,.5",_),"┣":(g={},g[3]="M.5,0 L.5,1 M.5,.5 L1,.5",g),"┤":(m={},m[1]="M.5,0 L.5,1 M.5,.5 L0,.5",m),"┫":(b={},b[3]="M.5,0 L.5,1 M.5,.5 L0,.5",b),"┬":(y={},y[1]="M0,.5 L1,.5 M.5,.5 L.5,1",y),"┳":(v={},v[3]="M0,.5 L1,.5 M.5,.5 L.5,1",v),"┴":(w={},w[1]="M0,.5 L1,.5 M.5,.5 L.5,0",w),"┻":(x={},x[3]="M0,.5 L1,.5 M.5,.5 L.5,0",x),"┼":(C={},C[1]="M0,.5 L1,.5 M.5,0 L.5,1",C),"╋":(S={},S[3]="M0,.5 L1,.5 M.5,0 L.5,1",S),"╴":(E={},E[1]="M.5,.5 L0,.5",E),"╸":(k={},k[3]="M.5,.5 L0,.5",k),"╵":(L={},L[1]="M.5,.5 L.5,0",L),"╹":(A={},A[3]="M.5,.5 L.5,0",A),"╶":(O={},O[1]="M.5,.5 L1,.5",O),"╺":(M={},M[3]="M.5,.5 L1,.5",M),"╷":(P={},P[1]="M.5,.5 L.5,1",P),"╻":(R={},R[3]="M.5,.5 L.5,1",R),"═":(D={},D[1]=function(e,t){return"M0,"+(.5-t)+" L1,"+(.5-t)+" M0,"+(.5+t)+" L1,"+(.5+t)},D),"║":(T={},T[1]=function(e,t){return"M"+(.5-e)+",0 L"+(.5-e)+",1 M"+(.5+e)+",0 L"+(.5+e)+",1"},T),"╒":(I={},I[1]=function(e,t){return"M.5,1 L.5,"+(.5-t)+" L1,"+(.5-t)+" M.5,"+(.5+t)+" L1,"+(.5+t)},I),"╓":(B={},B[1]=function(e,t){return"M"+(.5-e)+",1 L"+(.5-e)+",.5 L1,.5 M"+(.5+e)+",.5 L"+(.5+e)+",1"},B),"╔":(F={},F[1]=function(e,t){return"M1,"+(.5-t)+" L"+(.5-e)+","+(.5-t)+" L"+(.5-e)+",1 M1,"+(.5+t)+" L"+(.5+e)+","+(.5+t)+" L"+(.5+e)+",1"},F),"╕":(W={},W[1]=function(e,t){return"M0,"+(.5-t)+" L.5,"+(.5-t)+" L.5,1 M0,"+(.5+t)+" L.5,"+(.5+t)},W),"╖":(H={},H[1]=function(e,t){return"M"+(.5+e)+",1 L"+(.5+e)+",.5 L0,.5 M"+(.5-e)+",.5 L"+(.5-e)+",1"},H),"╗":(U={},U[1]=function(e,t){return"M0,"+(.5+t)+" L"+(.5-e)+","+(.5+t)+" L"+(.5-e)+",1 M0,"+(.5-t)+" L"+(.5+e)+","+(.5-t)+" L"+(.5+e)+",1"},U),"╘":(j={},j[1]=function(e,t){return"M.5,0 L.5,"+(.5+t)+" L1,"+(.5+t)+" M.5,"+(.5-t)+" L1,"+(.5-t)},j),"╙":(z={},z[1]=function(e,t){return"M1,.5 L"+(.5-e)+",.5 L"+(.5-e)+",0 M"+(.5+e)+",.5 L"+(.5+e)+",0"},z),"╚":(N={},N[1]=function(e,t){return"M1,"+(.5-t)+" L"+(.5+e)+","+(.5-t)+" L"+(.5+e)+",0 M1,"+(.5+t)+" L"+(.5-e)+","+(.5+t)+" L"+(.5-e)+",0"},N),"╛":(q={},q[1]=function(e,t){return"M0,"+(.5+t)+" L.5,"+(.5+t)+" L.5,0 M0,"+(.5-t)+" L.5,"+(.5-t)},q),"╜":(K={},K[1]=function(e,t){return"M0,.5 L"+(.5+e)+",.5 L"+(.5+e)+",0 M"+(.5-e)+",.5 L"+(.5-e)+",0"},K),"╝":($={},$[1]=function(e,t){return"M0,"+(.5-t)+" L"+(.5-e)+","+(.5-t)+" L"+(.5-e)+",0 M0,"+(.5+t)+" L"+(.5+e)+","+(.5+t)+" L"+(.5+e)+",0"},$),"╞":(V={},V[1]=function(e,t){return"M.5,0 L.5,1 M.5,"+(.5-t)+" L1,"+(.5-t)+" M.5,"+(.5+t)+" L1,"+(.5+t)},V),"╟":(J={},J[1]=function(e,t){return"M"+(.5-e)+",0 L"+(.5-e)+",1 M"+(.5+e)+",0 L"+(.5+e)+",1 M"+(.5+e)+",.5 L1,.5"},J),"╠":(G={},G[1]=function(e,t){return"M"+(.5-e)+",0 L"+(.5-e)+",1 M1,"+(.5+t)+" L"+(.5+e)+","+(.5+t)+" L"+(.5+e)+",1 M1,"+(.5-t)+" L"+(.5+e)+","+(.5-t)+" L"+(.5+e)+",0"},G),"╡":(X={},X[1]=function(e,t){return"M.5,0 L.5,1 M0,"+(.5-t)+" L.5,"+(.5-t)+" M0,"+(.5+t)+" L.5,"+(.5+t)},X),"╢":(Q={},Q[1]=function(e,t){return"M0,.5 L"+(.5-e)+",.5 M"+(.5-e)+",0 L"+(.5-e)+",1 M"+(.5+e)+",0 L"+(.5+e)+",1"},Q),"╣":(Y={},Y[1]=function(e,t){return"M"+(.5+e)+",0 L"+(.5+e)+",1 M0,"+(.5+t)+" L"+(.5-e)+","+(.5+t)+" L"+(.5-e)+",1 M0,"+(.5-t)+" L"+(.5-e)+","+(.5-t)+" L"+(.5-e)+",0"},Y),"╤":(Z={},Z[1]=function(e,t){return"M0,"+(.5-t)+" L1,"+(.5-t)+" M0,"+(.5+t)+" L1,"+(.5+t)+" M.5,"+(.5+t)+" L.5,1"},Z),"╥":(ee={},ee[1]=function(e,t){return"M0,.5 L1,.5 M"+(.5-e)+",.5 L"+(.5-e)+",1 M"+(.5+e)+",.5 L"+(.5+e)+",1"},ee),"╦":(te={},te[1]=function(e,t){return"M0,"+(.5-t)+" L1,"+(.5-t)+" M0,"+(.5+t)+" L"+(.5-e)+","+(.5+t)+" L"+(.5-e)+",1 M1,"+(.5+t)+" L"+(.5+e)+","+(.5+t)+" L"+(.5+e)+",1"},te),"╧":(ie={},ie[1]=function(e,t){return"M.5,0 L.5,"+(.5-t)+" M0,"+(.5-t)+" L1,"+(.5-t)+" M0,"+(.5+t)+" L1,"+(.5+t)},ie),"╨":(re={},re[1]=function(e,t){return"M0,.5 L1,.5 M"+(.5-e)+",.5 L"+(.5-e)+",0 M"+(.5+e)+",.5 L"+(.5+e)+",0"},re),"╩":(ne={},ne[1]=function(e,t){return"M0,"+(.5+t)+" L1,"+(.5+t)+" M0,"+(.5-t)+" L"+(.5-e)+","+(.5-t)+" L"+(.5-e)+",0 M1,"+(.5-t)+" L"+(.5+e)+","+(.5-t)+" L"+(.5+e)+",0"},ne),"╪":(oe={},oe[1]=function(e,t){return"M.5,0 L.5,1 M0,"+(.5-t)+" L1,"+(.5-t)+" M0,"+(.5+t)+" L1,"+(.5+t)},oe),"╫":(se={},se[1]=function(e,t){return"M0,.5 L1,.5 M"+(.5-e)+",0 L"+(.5-e)+",1 M"+(.5+e)+",0 L"+(.5+e)+",1"},se),"╬":(ae={},ae[1]=function(e,t){return"M0,"+(.5+t)+" L"+(.5-e)+","+(.5+t)+" L"+(.5-e)+",1 M1,"+(.5+t)+" L"+(.5+e)+","+(.5+t)+" L"+(.5+e)+",1 M0,"+(.5-t)+" L"+(.5-e)+","+(.5-t)+" L"+(.5-e)+",0 M1,"+(.5-t)+" L"+(.5+e)+","+(.5-t)+" L"+(.5+e)+",0"},ae),"╱":(le={},le[1]="M1,0 L0,1",le),"╲":(ce={},ce[1]="M0,0 L1,1",ce),"╳":(de={},de[1]="M1,0 L0,1 M0,0 L1,1",de),"╼":(he={},he[1]="M.5,.5 L0,.5",he[3]="M.5,.5 L1,.5",he),"╽":(pe={},pe[1]="M.5,.5 L.5,0",pe[3]="M.5,.5 L.5,1",pe),"╾":(ue={},ue[1]="M.5,.5 L1,.5",ue[3]="M.5,.5 L0,.5",ue),"╿":(fe={},fe[1]="M.5,.5 L.5,1",fe[3]="M.5,.5 L.5,0",fe),"┍":(_e={},_e[1]="M.5,.5 L.5,1",_e[3]="M.5,.5 L1,.5",_e),"┎":(ge={},ge[1]="M.5,.5 L1,.5",ge[3]="M.5,.5 L.5,1",ge),"┑":(me={},me[1]="M.5,.5 L.5,1",me[3]="M.5,.5 L0,.5",me),"┒":(be={},be[1]="M.5,.5 L0,.5",be[3]="M.5,.5 L.5,1",be),"┕":(ye={},ye[1]="M.5,.5 L.5,0",ye[3]="M.5,.5 L1,.5",ye),"┖":(ve={},ve[1]="M.5,.5 L1,.5",ve[3]="M.5,.5 L.5,0",ve),"┙":(we={},we[1]="M.5,.5 L.5,0",we[3]="M.5,.5 L0,.5",we),"┚":(xe={},xe[1]="M.5,.5 L0,.5",xe[3]="M.5,.5 L.5,0",xe),"┝":(Ce={},Ce[1]="M.5,0 L.5,1",Ce[3]="M.5,.5 L1,.5",Ce),"┞":(Se={},Se[1]="M0.5,1 L.5,.5 L1,.5",Se[3]="M.5,.5 L.5,0",Se),"┟":(Ee={},Ee[1]="M.5,0 L.5,.5 L1,.5",Ee[3]="M.5,.5 L.5,1",Ee),"┠":(ke={},ke[1]="M.5,.5 L1,.5",ke[3]="M.5,0 L.5,1",ke),"┡":(Le={},Le[1]="M.5,.5 L.5,1",Le[3]="M.5,0 L.5,.5 L1,.5",Le),"┢":(Ae={},Ae[1]="M.5,.5 L.5,0",Ae[3]="M0.5,1 L.5,.5 L1,.5",Ae),"┥":(Oe={},Oe[1]="M.5,0 L.5,1",Oe[3]="M.5,.5 L0,.5",Oe),"┦":(Me={},Me[1]="M0,.5 L.5,.5 L.5,1",Me[3]="M.5,.5 L.5,0",Me),"┧":(Pe={},Pe[1]="M.5,0 L.5,.5 L0,.5",Pe[3]="M.5,.5 L.5,1",Pe),"┨":(Re={},Re[1]="M.5,.5 L0,.5",Re[3]="M.5,0 L.5,1",Re),"┩":(De={},De[1]="M.5,.5 L.5,1",De[3]="M.5,0 L.5,.5 L0,.5",De),"┪":(Te={},Te[1]="M.5,.5 L.5,0",Te[3]="M0,.5 L.5,.5 L.5,1",Te),"┭":(Ie={},Ie[1]="M0.5,1 L.5,.5 L1,.5",Ie[3]="M.5,.5 L0,.5",Ie),"┮":(Be={},Be[1]="M0,.5 L.5,.5 L.5,1",Be[3]="M.5,.5 L1,.5",Be),"┯":(Fe={},Fe[1]="M.5,.5 L.5,1",Fe[3]="M0,.5 L1,.5",Fe),"┰":(We={},We[1]="M0,.5 L1,.5",We[3]="M.5,.5 L.5,1",We),"┱":(He={},He[1]="M.5,.5 L1,.5",He[3]="M0,.5 L.5,.5 L.5,1",He),"┲":(Ue={},Ue[1]="M.5,.5 L0,.5",Ue[3]="M0.5,1 L.5,.5 L1,.5",Ue),"┵":(je={},je[1]="M.5,0 L.5,.5 L1,.5",je[3]="M.5,.5 L0,.5",je),"┶":(ze={},ze[1]="M.5,0 L.5,.5 L0,.5",ze[3]="M.5,.5 L1,.5",ze),"┷":(Ne={},Ne[1]="M.5,.5 L.5,0",Ne[3]="M0,.5 L1,.5",Ne),"┸":(qe={},qe[1]="M0,.5 L1,.5",qe[3]="M.5,.5 L.5,0",qe),"┹":(Ke={},Ke[1]="M.5,.5 L1,.5",Ke[3]="M.5,0 L.5,.5 L0,.5",Ke),"┺":($e={},$e[1]="M.5,.5 L0,.5",$e[3]="M.5,0 L.5,.5 L1,.5",$e),"┽":(Ve={},Ve[1]="M.5,0 L.5,1 M.5,.5 L1,.5",Ve[3]="M.5,.5 L0,.5",Ve),"┾":(Je={},Je[1]="M.5,0 L.5,1 M.5,.5 L0,.5",Je[3]="M.5,.5 L1,.5",Je),"┿":(Ge={},Ge[1]="M.5,0 L.5,1",Ge[3]="M0,.5 L1,.5",Ge),"╀":(Xe={},Xe[1]="M0,.5 L1,.5 M.5,.5 L.5,1",Xe[3]="M.5,.5 L.5,0",Xe),"╁":(Qe={},Qe[1]="M.5,.5 L.5,0 M0,.5 L1,.5",Qe[3]="M.5,.5 L.5,1",Qe),"╂":(Ye={},Ye[1]="M0,.5 L1,.5",Ye[3]="M.5,0 L.5,1",Ye),"╃":(Ze={},Ze[1]="M0.5,1 L.5,.5 L1,.5",Ze[3]="M.5,0 L.5,.5 L0,.5",Ze),"╄":(et={},et[1]="M0,.5 L.5,.5 L.5,1",et[3]="M.5,0 L.5,.5 L1,.5",et),"╅":(tt={},tt[1]="M.5,0 L.5,.5 L1,.5",tt[3]="M0,.5 L.5,.5 L.5,1",tt),"╆":(it={},it[1]="M.5,0 L.5,.5 L0,.5",it[3]="M0.5,1 L.5,.5 L1,.5",it),"╇":(rt={},rt[1]="M.5,.5 L.5,1",rt[3]="M.5,.5 L.5,0 M0,.5 L1,.5",rt),"╈":(nt={},nt[1]="M.5,.5 L.5,0",nt[3]="M0,.5 L1,.5 M.5,.5 L.5,1",nt),"╉":(ot={},ot[1]="M.5,.5 L1,.5",ot[3]="M.5,0 L.5,1 M.5,.5 L0,.5",ot),"╊":(st={},st[1]="M.5,.5 L0,.5",st[3]="M.5,0 L.5,1 M.5,.5 L1,.5",st),"╌":(at={},at[1]="M.1,.5 L.4,.5 M.6,.5 L.9,.5",at),"╍":(lt={},lt[3]="M.1,.5 L.4,.5 M.6,.5 L.9,.5",lt),"┄":(ct={},ct[1]="M.0667,.5 L.2667,.5 M.4,.5 L.6,.5 M.7333,.5 L.9333,.5",ct),"┅":(dt={},dt[3]="M.0667,.5 L.2667,.5 M.4,.5 L.6,.5 M.7333,.5 L.9333,.5",dt),"┈":(ht={},ht[1]="M.05,.5 L.2,.5 M.3,.5 L.45,.5 M.55,.5 L.7,.5 M.8,.5 L.95,.5",ht),"┉":(pt={},pt[3]="M.05,.5 L.2,.5 M.3,.5 L.45,.5 M.55,.5 L.7,.5 M.8,.5 L.95,.5",pt),"╎":(ut={},ut[1]="M.5,.1 L.5,.4 M.5,.6 L.5,.9",ut),"╏":(ft={},ft[3]="M.5,.1 L.5,.4 M.5,.6 L.5,.9",ft),"┆":(_t={},_t[1]="M.5,.0667 L.5,.2667 M.5,.4 L.5,.6 M.5,.7333 L.5,.9333",_t),"┇":(gt={},gt[3]="M.5,.0667 L.5,.2667 M.5,.4 L.5,.6 M.5,.7333 L.5,.9333",gt),"┊":(mt={},mt[1]="M.5,.05 L.5,.2 M.5,.3 L.5,.45 L.5,.55 M.5,.7 L.5,.95",mt),"┋":(bt={},bt[3]="M.5,.05 L.5,.2 M.5,.3 L.5,.45 L.5,.55 M.5,.7 L.5,.95",bt),"╭":(yt={},yt[1]="C.5,1,.5,.5,1,.5",yt),"╮":(vt={},vt[1]="C.5,1,.5,.5,0,.5",vt),"╯":(wt={},wt[1]="C.5,0,.5,.5,0,.5",wt),"╰":(xt={},xt[1]="C.5,0,.5,.5,1,.5",xt)},t.tryDrawCustomChar=function(e,i,r,n,o,s){var a=t.blockElementDefinitions[i];if(a)return function(e,t,i,r,n,o){for(var s=0;s<t.length;s++){var a=t[s],l=n/8,c=o/8;e.fillRect(i+a.x*l,r+a.y*c,a.w*l,a.h*c)}}(e,a,r,n,o,s),!0;var l=St[i];if(l)return function(e,t,i,r,n,o){var s,a=Et.get(t);a||(a=new Map,Et.set(t,a));var l=e.fillStyle;if("string"!=typeof l)throw new Error('Unexpected fillStyle type "'+l+'"');var c=a.get(l);if(!c){var d=t[0].length,h=t.length,p=document.createElement("canvas");p.width=d,p.height=h;var u=(0,Ct.throwIfFalsy)(p.getContext("2d")),f=new ImageData(d,h),_=void 0,g=void 0,m=void 0,b=void 0;if(l.startsWith("#"))_=parseInt(l.substr(1,2),16),g=parseInt(l.substr(3,2),16),m=parseInt(l.substr(5,2),16),b=l.length>7&&parseInt(l.substr(7,2),16)||1;else{if(!l.startsWith("rgba"))throw new Error('Unexpected fillStyle color format "'+l+'" when drawing pattern glyph');_=(s=l.substring(5,l.length-1).split(",").map((function(e){return parseFloat(e)})))[0],g=s[1],m=s[2],b=s[3]}for(var y=0;y<h;y++)for(var v=0;v<d;v++)f.data[4*(y*d+v)]=_,f.data[4*(y*d+v)+1]=g,f.data[4*(y*d+v)+2]=m,f.data[4*(y*d+v)+3]=t[y][v]*(255*b);u.putImageData(f,0,0),c=(0,Ct.throwIfFalsy)(e.createPattern(p,null)),a.set(l,c)}e.fillStyle=c,e.fillRect(i,r,n,o)}(e,l,r,n,o,s),!0;var c=t.boxDrawingDefinitions[i];return!!c&&(function(e,t,i,r,n,o){e.strokeStyle=e.fillStyle;for(var s=0,a=Object.entries(t);s<a.length;s++){var l=a[s],c=l[0],d=l[1];e.beginPath(),e.lineWidth=window.devicePixelRatio*Number.parseInt(c);for(var h=0,p=("function"==typeof d?d(.15,.15/o*n):d).split(" ");h<p.length;h++){var u=p[h],f=u[0],_=Lt[f];if(_){var g=u.substring(1).split(",");g[0]&&g[1]&&_(e,At(g,n,o,i,r))}else console.error('Could not find drawing instructions for "'+f+'"')}e.stroke(),e.closePath()}}(e,c,r,n,o,s),!0)};var Et=new Map;function kt(e,t,i){return void 0===i&&(i=0),Math.max(Math.min(e,t),i)}var Lt={C:function(e,t){return e.bezierCurveTo(t[0],t[1],t[2],t[3],t[4],t[5])},L:function(e,t){return e.lineTo(t[0],t[1])},M:function(e,t){return e.moveTo(t[0],t[1])}};function At(e,t,i,r,n){var o=e.map((function(e){return parseFloat(e)||parseInt(e)}));if(o.length<2)throw new Error("Too few arguments for instruction");for(var s=0;s<o.length;s+=2)o[s]*=t,0!==o[s]&&(o[s]=kt(Math.round(o[s]+.5)-.5,t,0)),o[s]+=r;for(var a=1;a<o.length;a+=2)o[a]*=i,0!==o[a]&&(o[a]=kt(Math.round(o[a]+.5)-.5,i,0)),o[a]+=n;return o}},634:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.throwIfFalsy=void 0,t.throwIfFalsy=function(e){if(!e)throw new Error("value must not be falsy");return e}},499:(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.CHAR_ATLAS_CELL_SPACING=t.TEXT_BASELINE=t.DIM_OPACITY=t.INVERTED_DEFAULT_COLOR=void 0;var r=i(399);t.INVERTED_DEFAULT_COLOR=257,t.DIM_OPACITY=.5,t.TEXT_BASELINE=r.isFirefox?"bottom":"ideographic",t.CHAR_ATLAS_CELL_SPACING=1},345:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.forwardEvent=t.EventEmitter=void 0;var i=function(){function e(){this._listeners=[],this._disposed=!1}return Object.defineProperty(e.prototype,"event",{get:function(){var e=this;return this._event||(this._event=function(t){return e._listeners.push(t),{dispose:function(){if(!e._disposed)for(var i=0;i<e._listeners.length;i++)if(e._listeners[i]===t)return void e._listeners.splice(i,1)}}}),this._event},enumerable:!1,configurable:!0}),e.prototype.fire=function(e,t){for(var i=[],r=0;r<this._listeners.length;r++)i.push(this._listeners[r]);for(r=0;r<i.length;r++)i[r].call(void 0,e,t)},e.prototype.dispose=function(){this._listeners&&(this._listeners.length=0),this._disposed=!0},e}();t.EventEmitter=i,t.forwardEvent=function(e,t){return e((function(e){return t.fire(e)}))}},859:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getDisposeArrayDisposable=t.disposeArray=t.Disposable=void 0;var i=function(){function e(){this._disposables=[],this._isDisposed=!1}return e.prototype.dispose=function(){this._isDisposed=!0;for(var e=0,t=this._disposables;e<t.length;e++)t[e].dispose();this._disposables.length=0},e.prototype.register=function(e){return this._disposables.push(e),e},e.prototype.unregister=function(e){var t=this._disposables.indexOf(e);-1!==t&&this._disposables.splice(t,1)},e}();function r(e){for(var t=0,i=e;t<i.length;t++)i[t].dispose();e.length=0}t.Disposable=i,t.disposeArray=r,t.getDisposeArrayDisposable=function(e){return{dispose:function(){return r(e)}}}},399:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.isLinux=t.isWindows=t.isIphone=t.isIpad=t.isMac=t.isSafari=t.isFirefox=void 0;var i="undefined"==typeof navigator,r=i?"node":navigator.userAgent,n=i?"node":navigator.platform;t.isFirefox=r.includes("Firefox"),t.isSafari=/^((?!chrome|android).)*safari/i.test(r),t.isMac=["Macintosh","MacIntel","MacPPC","Mac68K"].includes(n),t.isIpad="iPad"===n,t.isIphone="iPhone"===n,t.isWindows=["Windows","Win16","Win32","WinCE"].includes(n),t.isLinux=n.indexOf("Linux")>=0},455:(e,t)=>{function i(e,t,i,r){if(void 0===i&&(i=0),void 0===r&&(r=e.length),i>=e.length)return e;i=(e.length+i)%e.length,r=r>=e.length?e.length:(e.length+r)%e.length;for(var n=i;n<r;++n)e[n]=t;return e}Object.defineProperty(t,"__esModule",{value:!0}),t.concat=t.fillFallback=t.fill=void 0,t.fill=function(e,t,r,n){return e.fill?e.fill(t,r,n):i(e,t,r,n)},t.fillFallback=i,t.concat=function(e,t){var i=new e.constructor(e.length+t.length);return i.set(e),i.set(t,e.length),i}},147:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.ExtendedAttrs=t.AttributeData=void 0;var i=function(){function e(){this.fg=0,this.bg=0,this.extended=new r}return e.toColorRGB=function(e){return[e>>>16&255,e>>>8&255,255&e]},e.fromColorRGB=function(e){return(255&e[0])<<16|(255&e[1])<<8|255&e[2]},e.prototype.clone=function(){var t=new e;return t.fg=this.fg,t.bg=this.bg,t.extended=this.extended.clone(),t},e.prototype.isInverse=function(){return 67108864&this.fg},e.prototype.isBold=function(){return 134217728&this.fg},e.prototype.isUnderline=function(){return 268435456&this.fg},e.prototype.isBlink=function(){return 536870912&this.fg},e.prototype.isInvisible=function(){return 1073741824&this.fg},e.prototype.isItalic=function(){return 67108864&this.bg},e.prototype.isDim=function(){return 134217728&this.bg},e.prototype.isStrikethrough=function(){return 2147483648&this.fg},e.prototype.getFgColorMode=function(){return 50331648&this.fg},e.prototype.getBgColorMode=function(){return 50331648&this.bg},e.prototype.isFgRGB=function(){return 50331648==(50331648&this.fg)},e.prototype.isBgRGB=function(){return 50331648==(50331648&this.bg)},e.prototype.isFgPalette=function(){return 16777216==(50331648&this.fg)||33554432==(50331648&this.fg)},e.prototype.isBgPalette=function(){return 16777216==(50331648&this.bg)||33554432==(50331648&this.bg)},e.prototype.isFgDefault=function(){return 0==(50331648&this.fg)},e.prototype.isBgDefault=function(){return 0==(50331648&this.bg)},e.prototype.isAttributeDefault=function(){return 0===this.fg&&0===this.bg},e.prototype.getFgColor=function(){switch(50331648&this.fg){case 16777216:case 33554432:return 255&this.fg;case 50331648:return 16777215&this.fg;default:return-1}},e.prototype.getBgColor=function(){switch(50331648&this.bg){case 16777216:case 33554432:return 255&this.bg;case 50331648:return 16777215&this.bg;default:return-1}},e.prototype.hasExtendedAttrs=function(){return 268435456&this.bg},e.prototype.updateExtended=function(){this.extended.isEmpty()?this.bg&=-268435457:this.bg|=268435456},e.prototype.getUnderlineColor=function(){if(268435456&this.bg&&~this.extended.underlineColor)switch(50331648&this.extended.underlineColor){case 16777216:case 33554432:return 255&this.extended.underlineColor;case 50331648:return 16777215&this.extended.underlineColor;default:return this.getFgColor()}return this.getFgColor()},e.prototype.getUnderlineColorMode=function(){return 268435456&this.bg&&~this.extended.underlineColor?50331648&this.extended.underlineColor:this.getFgColorMode()},e.prototype.isUnderlineColorRGB=function(){return 268435456&this.bg&&~this.extended.underlineColor?50331648==(50331648&this.extended.underlineColor):this.isFgRGB()},e.prototype.isUnderlineColorPalette=function(){return 268435456&this.bg&&~this.extended.underlineColor?16777216==(50331648&this.extended.underlineColor)||33554432==(50331648&this.extended.underlineColor):this.isFgPalette()},e.prototype.isUnderlineColorDefault=function(){return 268435456&this.bg&&~this.extended.underlineColor?0==(50331648&this.extended.underlineColor):this.isFgDefault()},e.prototype.getUnderlineStyle=function(){return 268435456&this.fg?268435456&this.bg?this.extended.underlineStyle:1:0},e}();t.AttributeData=i;var r=function(){function e(e,t){void 0===e&&(e=0),void 0===t&&(t=-1),this.underlineStyle=e,this.underlineColor=t}return e.prototype.clone=function(){return new e(this.underlineStyle,this.underlineColor)},e.prototype.isEmpty=function(){return 0===this.underlineStyle},e}();t.ExtendedAttrs=r},782:function(e,t,i){var r,n=this&&this.__extends||(r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])},r(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function i(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)});Object.defineProperty(t,"__esModule",{value:!0}),t.CellData=void 0;var o=i(133),s=i(855),a=i(147),l=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.content=0,t.fg=0,t.bg=0,t.extended=new a.ExtendedAttrs,t.combinedData="",t}return n(t,e),t.fromCharData=function(e){var i=new t;return i.setFromCharData(e),i},t.prototype.isCombined=function(){return 2097152&this.content},t.prototype.getWidth=function(){return this.content>>22},t.prototype.getChars=function(){return 2097152&this.content?this.combinedData:2097151&this.content?(0,o.stringFromCodePoint)(2097151&this.content):""},t.prototype.getCode=function(){return this.isCombined()?this.combinedData.charCodeAt(this.combinedData.length-1):2097151&this.content},t.prototype.setFromCharData=function(e){this.fg=e[s.CHAR_DATA_ATTR_INDEX],this.bg=0;var t=!1;if(e[s.CHAR_DATA_CHAR_INDEX].length>2)t=!0;else if(2===e[s.CHAR_DATA_CHAR_INDEX].length){var i=e[s.CHAR_DATA_CHAR_INDEX].charCodeAt(0);if(55296<=i&&i<=56319){var r=e[s.CHAR_DATA_CHAR_INDEX].charCodeAt(1);56320<=r&&r<=57343?this.content=1024*(i-55296)+r-56320+65536|e[s.CHAR_DATA_WIDTH_INDEX]<<22:t=!0}else t=!0}else this.content=e[s.CHAR_DATA_CHAR_INDEX].charCodeAt(0)|e[s.CHAR_DATA_WIDTH_INDEX]<<22;t&&(this.combinedData=e[s.CHAR_DATA_CHAR_INDEX],this.content=2097152|e[s.CHAR_DATA_WIDTH_INDEX]<<22)},t.prototype.getAsCharData=function(){return[this.fg,this.getChars(),this.getWidth(),this.getCode()]},t}(a.AttributeData);t.CellData=l},855:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.WHITESPACE_CELL_CODE=t.WHITESPACE_CELL_WIDTH=t.WHITESPACE_CELL_CHAR=t.NULL_CELL_CODE=t.NULL_CELL_WIDTH=t.NULL_CELL_CHAR=t.CHAR_DATA_CODE_INDEX=t.CHAR_DATA_WIDTH_INDEX=t.CHAR_DATA_CHAR_INDEX=t.CHAR_DATA_ATTR_INDEX=t.DEFAULT_ATTR=t.DEFAULT_COLOR=void 0,t.DEFAULT_COLOR=256,t.DEFAULT_ATTR=256|t.DEFAULT_COLOR<<9,t.CHAR_DATA_ATTR_INDEX=0,t.CHAR_DATA_CHAR_INDEX=1,t.CHAR_DATA_WIDTH_INDEX=2,t.CHAR_DATA_CODE_INDEX=3,t.NULL_CELL_CHAR="",t.NULL_CELL_WIDTH=1,t.NULL_CELL_CODE=0,t.WHITESPACE_CELL_CHAR=" ",t.WHITESPACE_CELL_WIDTH=1,t.WHITESPACE_CELL_CODE=32},133:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.Utf8ToUtf32=t.StringToUtf32=t.utf32ToString=t.stringFromCodePoint=void 0,t.stringFromCodePoint=function(e){return e>65535?(e-=65536,String.fromCharCode(55296+(e>>10))+String.fromCharCode(e%1024+56320)):String.fromCharCode(e)},t.utf32ToString=function(e,t,i){void 0===t&&(t=0),void 0===i&&(i=e.length);for(var r="",n=t;n<i;++n){var o=e[n];o>65535?(o-=65536,r+=String.fromCharCode(55296+(o>>10))+String.fromCharCode(o%1024+56320)):r+=String.fromCharCode(o)}return r};var i=function(){function e(){this._interim=0}return e.prototype.clear=function(){this._interim=0},e.prototype.decode=function(e,t){var i=e.length;if(!i)return 0;var r=0,n=0;this._interim&&(56320<=(a=e.charCodeAt(n++))&&a<=57343?t[r++]=1024*(this._interim-55296)+a-56320+65536:(t[r++]=this._interim,t[r++]=a),this._interim=0);for(var o=n;o<i;++o){var s=e.charCodeAt(o);if(55296<=s&&s<=56319){if(++o>=i)return this._interim=s,r;var a;56320<=(a=e.charCodeAt(o))&&a<=57343?t[r++]=1024*(s-55296)+a-56320+65536:(t[r++]=s,t[r++]=a)}else 65279!==s&&(t[r++]=s)}return r},e}();t.StringToUtf32=i;var r=function(){function e(){this.interim=new Uint8Array(3)}return e.prototype.clear=function(){this.interim.fill(0)},e.prototype.decode=function(e,t){var i=e.length;if(!i)return 0;var r,n,o,s,a=0,l=0,c=0;if(this.interim[0]){var d=!1,h=this.interim[0];h&=192==(224&h)?31:224==(240&h)?15:7;for(var p=0,u=void 0;(u=63&this.interim[++p])&&p<4;)h<<=6,h|=u;for(var f=192==(224&this.interim[0])?2:224==(240&this.interim[0])?3:4,_=f-p;c<_;){if(c>=i)return 0;if(128!=(192&(u=e[c++]))){c--,d=!0;break}this.interim[p++]=u,h<<=6,h|=63&u}d||(2===f?h<128?c--:t[a++]=h:3===f?h<2048||h>=55296&&h<=57343||65279===h||(t[a++]=h):h<65536||h>1114111||(t[a++]=h)),this.interim.fill(0)}for(var g=i-4,m=c;m<i;){for(;!(!(m<g)||128&(r=e[m])||128&(n=e[m+1])||128&(o=e[m+2])||128&(s=e[m+3]));)t[a++]=r,t[a++]=n,t[a++]=o,t[a++]=s,m+=4;if((r=e[m++])<128)t[a++]=r;else if(192==(224&r)){if(m>=i)return this.interim[0]=r,a;if(128!=(192&(n=e[m++]))){m--;continue}if((l=(31&r)<<6|63&n)<128){m--;continue}t[a++]=l}else if(224==(240&r)){if(m>=i)return this.interim[0]=r,a;if(128!=(192&(n=e[m++]))){m--;continue}if(m>=i)return this.interim[0]=r,this.interim[1]=n,a;if(128!=(192&(o=e[m++]))){m--;continue}if((l=(15&r)<<12|(63&n)<<6|63&o)<2048||l>=55296&&l<=57343||65279===l)continue;t[a++]=l}else if(240==(248&r)){if(m>=i)return this.interim[0]=r,a;if(128!=(192&(n=e[m++]))){m--;continue}if(m>=i)return this.interim[0]=r,this.interim[1]=n,a;if(128!=(192&(o=e[m++]))){m--;continue}if(m>=i)return this.interim[0]=r,this.interim[1]=n,this.interim[2]=o,a;if(128!=(192&(s=e[m++]))){m--;continue}if((l=(7&r)<<18|(63&n)<<12|(63&o)<<6|63&s)<65536||l>1114111)continue;t[a++]=l}}return a},e}();t.Utf8ToUtf32=r}},t={};function i(r){var n=t[r];if(void 0!==n)return n.exports;var o=t[r]={exports:{}};return e[r].call(o.exports,o,o.exports,i),o.exports}var r={};return(()=>{var e=r;Object.defineProperty(e,"__esModule",{value:!0}),e.WebglAddon=void 0;var t=i(666),n=i(345),o=i(399),s=function(){function e(e){this._preserveDrawingBuffer=e,this._onContextLoss=new n.EventEmitter}return Object.defineProperty(e.prototype,"onContextLoss",{get:function(){return this._onContextLoss.event},enumerable:!1,configurable:!0}),e.prototype.activate=function(e){var i=this;if(!e.element)throw new Error("Cannot activate WebglAddon before Terminal.open");if(o.isSafari)throw new Error("Webgl is not currently supported on Safari");this._terminal=e;var r=e._core._renderService,n=e._core._characterJoinerService,s=e._core._colorManager.colors;this._renderer=new t.WebglRenderer(e,s,n,this._preserveDrawingBuffer),this._renderer.onContextLoss((function(){return i._onContextLoss.fire()})),r.setRenderer(this._renderer)},e.prototype.dispose=function(){if(!this._terminal)throw new Error("Cannot dispose WebglAddon because it is activated");var e=this._terminal._core._renderService;e.setRenderer(this._terminal._core._createRenderer()),e.onResize(this._terminal.cols,this._terminal.rows),this._renderer=void 0},Object.defineProperty(e.prototype,"textureAtlas",{get:function(){var e;return null===(e=this._renderer)||void 0===e?void 0:e.textureAtlas},enumerable:!1,configurable:!0}),e.prototype.clearTextureAtlas=function(){var e;null===(e=this._renderer)||void 0===e||e.clearCharAtlas()},e}();e.WebglAddon=s})(),r})()},2320:e=>{self,e.exports=(()=>{"use strict";var e={4567:function(e,t,i){var r,n=this&&this.__extends||(r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])},r(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function i(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)});Object.defineProperty(t,"__esModule",{value:!0}),t.AccessibilityManager=void 0;var o=i(9042),s=i(6114),a=i(9924),l=i(3656),c=i(844),d=i(5596),h=i(9631),p=function(e){function t(t,i){var r=e.call(this)||this;r._terminal=t,r._renderService=i,r._liveRegionLineCount=0,r._charsToConsume=[],r._charsToAnnounce="",r._accessibilityTreeRoot=document.createElement("div"),r._accessibilityTreeRoot.classList.add("xterm-accessibility"),r._accessibilityTreeRoot.tabIndex=0,r._rowContainer=document.createElement("div"),r._rowContainer.setAttribute("role","list"),r._rowContainer.classList.add("xterm-accessibility-tree"),r._rowElements=[];for(var n=0;n<r._terminal.rows;n++)r._rowElements[n]=r._createAccessibilityTreeNode(),r._rowContainer.appendChild(r._rowElements[n]);if(r._topBoundaryFocusListener=function(e){return r._onBoundaryFocus(e,0)},r._bottomBoundaryFocusListener=function(e){return r._onBoundaryFocus(e,1)},r._rowElements[0].addEventListener("focus",r._topBoundaryFocusListener),r._rowElements[r._rowElements.length-1].addEventListener("focus",r._bottomBoundaryFocusListener),r._refreshRowsDimensions(),r._accessibilityTreeRoot.appendChild(r._rowContainer),r._renderRowsDebouncer=new a.TimeBasedDebouncer(r._renderRows.bind(r)),r._refreshRows(),r._liveRegion=document.createElement("div"),r._liveRegion.classList.add("live-region"),r._liveRegion.setAttribute("aria-live","assertive"),r._accessibilityTreeRoot.appendChild(r._liveRegion),!r._terminal.element)throw new Error("Cannot enable accessibility before Terminal.open");return r._terminal.element.insertAdjacentElement("afterbegin",r._accessibilityTreeRoot),r.register(r._renderRowsDebouncer),r.register(r._terminal.onResize((function(e){return r._onResize(e.rows)}))),r.register(r._terminal.onRender((function(e){return r._refreshRows(e.start,e.end)}))),r.register(r._terminal.onScroll((function(){return r._refreshRows()}))),r.register(r._terminal.onA11yChar((function(e){return r._onChar(e)}))),r.register(r._terminal.onLineFeed((function(){return r._onChar("\n")}))),r.register(r._terminal.onA11yTab((function(e){return r._onTab(e)}))),r.register(r._terminal.onKey((function(e){return r._onKey(e.key)}))),r.register(r._terminal.onBlur((function(){return r._clearLiveRegion()}))),r.register(r._renderService.onDimensionsChange((function(){return r._refreshRowsDimensions()}))),r._screenDprMonitor=new d.ScreenDprMonitor,r.register(r._screenDprMonitor),r._screenDprMonitor.setListener((function(){return r._refreshRowsDimensions()})),r.register((0,l.addDisposableDomListener)(window,"resize",(function(){return r._refreshRowsDimensions()}))),r}return n(t,e),t.prototype.dispose=function(){e.prototype.dispose.call(this),(0,h.removeElementFromParent)(this._accessibilityTreeRoot),this._rowElements.length=0},t.prototype._onBoundaryFocus=function(e,t){var i=e.target,r=this._rowElements[0===t?1:this._rowElements.length-2];if(i.getAttribute("aria-posinset")!==(0===t?"1":""+this._terminal.buffer.lines.length)&&e.relatedTarget===r){var n,o;if(0===t?(n=i,o=this._rowElements.pop(),this._rowContainer.removeChild(o)):(n=this._rowElements.shift(),o=i,this._rowContainer.removeChild(n)),n.removeEventListener("focus",this._topBoundaryFocusListener),o.removeEventListener("focus",this._bottomBoundaryFocusListener),0===t){var s=this._createAccessibilityTreeNode();this._rowElements.unshift(s),this._rowContainer.insertAdjacentElement("afterbegin",s)}else s=this._createAccessibilityTreeNode(),this._rowElements.push(s),this._rowContainer.appendChild(s);this._rowElements[0].addEventListener("focus",this._topBoundaryFocusListener),this._rowElements[this._rowElements.length-1].addEventListener("focus",this._bottomBoundaryFocusListener),this._terminal.scrollLines(0===t?-1:1),this._rowElements[0===t?1:this._rowElements.length-2].focus(),e.preventDefault(),e.stopImmediatePropagation()}},t.prototype._onResize=function(e){this._rowElements[this._rowElements.length-1].removeEventListener("focus",this._bottomBoundaryFocusListener);for(var t=this._rowContainer.children.length;t<this._terminal.rows;t++)this._rowElements[t]=this._createAccessibilityTreeNode(),this._rowContainer.appendChild(this._rowElements[t]);for(;this._rowElements.length>e;)this._rowContainer.removeChild(this._rowElements.pop());this._rowElements[this._rowElements.length-1].addEventListener("focus",this._bottomBoundaryFocusListener),this._refreshRowsDimensions()},t.prototype._createAccessibilityTreeNode=function(){var e=document.createElement("div");return e.setAttribute("role","listitem"),e.tabIndex=-1,this._refreshRowDimensions(e),e},t.prototype._onTab=function(e){for(var t=0;t<e;t++)this._onChar(" ")},t.prototype._onChar=function(e){var t=this;this._liveRegionLineCount<21&&(this._charsToConsume.length>0?this._charsToConsume.shift()!==e&&(this._charsToAnnounce+=e):this._charsToAnnounce+=e,"\n"===e&&(this._liveRegionLineCount++,21===this._liveRegionLineCount&&(this._liveRegion.textContent+=o.tooMuchOutput)),s.isMac&&this._liveRegion.textContent&&this._liveRegion.textContent.length>0&&!this._liveRegion.parentNode&&setTimeout((function(){t._accessibilityTreeRoot.appendChild(t._liveRegion)}),0))},t.prototype._clearLiveRegion=function(){this._liveRegion.textContent="",this._liveRegionLineCount=0,s.isMac&&(0,h.removeElementFromParent)(this._liveRegion)},t.prototype._onKey=function(e){this._clearLiveRegion(),this._charsToConsume.push(e)},t.prototype._refreshRows=function(e,t){this._renderRowsDebouncer.refresh(e,t,this._terminal.rows)},t.prototype._renderRows=function(e,t){for(var i=this._terminal.buffer,r=i.lines.length.toString(),n=e;n<=t;n++){var o=i.translateBufferLineToString(i.ydisp+n,!0),s=(i.ydisp+n+1).toString(),a=this._rowElements[n];a&&(0===o.length?a.innerText=" ":a.textContent=o,a.setAttribute("aria-posinset",s),a.setAttribute("aria-setsize",r))}this._announceCharacters()},t.prototype._refreshRowsDimensions=function(){if(this._renderService.dimensions.actualCellHeight){this._rowElements.length!==this._terminal.rows&&this._onResize(this._terminal.rows);for(var e=0;e<this._terminal.rows;e++)this._refreshRowDimensions(this._rowElements[e])}},t.prototype._refreshRowDimensions=function(e){e.style.height=this._renderService.dimensions.actualCellHeight+"px"},t.prototype._announceCharacters=function(){0!==this._charsToAnnounce.length&&(this._liveRegion.textContent+=this._charsToAnnounce,this._charsToAnnounce="")},t}(c.Disposable);t.AccessibilityManager=p},3614:(e,t)=>{function i(e){return e.replace(/\r?\n/g,"\r")}function r(e,t){return t?"[200~"+e+"[201~":e}function n(e,t,n){e=r(e=i(e),n.decPrivateModes.bracketedPasteMode),n.triggerDataEvent(e,!0),t.value=""}function o(e,t,i){var r=i.getBoundingClientRect(),n=e.clientX-r.left-10,o=e.clientY-r.top-10;t.style.width="20px",t.style.height="20px",t.style.left=n+"px",t.style.top=o+"px",t.style.zIndex="1000",t.focus()}Object.defineProperty(t,"__esModule",{value:!0}),t.rightClickHandler=t.moveTextAreaUnderMouseCursor=t.paste=t.handlePasteEvent=t.copyHandler=t.bracketTextForPaste=t.prepareTextForTerminal=void 0,t.prepareTextForTerminal=i,t.bracketTextForPaste=r,t.copyHandler=function(e,t){e.clipboardData&&e.clipboardData.setData("text/plain",t.selectionText),e.preventDefault()},t.handlePasteEvent=function(e,t,i){e.stopPropagation(),e.clipboardData&&n(e.clipboardData.getData("text/plain"),t,i)},t.paste=n,t.moveTextAreaUnderMouseCursor=o,t.rightClickHandler=function(e,t,i,r,n){o(e,t,i),n&&r.rightClickSelect(e),t.value=r.selectionText,t.select()}},7239:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.ColorContrastCache=void 0;var i=function(){function e(){this._color={},this._rgba={}}return e.prototype.clear=function(){this._color={},this._rgba={}},e.prototype.setCss=function(e,t,i){this._rgba[e]||(this._rgba[e]={}),this._rgba[e][t]=i},e.prototype.getCss=function(e,t){return this._rgba[e]?this._rgba[e][t]:void 0},e.prototype.setColor=function(e,t,i){this._color[e]||(this._color[e]={}),this._color[e][t]=i},e.prototype.getColor=function(e,t){return this._color[e]?this._color[e][t]:void 0},e}();t.ColorContrastCache=i},5680:function(e,t,i){var r=this&&this.__read||function(e,t){var i="function"==typeof Symbol&&e[Symbol.iterator];if(!i)return e;var r,n,o=i.call(e),s=[];try{for(;(void 0===t||t-- >0)&&!(r=o.next()).done;)s.push(r.value)}catch(e){n={error:e}}finally{try{r&&!r.done&&(i=o.return)&&i.call(o)}finally{if(n)throw n.error}}return s};Object.defineProperty(t,"__esModule",{value:!0}),t.ColorManager=t.DEFAULT_ANSI_COLORS=void 0;var n=i(8055),o=i(7239),s=n.css.toColor("#ffffff"),a=n.css.toColor("#000000"),l=n.css.toColor("#ffffff"),c=n.css.toColor("#000000"),d={css:"rgba(255, 255, 255, 0.3)",rgba:4294967117};t.DEFAULT_ANSI_COLORS=Object.freeze(function(){for(var e=[n.css.toColor("#2e3436"),n.css.toColor("#cc0000"),n.css.toColor("#4e9a06"),n.css.toColor("#c4a000"),n.css.toColor("#3465a4"),n.css.toColor("#75507b"),n.css.toColor("#06989a"),n.css.toColor("#d3d7cf"),n.css.toColor("#555753"),n.css.toColor("#ef2929"),n.css.toColor("#8ae234"),n.css.toColor("#fce94f"),n.css.toColor("#729fcf"),n.css.toColor("#ad7fa8"),n.css.toColor("#34e2e2"),n.css.toColor("#eeeeec")],t=[0,95,135,175,215,255],i=0;i<216;i++){var r=t[i/36%6|0],o=t[i/6%6|0],s=t[i%6];e.push({css:n.channels.toCss(r,o,s),rgba:n.channels.toRgba(r,o,s)})}for(i=0;i<24;i++){var a=8+10*i;e.push({css:n.channels.toCss(a,a,a),rgba:n.channels.toRgba(a,a,a)})}return e}());var h=function(){function e(e,i){this.allowTransparency=i;var r=e.createElement("canvas");r.width=1,r.height=1;var h=r.getContext("2d");if(!h)throw new Error("Could not get rendering context");this._ctx=h,this._ctx.globalCompositeOperation="copy",this._litmusColor=this._ctx.createLinearGradient(0,0,1,1),this._contrastCache=new o.ColorContrastCache,this.colors={foreground:s,background:a,cursor:l,cursorAccent:c,selectionTransparent:d,selectionOpaque:n.color.blend(a,d),selectionForeground:void 0,ansi:t.DEFAULT_ANSI_COLORS.slice(),contrastCache:this._contrastCache},this._updateRestoreColors()}return e.prototype.onOptionsChange=function(e){"minimumContrastRatio"===e&&this._contrastCache.clear()},e.prototype.setTheme=function(e){void 0===e&&(e={}),this.colors.foreground=this._parseColor(e.foreground,s),this.colors.background=this._parseColor(e.background,a),this.colors.cursor=this._parseColor(e.cursor,l,!0),this.colors.cursorAccent=this._parseColor(e.cursorAccent,c,!0),this.colors.selectionTransparent=this._parseColor(e.selection,d,!0),this.colors.selectionOpaque=n.color.blend(this.colors.background,this.colors.selectionTransparent);var i={css:"",rgba:0};this.colors.selectionForeground=e.selectionForeground?this._parseColor(e.selectionForeground,i):void 0,this.colors.selectionForeground===i&&(this.colors.selectionForeground=void 0),n.color.isOpaque(this.colors.selectionTransparent)&&(this.colors.selectionTransparent=n.color.opacity(this.colors.selectionTransparent,.3)),this.colors.ansi[0]=this._parseColor(e.black,t.DEFAULT_ANSI_COLORS[0]),this.colors.ansi[1]=this._parseColor(e.red,t.DEFAULT_ANSI_COLORS[1]),this.colors.ansi[2]=this._parseColor(e.green,t.DEFAULT_ANSI_COLORS[2]),this.colors.ansi[3]=this._parseColor(e.yellow,t.DEFAULT_ANSI_COLORS[3]),this.colors.ansi[4]=this._parseColor(e.blue,t.DEFAULT_ANSI_COLORS[4]),this.colors.ansi[5]=this._parseColor(e.magenta,t.DEFAULT_ANSI_COLORS[5]),this.colors.ansi[6]=this._parseColor(e.cyan,t.DEFAULT_ANSI_COLORS[6]),this.colors.ansi[7]=this._parseColor(e.white,t.DEFAULT_ANSI_COLORS[7]),this.colors.ansi[8]=this._parseColor(e.brightBlack,t.DEFAULT_ANSI_COLORS[8]),this.colors.ansi[9]=this._parseColor(e.brightRed,t.DEFAULT_ANSI_COLORS[9]),this.colors.ansi[10]=this._parseColor(e.brightGreen,t.DEFAULT_ANSI_COLORS[10]),this.colors.ansi[11]=this._parseColor(e.brightYellow,t.DEFAULT_ANSI_COLORS[11]),this.colors.ansi[12]=this._parseColor(e.brightBlue,t.DEFAULT_ANSI_COLORS[12]),this.colors.ansi[13]=this._parseColor(e.brightMagenta,t.DEFAULT_ANSI_COLORS[13]),this.colors.ansi[14]=this._parseColor(e.brightCyan,t.DEFAULT_ANSI_COLORS[14]),this.colors.ansi[15]=this._parseColor(e.brightWhite,t.DEFAULT_ANSI_COLORS[15]),this._contrastCache.clear(),this._updateRestoreColors()},e.prototype.restoreColor=function(e){if(void 0!==e)switch(e){case 256:this.colors.foreground=this._restoreColors.foreground;break;case 257:this.colors.background=this._restoreColors.background;break;case 258:this.colors.cursor=this._restoreColors.cursor;break;default:this.colors.ansi[e]=this._restoreColors.ansi[e]}else for(var t=0;t<this._restoreColors.ansi.length;++t)this.colors.ansi[t]=this._restoreColors.ansi[t]},e.prototype._updateRestoreColors=function(){this._restoreColors={foreground:this.colors.foreground,background:this.colors.background,cursor:this.colors.cursor,ansi:this.colors.ansi.slice()}},e.prototype._parseColor=function(e,t,i){if(void 0===i&&(i=this.allowTransparency),void 0===e)return t;if(this._ctx.fillStyle=this._litmusColor,this._ctx.fillStyle=e,"string"!=typeof this._ctx.fillStyle)return console.warn("Color: "+e+" is invalid using fallback "+t.css),t;this._ctx.fillRect(0,0,1,1);var o=this._ctx.getImageData(0,0,1,1).data;if(255!==o[3]){if(!i)return console.warn("Color: "+e+" is using transparency, but allowTransparency is false. Using fallback "+t.css+"."),t;var s=r(this._ctx.fillStyle.substring(5,this._ctx.fillStyle.length-1).split(",").map((function(e){return Number(e)})),4),a=s[0],l=s[1],c=s[2],d=s[3],h=Math.round(255*d);return{rgba:n.channels.toRgba(a,l,c,h),css:e}}return{css:this._ctx.fillStyle,rgba:n.channels.toRgba(o[0],o[1],o[2],o[3])}},e}();t.ColorManager=h},9631:function(e,t){var i=this&&this.__values||function(e){var t="function"==typeof Symbol&&Symbol.iterator,i=t&&e[t],r=0;if(i)return i.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(t,"__esModule",{value:!0}),t.removeElementFromParent=void 0,t.removeElementFromParent=function(){for(var e,t,r,n=[],o=0;o<arguments.length;o++)n[o]=arguments[o];try{for(var s=i(n),a=s.next();!a.done;a=s.next()){var l=a.value;null===(r=null==l?void 0:l.parentElement)||void 0===r||r.removeChild(l)}}catch(t){e={error:t}}finally{try{a&&!a.done&&(t=s.return)&&t.call(s)}finally{if(e)throw e.error}}}},3656:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.addDisposableDomListener=void 0,t.addDisposableDomListener=function(e,t,i,r){e.addEventListener(t,i,r);var n=!1;return{dispose:function(){n||(n=!0,e.removeEventListener(t,i,r))}}}},3551:function(e,t,i){var r=this&&this.__decorate||function(e,t,i,r){var n,o=arguments.length,s=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,r);else for(var a=e.length-1;a>=0;a--)(n=e[a])&&(s=(o<3?n(s):o>3?n(t,i,s):n(t,i))||s);return o>3&&s&&Object.defineProperty(t,i,s),s},n=this&&this.__param||function(e,t){return function(i,r){t(i,r,e)}};Object.defineProperty(t,"__esModule",{value:!0}),t.MouseZone=t.Linkifier=void 0;var o=i(8460),s=i(2585),a=function(){function e(e,t,i){this._bufferService=e,this._logService=t,this._unicodeService=i,this._linkMatchers=[],this._nextLinkMatcherId=0,this._onShowLinkUnderline=new o.EventEmitter,this._onHideLinkUnderline=new o.EventEmitter,this._onLinkTooltip=new o.EventEmitter,this._rowsToLinkify={start:void 0,end:void 0}}return Object.defineProperty(e.prototype,"onShowLinkUnderline",{get:function(){return this._onShowLinkUnderline.event},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"onHideLinkUnderline",{get:function(){return this._onHideLinkUnderline.event},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"onLinkTooltip",{get:function(){return this._onLinkTooltip.event},enumerable:!1,configurable:!0}),e.prototype.attachToDom=function(e,t){this._element=e,this._mouseZoneManager=t},e.prototype.linkifyRows=function(t,i){var r=this;this._mouseZoneManager&&(void 0===this._rowsToLinkify.start||void 0===this._rowsToLinkify.end?(this._rowsToLinkify.start=t,this._rowsToLinkify.end=i):(this._rowsToLinkify.start=Math.min(this._rowsToLinkify.start,t),this._rowsToLinkify.end=Math.max(this._rowsToLinkify.end,i)),this._mouseZoneManager.clearAll(t,i),this._rowsTimeoutId&&clearTimeout(this._rowsTimeoutId),this._rowsTimeoutId=setTimeout((function(){return r._linkifyRows()}),e._timeBeforeLatency))},e.prototype._linkifyRows=function(){this._rowsTimeoutId=void 0;var e=this._bufferService.buffer;if(void 0!==this._rowsToLinkify.start&&void 0!==this._rowsToLinkify.end){var t=e.ydisp+this._rowsToLinkify.start;if(!(t>=e.lines.length)){for(var i=e.ydisp+Math.min(this._rowsToLinkify.end,this._bufferService.rows)+1,r=Math.ceil(2e3/this._bufferService.cols),n=this._bufferService.buffer.iterator(!1,t,i,r,r);n.hasNext();)for(var o=n.next(),s=0;s<this._linkMatchers.length;s++)this._doLinkifyRow(o.range.first,o.content,this._linkMatchers[s]);this._rowsToLinkify.start=void 0,this._rowsToLinkify.end=void 0}}else this._logService.debug("_rowToLinkify was unset before _linkifyRows was called")},e.prototype.registerLinkMatcher=function(e,t,i){if(void 0===i&&(i={}),!t)throw new Error("handler must be defined");var r={id:this._nextLinkMatcherId++,regex:e,handler:t,matchIndex:i.matchIndex,validationCallback:i.validationCallback,hoverTooltipCallback:i.tooltipCallback,hoverLeaveCallback:i.leaveCallback,willLinkActivate:i.willLinkActivate,priority:i.priority||0};return this._addLinkMatcherToList(r),r.id},e.prototype._addLinkMatcherToList=function(e){if(0!==this._linkMatchers.length){for(var t=this._linkMatchers.length-1;t>=0;t--)if(e.priority<=this._linkMatchers[t].priority)return void this._linkMatchers.splice(t+1,0,e);this._linkMatchers.splice(0,0,e)}else this._linkMatchers.push(e)},e.prototype.deregisterLinkMatcher=function(e){for(var t=0;t<this._linkMatchers.length;t++)if(this._linkMatchers[t].id===e)return this._linkMatchers.splice(t,1),!0;return!1},e.prototype._doLinkifyRow=function(e,t,i){for(var r,n=this,o=new RegExp(i.regex.source,(i.regex.flags||"")+"g"),s=-1,a=function(){var a=r["number"!=typeof i.matchIndex?0:i.matchIndex];if(!a)return l._logService.debug("match found without corresponding matchIndex",r,i),"break";if(s=t.indexOf(a,s+1),o.lastIndex=s+a.length,s<0)return"break";var c=l._bufferService.buffer.stringIndexToBufferIndex(e,s);if(c[0]<0)return"break";var d=l._bufferService.buffer.lines.get(c[0]);if(!d)return"break";var h=d.getFg(c[1]),p=h?h>>9&511:void 0;i.validationCallback?i.validationCallback(a,(function(e){n._rowsTimeoutId||e&&n._addLink(c[1],c[0]-n._bufferService.buffer.ydisp,a,i,p)})):l._addLink(c[1],c[0]-l._bufferService.buffer.ydisp,a,i,p)},l=this;null!==(r=o.exec(t))&&"break"!==a(););},e.prototype._addLink=function(e,t,i,r,n){var o=this;if(this._mouseZoneManager&&this._element){var s=this._unicodeService.getStringCellWidth(i),a=e%this._bufferService.cols,c=t+Math.floor(e/this._bufferService.cols),d=(a+s)%this._bufferService.cols,h=c+Math.floor((a+s)/this._bufferService.cols);0===d&&(d=this._bufferService.cols,h--),this._mouseZoneManager.add(new l(a+1,c+1,d+1,h+1,(function(e){if(r.handler)return r.handler(e,i);var t=window.open();t?(t.opener=null,t.location.href=i):console.warn("Opening link blocked as opener could not be cleared")}),(function(){o._onShowLinkUnderline.fire(o._createLinkHoverEvent(a,c,d,h,n)),o._element.classList.add("xterm-cursor-pointer")}),(function(e){o._onLinkTooltip.fire(o._createLinkHoverEvent(a,c,d,h,n)),r.hoverTooltipCallback&&r.hoverTooltipCallback(e,i,{start:{x:a,y:c},end:{x:d,y:h}})}),(function(){o._onHideLinkUnderline.fire(o._createLinkHoverEvent(a,c,d,h,n)),o._element.classList.remove("xterm-cursor-pointer"),r.hoverLeaveCallback&&r.hoverLeaveCallback()}),(function(e){return!r.willLinkActivate||r.willLinkActivate(e,i)})))}},e.prototype._createLinkHoverEvent=function(e,t,i,r,n){return{x1:e,y1:t,x2:i,y2:r,cols:this._bufferService.cols,fg:n}},e._timeBeforeLatency=200,e=r([n(0,s.IBufferService),n(1,s.ILogService),n(2,s.IUnicodeService)],e)}();t.Linkifier=a;var l=function(e,t,i,r,n,o,s,a,l){this.x1=e,this.y1=t,this.x2=i,this.y2=r,this.clickCallback=n,this.hoverCallback=o,this.tooltipCallback=s,this.leaveCallback=a,this.willLinkActivate=l};t.MouseZone=l},6465:function(e,t,i){var r,n=this&&this.__extends||(r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])},r(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function i(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),o=this&&this.__decorate||function(e,t,i,r){var n,o=arguments.length,s=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,r);else for(var a=e.length-1;a>=0;a--)(n=e[a])&&(s=(o<3?n(s):o>3?n(t,i,s):n(t,i))||s);return o>3&&s&&Object.defineProperty(t,i,s),s},s=this&&this.__param||function(e,t){return function(i,r){t(i,r,e)}},a=this&&this.__values||function(e){var t="function"==typeof Symbol&&Symbol.iterator,i=t&&e[t],r=0;if(i)return i.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},l=this&&this.__read||function(e,t){var i="function"==typeof Symbol&&e[Symbol.iterator];if(!i)return e;var r,n,o=i.call(e),s=[];try{for(;(void 0===t||t-- >0)&&!(r=o.next()).done;)s.push(r.value)}catch(e){n={error:e}}finally{try{r&&!r.done&&(i=o.return)&&i.call(o)}finally{if(n)throw n.error}}return s};Object.defineProperty(t,"__esModule",{value:!0}),t.Linkifier2=void 0;var c=i(2585),d=i(8460),h=i(844),p=i(3656),u=function(e){function t(t){var i=e.call(this)||this;return i._bufferService=t,i._linkProviders=[],i._linkCacheDisposables=[],i._isMouseOut=!0,i._activeLine=-1,i._onShowLinkUnderline=i.register(new d.EventEmitter),i._onHideLinkUnderline=i.register(new d.EventEmitter),i.register((0,h.getDisposeArrayDisposable)(i._linkCacheDisposables)),i}return n(t,e),Object.defineProperty(t.prototype,"currentLink",{get:function(){return this._currentLink},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"onShowLinkUnderline",{get:function(){return this._onShowLinkUnderline.event},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"onHideLinkUnderline",{get:function(){return this._onHideLinkUnderline.event},enumerable:!1,configurable:!0}),t.prototype.registerLinkProvider=function(e){var t=this;return this._linkProviders.push(e),{dispose:function(){var i=t._linkProviders.indexOf(e);-1!==i&&t._linkProviders.splice(i,1)}}},t.prototype.attachToDom=function(e,t,i){var r=this;this._element=e,this._mouseService=t,this._renderService=i,this.register((0,p.addDisposableDomListener)(this._element,"mouseleave",(function(){r._isMouseOut=!0,r._clearCurrentLink()}))),this.register((0,p.addDisposableDomListener)(this._element,"mousemove",this._onMouseMove.bind(this))),this.register((0,p.addDisposableDomListener)(this._element,"mousedown",this._handleMouseDown.bind(this))),this.register((0,p.addDisposableDomListener)(this._element,"mouseup",this._handleMouseUp.bind(this)))},t.prototype._onMouseMove=function(e){if(this._lastMouseEvent=e,this._element&&this._mouseService){var t=this._positionFromMouseEvent(e,this._element,this._mouseService);if(t){this._isMouseOut=!1;for(var i=e.composedPath(),r=0;r<i.length;r++){var n=i[r];if(n.classList.contains("xterm"))break;if(n.classList.contains("xterm-hover"))return}this._lastBufferCell&&t.x===this._lastBufferCell.x&&t.y===this._lastBufferCell.y||(this._onHover(t),this._lastBufferCell=t)}}},t.prototype._onHover=function(e){if(this._activeLine!==e.y)return this._clearCurrentLink(),void this._askForLink(e,!1);this._currentLink&&this._linkAtPosition(this._currentLink.link,e)||(this._clearCurrentLink(),this._askForLink(e,!0))},t.prototype._askForLink=function(e,t){var i,r,n,o,s=this;this._activeProviderReplies&&t||(null===(n=this._activeProviderReplies)||void 0===n||n.forEach((function(e){null==e||e.forEach((function(e){e.link.dispose&&e.link.dispose()}))})),this._activeProviderReplies=new Map,this._activeLine=e.y);var c=!1,d=function(i,r){t?(null===(o=h._activeProviderReplies)||void 0===o?void 0:o.get(i))&&(c=h._checkLinkProviderResult(i,e,c)):r.provideLinks(e.y,(function(t){var r,n;if(!s._isMouseOut){var o=null==t?void 0:t.map((function(e){return{link:e}}));null===(r=s._activeProviderReplies)||void 0===r||r.set(i,o),c=s._checkLinkProviderResult(i,e,c),(null===(n=s._activeProviderReplies)||void 0===n?void 0:n.size)===s._linkProviders.length&&s._removeIntersectingLinks(e.y,s._activeProviderReplies)}}))},h=this;try{for(var p=a(this._linkProviders.entries()),u=p.next();!u.done;u=p.next()){var f=l(u.value,2);d(f[0],f[1])}}catch(e){i={error:e}}finally{try{u&&!u.done&&(r=p.return)&&r.call(p)}finally{if(i)throw i.error}}},t.prototype._removeIntersectingLinks=function(e,t){for(var i=new Set,r=0;r<t.size;r++){var n=t.get(r);if(n)for(var o=0;o<n.length;o++)for(var s=n[o],a=s.link.range.start.y<e?0:s.link.range.start.x,l=s.link.range.end.y>e?this._bufferService.cols:s.link.range.end.x,c=a;c<=l;c++){if(i.has(c)){n.splice(o--,1);break}i.add(c)}}},t.prototype._checkLinkProviderResult=function(e,t,i){var r,n=this;if(!this._activeProviderReplies)return i;for(var o=this._activeProviderReplies.get(e),s=!1,a=0;a<e;a++)this._activeProviderReplies.has(a)&&!this._activeProviderReplies.get(a)||(s=!0);if(!s&&o){var l=o.find((function(e){return n._linkAtPosition(e.link,t)}));l&&(i=!0,this._handleNewLink(l))}if(this._activeProviderReplies.size===this._linkProviders.length&&!i)for(a=0;a<this._activeProviderReplies.size;a++){var c=null===(r=this._activeProviderReplies.get(a))||void 0===r?void 0:r.find((function(e){return n._linkAtPosition(e.link,t)}));if(c){i=!0,this._handleNewLink(c);break}}return i},t.prototype._handleMouseDown=function(){this._mouseDownLink=this._currentLink},t.prototype._handleMouseUp=function(e){if(this._element&&this._mouseService&&this._currentLink){var t=this._positionFromMouseEvent(e,this._element,this._mouseService);t&&this._mouseDownLink===this._currentLink&&this._linkAtPosition(this._currentLink.link,t)&&this._currentLink.link.activate(e,this._currentLink.link.text)}},t.prototype._clearCurrentLink=function(e,t){this._element&&this._currentLink&&this._lastMouseEvent&&(!e||!t||this._currentLink.link.range.start.y>=e&&this._currentLink.link.range.end.y<=t)&&(this._linkLeave(this._element,this._currentLink.link,this._lastMouseEvent),this._currentLink=void 0,(0,h.disposeArray)(this._linkCacheDisposables))},t.prototype._handleNewLink=function(e){var t=this;if(this._element&&this._lastMouseEvent&&this._mouseService){var i=this._positionFromMouseEvent(this._lastMouseEvent,this._element,this._mouseService);i&&this._linkAtPosition(e.link,i)&&(this._currentLink=e,this._currentLink.state={decorations:{underline:void 0===e.link.decorations||e.link.decorations.underline,pointerCursor:void 0===e.link.decorations||e.link.decorations.pointerCursor},isHovered:!0},this._linkHover(this._element,e.link,this._lastMouseEvent),e.link.decorations={},Object.defineProperties(e.link.decorations,{pointerCursor:{get:function(){var e,i;return null===(i=null===(e=t._currentLink)||void 0===e?void 0:e.state)||void 0===i?void 0:i.decorations.pointerCursor},set:function(e){var i,r;(null===(i=t._currentLink)||void 0===i?void 0:i.state)&&t._currentLink.state.decorations.pointerCursor!==e&&(t._currentLink.state.decorations.pointerCursor=e,t._currentLink.state.isHovered&&(null===(r=t._element)||void 0===r||r.classList.toggle("xterm-cursor-pointer",e)))}},underline:{get:function(){var e,i;return null===(i=null===(e=t._currentLink)||void 0===e?void 0:e.state)||void 0===i?void 0:i.decorations.underline},set:function(i){var r,n,o;(null===(r=t._currentLink)||void 0===r?void 0:r.state)&&(null===(o=null===(n=t._currentLink)||void 0===n?void 0:n.state)||void 0===o?void 0:o.decorations.underline)!==i&&(t._currentLink.state.decorations.underline=i,t._currentLink.state.isHovered&&t._fireUnderlineEvent(e.link,i))}}}),this._renderService&&this._linkCacheDisposables.push(this._renderService.onRenderedViewportChange((function(e){var i=0===e.start?0:e.start+1+t._bufferService.buffer.ydisp;t._clearCurrentLink(i,e.end+1+t._bufferService.buffer.ydisp)}))))}},t.prototype._linkHover=function(e,t,i){var r;(null===(r=this._currentLink)||void 0===r?void 0:r.state)&&(this._currentLink.state.isHovered=!0,this._currentLink.state.decorations.underline&&this._fireUnderlineEvent(t,!0),this._currentLink.state.decorations.pointerCursor&&e.classList.add("xterm-cursor-pointer")),t.hover&&t.hover(i,t.text)},t.prototype._fireUnderlineEvent=function(e,t){var i=e.range,r=this._bufferService.buffer.ydisp,n=this._createLinkUnderlineEvent(i.start.x-1,i.start.y-r-1,i.end.x,i.end.y-r-1,void 0);(t?this._onShowLinkUnderline:this._onHideLinkUnderline).fire(n)},t.prototype._linkLeave=function(e,t,i){var r;(null===(r=this._currentLink)||void 0===r?void 0:r.state)&&(this._currentLink.state.isHovered=!1,this._currentLink.state.decorations.underline&&this._fireUnderlineEvent(t,!1),this._currentLink.state.decorations.pointerCursor&&e.classList.remove("xterm-cursor-pointer")),t.leave&&t.leave(i,t.text)},t.prototype._linkAtPosition=function(e,t){var i=e.range.start.y===e.range.end.y,r=e.range.start.y<t.y,n=e.range.end.y>t.y;return(i&&e.range.start.x<=t.x&&e.range.end.x>=t.x||r&&e.range.end.x>=t.x||n&&e.range.start.x<=t.x||r&&n)&&e.range.start.y<=t.y&&e.range.end.y>=t.y},t.prototype._positionFromMouseEvent=function(e,t,i){var r=i.getCoords(e,t,this._bufferService.cols,this._bufferService.rows);if(r)return{x:r[0],y:r[1]+this._bufferService.buffer.ydisp}},t.prototype._createLinkUnderlineEvent=function(e,t,i,r,n){return{x1:e,y1:t,x2:i,y2:r,cols:this._bufferService.cols,fg:n}},o([s(0,c.IBufferService)],t)}(h.Disposable);t.Linkifier2=u},9042:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.tooMuchOutput=t.promptLabel=void 0,t.promptLabel="Terminal input",t.tooMuchOutput="Too much output to announce, navigate to rows manually to read"},6954:function(e,t,i){var r,n=this&&this.__extends||(r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])},r(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function i(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),o=this&&this.__decorate||function(e,t,i,r){var n,o=arguments.length,s=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,r);else for(var a=e.length-1;a>=0;a--)(n=e[a])&&(s=(o<3?n(s):o>3?n(t,i,s):n(t,i))||s);return o>3&&s&&Object.defineProperty(t,i,s),s},s=this&&this.__param||function(e,t){return function(i,r){t(i,r,e)}};Object.defineProperty(t,"__esModule",{value:!0}),t.MouseZoneManager=void 0;var a=i(844),l=i(3656),c=i(4725),d=i(2585),h=function(e){function t(t,i,r,n,o,s){var a=e.call(this)||this;return a._element=t,a._screenElement=i,a._bufferService=r,a._mouseService=n,a._selectionService=o,a._optionsService=s,a._zones=[],a._areZonesActive=!1,a._lastHoverCoords=[void 0,void 0],a._initialSelectionLength=0,a.register((0,l.addDisposableDomListener)(a._element,"mousedown",(function(e){return a._onMouseDown(e)}))),a._mouseMoveListener=function(e){return a._onMouseMove(e)},a._mouseLeaveListener=function(e){return a._onMouseLeave(e)},a._clickListener=function(e){return a._onClick(e)},a}return n(t,e),t.prototype.dispose=function(){e.prototype.dispose.call(this),this._deactivate()},t.prototype.add=function(e){this._zones.push(e),1===this._zones.length&&this._activate()},t.prototype.clearAll=function(e,t){if(0!==this._zones.length){e&&t||(e=0,t=this._bufferService.rows-1);for(var i=0;i<this._zones.length;i++){var r=this._zones[i];(r.y1>e&&r.y1<=t+1||r.y2>e&&r.y2<=t+1||r.y1<e&&r.y2>t+1)&&(this._currentZone&&this._currentZone===r&&(this._currentZone.leaveCallback(),this._currentZone=void 0),this._zones.splice(i--,1))}0===this._zones.length&&this._deactivate()}},t.prototype._activate=function(){this._areZonesActive||(this._areZonesActive=!0,this._element.addEventListener("mousemove",this._mouseMoveListener),this._element.addEventListener("mouseleave",this._mouseLeaveListener),this._element.addEventListener("click",this._clickListener))},t.prototype._deactivate=function(){this._areZonesActive&&(this._areZonesActive=!1,this._element.removeEventListener("mousemove",this._mouseMoveListener),this._element.removeEventListener("mouseleave",this._mouseLeaveListener),this._element.removeEventListener("click",this._clickListener))},t.prototype._onMouseMove=function(e){this._lastHoverCoords[0]===e.pageX&&this._lastHoverCoords[1]===e.pageY||(this._onHover(e),this._lastHoverCoords=[e.pageX,e.pageY])},t.prototype._onHover=function(e){var t=this,i=this._findZoneEventAt(e);i!==this._currentZone&&(this._currentZone&&(this._currentZone.leaveCallback(),this._currentZone=void 0,this._tooltipTimeout&&clearTimeout(this._tooltipTimeout)),i&&(this._currentZone=i,i.hoverCallback&&i.hoverCallback(e),this._tooltipTimeout=window.setTimeout((function(){return t._onTooltip(e)}),this._optionsService.rawOptions.linkTooltipHoverDuration)))},t.prototype._onTooltip=function(e){this._tooltipTimeout=void 0;var t=this._findZoneEventAt(e);null==t||t.tooltipCallback(e)},t.prototype._onMouseDown=function(e){if(this._initialSelectionLength=this._getSelectionLength(),this._areZonesActive){var t=this._findZoneEventAt(e);(null==t?void 0:t.willLinkActivate(e))&&(e.preventDefault(),e.stopImmediatePropagation())}},t.prototype._onMouseLeave=function(e){this._currentZone&&(this._currentZone.leaveCallback(),this._currentZone=void 0,this._tooltipTimeout&&clearTimeout(this._tooltipTimeout))},t.prototype._onClick=function(e){var t=this._findZoneEventAt(e),i=this._getSelectionLength();t&&i===this._initialSelectionLength&&(t.clickCallback(e),e.preventDefault(),e.stopImmediatePropagation())},t.prototype._getSelectionLength=function(){var e=this._selectionService.selectionText;return e?e.length:0},t.prototype._findZoneEventAt=function(e){var t=this._mouseService.getCoords(e,this._screenElement,this._bufferService.cols,this._bufferService.rows);if(t)for(var i=t[0],r=t[1],n=0;n<this._zones.length;n++){var o=this._zones[n];if(o.y1===o.y2){if(r===o.y1&&i>=o.x1&&i<o.x2)return o}else if(r===o.y1&&i>=o.x1||r===o.y2&&i<o.x2||r>o.y1&&r<o.y2)return o}},o([s(2,d.IBufferService),s(3,c.IMouseService),s(4,c.ISelectionService),s(5,d.IOptionsService)],t)}(a.Disposable);t.MouseZoneManager=h},6193:function(e,t){var i=this&&this.__values||function(e){var t="function"==typeof Symbol&&Symbol.iterator,i=t&&e[t],r=0;if(i)return i.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(t,"__esModule",{value:!0}),t.RenderDebouncer=void 0;var r=function(){function e(e){this._renderCallback=e,this._refreshCallbacks=[]}return e.prototype.dispose=function(){this._animationFrame&&(window.cancelAnimationFrame(this._animationFrame),this._animationFrame=void 0)},e.prototype.addRefreshCallback=function(e){var t=this;return this._refreshCallbacks.push(e),this._animationFrame||(this._animationFrame=window.requestAnimationFrame((function(){return t._innerRefresh()}))),this._animationFrame},e.prototype.refresh=function(e,t,i){var r=this;this._rowCount=i,e=void 0!==e?e:0,t=void 0!==t?t:this._rowCount-1,this._rowStart=void 0!==this._rowStart?Math.min(this._rowStart,e):e,this._rowEnd=void 0!==this._rowEnd?Math.max(this._rowEnd,t):t,this._animationFrame||(this._animationFrame=window.requestAnimationFrame((function(){return r._innerRefresh()})))},e.prototype._innerRefresh=function(){if(this._animationFrame=void 0,void 0!==this._rowStart&&void 0!==this._rowEnd&&void 0!==this._rowCount){var e=Math.max(this._rowStart,0),t=Math.min(this._rowEnd,this._rowCount-1);this._rowStart=void 0,this._rowEnd=void 0,this._renderCallback(e,t),this._runRefreshCallbacks()}else this._runRefreshCallbacks()},e.prototype._runRefreshCallbacks=function(){var e,t;try{for(var r=i(this._refreshCallbacks),n=r.next();!n.done;n=r.next())(0,n.value)(0)}catch(t){e={error:t}}finally{try{n&&!n.done&&(t=r.return)&&t.call(r)}finally{if(e)throw e.error}}this._refreshCallbacks=[]},e}();t.RenderDebouncer=r},5596:function(e,t,i){var r,n=this&&this.__extends||(r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])},r(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function i(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)});Object.defineProperty(t,"__esModule",{value:!0}),t.ScreenDprMonitor=void 0;var o=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._currentDevicePixelRatio=window.devicePixelRatio,t}return n(t,e),t.prototype.setListener=function(e){var t=this;this._listener&&this.clearListener(),this._listener=e,this._outerListener=function(){t._listener&&(t._listener(window.devicePixelRatio,t._currentDevicePixelRatio),t._updateDpr())},this._updateDpr()},t.prototype.dispose=function(){e.prototype.dispose.call(this),this.clearListener()},t.prototype._updateDpr=function(){var e;this._outerListener&&(null===(e=this._resolutionMediaMatchList)||void 0===e||e.removeListener(this._outerListener),this._currentDevicePixelRatio=window.devicePixelRatio,this._resolutionMediaMatchList=window.matchMedia("screen and (resolution: "+window.devicePixelRatio+"dppx)"),this._resolutionMediaMatchList.addListener(this._outerListener))},t.prototype.clearListener=function(){this._resolutionMediaMatchList&&this._listener&&this._outerListener&&(this._resolutionMediaMatchList.removeListener(this._outerListener),this._resolutionMediaMatchList=void 0,this._listener=void 0,this._outerListener=void 0)},t}(i(844).Disposable);t.ScreenDprMonitor=o},3236:function(e,t,i){var r,n=this&&this.__extends||(r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])},r(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function i(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),o=this&&this.__values||function(e){var t="function"==typeof Symbol&&Symbol.iterator,i=t&&e[t],r=0;if(i)return i.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},s=this&&this.__read||function(e,t){var i="function"==typeof Symbol&&e[Symbol.iterator];if(!i)return e;var r,n,o=i.call(e),s=[];try{for(;(void 0===t||t-- >0)&&!(r=o.next()).done;)s.push(r.value)}catch(e){n={error:e}}finally{try{r&&!r.done&&(i=o.return)&&i.call(o)}finally{if(n)throw n.error}}return s},a=this&&this.__spreadArray||function(e,t,i){if(i||2===arguments.length)for(var r,n=0,o=t.length;n<o;n++)!r&&n in t||(r||(r=Array.prototype.slice.call(t,0,n)),r[n]=t[n]);return e.concat(r||Array.prototype.slice.call(t))};Object.defineProperty(t,"__esModule",{value:!0}),t.Terminal=void 0;var l=i(2950),c=i(1680),d=i(3614),h=i(2584),p=i(5435),u=i(3525),f=i(3551),_=i(9312),g=i(6114),m=i(3656),b=i(9042),y=i(357),v=i(6954),w=i(4567),x=i(1296),C=i(7399),S=i(8460),E=i(8437),k=i(5680),L=i(3230),A=i(4725),O=i(428),M=i(8934),P=i(6465),R=i(5114),D=i(8969),T=i(8055),I=i(4269),B=i(5941),F=i(3107),W=i(5744),H=i(9074),U=i(2585),j="undefined"!=typeof window?window.document:null,z=function(e){function t(t){void 0===t&&(t={});var i=e.call(this,t)||this;return i.browser=g,i._keyDownHandled=!1,i._keyDownSeen=!1,i._keyPressHandled=!1,i._unprocessedDeadKey=!1,i._onCursorMove=new S.EventEmitter,i._onKey=new S.EventEmitter,i._onRender=new S.EventEmitter,i._onSelectionChange=new S.EventEmitter,i._onTitleChange=new S.EventEmitter,i._onBell=new S.EventEmitter,i._onFocus=new S.EventEmitter,i._onBlur=new S.EventEmitter,i._onA11yCharEmitter=new S.EventEmitter,i._onA11yTabEmitter=new S.EventEmitter,i._setup(),i.linkifier=i._instantiationService.createInstance(f.Linkifier),i.linkifier2=i.register(i._instantiationService.createInstance(P.Linkifier2)),i._decorationService=i._instantiationService.createInstance(H.DecorationService),i._instantiationService.setService(U.IDecorationService,i._decorationService),i.register(i._inputHandler.onRequestBell((function(){return i.bell()}))),i.register(i._inputHandler.onRequestRefreshRows((function(e,t){return i.refresh(e,t)}))),i.register(i._inputHandler.onRequestSendFocus((function(){return i._reportFocus()}))),i.register(i._inputHandler.onRequestReset((function(){return i.reset()}))),i.register(i._inputHandler.onRequestWindowsOptionsReport((function(e){return i._reportWindowsOptions(e)}))),i.register(i._inputHandler.onColor((function(e){return i._handleColorEvent(e)}))),i.register((0,S.forwardEvent)(i._inputHandler.onCursorMove,i._onCursorMove)),i.register((0,S.forwardEvent)(i._inputHandler.onTitleChange,i._onTitleChange)),i.register((0,S.forwardEvent)(i._inputHandler.onA11yChar,i._onA11yCharEmitter)),i.register((0,S.forwardEvent)(i._inputHandler.onA11yTab,i._onA11yTabEmitter)),i.register(i._bufferService.onResize((function(e){return i._afterResize(e.cols,e.rows)}))),i}return n(t,e),Object.defineProperty(t.prototype,"onCursorMove",{get:function(){return this._onCursorMove.event},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"onKey",{get:function(){return this._onKey.event},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"onRender",{get:function(){return this._onRender.event},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"onSelectionChange",{get:function(){return this._onSelectionChange.event},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"onTitleChange",{get:function(){return this._onTitleChange.event},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"onBell",{get:function(){return this._onBell.event},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"onFocus",{get:function(){return this._onFocus.event},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"onBlur",{get:function(){return this._onBlur.event},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"onA11yChar",{get:function(){return this._onA11yCharEmitter.event},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"onA11yTab",{get:function(){return this._onA11yTabEmitter.event},enumerable:!1,configurable:!0}),t.prototype._handleColorEvent=function(e){var t,i,r,n;if(this._colorManager){try{for(var l=o(e),c=l.next();!c.done;c=l.next()){var d=c.value,p=void 0,u="";switch(d.index){case 256:p="foreground",u="10";break;case 257:p="background",u="11";break;case 258:p="cursor",u="12";break;default:p="ansi",u="4;"+d.index}if(p)switch(d.type){case 0:var f=T.color.toColorRGB("ansi"===p?this._colorManager.colors.ansi[d.index]:this._colorManager.colors[p]);this.coreService.triggerDataEvent(h.C0.ESC+"]"+u+";"+(0,B.toRgbString)(f)+h.C1_ESCAPED.ST);break;case 1:"ansi"===p?this._colorManager.colors.ansi[d.index]=T.rgba.toColor.apply(T.rgba,a([],s(d.color),!1)):this._colorManager.colors[p]=T.rgba.toColor.apply(T.rgba,a([],s(d.color),!1));break;case 2:this._colorManager.restoreColor(d.index)}}}catch(e){t={error:e}}finally{try{c&&!c.done&&(i=l.return)&&i.call(l)}finally{if(t)throw t.error}}null===(r=this._renderService)||void 0===r||r.setColors(this._colorManager.colors),null===(n=this.viewport)||void 0===n||n.onThemeChange(this._colorManager.colors)}},t.prototype.dispose=function(){var t,i,r;this._isDisposed||(e.prototype.dispose.call(this),null===(t=this._renderService)||void 0===t||t.dispose(),this._customKeyEventHandler=void 0,this.write=function(){},null===(r=null===(i=this.element)||void 0===i?void 0:i.parentNode)||void 0===r||r.removeChild(this.element))},t.prototype._setup=function(){e.prototype._setup.call(this),this._customKeyEventHandler=void 0},Object.defineProperty(t.prototype,"buffer",{get:function(){return this.buffers.active},enumerable:!1,configurable:!0}),t.prototype.focus=function(){this.textarea&&this.textarea.focus({preventScroll:!0})},t.prototype._updateOptions=function(t){var i,r,n,o;switch(e.prototype._updateOptions.call(this,t),t){case"fontFamily":case"fontSize":null===(i=this._renderService)||void 0===i||i.clear(),null===(r=this._charSizeService)||void 0===r||r.measure();break;case"cursorBlink":case"cursorStyle":this.refresh(this.buffer.y,this.buffer.y);break;case"customGlyphs":case"drawBoldTextInBrightColors":case"letterSpacing":case"lineHeight":case"fontWeight":case"fontWeightBold":case"minimumContrastRatio":this._renderService&&(this._renderService.clear(),this._renderService.onResize(this.cols,this.rows),this.refresh(0,this.rows-1));break;case"rendererType":this._renderService&&(this._renderService.setRenderer(this._createRenderer()),this._renderService.onResize(this.cols,this.rows));break;case"scrollback":null===(n=this.viewport)||void 0===n||n.syncScrollArea();break;case"screenReaderMode":this.optionsService.rawOptions.screenReaderMode?!this._accessibilityManager&&this._renderService&&(this._accessibilityManager=new w.AccessibilityManager(this,this._renderService)):(null===(o=this._accessibilityManager)||void 0===o||o.dispose(),this._accessibilityManager=void 0);break;case"tabStopWidth":this.buffers.setupTabStops();break;case"theme":this._setTheme(this.optionsService.rawOptions.theme)}},t.prototype._onTextAreaFocus=function(e){this.coreService.decPrivateModes.sendFocus&&this.coreService.triggerDataEvent(h.C0.ESC+"[I"),this.updateCursorStyle(e),this.element.classList.add("focus"),this._showCursor(),this._onFocus.fire()},t.prototype.blur=function(){var e;return null===(e=this.textarea)||void 0===e?void 0:e.blur()},t.prototype._onTextAreaBlur=function(){this.textarea.value="",this.refresh(this.buffer.y,this.buffer.y),this.coreService.decPrivateModes.sendFocus&&this.coreService.triggerDataEvent(h.C0.ESC+"[O"),this.element.classList.remove("focus"),this._onBlur.fire()},t.prototype._syncTextArea=function(){if(this.textarea&&this.buffer.isCursorInViewport&&!this._compositionHelper.isComposing&&this._renderService){var e=this.buffer.ybase+this.buffer.y,t=this.buffer.lines.get(e);if(t){var i=Math.min(this.buffer.x,this.cols-1),r=this._renderService.dimensions.actualCellHeight,n=t.getWidth(i),o=this._renderService.dimensions.actualCellWidth*n,s=this.buffer.y*this._renderService.dimensions.actualCellHeight,a=i*this._renderService.dimensions.actualCellWidth;this.textarea.style.left=a+"px",this.textarea.style.top=s+"px",this.textarea.style.width=o+"px",this.textarea.style.height=r+"px",this.textarea.style.lineHeight=r+"px",this.textarea.style.zIndex="-5"}}},t.prototype._initGlobal=function(){var e=this;this._bindKeys(),this.register((0,m.addDisposableDomListener)(this.element,"copy",(function(t){e.hasSelection()&&(0,d.copyHandler)(t,e._selectionService)})));var t=function(t){return(0,d.handlePasteEvent)(t,e.textarea,e.coreService)};this.register((0,m.addDisposableDomListener)(this.textarea,"paste",t)),this.register((0,m.addDisposableDomListener)(this.element,"paste",t)),g.isFirefox?this.register((0,m.addDisposableDomListener)(this.element,"mousedown",(function(t){2===t.button&&(0,d.rightClickHandler)(t,e.textarea,e.screenElement,e._selectionService,e.options.rightClickSelectsWord)}))):this.register((0,m.addDisposableDomListener)(this.element,"contextmenu",(function(t){(0,d.rightClickHandler)(t,e.textarea,e.screenElement,e._selectionService,e.options.rightClickSelectsWord)}))),g.isLinux&&this.register((0,m.addDisposableDomListener)(this.element,"auxclick",(function(t){1===t.button&&(0,d.moveTextAreaUnderMouseCursor)(t,e.textarea,e.screenElement)})))},t.prototype._bindKeys=function(){var e=this;this.register((0,m.addDisposableDomListener)(this.textarea,"keyup",(function(t){return e._keyUp(t)}),!0)),this.register((0,m.addDisposableDomListener)(this.textarea,"keydown",(function(t){return e._keyDown(t)}),!0)),this.register((0,m.addDisposableDomListener)(this.textarea,"keypress",(function(t){return e._keyPress(t)}),!0)),this.register((0,m.addDisposableDomListener)(this.textarea,"compositionstart",(function(){return e._compositionHelper.compositionstart()}))),this.register((0,m.addDisposableDomListener)(this.textarea,"compositionupdate",(function(t){return e._compositionHelper.compositionupdate(t)}))),this.register((0,m.addDisposableDomListener)(this.textarea,"compositionend",(function(){return e._compositionHelper.compositionend()}))),this.register((0,m.addDisposableDomListener)(this.textarea,"input",(function(t){return e._inputEvent(t)}),!0)),this.register(this.onRender((function(){return e._compositionHelper.updateCompositionElements()}))),this.register(this.onRender((function(t){return e._queueLinkification(t.start,t.end)})))},t.prototype.open=function(e){var t=this;if(!e)throw new Error("Terminal requires a parent element.");e.isConnected||this._logService.debug("Terminal.open was called on an element that was not attached to the DOM"),this._document=e.ownerDocument,this.element=this._document.createElement("div"),this.element.dir="ltr",this.element.classList.add("terminal"),this.element.classList.add("xterm"),this.element.setAttribute("tabindex","0"),e.appendChild(this.element);var i=j.createDocumentFragment();this._viewportElement=j.createElement("div"),this._viewportElement.classList.add("xterm-viewport"),i.appendChild(this._viewportElement),this._viewportScrollArea=j.createElement("div"),this._viewportScrollArea.classList.add("xterm-scroll-area"),this._viewportElement.appendChild(this._viewportScrollArea),this.screenElement=j.createElement("div"),this.screenElement.classList.add("xterm-screen"),this._helperContainer=j.createElement("div"),this._helperContainer.classList.add("xterm-helpers"),this.screenElement.appendChild(this._helperContainer),i.appendChild(this.screenElement),this.textarea=j.createElement("textarea"),this.textarea.classList.add("xterm-helper-textarea"),this.textarea.setAttribute("aria-label",b.promptLabel),this.textarea.setAttribute("aria-multiline","false"),this.textarea.setAttribute("autocorrect","off"),this.textarea.setAttribute("autocapitalize","off"),this.textarea.setAttribute("spellcheck","false"),this.textarea.tabIndex=0,this.register((0,m.addDisposableDomListener)(this.textarea,"focus",(function(e){return t._onTextAreaFocus(e)}))),this.register((0,m.addDisposableDomListener)(this.textarea,"blur",(function(){return t._onTextAreaBlur()}))),this._helperContainer.appendChild(this.textarea);var r=this._instantiationService.createInstance(R.CoreBrowserService,this.textarea);this._instantiationService.setService(A.ICoreBrowserService,r),this._charSizeService=this._instantiationService.createInstance(O.CharSizeService,this._document,this._helperContainer),this._instantiationService.setService(A.ICharSizeService,this._charSizeService),this._theme=this.options.theme||this._theme,this._colorManager=new k.ColorManager(j,this.options.allowTransparency),this.register(this.optionsService.onOptionChange((function(e){return t._colorManager.onOptionsChange(e)}))),this._colorManager.setTheme(this._theme),this._characterJoinerService=this._instantiationService.createInstance(I.CharacterJoinerService),this._instantiationService.setService(A.ICharacterJoinerService,this._characterJoinerService);var n=this._createRenderer();this._renderService=this.register(this._instantiationService.createInstance(L.RenderService,n,this.rows,this.screenElement)),this._instantiationService.setService(A.IRenderService,this._renderService),this.register(this._renderService.onRenderedViewportChange((function(e){return t._onRender.fire(e)}))),this.onResize((function(e){return t._renderService.resize(e.cols,e.rows)})),this._compositionView=j.createElement("div"),this._compositionView.classList.add("composition-view"),this._compositionHelper=this._instantiationService.createInstance(l.CompositionHelper,this.textarea,this._compositionView),this._helperContainer.appendChild(this._compositionView),this.element.appendChild(i),this._soundService=this._instantiationService.createInstance(y.SoundService),this._instantiationService.setService(A.ISoundService,this._soundService),this._mouseService=this._instantiationService.createInstance(M.MouseService),this._instantiationService.setService(A.IMouseService,this._mouseService),this.viewport=this._instantiationService.createInstance(c.Viewport,(function(e){return t.scrollLines(e,!0,1)}),this._viewportElement,this._viewportScrollArea,this.element),this.viewport.onThemeChange(this._colorManager.colors),this.register(this._inputHandler.onRequestSyncScrollBar((function(){return t.viewport.syncScrollArea()}))),this.register(this.viewport),this.register(this.onCursorMove((function(){t._renderService.onCursorMove(),t._syncTextArea()}))),this.register(this.onResize((function(){return t._renderService.onResize(t.cols,t.rows)}))),this.register(this.onBlur((function(){return t._renderService.onBlur()}))),this.register(this.onFocus((function(){return t._renderService.onFocus()}))),this.register(this._renderService.onDimensionsChange((function(){return t.viewport.syncScrollArea()}))),this._selectionService=this.register(this._instantiationService.createInstance(_.SelectionService,this.element,this.screenElement,this.linkifier2)),this._instantiationService.setService(A.ISelectionService,this._selectionService),this.register(this._selectionService.onRequestScrollLines((function(e){return t.scrollLines(e.amount,e.suppressScrollEvent)}))),this.register(this._selectionService.onSelectionChange((function(){return t._onSelectionChange.fire()}))),this.register(this._selectionService.onRequestRedraw((function(e){return t._renderService.onSelectionChanged(e.start,e.end,e.columnSelectMode)}))),this.register(this._selectionService.onLinuxMouseSelection((function(e){t.textarea.value=e,t.textarea.focus(),t.textarea.select()}))),this.register(this._onScroll.event((function(e){t.viewport.syncScrollArea(),t._selectionService.refresh()}))),this.register((0,m.addDisposableDomListener)(this._viewportElement,"scroll",(function(){return t._selectionService.refresh()}))),this._mouseZoneManager=this._instantiationService.createInstance(v.MouseZoneManager,this.element,this.screenElement),this.register(this._mouseZoneManager),this.register(this.onScroll((function(){return t._mouseZoneManager.clearAll()}))),this.linkifier.attachToDom(this.element,this._mouseZoneManager),this.linkifier2.attachToDom(this.screenElement,this._mouseService,this._renderService),this.register(this._instantiationService.createInstance(F.BufferDecorationRenderer,this.screenElement)),this.register((0,m.addDisposableDomListener)(this.element,"mousedown",(function(e){return t._selectionService.onMouseDown(e)}))),this.coreMouseService.areMouseEventsActive?(this._selectionService.disable(),this.element.classList.add("enable-mouse-events")):this._selectionService.enable(),this.options.screenReaderMode&&(this._accessibilityManager=new w.AccessibilityManager(this,this._renderService)),this.options.overviewRulerWidth&&(this._overviewRulerRenderer=this._instantiationService.createInstance(W.OverviewRulerRenderer,this._viewportElement,this.screenElement)),this.optionsService.onOptionChange((function(){!t._overviewRulerRenderer&&t.options.overviewRulerWidth&&t._viewportElement&&t.screenElement&&(t._overviewRulerRenderer=t._instantiationService.createInstance(W.OverviewRulerRenderer,t._viewportElement,t.screenElement))})),this._charSizeService.measure(),this.refresh(0,this.rows-1),this._initGlobal(),this.bindMouse()},t.prototype._createRenderer=function(){switch(this.options.rendererType){case"canvas":return this._instantiationService.createInstance(u.Renderer,this._colorManager.colors,this.screenElement,this.linkifier,this.linkifier2);case"dom":return this._instantiationService.createInstance(x.DomRenderer,this._colorManager.colors,this.element,this.screenElement,this._viewportElement,this.linkifier,this.linkifier2);default:throw new Error('Unrecognized rendererType "'+this.options.rendererType+'"')}},t.prototype._setTheme=function(e){var t,i,r;this._theme=e,null===(t=this._colorManager)||void 0===t||t.setTheme(e),null===(i=this._renderService)||void 0===i||i.setColors(this._colorManager.colors),null===(r=this.viewport)||void 0===r||r.onThemeChange(this._colorManager.colors)},t.prototype.bindMouse=function(){var e=this,t=this,i=this.element;function r(e){var i,r,n=t._mouseService.getRawByteCoords(e,t.screenElement,t.cols,t.rows);if(!n)return!1;switch(e.overrideType||e.type){case"mousemove":r=32,void 0===e.buttons?(i=3,void 0!==e.button&&(i=e.button<3?e.button:3)):i=1&e.buttons?0:4&e.buttons?1:2&e.buttons?2:3;break;case"mouseup":r=0,i=e.button<3?e.button:3;break;case"mousedown":r=1,i=e.button<3?e.button:3;break;case"wheel":if(0===t.viewport.getLinesScrolled(e))return!1;r=e.deltaY<0?0:1,i=4;break;default:return!1}return!(void 0===r||void 0===i||i>4)&&t.coreMouseService.triggerMouseEvent({col:n.x-33,row:n.y-33,button:i,action:r,ctrl:e.ctrlKey,alt:e.altKey,shift:e.shiftKey})}var n={mouseup:null,wheel:null,mousedrag:null,mousemove:null},o=function(t){return r(t),t.buttons||(e._document.removeEventListener("mouseup",n.mouseup),n.mousedrag&&e._document.removeEventListener("mousemove",n.mousedrag)),e.cancel(t)},s=function(t){return r(t),e.cancel(t,!0)},a=function(e){e.buttons&&r(e)},l=function(e){e.buttons||r(e)};this.register(this.coreMouseService.onProtocolChange((function(t){t?("debug"===e.optionsService.rawOptions.logLevel&&e._logService.debug("Binding to mouse events:",e.coreMouseService.explainEvents(t)),e.element.classList.add("enable-mouse-events"),e._selectionService.disable()):(e._logService.debug("Unbinding from mouse events."),e.element.classList.remove("enable-mouse-events"),e._selectionService.enable()),8&t?n.mousemove||(i.addEventListener("mousemove",l),n.mousemove=l):(i.removeEventListener("mousemove",n.mousemove),n.mousemove=null),16&t?n.wheel||(i.addEventListener("wheel",s,{passive:!1}),n.wheel=s):(i.removeEventListener("wheel",n.wheel),n.wheel=null),2&t?n.mouseup||(n.mouseup=o):(e._document.removeEventListener("mouseup",n.mouseup),n.mouseup=null),4&t?n.mousedrag||(n.mousedrag=a):(e._document.removeEventListener("mousemove",n.mousedrag),n.mousedrag=null)}))),this.coreMouseService.activeProtocol=this.coreMouseService.activeProtocol,this.register((0,m.addDisposableDomListener)(i,"mousedown",(function(t){if(t.preventDefault(),e.focus(),e.coreMouseService.areMouseEventsActive&&!e._selectionService.shouldForceSelection(t))return r(t),n.mouseup&&e._document.addEventListener("mouseup",n.mouseup),n.mousedrag&&e._document.addEventListener("mousemove",n.mousedrag),e.cancel(t)}))),this.register((0,m.addDisposableDomListener)(i,"wheel",(function(t){if(!n.wheel){if(!e.buffer.hasScrollback){var i=e.viewport.getLinesScrolled(t);if(0===i)return;for(var r=h.C0.ESC+(e.coreService.decPrivateModes.applicationCursorKeys?"O":"[")+(t.deltaY<0?"A":"B"),o="",s=0;s<Math.abs(i);s++)o+=r;return e.coreService.triggerDataEvent(o,!0),e.cancel(t,!0)}return e.viewport.onWheel(t)?e.cancel(t):void 0}}),{passive:!1})),this.register((0,m.addDisposableDomListener)(i,"touchstart",(function(t){if(!e.coreMouseService.areMouseEventsActive)return e.viewport.onTouchStart(t),e.cancel(t)}),{passive:!0})),this.register((0,m.addDisposableDomListener)(i,"touchmove",(function(t){if(!e.coreMouseService.areMouseEventsActive)return e.viewport.onTouchMove(t)?void 0:e.cancel(t)}),{passive:!1}))},t.prototype.refresh=function(e,t){var i;null===(i=this._renderService)||void 0===i||i.refreshRows(e,t)},t.prototype._queueLinkification=function(e,t){var i;null===(i=this.linkifier)||void 0===i||i.linkifyRows(e,t)},t.prototype.updateCursorStyle=function(e){var t;(null===(t=this._selectionService)||void 0===t?void 0:t.shouldColumnSelect(e))?this.element.classList.add("column-select"):this.element.classList.remove("column-select")},t.prototype._showCursor=function(){this.coreService.isCursorInitialized||(this.coreService.isCursorInitialized=!0,this.refresh(this.buffer.y,this.buffer.y))},t.prototype.scrollLines=function(t,i,r){void 0===r&&(r=0),e.prototype.scrollLines.call(this,t,i,r),this.refresh(0,this.rows-1)},t.prototype.paste=function(e){(0,d.paste)(e,this.textarea,this.coreService)},t.prototype.attachCustomKeyEventHandler=function(e){this._customKeyEventHandler=e},t.prototype.registerLinkMatcher=function(e,t,i){var r=this.linkifier.registerLinkMatcher(e,t,i);return this.refresh(0,this.rows-1),r},t.prototype.deregisterLinkMatcher=function(e){this.linkifier.deregisterLinkMatcher(e)&&this.refresh(0,this.rows-1)},t.prototype.registerLinkProvider=function(e){return this.linkifier2.registerLinkProvider(e)},t.prototype.registerCharacterJoiner=function(e){if(!this._characterJoinerService)throw new Error("Terminal must be opened first");var t=this._characterJoinerService.register(e);return this.refresh(0,this.rows-1),t},t.prototype.deregisterCharacterJoiner=function(e){if(!this._characterJoinerService)throw new Error("Terminal must be opened first");this._characterJoinerService.deregister(e)&&this.refresh(0,this.rows-1)},Object.defineProperty(t.prototype,"markers",{get:function(){return this.buffer.markers},enumerable:!1,configurable:!0}),t.prototype.addMarker=function(e){if(this.buffer===this.buffers.normal)return this.buffer.addMarker(this.buffer.ybase+this.buffer.y+e)},t.prototype.registerDecoration=function(e){return this._decorationService.registerDecoration(e)},t.prototype.hasSelection=function(){return!!this._selectionService&&this._selectionService.hasSelection},t.prototype.select=function(e,t,i){this._selectionService.setSelection(e,t,i)},t.prototype.getSelection=function(){return this._selectionService?this._selectionService.selectionText:""},t.prototype.getSelectionPosition=function(){if(this._selectionService&&this._selectionService.hasSelection)return{startColumn:this._selectionService.selectionStart[0],startRow:this._selectionService.selectionStart[1],endColumn:this._selectionService.selectionEnd[0],endRow:this._selectionService.selectionEnd[1]}},t.prototype.clearSelection=function(){var e;null===(e=this._selectionService)||void 0===e||e.clearSelection()},t.prototype.selectAll=function(){var e;null===(e=this._selectionService)||void 0===e||e.selectAll()},t.prototype.selectLines=function(e,t){var i;null===(i=this._selectionService)||void 0===i||i.selectLines(e,t)},t.prototype._keyDown=function(e){if(this._keyDownHandled=!1,this._keyDownSeen=!0,this._customKeyEventHandler&&!1===this._customKeyEventHandler(e))return!1;var t=this.browser.isMac&&this.options.macOptionIsMeta&&e.altKey;if(!t&&!this._compositionHelper.keydown(e))return this.buffer.ybase!==this.buffer.ydisp&&this._bufferService.scrollToBottom(),!1;t||"Dead"!==e.key&&"AltGraph"!==e.key||(this._unprocessedDeadKey=!0);var i=(0,C.evaluateKeyboardEvent)(e,this.coreService.decPrivateModes.applicationCursorKeys,this.browser.isMac,this.options.macOptionIsMeta);if(this.updateCursorStyle(e),3===i.type||2===i.type){var r=this.rows-1;return this.scrollLines(2===i.type?-r:r),this.cancel(e,!0)}return 1===i.type&&this.selectAll(),!!this._isThirdLevelShift(this.browser,e)||(i.cancel&&this.cancel(e,!0),!i.key||!!(e.key&&!e.ctrlKey&&!e.altKey&&!e.metaKey&&1===e.key.length&&e.key.charCodeAt(0)>=65&&e.key.charCodeAt(0)<=90)||(this._unprocessedDeadKey?(this._unprocessedDeadKey=!1,!0):(i.key!==h.C0.ETX&&i.key!==h.C0.CR||(this.textarea.value=""),this._onKey.fire({key:i.key,domEvent:e}),this._showCursor(),this.coreService.triggerDataEvent(i.key,!0),this.optionsService.rawOptions.screenReaderMode?void(this._keyDownHandled=!0):this.cancel(e,!0))))},t.prototype._isThirdLevelShift=function(e,t){var i=e.isMac&&!this.options.macOptionIsMeta&&t.altKey&&!t.ctrlKey&&!t.metaKey||e.isWindows&&t.altKey&&t.ctrlKey&&!t.metaKey||e.isWindows&&t.getModifierState("AltGraph");return"keypress"===t.type?i:i&&(!t.keyCode||t.keyCode>47)},t.prototype._keyUp=function(e){this._keyDownSeen=!1,this._customKeyEventHandler&&!1===this._customKeyEventHandler(e)||(function(e){return 16===e.keyCode||17===e.keyCode||18===e.keyCode}(e)||this.focus(),this.updateCursorStyle(e),this._keyPressHandled=!1)},t.prototype._keyPress=function(e){var t;if(this._keyPressHandled=!1,this._keyDownHandled)return!1;if(this._customKeyEventHandler&&!1===this._customKeyEventHandler(e))return!1;if(this.cancel(e),e.charCode)t=e.charCode;else if(null===e.which||void 0===e.which)t=e.keyCode;else{if(0===e.which||0===e.charCode)return!1;t=e.which}return!(!t||(e.altKey||e.ctrlKey||e.metaKey)&&!this._isThirdLevelShift(this.browser,e)||(t=String.fromCharCode(t),this._onKey.fire({key:t,domEvent:e}),this._showCursor(),this.coreService.triggerDataEvent(t,!0),this._keyPressHandled=!0,this._unprocessedDeadKey=!1,0))},t.prototype._inputEvent=function(e){if(e.data&&"insertText"===e.inputType&&(!e.composed||!this._keyDownSeen)&&!this.optionsService.rawOptions.screenReaderMode){if(this._keyPressHandled)return!1;this._unprocessedDeadKey=!1;var t=e.data;return this.coreService.triggerDataEvent(t,!0),this.cancel(e),!0}return!1},t.prototype.bell=function(){var e;this._soundBell()&&(null===(e=this._soundService)||void 0===e||e.playBellSound()),this._onBell.fire()},t.prototype.resize=function(t,i){t!==this.cols||i!==this.rows?e.prototype.resize.call(this,t,i):this._charSizeService&&!this._charSizeService.hasValidSize&&this._charSizeService.measure()},t.prototype._afterResize=function(e,t){var i,r;null===(i=this._charSizeService)||void 0===i||i.measure(),null===(r=this.viewport)||void 0===r||r.syncScrollArea(!0)},t.prototype.clear=function(){if(0!==this.buffer.ybase||0!==this.buffer.y){this.buffer.clearAllMarkers(),this.buffer.lines.set(0,this.buffer.lines.get(this.buffer.ybase+this.buffer.y)),this.buffer.lines.length=1,this.buffer.ydisp=0,this.buffer.ybase=0,this.buffer.y=0;for(var e=1;e<this.rows;e++)this.buffer.lines.push(this.buffer.getBlankLine(E.DEFAULT_ATTR_DATA));this.refresh(0,this.rows-1),this._onScroll.fire({position:this.buffer.ydisp,source:0})}},t.prototype.reset=function(){var t,i;this.options.rows=this.rows,this.options.cols=this.cols;var r=this._customKeyEventHandler;this._setup(),e.prototype.reset.call(this),null===(t=this._selectionService)||void 0===t||t.reset(),this._decorationService.reset(),this._customKeyEventHandler=r,this.refresh(0,this.rows-1),null===(i=this.viewport)||void 0===i||i.syncScrollArea()},t.prototype.clearTextureAtlas=function(){var e;null===(e=this._renderService)||void 0===e||e.clearTextureAtlas()},t.prototype._reportFocus=function(){var e;(null===(e=this.element)||void 0===e?void 0:e.classList.contains("focus"))?this.coreService.triggerDataEvent(h.C0.ESC+"[I"):this.coreService.triggerDataEvent(h.C0.ESC+"[O")},t.prototype._reportWindowsOptions=function(e){if(this._renderService)switch(e){case p.WindowsOptionsReportType.GET_WIN_SIZE_PIXELS:var t=this._renderService.dimensions.scaledCanvasWidth.toFixed(0),i=this._renderService.dimensions.scaledCanvasHeight.toFixed(0);this.coreService.triggerDataEvent(h.C0.ESC+"[4;"+i+";"+t+"t");break;case p.WindowsOptionsReportType.GET_CELL_SIZE_PIXELS:var r=this._renderService.dimensions.scaledCellWidth.toFixed(0),n=this._renderService.dimensions.scaledCellHeight.toFixed(0);this.coreService.triggerDataEvent(h.C0.ESC+"[6;"+n+";"+r+"t")}},t.prototype.cancel=function(e,t){if(this.options.cancelEvents||t)return e.preventDefault(),e.stopPropagation(),!1},t.prototype._visualBell=function(){return!1},t.prototype._soundBell=function(){return"sound"===this.options.bellStyle},t}(D.CoreTerminal);t.Terminal=z},9924:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.TimeBasedDebouncer=void 0;var i=function(){function e(e,t){void 0===t&&(t=1e3),this._renderCallback=e,this._debounceThresholdMS=t,this._lastRefreshMs=0,this._additionalRefreshRequested=!1}return e.prototype.dispose=function(){this._refreshTimeoutID&&clearTimeout(this._refreshTimeoutID)},e.prototype.refresh=function(e,t,i){var r=this;this._rowCount=i,e=void 0!==e?e:0,t=void 0!==t?t:this._rowCount-1,this._rowStart=void 0!==this._rowStart?Math.min(this._rowStart,e):e,this._rowEnd=void 0!==this._rowEnd?Math.max(this._rowEnd,t):t;var n=Date.now();if(n-this._lastRefreshMs>=this._debounceThresholdMS)this._lastRefreshMs=n,this._innerRefresh();else if(!this._additionalRefreshRequested){var o=n-this._lastRefreshMs,s=this._debounceThresholdMS-o;this._additionalRefreshRequested=!0,this._refreshTimeoutID=window.setTimeout((function(){r._lastRefreshMs=Date.now(),r._innerRefresh(),r._additionalRefreshRequested=!1,r._refreshTimeoutID=void 0}),s)}},e.prototype._innerRefresh=function(){if(void 0!==this._rowStart&&void 0!==this._rowEnd&&void 0!==this._rowCount){var e=Math.max(this._rowStart,0),t=Math.min(this._rowEnd,this._rowCount-1);this._rowStart=void 0,this._rowEnd=void 0,this._renderCallback(e,t)}},e}();t.TimeBasedDebouncer=i},1680:function(e,t,i){var r,n=this&&this.__extends||(r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])},r(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function i(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),o=this&&this.__decorate||function(e,t,i,r){var n,o=arguments.length,s=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,r);else for(var a=e.length-1;a>=0;a--)(n=e[a])&&(s=(o<3?n(s):o>3?n(t,i,s):n(t,i))||s);return o>3&&s&&Object.defineProperty(t,i,s),s},s=this&&this.__param||function(e,t){return function(i,r){t(i,r,e)}};Object.defineProperty(t,"__esModule",{value:!0}),t.Viewport=void 0;var a=i(844),l=i(3656),c=i(4725),d=i(2585),h=function(e){function t(t,i,r,n,o,s,a,c){var d=e.call(this)||this;return d._scrollLines=t,d._viewportElement=i,d._scrollArea=r,d._element=n,d._bufferService=o,d._optionsService=s,d._charSizeService=a,d._renderService=c,d.scrollBarWidth=0,d._currentRowHeight=0,d._currentScaledCellHeight=0,d._lastRecordedBufferLength=0,d._lastRecordedViewportHeight=0,d._lastRecordedBufferHeight=0,d._lastTouchY=0,d._lastScrollTop=0,d._wheelPartialScroll=0,d._refreshAnimationFrame=null,d._ignoreNextScrollEvent=!1,d.scrollBarWidth=d._viewportElement.offsetWidth-d._scrollArea.offsetWidth||15,d.register((0,l.addDisposableDomListener)(d._viewportElement,"scroll",d._onScroll.bind(d))),d._activeBuffer=d._bufferService.buffer,d.register(d._bufferService.buffers.onBufferActivate((function(e){return d._activeBuffer=e.activeBuffer}))),d._renderDimensions=d._renderService.dimensions,d.register(d._renderService.onDimensionsChange((function(e){return d._renderDimensions=e}))),setTimeout((function(){return d.syncScrollArea()}),0),d}return n(t,e),t.prototype.onThemeChange=function(e){this._viewportElement.style.backgroundColor=e.background.css},t.prototype._refresh=function(e){var t=this;if(e)return this._innerRefresh(),void(null!==this._refreshAnimationFrame&&cancelAnimationFrame(this._refreshAnimationFrame));null===this._refreshAnimationFrame&&(this._refreshAnimationFrame=requestAnimationFrame((function(){return t._innerRefresh()})))},t.prototype._innerRefresh=function(){if(this._charSizeService.height>0){this._currentRowHeight=this._renderService.dimensions.scaledCellHeight/window.devicePixelRatio,this._currentScaledCellHeight=this._renderService.dimensions.scaledCellHeight,this._lastRecordedViewportHeight=this._viewportElement.offsetHeight;var e=Math.round(this._currentRowHeight*this._lastRecordedBufferLength)+(this._lastRecordedViewportHeight-this._renderService.dimensions.canvasHeight);this._lastRecordedBufferHeight!==e&&(this._lastRecordedBufferHeight=e,this._scrollArea.style.height=this._lastRecordedBufferHeight+"px")}var t=this._bufferService.buffer.ydisp*this._currentRowHeight;this._viewportElement.scrollTop!==t&&(this._ignoreNextScrollEvent=!0,this._viewportElement.scrollTop=t),this._refreshAnimationFrame=null},t.prototype.syncScrollArea=function(e){if(void 0===e&&(e=!1),this._lastRecordedBufferLength!==this._bufferService.buffer.lines.length)return this._lastRecordedBufferLength=this._bufferService.buffer.lines.length,void this._refresh(e);this._lastRecordedViewportHeight===this._renderService.dimensions.canvasHeight&&this._lastScrollTop===this._activeBuffer.ydisp*this._currentRowHeight&&this._renderDimensions.scaledCellHeight===this._currentScaledCellHeight||this._refresh(e)},t.prototype._onScroll=function(e){if(this._lastScrollTop=this._viewportElement.scrollTop,this._viewportElement.offsetParent){if(this._ignoreNextScrollEvent)return this._ignoreNextScrollEvent=!1,void this._scrollLines(0);var t=Math.round(this._lastScrollTop/this._currentRowHeight)-this._bufferService.buffer.ydisp;this._scrollLines(t)}},t.prototype._bubbleScroll=function(e,t){var i=this._viewportElement.scrollTop+this._lastRecordedViewportHeight;return!(t<0&&0!==this._viewportElement.scrollTop||t>0&&i<this._lastRecordedBufferHeight)||(e.cancelable&&e.preventDefault(),!1)},t.prototype.onWheel=function(e){var t=this._getPixelsScrolled(e);return 0!==t&&(this._viewportElement.scrollTop+=t,this._bubbleScroll(e,t))},t.prototype._getPixelsScrolled=function(e){if(0===e.deltaY||e.shiftKey)return 0;var t=this._applyScrollModifier(e.deltaY,e);return e.deltaMode===WheelEvent.DOM_DELTA_LINE?t*=this._currentRowHeight:e.deltaMode===WheelEvent.DOM_DELTA_PAGE&&(t*=this._currentRowHeight*this._bufferService.rows),t},t.prototype.getLinesScrolled=function(e){if(0===e.deltaY||e.shiftKey)return 0;var t=this._applyScrollModifier(e.deltaY,e);return e.deltaMode===WheelEvent.DOM_DELTA_PIXEL?(t/=this._currentRowHeight+0,this._wheelPartialScroll+=t,t=Math.floor(Math.abs(this._wheelPartialScroll))*(this._wheelPartialScroll>0?1:-1),this._wheelPartialScroll%=1):e.deltaMode===WheelEvent.DOM_DELTA_PAGE&&(t*=this._bufferService.rows),t},t.prototype._applyScrollModifier=function(e,t){var i=this._optionsService.rawOptions.fastScrollModifier;return"alt"===i&&t.altKey||"ctrl"===i&&t.ctrlKey||"shift"===i&&t.shiftKey?e*this._optionsService.rawOptions.fastScrollSensitivity*this._optionsService.rawOptions.scrollSensitivity:e*this._optionsService.rawOptions.scrollSensitivity},t.prototype.onTouchStart=function(e){this._lastTouchY=e.touches[0].pageY},t.prototype.onTouchMove=function(e){var t=this._lastTouchY-e.touches[0].pageY;return this._lastTouchY=e.touches[0].pageY,0!==t&&(this._viewportElement.scrollTop+=t,this._bubbleScroll(e,t))},o([s(4,d.IBufferService),s(5,d.IOptionsService),s(6,c.ICharSizeService),s(7,c.IRenderService)],t)}(a.Disposable);t.Viewport=h},3107:function(e,t,i){var r,n=this&&this.__extends||(r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])},r(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function i(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),o=this&&this.__decorate||function(e,t,i,r){var n,o=arguments.length,s=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,r);else for(var a=e.length-1;a>=0;a--)(n=e[a])&&(s=(o<3?n(s):o>3?n(t,i,s):n(t,i))||s);return o>3&&s&&Object.defineProperty(t,i,s),s},s=this&&this.__param||function(e,t){return function(i,r){t(i,r,e)}},a=this&&this.__values||function(e){var t="function"==typeof Symbol&&Symbol.iterator,i=t&&e[t],r=0;if(i)return i.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(t,"__esModule",{value:!0}),t.BufferDecorationRenderer=void 0;var l=i(3656),c=i(4725),d=i(844),h=i(2585),p=function(e){function t(t,i,r,n){var o=e.call(this)||this;return o._screenElement=t,o._bufferService=i,o._decorationService=r,o._renderService=n,o._decorationElements=new Map,o._altBufferIsActive=!1,o._dimensionsChanged=!1,o._container=document.createElement("div"),o._container.classList.add("xterm-decoration-container"),o._screenElement.appendChild(o._container),o.register(o._renderService.onRenderedViewportChange((function(){return o._queueRefresh()}))),o.register(o._renderService.onDimensionsChange((function(){o._dimensionsChanged=!0,o._queueRefresh()}))),o.register((0,l.addDisposableDomListener)(window,"resize",(function(){return o._queueRefresh()}))),o.register(o._bufferService.buffers.onBufferActivate((function(){o._altBufferIsActive=o._bufferService.buffer===o._bufferService.buffers.alt}))),o.register(o._decorationService.onDecorationRegistered((function(){return o._queueRefresh()}))),o.register(o._decorationService.onDecorationRemoved((function(e){return o._removeDecoration(e)}))),o}return n(t,e),t.prototype.dispose=function(){this._container.remove(),this._decorationElements.clear(),e.prototype.dispose.call(this)},t.prototype._queueRefresh=function(){var e=this;void 0===this._animationFrame&&(this._animationFrame=this._renderService.addRefreshCallback((function(){e.refreshDecorations(),e._animationFrame=void 0})))},t.prototype.refreshDecorations=function(){var e,t;try{for(var i=a(this._decorationService.decorations),r=i.next();!r.done;r=i.next()){var n=r.value;this._renderDecoration(n)}}catch(t){e={error:t}}finally{try{r&&!r.done&&(t=i.return)&&t.call(i)}finally{if(e)throw e.error}}this._dimensionsChanged=!1},t.prototype._renderDecoration=function(e){this._refreshStyle(e),this._dimensionsChanged&&this._refreshXPosition(e)},t.prototype._createElement=function(e){var t,i=document.createElement("div");i.classList.add("xterm-decoration"),i.style.width=Math.round((e.options.width||1)*this._renderService.dimensions.actualCellWidth)+"px",i.style.height=(e.options.height||1)*this._renderService.dimensions.actualCellHeight+"px",i.style.top=(e.marker.line-this._bufferService.buffers.active.ydisp)*this._renderService.dimensions.actualCellHeight+"px",i.style.lineHeight=this._renderService.dimensions.actualCellHeight+"px";var r=null!==(t=e.options.x)&&void 0!==t?t:0;return r&&r>this._bufferService.cols&&(i.style.display="none"),this._refreshXPosition(e,i),i},t.prototype._refreshStyle=function(e){var t=this,i=e.marker.line-this._bufferService.buffers.active.ydisp;if(i<0||i>=this._bufferService.rows)e.element&&(e.element.style.display="none",e.onRenderEmitter.fire(e.element));else{var r=this._decorationElements.get(e);r||(e.onDispose((function(){return t._removeDecoration(e)})),r=this._createElement(e),e.element=r,this._decorationElements.set(e,r),this._container.appendChild(r)),r.style.top=i*this._renderService.dimensions.actualCellHeight+"px",r.style.display=this._altBufferIsActive?"none":"block",e.onRenderEmitter.fire(r)}},t.prototype._refreshXPosition=function(e,t){var i;if(void 0===t&&(t=e.element),t){var r=null!==(i=e.options.x)&&void 0!==i?i:0;"right"===(e.options.anchor||"left")?t.style.right=r?r*this._renderService.dimensions.actualCellWidth+"px":"":t.style.left=r?r*this._renderService.dimensions.actualCellWidth+"px":""}},t.prototype._removeDecoration=function(e){var t;null===(t=this._decorationElements.get(e))||void 0===t||t.remove(),this._decorationElements.delete(e)},o([s(1,h.IBufferService),s(2,h.IDecorationService),s(3,c.IRenderService)],t)}(d.Disposable);t.BufferDecorationRenderer=p},5871:function(e,t){var i=this&&this.__values||function(e){var t="function"==typeof Symbol&&Symbol.iterator,i=t&&e[t],r=0;if(i)return i.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(t,"__esModule",{value:!0}),t.ColorZoneStore=void 0;var r=function(){function e(){this._zones=[],this._zonePool=[],this._zonePoolIndex=0,this._linePadding={full:0,left:0,center:0,right:0}}return Object.defineProperty(e.prototype,"zones",{get:function(){return this._zonePool.length=Math.min(this._zonePool.length,this._zones.length),this._zones},enumerable:!1,configurable:!0}),e.prototype.clear=function(){this._zones.length=0,this._zonePoolIndex=0},e.prototype.addDecoration=function(e){var t,r;if(e.options.overviewRulerOptions){try{for(var n=i(this._zones),o=n.next();!o.done;o=n.next()){var s=o.value;if(s.color===e.options.overviewRulerOptions.color&&s.position===e.options.overviewRulerOptions.position){if(this._lineIntersectsZone(s,e.marker.line))return;if(this._lineAdjacentToZone(s,e.marker.line,e.options.overviewRulerOptions.position))return void this._addLineToZone(s,e.marker.line)}}}catch(e){t={error:e}}finally{try{o&&!o.done&&(r=n.return)&&r.call(n)}finally{if(t)throw t.error}}if(this._zonePoolIndex<this._zonePool.length)return this._zonePool[this._zonePoolIndex].color=e.options.overviewRulerOptions.color,this._zonePool[this._zonePoolIndex].position=e.options.overviewRulerOptions.position,this._zonePool[this._zonePoolIndex].startBufferLine=e.marker.line,this._zonePool[this._zonePoolIndex].endBufferLine=e.marker.line,void this._zones.push(this._zonePool[this._zonePoolIndex++]);this._zones.push({color:e.options.overviewRulerOptions.color,position:e.options.overviewRulerOptions.position,startBufferLine:e.marker.line,endBufferLine:e.marker.line}),this._zonePool.push(this._zones[this._zones.length-1]),this._zonePoolIndex++}},e.prototype.setPadding=function(e){this._linePadding=e},e.prototype._lineIntersectsZone=function(e,t){return t>=e.startBufferLine&&t<=e.endBufferLine},e.prototype._lineAdjacentToZone=function(e,t,i){return t>=e.startBufferLine-this._linePadding[i||"full"]&&t<=e.endBufferLine+this._linePadding[i||"full"]},e.prototype._addLineToZone=function(e,t){e.startBufferLine=Math.min(e.startBufferLine,t),e.endBufferLine=Math.max(e.endBufferLine,t)},e}();t.ColorZoneStore=r},5744:function(e,t,i){var r,n=this&&this.__extends||(r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])},r(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function i(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),o=this&&this.__decorate||function(e,t,i,r){var n,o=arguments.length,s=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,r);else for(var a=e.length-1;a>=0;a--)(n=e[a])&&(s=(o<3?n(s):o>3?n(t,i,s):n(t,i))||s);return o>3&&s&&Object.defineProperty(t,i,s),s},s=this&&this.__param||function(e,t){return function(i,r){t(i,r,e)}},a=this&&this.__values||function(e){var t="function"==typeof Symbol&&Symbol.iterator,i=t&&e[t],r=0;if(i)return i.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(t,"__esModule",{value:!0}),t.OverviewRulerRenderer=void 0;var l=i(5871),c=i(3656),d=i(4725),h=i(844),p=i(2585),u={full:0,left:0,center:0,right:0},f={full:0,left:0,center:0,right:0},_={full:0,left:0,center:0,right:0},g=function(e){function t(t,i,r,n,o,s){var a,c=e.call(this)||this;c._viewportElement=t,c._screenElement=i,c._bufferService=r,c._decorationService=n,c._renderService=o,c._optionsService=s,c._colorZoneStore=new l.ColorZoneStore,c._shouldUpdateDimensions=!0,c._shouldUpdateAnchor=!0,c._lastKnownBufferLength=0,c._canvas=document.createElement("canvas"),c._canvas.classList.add("xterm-decoration-overview-ruler"),c._refreshCanvasDimensions(),null===(a=c._viewportElement.parentElement)||void 0===a||a.insertBefore(c._canvas,c._viewportElement);var d=c._canvas.getContext("2d");if(!d)throw new Error("Ctx cannot be null");return c._ctx=d,c._registerDecorationListeners(),c._registerBufferChangeListeners(),c._registerDimensionChangeListeners(),c}return n(t,e),Object.defineProperty(t.prototype,"_width",{get:function(){return this._optionsService.options.overviewRulerWidth||0},enumerable:!1,configurable:!0}),t.prototype._registerDecorationListeners=function(){var e=this;this.register(this._decorationService.onDecorationRegistered((function(){return e._queueRefresh(void 0,!0)}))),this.register(this._decorationService.onDecorationRemoved((function(){return e._queueRefresh(void 0,!0)})))},t.prototype._registerBufferChangeListeners=function(){var e=this;this.register(this._renderService.onRenderedViewportChange((function(){return e._queueRefresh()}))),this.register(this._bufferService.buffers.onBufferActivate((function(){e._canvas.style.display=e._bufferService.buffer===e._bufferService.buffers.alt?"none":"block"}))),this.register(this._bufferService.onScroll((function(){e._lastKnownBufferLength!==e._bufferService.buffers.normal.lines.length&&(e._refreshDrawHeightConstants(),e._refreshColorZonePadding())})))},t.prototype._registerDimensionChangeListeners=function(){var e=this;this.register(this._renderService.onRender((function(){e._containerHeight&&e._containerHeight===e._screenElement.clientHeight||(e._queueRefresh(!0),e._containerHeight=e._screenElement.clientHeight)}))),this.register(this._optionsService.onOptionChange((function(t){"overviewRulerWidth"===t&&e._queueRefresh(!0)}))),this.register((0,c.addDisposableDomListener)(window,"resize",(function(){e._queueRefresh(!0)}))),this._queueRefresh(!0)},t.prototype.dispose=function(){var t;null===(t=this._canvas)||void 0===t||t.remove(),e.prototype.dispose.call(this)},t.prototype._refreshDrawConstants=function(){var e=Math.floor(this._canvas.width/3),t=Math.ceil(this._canvas.width/3);f.full=this._canvas.width,f.left=e,f.center=t,f.right=e,this._refreshDrawHeightConstants(),_.full=0,_.left=0,_.center=f.left,_.right=f.left+f.center},t.prototype._refreshDrawHeightConstants=function(){u.full=Math.round(2*window.devicePixelRatio);var e=this._canvas.height/this._bufferService.buffer.lines.length,t=Math.round(Math.max(Math.min(e,12),6)*window.devicePixelRatio);u.left=t,u.center=t,u.right=t},t.prototype._refreshColorZonePadding=function(){this._colorZoneStore.setPadding({full:Math.floor(this._bufferService.buffers.active.lines.length/(this._canvas.height-1)*u.full),left:Math.floor(this._bufferService.buffers.active.lines.length/(this._canvas.height-1)*u.left),center:Math.floor(this._bufferService.buffers.active.lines.length/(this._canvas.height-1)*u.center),right:Math.floor(this._bufferService.buffers.active.lines.length/(this._canvas.height-1)*u.right)}),this._lastKnownBufferLength=this._bufferService.buffers.normal.lines.length},t.prototype._refreshCanvasDimensions=function(){this._canvas.style.width=this._width+"px",this._canvas.width=Math.round(this._width*window.devicePixelRatio),this._canvas.style.height=this._screenElement.clientHeight+"px",this._canvas.height=Math.round(this._screenElement.clientHeight*window.devicePixelRatio),this._refreshDrawConstants(),this._refreshColorZonePadding()},t.prototype._refreshDecorations=function(){var e,t,i,r,n,o;this._shouldUpdateDimensions&&this._refreshCanvasDimensions(),this._ctx.clearRect(0,0,this._canvas.width,this._canvas.height),this._colorZoneStore.clear();try{for(var s=a(this._decorationService.decorations),l=s.next();!l.done;l=s.next()){var c=l.value;this._colorZoneStore.addDecoration(c)}}catch(t){e={error:t}}finally{try{l&&!l.done&&(t=s.return)&&t.call(s)}finally{if(e)throw e.error}}this._ctx.lineWidth=1;var d=this._colorZoneStore.zones;try{for(var h=a(d),p=h.next();!p.done;p=h.next())"full"!==(_=p.value).position&&this._renderColorZone(_)}catch(e){i={error:e}}finally{try{p&&!p.done&&(r=h.return)&&r.call(h)}finally{if(i)throw i.error}}try{for(var u=a(d),f=u.next();!f.done;f=u.next()){var _;"full"===(_=f.value).position&&this._renderColorZone(_)}}catch(e){n={error:e}}finally{try{f&&!f.done&&(o=u.return)&&o.call(u)}finally{if(n)throw n.error}}this._shouldUpdateDimensions=!1,this._shouldUpdateAnchor=!1},t.prototype._renderColorZone=function(e){this._ctx.fillStyle=e.color,this._ctx.fillRect(_[e.position||"full"],Math.round((this._canvas.height-1)*(e.startBufferLine/this._bufferService.buffers.active.lines.length)-u[e.position||"full"]/2),f[e.position||"full"],Math.round((this._canvas.height-1)*((e.endBufferLine-e.startBufferLine)/this._bufferService.buffers.active.lines.length)+u[e.position||"full"]))},t.prototype._queueRefresh=function(e,t){var i=this;this._shouldUpdateDimensions=e||this._shouldUpdateDimensions,this._shouldUpdateAnchor=t||this._shouldUpdateAnchor,void 0===this._animationFrame&&(this._animationFrame=window.requestAnimationFrame((function(){i._refreshDecorations(),i._animationFrame=void 0})))},o([s(2,p.IBufferService),s(3,p.IDecorationService),s(4,d.IRenderService),s(5,p.IOptionsService)],t)}(h.Disposable);t.OverviewRulerRenderer=g},2950:function(e,t,i){var r=this&&this.__decorate||function(e,t,i,r){var n,o=arguments.length,s=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,r);else for(var a=e.length-1;a>=0;a--)(n=e[a])&&(s=(o<3?n(s):o>3?n(t,i,s):n(t,i))||s);return o>3&&s&&Object.defineProperty(t,i,s),s},n=this&&this.__param||function(e,t){return function(i,r){t(i,r,e)}};Object.defineProperty(t,"__esModule",{value:!0}),t.CompositionHelper=void 0;var o=i(4725),s=i(2585),a=function(){function e(e,t,i,r,n,o){this._textarea=e,this._compositionView=t,this._bufferService=i,this._optionsService=r,this._coreService=n,this._renderService=o,this._isComposing=!1,this._isSendingComposition=!1,this._compositionPosition={start:0,end:0},this._dataAlreadySent=""}return Object.defineProperty(e.prototype,"isComposing",{get:function(){return this._isComposing},enumerable:!1,configurable:!0}),e.prototype.compositionstart=function(){this._isComposing=!0,this._compositionPosition.start=this._textarea.value.length,this._compositionView.textContent="",this._dataAlreadySent="",this._compositionView.classList.add("active")},e.prototype.compositionupdate=function(e){var t=this;this._compositionView.textContent=e.data,this.updateCompositionElements(),setTimeout((function(){t._compositionPosition.end=t._textarea.value.length}),0)},e.prototype.compositionend=function(){this._finalizeComposition(!0)},e.prototype.keydown=function(e){if(this._isComposing||this._isSendingComposition){if(229===e.keyCode)return!1;if(16===e.keyCode||17===e.keyCode||18===e.keyCode)return!1;this._finalizeComposition(!1)}return 229!==e.keyCode||(this._handleAnyTextareaChanges(),!1)},e.prototype._finalizeComposition=function(e){var t=this;if(this._compositionView.classList.remove("active"),this._isComposing=!1,e){var i={start:this._compositionPosition.start,end:this._compositionPosition.end};this._isSendingComposition=!0,setTimeout((function(){var e;t._isSendingComposition&&(t._isSendingComposition=!1,i.start+=t._dataAlreadySent.length,(e=t._isComposing?t._textarea.value.substring(i.start,i.end):t._textarea.value.substring(i.start)).length>0&&t._coreService.triggerDataEvent(e,!0))}),0)}else{this._isSendingComposition=!1;var r=this._textarea.value.substring(this._compositionPosition.start,this._compositionPosition.end);this._coreService.triggerDataEvent(r,!0)}},e.prototype._handleAnyTextareaChanges=function(){var e=this,t=this._textarea.value;setTimeout((function(){if(!e._isComposing){var i=e._textarea.value.replace(t,"");i.length>0&&(e._dataAlreadySent=i,e._coreService.triggerDataEvent(i,!0))}}),0)},e.prototype.updateCompositionElements=function(e){var t=this;if(this._isComposing){if(this._bufferService.buffer.isCursorInViewport){var i=Math.min(this._bufferService.buffer.x,this._bufferService.cols-1),r=this._renderService.dimensions.actualCellHeight,n=this._bufferService.buffer.y*this._renderService.dimensions.actualCellHeight,o=i*this._renderService.dimensions.actualCellWidth;this._compositionView.style.left=o+"px",this._compositionView.style.top=n+"px",this._compositionView.style.height=r+"px",this._compositionView.style.lineHeight=r+"px",this._compositionView.style.fontFamily=this._optionsService.rawOptions.fontFamily,this._compositionView.style.fontSize=this._optionsService.rawOptions.fontSize+"px";var s=this._compositionView.getBoundingClientRect();this._textarea.style.left=o+"px",this._textarea.style.top=n+"px",this._textarea.style.width=Math.max(s.width,1)+"px",this._textarea.style.height=Math.max(s.height,1)+"px",this._textarea.style.lineHeight=s.height+"px"}e||setTimeout((function(){return t.updateCompositionElements(!0)}),0)}},r([n(2,s.IBufferService),n(3,s.IOptionsService),n(4,s.ICoreService),n(5,o.IRenderService)],e)}();t.CompositionHelper=a},9806:(e,t)=>{function i(e,t,i){var r=i.getBoundingClientRect(),n=e.getComputedStyle(i),o=parseInt(n.getPropertyValue("padding-left")),s=parseInt(n.getPropertyValue("padding-top"));return[t.clientX-r.left-o,t.clientY-r.top-s]}Object.defineProperty(t,"__esModule",{value:!0}),t.getRawByteCoords=t.getCoords=t.getCoordsRelativeToElement=void 0,t.getCoordsRelativeToElement=i,t.getCoords=function(e,t,r,n,o,s,a,l,c){if(s){var d=i(e,t,r);if(d)return d[0]=Math.ceil((d[0]+(c?a/2:0))/a),d[1]=Math.ceil(d[1]/l),d[0]=Math.min(Math.max(d[0],1),n+(c?1:0)),d[1]=Math.min(Math.max(d[1],1),o),d}},t.getRawByteCoords=function(e){if(e)return{x:e[0]+32,y:e[1]+32}}},9504:(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.moveToCellSequence=void 0;var r=i(2584);function n(e,t,i,r){var n=e-o(i,e),a=t-o(i,t),d=Math.abs(n-a)-function(e,t,i){for(var r=0,n=e-o(i,e),a=t-o(i,t),l=0;l<Math.abs(n-a);l++){var c="A"===s(e,t)?-1:1,d=i.buffer.lines.get(n+c*l);(null==d?void 0:d.isWrapped)&&r++}return r}(e,t,i);return c(d,l(s(e,t),r))}function o(e,t){for(var i=0,r=e.buffer.lines.get(t),n=null==r?void 0:r.isWrapped;n&&t>=0&&t<e.rows;)i++,n=null==(r=e.buffer.lines.get(--t))?void 0:r.isWrapped;return i}function s(e,t){return e>t?"A":"B"}function a(e,t,i,r,n,o){for(var s=e,a=t,l="";s!==i||a!==r;)s+=n?1:-1,n&&s>o.cols-1?(l+=o.buffer.translateBufferLineToString(a,!1,e,s),s=0,e=0,a++):!n&&s<0&&(l+=o.buffer.translateBufferLineToString(a,!1,0,e+1),e=s=o.cols-1,a--);return l+o.buffer.translateBufferLineToString(a,!1,e,s)}function l(e,t){var i=t?"O":"[";return r.C0.ESC+i+e}function c(e,t){e=Math.floor(e);for(var i="",r=0;r<e;r++)i+=t;return i}t.moveToCellSequence=function(e,t,i,r){var s,d=i.buffer.x,h=i.buffer.y;if(!i.buffer.hasScrollback)return function(e,t,i,r,s,d){return 0===n(t,r,s,d).length?"":c(a(e,t,e,t-o(s,t),!1,s).length,l("D",d))}(d,h,0,t,i,r)+n(h,t,i,r)+function(e,t,i,r,s,d){var h;h=n(t,r,s,d).length>0?r-o(s,r):t;var p=r,u=function(e,t,i,r,s,a){var l;return l=n(i,r,s,a).length>0?r-o(s,r):t,e<i&&l<=r||e>=i&&l<r?"C":"D"}(e,t,i,r,s,d);return c(a(e,h,i,p,"C"===u,s).length,l(u,d))}(d,h,e,t,i,r);if(h===t)return s=d>e?"D":"C",c(Math.abs(d-e),l(s,r));s=h>t?"D":"C";var p=Math.abs(h-t);return c(function(e,t){return t.cols-e}(h>t?e:d,i)+(p-1)*i.cols+1+((h>t?d:e)-1),l(s,r))}},4389:function(e,t,i){var r=this&&this.__assign||function(){return r=Object.assign||function(e){for(var t,i=1,r=arguments.length;i<r;i++)for(var n in t=arguments[i])Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e},r.apply(this,arguments)},n=this&&this.__values||function(e){var t="function"==typeof Symbol&&Symbol.iterator,i=t&&e[t],r=0;if(i)return i.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(t,"__esModule",{value:!0}),t.Terminal=void 0;var o=i(3236),s=i(9042),a=i(7975),l=i(7090),c=i(5741),d=i(8285),h=["cols","rows"],p=function(){function e(e){var t=this;this._core=new o.Terminal(e),this._addonManager=new c.AddonManager,this._publicOptions=r({},this._core.options);var i=function(e){return t._core.options[e]},n=function(e,i){t._checkReadonlyOptions(e),t._core.options[e]=i};for(var s in this._core.options){var a={get:i.bind(this,s),set:n.bind(this,s)};Object.defineProperty(this._publicOptions,s,a)}}return e.prototype._checkReadonlyOptions=function(e){if(h.includes(e))throw new Error('Option "'+e+'" can only be set in the constructor')},e.prototype._checkProposedApi=function(){if(!this._core.optionsService.rawOptions.allowProposedApi)throw new Error("You must set the allowProposedApi option to true to use proposed API")},Object.defineProperty(e.prototype,"onBell",{get:function(){return this._core.onBell},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"onBinary",{get:function(){return this._core.onBinary},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"onCursorMove",{get:function(){return this._core.onCursorMove},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"onData",{get:function(){return this._core.onData},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"onKey",{get:function(){return this._core.onKey},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"onLineFeed",{get:function(){return this._core.onLineFeed},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"onRender",{get:function(){return this._core.onRender},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"onResize",{get:function(){return this._core.onResize},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"onScroll",{get:function(){return this._core.onScroll},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"onSelectionChange",{get:function(){return this._core.onSelectionChange},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"onTitleChange",{get:function(){return this._core.onTitleChange},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"onWriteParsed",{get:function(){return this._core.onWriteParsed},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"element",{get:function(){return this._core.element},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"parser",{get:function(){return this._checkProposedApi(),this._parser||(this._parser=new a.ParserApi(this._core)),this._parser},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"unicode",{get:function(){return this._checkProposedApi(),new l.UnicodeApi(this._core)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"textarea",{get:function(){return this._core.textarea},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"rows",{get:function(){return this._core.rows},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"cols",{get:function(){return this._core.cols},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"buffer",{get:function(){return this._checkProposedApi(),this._buffer||(this._buffer=new d.BufferNamespaceApi(this._core)),this._buffer},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"markers",{get:function(){return this._checkProposedApi(),this._core.markers},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"modes",{get:function(){var e=this._core.coreService.decPrivateModes,t="none";switch(this._core.coreMouseService.activeProtocol){case"X10":t="x10";break;case"VT200":t="vt200";break;case"DRAG":t="drag";break;case"ANY":t="any"}return{applicationCursorKeysMode:e.applicationCursorKeys,applicationKeypadMode:e.applicationKeypad,bracketedPasteMode:e.bracketedPasteMode,insertMode:this._core.coreService.modes.insertMode,mouseTrackingMode:t,originMode:e.origin,reverseWraparoundMode:e.reverseWraparound,sendFocusMode:e.sendFocus,wraparoundMode:e.wraparound}},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"options",{get:function(){return this._publicOptions},set:function(e){for(var t in e)this._publicOptions[t]=e[t]},enumerable:!1,configurable:!0}),e.prototype.blur=function(){this._core.blur()},e.prototype.focus=function(){this._core.focus()},e.prototype.resize=function(e,t){this._verifyIntegers(e,t),this._core.resize(e,t)},e.prototype.open=function(e){this._core.open(e)},e.prototype.attachCustomKeyEventHandler=function(e){this._core.attachCustomKeyEventHandler(e)},e.prototype.registerLinkMatcher=function(e,t,i){return this._checkProposedApi(),this._core.registerLinkMatcher(e,t,i)},e.prototype.deregisterLinkMatcher=function(e){this._checkProposedApi(),this._core.deregisterLinkMatcher(e)},e.prototype.registerLinkProvider=function(e){return this._checkProposedApi(),this._core.registerLinkProvider(e)},e.prototype.registerCharacterJoiner=function(e){return this._checkProposedApi(),this._core.registerCharacterJoiner(e)},e.prototype.deregisterCharacterJoiner=function(e){this._checkProposedApi(),this._core.deregisterCharacterJoiner(e)},e.prototype.registerMarker=function(e){return void 0===e&&(e=0),this._checkProposedApi(),this._verifyIntegers(e),this._core.addMarker(e)},e.prototype.registerDecoration=function(e){var t,i,r;return this._checkProposedApi(),this._verifyPositiveIntegers(null!==(t=e.x)&&void 0!==t?t:0,null!==(i=e.width)&&void 0!==i?i:0,null!==(r=e.height)&&void 0!==r?r:0),this._core.registerDecoration(e)},e.prototype.addMarker=function(e){return this.registerMarker(e)},e.prototype.hasSelection=function(){return this._core.hasSelection()},e.prototype.select=function(e,t,i){this._verifyIntegers(e,t,i),this._core.select(e,t,i)},e.prototype.getSelection=function(){return this._core.getSelection()},e.prototype.getSelectionPosition=function(){return this._core.getSelectionPosition()},e.prototype.clearSelection=function(){this._core.clearSelection()},e.prototype.selectAll=function(){this._core.selectAll()},e.prototype.selectLines=function(e,t){this._verifyIntegers(e,t),this._core.selectLines(e,t)},e.prototype.dispose=function(){this._addonManager.dispose(),this._core.dispose()},e.prototype.scrollLines=function(e){this._verifyIntegers(e),this._core.scrollLines(e)},e.prototype.scrollPages=function(e){this._verifyIntegers(e),this._core.scrollPages(e)},e.prototype.scrollToTop=function(){this._core.scrollToTop()},e.prototype.scrollToBottom=function(){this._core.scrollToBottom()},e.prototype.scrollToLine=function(e){this._verifyIntegers(e),this._core.scrollToLine(e)},e.prototype.clear=function(){this._core.clear()},e.prototype.write=function(e,t){this._core.write(e,t)},e.prototype.writeUtf8=function(e,t){this._core.write(e,t)},e.prototype.writeln=function(e,t){this._core.write(e),this._core.write("\r\n",t)},e.prototype.paste=function(e){this._core.paste(e)},e.prototype.getOption=function(e){return this._core.optionsService.getOption(e)},e.prototype.setOption=function(e,t){this._checkReadonlyOptions(e),this._core.optionsService.setOption(e,t)},e.prototype.refresh=function(e,t){this._verifyIntegers(e,t),this._core.refresh(e,t)},e.prototype.reset=function(){this._core.reset()},e.prototype.clearTextureAtlas=function(){this._core.clearTextureAtlas()},e.prototype.loadAddon=function(e){return this._addonManager.loadAddon(this,e)},Object.defineProperty(e,"strings",{get:function(){return s},enumerable:!1,configurable:!0}),e.prototype._verifyIntegers=function(){for(var e,t,i=[],r=0;r<arguments.length;r++)i[r]=arguments[r];try{for(var o=n(i),s=o.next();!s.done;s=o.next()){var a=s.value;if(a===1/0||isNaN(a)||a%1!=0)throw new Error("This API only accepts integers")}}catch(t){e={error:t}}finally{try{s&&!s.done&&(t=o.return)&&t.call(o)}finally{if(e)throw e.error}}},e.prototype._verifyPositiveIntegers=function(){for(var e,t,i=[],r=0;r<arguments.length;r++)i[r]=arguments[r];try{for(var o=n(i),s=o.next();!s.done;s=o.next()){var a=s.value;if(a&&(a===1/0||isNaN(a)||a%1!=0||a<0))throw new Error("This API only accepts positive integers")}}catch(t){e={error:t}}finally{try{s&&!s.done&&(t=o.return)&&t.call(o)}finally{if(e)throw e.error}}},e}();t.Terminal=p},1546:function(e,t,i){var r=this&&this.__values||function(e){var t="function"==typeof Symbol&&Symbol.iterator,i=t&&e[t],r=0;if(i)return i.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(t,"__esModule",{value:!0}),t.BaseRenderLayer=void 0;var n=i(643),o=i(8803),s=i(1420),a=i(3734),l=i(1752),c=i(8055),d=i(9631),h=i(8978),p=function(){function e(e,t,i,r,n,o,s,a,l){this._container=e,this._alpha=r,this._colors=n,this._rendererId=o,this._bufferService=s,this._optionsService=a,this._decorationService=l,this._scaledCharWidth=0,this._scaledCharHeight=0,this._scaledCellWidth=0,this._scaledCellHeight=0,this._scaledCharLeft=0,this._scaledCharTop=0,this._columnSelectMode=!1,this._currentGlyphIdentifier={chars:"",code:0,bg:0,fg:0,bold:!1,dim:!1,italic:!1},this._canvas=document.createElement("canvas"),this._canvas.classList.add("xterm-"+t+"-layer"),this._canvas.style.zIndex=i.toString(),this._initCanvas(),this._container.appendChild(this._canvas)}return e.prototype.dispose=function(){var e;(0,d.removeElementFromParent)(this._canvas),null===(e=this._charAtlas)||void 0===e||e.dispose()},e.prototype._initCanvas=function(){this._ctx=(0,l.throwIfFalsy)(this._canvas.getContext("2d",{alpha:this._alpha})),this._alpha||this._clearAll()},e.prototype.onOptionsChanged=function(){},e.prototype.onBlur=function(){},e.prototype.onFocus=function(){},e.prototype.onCursorMove=function(){},e.prototype.onGridChanged=function(e,t){},e.prototype.onSelectionChanged=function(e,t,i){void 0===i&&(i=!1),this._selectionStart=e,this._selectionEnd=t,this._columnSelectMode=i},e.prototype.setColors=function(e){this._refreshCharAtlas(e)},e.prototype._setTransparency=function(e){if(e!==this._alpha){var t=this._canvas;this._alpha=e,this._canvas=this._canvas.cloneNode(),this._initCanvas(),this._container.replaceChild(this._canvas,t),this._refreshCharAtlas(this._colors),this.onGridChanged(0,this._bufferService.rows-1)}},e.prototype._refreshCharAtlas=function(e){this._scaledCharWidth<=0&&this._scaledCharHeight<=0||(this._charAtlas=(0,s.acquireCharAtlas)(this._optionsService.rawOptions,this._rendererId,e,this._scaledCharWidth,this._scaledCharHeight),this._charAtlas.warmUp())},e.prototype.resize=function(e){this._scaledCellWidth=e.scaledCellWidth,this._scaledCellHeight=e.scaledCellHeight,this._scaledCharWidth=e.scaledCharWidth,this._scaledCharHeight=e.scaledCharHeight,this._scaledCharLeft=e.scaledCharLeft,this._scaledCharTop=e.scaledCharTop,this._canvas.width=e.scaledCanvasWidth,this._canvas.height=e.scaledCanvasHeight,this._canvas.style.width=e.canvasWidth+"px",this._canvas.style.height=e.canvasHeight+"px",this._alpha||this._clearAll(),this._refreshCharAtlas(this._colors)},e.prototype.clearTextureAtlas=function(){var e;null===(e=this._charAtlas)||void 0===e||e.clear()},e.prototype._fillCells=function(e,t,i,r){this._ctx.fillRect(e*this._scaledCellWidth,t*this._scaledCellHeight,i*this._scaledCellWidth,r*this._scaledCellHeight)},e.prototype._fillMiddleLineAtCells=function(e,t,i){void 0===i&&(i=1);var r=Math.ceil(.5*this._scaledCellHeight);this._ctx.fillRect(e*this._scaledCellWidth,(t+1)*this._scaledCellHeight-r-window.devicePixelRatio,i*this._scaledCellWidth,window.devicePixelRatio)},e.prototype._fillBottomLineAtCells=function(e,t,i){void 0===i&&(i=1),this._ctx.fillRect(e*this._scaledCellWidth,(t+1)*this._scaledCellHeight-window.devicePixelRatio-1,i*this._scaledCellWidth,window.devicePixelRatio)},e.prototype._fillLeftLineAtCell=function(e,t,i){this._ctx.fillRect(e*this._scaledCellWidth,t*this._scaledCellHeight,window.devicePixelRatio*i,this._scaledCellHeight)},e.prototype._strokeRectAtCell=function(e,t,i,r){this._ctx.lineWidth=window.devicePixelRatio,this._ctx.strokeRect(e*this._scaledCellWidth+window.devicePixelRatio/2,t*this._scaledCellHeight+window.devicePixelRatio/2,i*this._scaledCellWidth-window.devicePixelRatio,r*this._scaledCellHeight-window.devicePixelRatio)},e.prototype._clearAll=function(){this._alpha?this._ctx.clearRect(0,0,this._canvas.width,this._canvas.height):(this._ctx.fillStyle=this._colors.background.css,this._ctx.fillRect(0,0,this._canvas.width,this._canvas.height))},e.prototype._clearCells=function(e,t,i,r){this._alpha?this._ctx.clearRect(e*this._scaledCellWidth,t*this._scaledCellHeight,i*this._scaledCellWidth,r*this._scaledCellHeight):(this._ctx.fillStyle=this._colors.background.css,this._ctx.fillRect(e*this._scaledCellWidth,t*this._scaledCellHeight,i*this._scaledCellWidth,r*this._scaledCellHeight))},e.prototype._fillCharTrueColor=function(e,t,i){this._ctx.font=this._getFont(!1,!1),this._ctx.textBaseline=o.TEXT_BASELINE,this._clipRow(i);var r=!1;!1!==this._optionsService.rawOptions.customGlyphs&&(r=(0,h.tryDrawCustomChar)(this._ctx,e.getChars(),t*this._scaledCellWidth,i*this._scaledCellHeight,this._scaledCellWidth,this._scaledCellHeight)),r||this._ctx.fillText(e.getChars(),t*this._scaledCellWidth+this._scaledCharLeft,i*this._scaledCellHeight+this._scaledCharTop+this._scaledCharHeight)},e.prototype._drawChars=function(e,t,i){var s,a,l,c=this._getContrastColor(e,t,i);if(c||e.isFgRGB()||e.isBgRGB())this._drawUncachedChars(e,t,i,c);else{var d,h;e.isInverse()?(d=e.isBgDefault()?o.INVERTED_DEFAULT_COLOR:e.getBgColor(),h=e.isFgDefault()?o.INVERTED_DEFAULT_COLOR:e.getFgColor()):(h=e.isBgDefault()?n.DEFAULT_COLOR:e.getBgColor(),d=e.isFgDefault()?n.DEFAULT_COLOR:e.getFgColor()),d+=this._optionsService.rawOptions.drawBoldTextInBrightColors&&e.isBold()&&d<8?8:0,this._currentGlyphIdentifier.chars=e.getChars()||n.WHITESPACE_CELL_CHAR,this._currentGlyphIdentifier.code=e.getCode()||n.WHITESPACE_CELL_CODE,this._currentGlyphIdentifier.bg=h,this._currentGlyphIdentifier.fg=d,this._currentGlyphIdentifier.bold=!!e.isBold(),this._currentGlyphIdentifier.dim=!!e.isDim(),this._currentGlyphIdentifier.italic=!!e.isItalic();var p=!1;try{for(var u=r(this._decorationService.getDecorationsAtCell(t,i)),f=u.next();!f.done;f=u.next()){var _=f.value;if(_.backgroundColorRGB||_.foregroundColorRGB){p=!0;break}}}catch(e){s={error:e}}finally{try{f&&!f.done&&(a=u.return)&&a.call(u)}finally{if(s)throw s.error}}!p&&(null===(l=this._charAtlas)||void 0===l?void 0:l.draw(this._ctx,this._currentGlyphIdentifier,t*this._scaledCellWidth+this._scaledCharLeft,i*this._scaledCellHeight+this._scaledCharTop))||this._drawUncachedChars(e,t,i)}},e.prototype._drawUncachedChars=function(e,t,i,r){if(this._ctx.save(),this._ctx.font=this._getFont(!!e.isBold(),!!e.isItalic()),this._ctx.textBaseline=o.TEXT_BASELINE,e.isInverse())if(r)this._ctx.fillStyle=r.css;else if(e.isBgDefault())this._ctx.fillStyle=c.color.opaque(this._colors.background).css;else if(e.isBgRGB())this._ctx.fillStyle="rgb("+a.AttributeData.toColorRGB(e.getBgColor()).join(",")+")";else{var n=e.getBgColor();this._optionsService.rawOptions.drawBoldTextInBrightColors&&e.isBold()&&n<8&&(n+=8),this._ctx.fillStyle=this._colors.ansi[n].css}else if(r)this._ctx.fillStyle=r.css;else if(e.isFgDefault())this._ctx.fillStyle=this._colors.foreground.css;else if(e.isFgRGB())this._ctx.fillStyle="rgb("+a.AttributeData.toColorRGB(e.getFgColor()).join(",")+")";else{var s=e.getFgColor();this._optionsService.rawOptions.drawBoldTextInBrightColors&&e.isBold()&&s<8&&(s+=8),this._ctx.fillStyle=this._colors.ansi[s].css}this._clipRow(i),e.isDim()&&(this._ctx.globalAlpha=o.DIM_OPACITY);var l=!1;!1!==this._optionsService.rawOptions.customGlyphs&&(l=(0,h.tryDrawCustomChar)(this._ctx,e.getChars(),t*this._scaledCellWidth,i*this._scaledCellHeight,this._scaledCellWidth,this._scaledCellHeight)),l||this._ctx.fillText(e.getChars(),t*this._scaledCellWidth+this._scaledCharLeft,i*this._scaledCellHeight+this._scaledCharTop+this._scaledCharHeight),this._ctx.restore()},e.prototype._clipRow=function(e){this._ctx.beginPath(),this._ctx.rect(0,e*this._scaledCellHeight,this._bufferService.cols*this._scaledCellWidth,this._scaledCellHeight),this._ctx.clip()},e.prototype._getFont=function(e,t){return(t?"italic":"")+" "+(e?this._optionsService.rawOptions.fontWeightBold:this._optionsService.rawOptions.fontWeight)+" "+this._optionsService.rawOptions.fontSize*window.devicePixelRatio+"px "+this._optionsService.rawOptions.fontFamily},e.prototype._getContrastColor=function(e,t,i){var n,o,s,a,d=!1;try{for(var h=r(this._decorationService.getDecorationsAtCell(t,i)),p=h.next();!p.done;p=h.next()){var u=p.value;"top"!==u.options.layer&&d||(u.backgroundColorRGB&&(s=u.backgroundColorRGB.rgba),u.foregroundColorRGB&&(a=u.foregroundColorRGB.rgba),d="top"===u.options.layer)}}catch(e){n={error:e}}finally{try{p&&!p.done&&(o=h.return)&&o.call(h)}finally{if(n)throw n.error}}if(d||this._colors.selectionForeground&&this._isCellInSelection(t,i)&&(a=this._colors.selectionForeground.rgba),s||a||1!==this._optionsService.rawOptions.minimumContrastRatio&&!(0,l.excludeFromContrastRatioDemands)(e.getCode())){if(!s&&!a){var f=this._colors.contrastCache.getColor(e.bg,e.fg);if(void 0!==f)return f||void 0}var _=e.getFgColor(),g=e.getFgColorMode(),m=e.getBgColor(),b=e.getBgColorMode(),y=!!e.isInverse(),v=!!e.isInverse();if(y){var w=_;_=m,m=w;var x=g;g=b,b=x}var C=this._resolveBackgroundRgba(void 0!==s?50331648:b,null!=s?s:m,y),S=this._resolveForegroundRgba(g,_,y,v),E=c.rgba.ensureContrastRatio(null!=s?s:C,null!=a?a:S,this._optionsService.rawOptions.minimumContrastRatio);if(!E){if(!a)return void this._colors.contrastCache.setColor(e.bg,e.fg,null);E=a}var k={css:c.channels.toCss(E>>24&255,E>>16&255,E>>8&255),rgba:E};return s||a||this._colors.contrastCache.setColor(e.bg,e.fg,k),k}},e.prototype._resolveBackgroundRgba=function(e,t,i){switch(e){case 16777216:case 33554432:return this._colors.ansi[t].rgba;case 50331648:return t<<8;default:return i?this._colors.foreground.rgba:this._colors.background.rgba}},e.prototype._resolveForegroundRgba=function(e,t,i,r){switch(e){case 16777216:case 33554432:return this._optionsService.rawOptions.drawBoldTextInBrightColors&&r&&t<8&&(t+=8),this._colors.ansi[t].rgba;case 50331648:return t<<8;default:return i?this._colors.background.rgba:this._colors.foreground.rgba}},e.prototype._isCellInSelection=function(e,t){var i=this._selectionStart,r=this._selectionEnd;return!(!i||!r)&&(this._columnSelectMode?e>=i[0]&&t>=i[1]&&e<r[0]&&t<r[1]:t>i[1]&&t<r[1]||i[1]===r[1]&&t===i[1]&&e>=i[0]&&e<r[0]||i[1]<r[1]&&t===r[1]&&e<r[0]||i[1]<r[1]&&t===i[1]&&e>=i[0])},e}();t.BaseRenderLayer=p},2512:function(e,t,i){var r,n=this&&this.__extends||(r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])},r(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function i(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),o=this&&this.__decorate||function(e,t,i,r){var n,o=arguments.length,s=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,r);else for(var a=e.length-1;a>=0;a--)(n=e[a])&&(s=(o<3?n(s):o>3?n(t,i,s):n(t,i))||s);return o>3&&s&&Object.defineProperty(t,i,s),s},s=this&&this.__param||function(e,t){return function(i,r){t(i,r,e)}};Object.defineProperty(t,"__esModule",{value:!0}),t.CursorRenderLayer=void 0;var a=i(1546),l=i(511),c=i(2585),d=i(4725),h=600,p=function(e){function t(t,i,r,n,o,s,a,c,d,h){var p=e.call(this,t,"cursor",i,!0,r,n,s,a,h)||this;return p._onRequestRedraw=o,p._coreService=c,p._coreBrowserService=d,p._cell=new l.CellData,p._state={x:0,y:0,isFocused:!1,style:"",width:0},p._cursorRenderers={bar:p._renderBarCursor.bind(p),block:p._renderBlockCursor.bind(p),underline:p._renderUnderlineCursor.bind(p)},p}return n(t,e),t.prototype.dispose=function(){this._cursorBlinkStateManager&&(this._cursorBlinkStateManager.dispose(),this._cursorBlinkStateManager=void 0),e.prototype.dispose.call(this)},t.prototype.resize=function(t){e.prototype.resize.call(this,t),this._state={x:0,y:0,isFocused:!1,style:"",width:0}},t.prototype.reset=function(){var e;this._clearCursor(),null===(e=this._cursorBlinkStateManager)||void 0===e||e.restartBlinkAnimation(),this.onOptionsChanged()},t.prototype.onBlur=function(){var e;null===(e=this._cursorBlinkStateManager)||void 0===e||e.pause(),this._onRequestRedraw.fire({start:this._bufferService.buffer.y,end:this._bufferService.buffer.y})},t.prototype.onFocus=function(){var e;null===(e=this._cursorBlinkStateManager)||void 0===e||e.resume(),this._onRequestRedraw.fire({start:this._bufferService.buffer.y,end:this._bufferService.buffer.y})},t.prototype.onOptionsChanged=function(){var e,t=this;this._optionsService.rawOptions.cursorBlink?this._cursorBlinkStateManager||(this._cursorBlinkStateManager=new u(this._coreBrowserService.isFocused,(function(){t._render(!0)}))):(null===(e=this._cursorBlinkStateManager)||void 0===e||e.dispose(),this._cursorBlinkStateManager=void 0),this._onRequestRedraw.fire({start:this._bufferService.buffer.y,end:this._bufferService.buffer.y})},t.prototype.onCursorMove=function(){var e;null===(e=this._cursorBlinkStateManager)||void 0===e||e.restartBlinkAnimation()},t.prototype.onGridChanged=function(e,t){!this._cursorBlinkStateManager||this._cursorBlinkStateManager.isPaused?this._render(!1):this._cursorBlinkStateManager.restartBlinkAnimation()},t.prototype._render=function(e){if(this._coreService.isCursorInitialized&&!this._coreService.isCursorHidden){var t=this._bufferService.buffer.ybase+this._bufferService.buffer.y,i=t-this._bufferService.buffer.ydisp;if(i<0||i>=this._bufferService.rows)this._clearCursor();else{var r=Math.min(this._bufferService.buffer.x,this._bufferService.cols-1);if(this._bufferService.buffer.lines.get(t).loadCell(r,this._cell),void 0!==this._cell.content){if(!this._coreBrowserService.isFocused){this._clearCursor(),this._ctx.save(),this._ctx.fillStyle=this._colors.cursor.css;var n=this._optionsService.rawOptions.cursorStyle;return n&&"block"!==n?this._cursorRenderers[n](r,i,this._cell):this._renderBlurCursor(r,i,this._cell),this._ctx.restore(),this._state.x=r,this._state.y=i,this._state.isFocused=!1,this._state.style=n,void(this._state.width=this._cell.getWidth())}if(!this._cursorBlinkStateManager||this._cursorBlinkStateManager.isCursorVisible){if(this._state){if(this._state.x===r&&this._state.y===i&&this._state.isFocused===this._coreBrowserService.isFocused&&this._state.style===this._optionsService.rawOptions.cursorStyle&&this._state.width===this._cell.getWidth())return;this._clearCursor()}this._ctx.save(),this._cursorRenderers[this._optionsService.rawOptions.cursorStyle||"block"](r,i,this._cell),this._ctx.restore(),this._state.x=r,this._state.y=i,this._state.isFocused=!1,this._state.style=this._optionsService.rawOptions.cursorStyle,this._state.width=this._cell.getWidth()}else this._clearCursor()}}}else this._clearCursor()},t.prototype._clearCursor=function(){this._state&&(window.devicePixelRatio<1?this._clearAll():this._clearCells(this._state.x,this._state.y,this._state.width,1),this._state={x:0,y:0,isFocused:!1,style:"",width:0})},t.prototype._renderBarCursor=function(e,t,i){this._ctx.save(),this._ctx.fillStyle=this._colors.cursor.css,this._fillLeftLineAtCell(e,t,this._optionsService.rawOptions.cursorWidth),this._ctx.restore()},t.prototype._renderBlockCursor=function(e,t,i){this._ctx.save(),this._ctx.fillStyle=this._colors.cursor.css,this._fillCells(e,t,i.getWidth(),1),this._ctx.fillStyle=this._colors.cursorAccent.css,this._fillCharTrueColor(i,e,t),this._ctx.restore()},t.prototype._renderUnderlineCursor=function(e,t,i){this._ctx.save(),this._ctx.fillStyle=this._colors.cursor.css,this._fillBottomLineAtCells(e,t),this._ctx.restore()},t.prototype._renderBlurCursor=function(e,t,i){this._ctx.save(),this._ctx.strokeStyle=this._colors.cursor.css,this._strokeRectAtCell(e,t,i.getWidth(),1),this._ctx.restore()},o([s(5,c.IBufferService),s(6,c.IOptionsService),s(7,c.ICoreService),s(8,d.ICoreBrowserService),s(9,c.IDecorationService)],t)}(a.BaseRenderLayer);t.CursorRenderLayer=p;var u=function(){function e(e,t){this._renderCallback=t,this.isCursorVisible=!0,e&&this._restartInterval()}return Object.defineProperty(e.prototype,"isPaused",{get:function(){return!(this._blinkStartTimeout||this._blinkInterval)},enumerable:!1,configurable:!0}),e.prototype.dispose=function(){this._blinkInterval&&(window.clearInterval(this._blinkInterval),this._blinkInterval=void 0),this._blinkStartTimeout&&(window.clearTimeout(this._blinkStartTimeout),this._blinkStartTimeout=void 0),this._animationFrame&&(window.cancelAnimationFrame(this._animationFrame),this._animationFrame=void 0)},e.prototype.restartBlinkAnimation=function(){var e=this;this.isPaused||(this._animationTimeRestarted=Date.now(),this.isCursorVisible=!0,this._animationFrame||(this._animationFrame=window.requestAnimationFrame((function(){e._renderCallback(),e._animationFrame=void 0}))))},e.prototype._restartInterval=function(e){var t=this;void 0===e&&(e=h),this._blinkInterval&&(window.clearInterval(this._blinkInterval),this._blinkInterval=void 0),this._blinkStartTimeout=window.setTimeout((function(){if(t._animationTimeRestarted){var e=h-(Date.now()-t._animationTimeRestarted);if(t._animationTimeRestarted=void 0,e>0)return void t._restartInterval(e)}t.isCursorVisible=!1,t._animationFrame=window.requestAnimationFrame((function(){t._renderCallback(),t._animationFrame=void 0})),t._blinkInterval=window.setInterval((function(){if(t._animationTimeRestarted){var e=h-(Date.now()-t._animationTimeRestarted);return t._animationTimeRestarted=void 0,void t._restartInterval(e)}t.isCursorVisible=!t.isCursorVisible,t._animationFrame=window.requestAnimationFrame((function(){t._renderCallback(),t._animationFrame=void 0}))}),h)}),e)},e.prototype.pause=function(){this.isCursorVisible=!0,this._blinkInterval&&(window.clearInterval(this._blinkInterval),this._blinkInterval=void 0),this._blinkStartTimeout&&(window.clearTimeout(this._blinkStartTimeout),this._blinkStartTimeout=void 0),this._animationFrame&&(window.cancelAnimationFrame(this._animationFrame),this._animationFrame=void 0)},e.prototype.resume=function(){this.pause(),this._animationTimeRestarted=void 0,this._restartInterval(),this.restartBlinkAnimation()},e}()},8978:function(e,t,i){var r,n,o,s,a,l,c,d,h,p,u,f,_,g,m,b,y,v,w,x,C,S,E,k,L,A,O,M,P,R,D,T,I,B,F,W,H,U,j,z,N,q,K,$,V,J,G,X,Q,Y,Z,ee,te,ie,re,ne,oe,se,ae,le,ce,de,he,pe,ue,fe,_e,ge,me,be,ye,ve,we,xe,Ce,Se,Ee,ke,Le,Ae,Oe,Me,Pe,Re,De,Te,Ie,Be,Fe,We,He,Ue,je,ze,Ne,qe,Ke,$e,Ve,Je,Ge,Xe,Qe,Ye,Ze,et,tt,it,rt,nt,ot,st,at,lt,ct,dt,ht,pt,ut,ft,_t,gt,mt,bt,yt,vt,wt,xt,Ct=this&&this.__read||function(e,t){var i="function"==typeof Symbol&&e[Symbol.iterator];if(!i)return e;var r,n,o=i.call(e),s=[];try{for(;(void 0===t||t-- >0)&&!(r=o.next()).done;)s.push(r.value)}catch(e){n={error:e}}finally{try{r&&!r.done&&(i=o.return)&&i.call(o)}finally{if(n)throw n.error}}return s},St=this&&this.__values||function(e){var t="function"==typeof Symbol&&Symbol.iterator,i=t&&e[t],r=0;if(i)return i.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(t,"__esModule",{value:!0}),t.tryDrawCustomChar=t.powerlineDefinitions=t.boxDrawingDefinitions=t.blockElementDefinitions=void 0;var Et=i(1752);t.blockElementDefinitions={"▀":[{x:0,y:0,w:8,h:4}],"▁":[{x:0,y:7,w:8,h:1}],"▂":[{x:0,y:6,w:8,h:2}],"▃":[{x:0,y:5,w:8,h:3}],"▄":[{x:0,y:4,w:8,h:4}],"▅":[{x:0,y:3,w:8,h:5}],"▆":[{x:0,y:2,w:8,h:6}],"▇":[{x:0,y:1,w:8,h:7}],"█":[{x:0,y:0,w:8,h:8}],"▉":[{x:0,y:0,w:7,h:8}],"▊":[{x:0,y:0,w:6,h:8}],"▋":[{x:0,y:0,w:5,h:8}],"▌":[{x:0,y:0,w:4,h:8}],"▍":[{x:0,y:0,w:3,h:8}],"▎":[{x:0,y:0,w:2,h:8}],"▏":[{x:0,y:0,w:1,h:8}],"▐":[{x:4,y:0,w:4,h:8}],"▔":[{x:0,y:0,w:9,h:1}],"▕":[{x:7,y:0,w:1,h:8}],"▖":[{x:0,y:4,w:4,h:4}],"▗":[{x:4,y:4,w:4,h:4}],"▘":[{x:0,y:0,w:4,h:4}],"▙":[{x:0,y:0,w:4,h:8},{x:0,y:4,w:8,h:4}],"▚":[{x:0,y:0,w:4,h:4},{x:4,y:4,w:4,h:4}],"▛":[{x:0,y:0,w:4,h:8},{x:0,y:0,w:4,h:8}],"▜":[{x:0,y:0,w:8,h:4},{x:4,y:0,w:4,h:8}],"▝":[{x:4,y:0,w:4,h:4}],"▞":[{x:4,y:0,w:4,h:4},{x:0,y:4,w:4,h:4}],"▟":[{x:4,y:0,w:4,h:8},{x:0,y:4,w:8,h:4}],"🭰":[{x:1,y:0,w:1,h:8}],"🭱":[{x:2,y:0,w:1,h:8}],"🭲":[{x:3,y:0,w:1,h:8}],"🭳":[{x:4,y:0,w:1,h:8}],"🭴":[{x:5,y:0,w:1,h:8}],"🭵":[{x:6,y:0,w:1,h:8}],"🭶":[{x:0,y:1,w:8,h:1}],"🭷":[{x:0,y:2,w:8,h:1}],"🭸":[{x:0,y:3,w:8,h:1}],"🭹":[{x:0,y:4,w:8,h:1}],"🭺":[{x:0,y:5,w:8,h:1}],"🭻":[{x:0,y:6,w:8,h:1}],"🭼":[{x:0,y:0,w:1,h:8},{x:0,y:7,w:8,h:1}],"🭽":[{x:0,y:0,w:1,h:8},{x:0,y:0,w:8,h:1}],"🭾":[{x:7,y:0,w:1,h:8},{x:0,y:0,w:8,h:1}],"🭿":[{x:7,y:0,w:1,h:8},{x:0,y:7,w:8,h:1}],"🮀":[{x:0,y:0,w:8,h:1},{x:0,y:7,w:8,h:1}],"🮁":[{x:0,y:0,w:8,h:1},{x:0,y:2,w:8,h:1},{x:0,y:4,w:8,h:1},{x:0,y:7,w:8,h:1}],"🮂":[{x:0,y:0,w:8,h:2}],"🮃":[{x:0,y:0,w:8,h:3}],"🮄":[{x:0,y:0,w:8,h:5}],"🮅":[{x:0,y:0,w:8,h:6}],"🮆":[{x:0,y:0,w:8,h:7}],"🮇":[{x:6,y:0,w:2,h:8}],"🮈":[{x:5,y:0,w:3,h:8}],"🮉":[{x:3,y:0,w:5,h:8}],"🮊":[{x:2,y:0,w:6,h:8}],"🮋":[{x:1,y:0,w:7,h:8}],"🮕":[{x:0,y:0,w:2,h:2},{x:4,y:0,w:2,h:2},{x:2,y:2,w:2,h:2},{x:6,y:2,w:2,h:2},{x:0,y:4,w:2,h:2},{x:4,y:4,w:2,h:2},{x:2,y:6,w:2,h:2},{x:6,y:6,w:2,h:2}],"🮖":[{x:2,y:0,w:2,h:2},{x:6,y:0,w:2,h:2},{x:0,y:2,w:2,h:2},{x:4,y:2,w:2,h:2},{x:2,y:4,w:2,h:2},{x:6,y:4,w:2,h:2},{x:0,y:6,w:2,h:2},{x:4,y:6,w:2,h:2}],"🮗":[{x:0,y:2,w:8,h:2},{x:0,y:6,w:8,h:2}]};var kt={"░":[[1,0,0,0],[0,0,0,0],[0,0,1,0],[0,0,0,0]],"▒":[[1,0],[0,0],[0,1],[0,0]],"▓":[[0,1],[1,1],[1,0],[1,1]]};t.boxDrawingDefinitions={"─":(r={},r[1]="M0,.5 L1,.5",r),"━":(n={},n[3]="M0,.5 L1,.5",n),"│":(o={},o[1]="M.5,0 L.5,1",o),"┃":(s={},s[3]="M.5,0 L.5,1",s),"┌":(a={},a[1]="M0.5,1 L.5,.5 L1,.5",a),"┏":(l={},l[3]="M0.5,1 L.5,.5 L1,.5",l),"┐":(c={},c[1]="M0,.5 L.5,.5 L.5,1",c),"┓":(d={},d[3]="M0,.5 L.5,.5 L.5,1",d),"└":(h={},h[1]="M.5,0 L.5,.5 L1,.5",h),"┗":(p={},p[3]="M.5,0 L.5,.5 L1,.5",p),"┘":(u={},u[1]="M.5,0 L.5,.5 L0,.5",u),"┛":(f={},f[3]="M.5,0 L.5,.5 L0,.5",f),"├":(_={},_[1]="M.5,0 L.5,1 M.5,.5 L1,.5",_),"┣":(g={},g[3]="M.5,0 L.5,1 M.5,.5 L1,.5",g),"┤":(m={},m[1]="M.5,0 L.5,1 M.5,.5 L0,.5",m),"┫":(b={},b[3]="M.5,0 L.5,1 M.5,.5 L0,.5",b),"┬":(y={},y[1]="M0,.5 L1,.5 M.5,.5 L.5,1",y),"┳":(v={},v[3]="M0,.5 L1,.5 M.5,.5 L.5,1",v),"┴":(w={},w[1]="M0,.5 L1,.5 M.5,.5 L.5,0",w),"┻":(x={},x[3]="M0,.5 L1,.5 M.5,.5 L.5,0",x),"┼":(C={},C[1]="M0,.5 L1,.5 M.5,0 L.5,1",C),"╋":(S={},S[3]="M0,.5 L1,.5 M.5,0 L.5,1",S),"╴":(E={},E[1]="M.5,.5 L0,.5",E),"╸":(k={},k[3]="M.5,.5 L0,.5",k),"╵":(L={},L[1]="M.5,.5 L.5,0",L),"╹":(A={},A[3]="M.5,.5 L.5,0",A),"╶":(O={},O[1]="M.5,.5 L1,.5",O),"╺":(M={},M[3]="M.5,.5 L1,.5",M),"╷":(P={},P[1]="M.5,.5 L.5,1",P),"╻":(R={},R[3]="M.5,.5 L.5,1",R),"═":(D={},D[1]=function(e,t){return"M0,"+(.5-t)+" L1,"+(.5-t)+" M0,"+(.5+t)+" L1,"+(.5+t)},D),"║":(T={},T[1]=function(e,t){return"M"+(.5-e)+",0 L"+(.5-e)+",1 M"+(.5+e)+",0 L"+(.5+e)+",1"},T),"╒":(I={},I[1]=function(e,t){return"M.5,1 L.5,"+(.5-t)+" L1,"+(.5-t)+" M.5,"+(.5+t)+" L1,"+(.5+t)},I),"╓":(B={},B[1]=function(e,t){return"M"+(.5-e)+",1 L"+(.5-e)+",.5 L1,.5 M"+(.5+e)+",.5 L"+(.5+e)+",1"},B),"╔":(F={},F[1]=function(e,t){return"M1,"+(.5-t)+" L"+(.5-e)+","+(.5-t)+" L"+(.5-e)+",1 M1,"+(.5+t)+" L"+(.5+e)+","+(.5+t)+" L"+(.5+e)+",1"},F),"╕":(W={},W[1]=function(e,t){return"M0,"+(.5-t)+" L.5,"+(.5-t)+" L.5,1 M0,"+(.5+t)+" L.5,"+(.5+t)},W),"╖":(H={},H[1]=function(e,t){return"M"+(.5+e)+",1 L"+(.5+e)+",.5 L0,.5 M"+(.5-e)+",.5 L"+(.5-e)+",1"},H),"╗":(U={},U[1]=function(e,t){return"M0,"+(.5+t)+" L"+(.5-e)+","+(.5+t)+" L"+(.5-e)+",1 M0,"+(.5-t)+" L"+(.5+e)+","+(.5-t)+" L"+(.5+e)+",1"},U),"╘":(j={},j[1]=function(e,t){return"M.5,0 L.5,"+(.5+t)+" L1,"+(.5+t)+" M.5,"+(.5-t)+" L1,"+(.5-t)},j),"╙":(z={},z[1]=function(e,t){return"M1,.5 L"+(.5-e)+",.5 L"+(.5-e)+",0 M"+(.5+e)+",.5 L"+(.5+e)+",0"},z),"╚":(N={},N[1]=function(e,t){return"M1,"+(.5-t)+" L"+(.5+e)+","+(.5-t)+" L"+(.5+e)+",0 M1,"+(.5+t)+" L"+(.5-e)+","+(.5+t)+" L"+(.5-e)+",0"},N),"╛":(q={},q[1]=function(e,t){return"M0,"+(.5+t)+" L.5,"+(.5+t)+" L.5,0 M0,"+(.5-t)+" L.5,"+(.5-t)},q),"╜":(K={},K[1]=function(e,t){return"M0,.5 L"+(.5+e)+",.5 L"+(.5+e)+",0 M"+(.5-e)+",.5 L"+(.5-e)+",0"},K),"╝":($={},$[1]=function(e,t){return"M0,"+(.5-t)+" L"+(.5-e)+","+(.5-t)+" L"+(.5-e)+",0 M0,"+(.5+t)+" L"+(.5+e)+","+(.5+t)+" L"+(.5+e)+",0"},$),"╞":(V={},V[1]=function(e,t){return"M.5,0 L.5,1 M.5,"+(.5-t)+" L1,"+(.5-t)+" M.5,"+(.5+t)+" L1,"+(.5+t)},V),"╟":(J={},J[1]=function(e,t){return"M"+(.5-e)+",0 L"+(.5-e)+",1 M"+(.5+e)+",0 L"+(.5+e)+",1 M"+(.5+e)+",.5 L1,.5"},J),"╠":(G={},G[1]=function(e,t){return"M"+(.5-e)+",0 L"+(.5-e)+",1 M1,"+(.5+t)+" L"+(.5+e)+","+(.5+t)+" L"+(.5+e)+",1 M1,"+(.5-t)+" L"+(.5+e)+","+(.5-t)+" L"+(.5+e)+",0"},G),"╡":(X={},X[1]=function(e,t){return"M.5,0 L.5,1 M0,"+(.5-t)+" L.5,"+(.5-t)+" M0,"+(.5+t)+" L.5,"+(.5+t)},X),"╢":(Q={},Q[1]=function(e,t){return"M0,.5 L"+(.5-e)+",.5 M"+(.5-e)+",0 L"+(.5-e)+",1 M"+(.5+e)+",0 L"+(.5+e)+",1"},Q),"╣":(Y={},Y[1]=function(e,t){return"M"+(.5+e)+",0 L"+(.5+e)+",1 M0,"+(.5+t)+" L"+(.5-e)+","+(.5+t)+" L"+(.5-e)+",1 M0,"+(.5-t)+" L"+(.5-e)+","+(.5-t)+" L"+(.5-e)+",0"},Y),"╤":(Z={},Z[1]=function(e,t){return"M0,"+(.5-t)+" L1,"+(.5-t)+" M0,"+(.5+t)+" L1,"+(.5+t)+" M.5,"+(.5+t)+" L.5,1"},Z),"╥":(ee={},ee[1]=function(e,t){return"M0,.5 L1,.5 M"+(.5-e)+",.5 L"+(.5-e)+",1 M"+(.5+e)+",.5 L"+(.5+e)+",1"},ee),"╦":(te={},te[1]=function(e,t){return"M0,"+(.5-t)+" L1,"+(.5-t)+" M0,"+(.5+t)+" L"+(.5-e)+","+(.5+t)+" L"+(.5-e)+",1 M1,"+(.5+t)+" L"+(.5+e)+","+(.5+t)+" L"+(.5+e)+",1"},te),"╧":(ie={},ie[1]=function(e,t){return"M.5,0 L.5,"+(.5-t)+" M0,"+(.5-t)+" L1,"+(.5-t)+" M0,"+(.5+t)+" L1,"+(.5+t)},ie),"╨":(re={},re[1]=function(e,t){return"M0,.5 L1,.5 M"+(.5-e)+",.5 L"+(.5-e)+",0 M"+(.5+e)+",.5 L"+(.5+e)+",0"},re),"╩":(ne={},ne[1]=function(e,t){return"M0,"+(.5+t)+" L1,"+(.5+t)+" M0,"+(.5-t)+" L"+(.5-e)+","+(.5-t)+" L"+(.5-e)+",0 M1,"+(.5-t)+" L"+(.5+e)+","+(.5-t)+" L"+(.5+e)+",0"},ne),"╪":(oe={},oe[1]=function(e,t){return"M.5,0 L.5,1 M0,"+(.5-t)+" L1,"+(.5-t)+" M0,"+(.5+t)+" L1,"+(.5+t)},oe),"╫":(se={},se[1]=function(e,t){return"M0,.5 L1,.5 M"+(.5-e)+",0 L"+(.5-e)+",1 M"+(.5+e)+",0 L"+(.5+e)+",1"},se),"╬":(ae={},ae[1]=function(e,t){return"M0,"+(.5+t)+" L"+(.5-e)+","+(.5+t)+" L"+(.5-e)+",1 M1,"+(.5+t)+" L"+(.5+e)+","+(.5+t)+" L"+(.5+e)+",1 M0,"+(.5-t)+" L"+(.5-e)+","+(.5-t)+" L"+(.5-e)+",0 M1,"+(.5-t)+" L"+(.5+e)+","+(.5-t)+" L"+(.5+e)+",0"},ae),"╱":(le={},le[1]="M1,0 L0,1",le),"╲":(ce={},ce[1]="M0,0 L1,1",ce),"╳":(de={},de[1]="M1,0 L0,1 M0,0 L1,1",de),"╼":(he={},he[1]="M.5,.5 L0,.5",he[3]="M.5,.5 L1,.5",he),"╽":(pe={},pe[1]="M.5,.5 L.5,0",pe[3]="M.5,.5 L.5,1",pe),"╾":(ue={},ue[1]="M.5,.5 L1,.5",ue[3]="M.5,.5 L0,.5",ue),"╿":(fe={},fe[1]="M.5,.5 L.5,1",fe[3]="M.5,.5 L.5,0",fe),"┍":(_e={},_e[1]="M.5,.5 L.5,1",_e[3]="M.5,.5 L1,.5",_e),"┎":(ge={},ge[1]="M.5,.5 L1,.5",ge[3]="M.5,.5 L.5,1",ge),"┑":(me={},me[1]="M.5,.5 L.5,1",me[3]="M.5,.5 L0,.5",me),"┒":(be={},be[1]="M.5,.5 L0,.5",be[3]="M.5,.5 L.5,1",be),"┕":(ye={},ye[1]="M.5,.5 L.5,0",ye[3]="M.5,.5 L1,.5",ye),"┖":(ve={},ve[1]="M.5,.5 L1,.5",ve[3]="M.5,.5 L.5,0",ve),"┙":(we={},we[1]="M.5,.5 L.5,0",we[3]="M.5,.5 L0,.5",we),"┚":(xe={},xe[1]="M.5,.5 L0,.5",xe[3]="M.5,.5 L.5,0",xe),"┝":(Ce={},Ce[1]="M.5,0 L.5,1",Ce[3]="M.5,.5 L1,.5",Ce),"┞":(Se={},Se[1]="M0.5,1 L.5,.5 L1,.5",Se[3]="M.5,.5 L.5,0",Se),"┟":(Ee={},Ee[1]="M.5,0 L.5,.5 L1,.5",Ee[3]="M.5,.5 L.5,1",Ee),"┠":(ke={},ke[1]="M.5,.5 L1,.5",ke[3]="M.5,0 L.5,1",ke),"┡":(Le={},Le[1]="M.5,.5 L.5,1",Le[3]="M.5,0 L.5,.5 L1,.5",Le),"┢":(Ae={},Ae[1]="M.5,.5 L.5,0",Ae[3]="M0.5,1 L.5,.5 L1,.5",Ae),"┥":(Oe={},Oe[1]="M.5,0 L.5,1",Oe[3]="M.5,.5 L0,.5",Oe),"┦":(Me={},Me[1]="M0,.5 L.5,.5 L.5,1",Me[3]="M.5,.5 L.5,0",Me),"┧":(Pe={},Pe[1]="M.5,0 L.5,.5 L0,.5",Pe[3]="M.5,.5 L.5,1",Pe),"┨":(Re={},Re[1]="M.5,.5 L0,.5",Re[3]="M.5,0 L.5,1",Re),"┩":(De={},De[1]="M.5,.5 L.5,1",De[3]="M.5,0 L.5,.5 L0,.5",De),"┪":(Te={},Te[1]="M.5,.5 L.5,0",Te[3]="M0,.5 L.5,.5 L.5,1",Te),"┭":(Ie={},Ie[1]="M0.5,1 L.5,.5 L1,.5",Ie[3]="M.5,.5 L0,.5",Ie),"┮":(Be={},Be[1]="M0,.5 L.5,.5 L.5,1",Be[3]="M.5,.5 L1,.5",Be),"┯":(Fe={},Fe[1]="M.5,.5 L.5,1",Fe[3]="M0,.5 L1,.5",Fe),"┰":(We={},We[1]="M0,.5 L1,.5",We[3]="M.5,.5 L.5,1",We),"┱":(He={},He[1]="M.5,.5 L1,.5",He[3]="M0,.5 L.5,.5 L.5,1",He),"┲":(Ue={},Ue[1]="M.5,.5 L0,.5",Ue[3]="M0.5,1 L.5,.5 L1,.5",Ue),"┵":(je={},je[1]="M.5,0 L.5,.5 L1,.5",je[3]="M.5,.5 L0,.5",je),"┶":(ze={},ze[1]="M.5,0 L.5,.5 L0,.5",ze[3]="M.5,.5 L1,.5",ze),"┷":(Ne={},Ne[1]="M.5,.5 L.5,0",Ne[3]="M0,.5 L1,.5",Ne),"┸":(qe={},qe[1]="M0,.5 L1,.5",qe[3]="M.5,.5 L.5,0",qe),"┹":(Ke={},Ke[1]="M.5,.5 L1,.5",Ke[3]="M.5,0 L.5,.5 L0,.5",Ke),"┺":($e={},$e[1]="M.5,.5 L0,.5",$e[3]="M.5,0 L.5,.5 L1,.5",$e),"┽":(Ve={},Ve[1]="M.5,0 L.5,1 M.5,.5 L1,.5",Ve[3]="M.5,.5 L0,.5",Ve),"┾":(Je={},Je[1]="M.5,0 L.5,1 M.5,.5 L0,.5",Je[3]="M.5,.5 L1,.5",Je),"┿":(Ge={},Ge[1]="M.5,0 L.5,1",Ge[3]="M0,.5 L1,.5",Ge),"╀":(Xe={},Xe[1]="M0,.5 L1,.5 M.5,.5 L.5,1",Xe[3]="M.5,.5 L.5,0",Xe),"╁":(Qe={},Qe[1]="M.5,.5 L.5,0 M0,.5 L1,.5",Qe[3]="M.5,.5 L.5,1",Qe),"╂":(Ye={},Ye[1]="M0,.5 L1,.5",Ye[3]="M.5,0 L.5,1",Ye),"╃":(Ze={},Ze[1]="M0.5,1 L.5,.5 L1,.5",Ze[3]="M.5,0 L.5,.5 L0,.5",Ze),"╄":(et={},et[1]="M0,.5 L.5,.5 L.5,1",et[3]="M.5,0 L.5,.5 L1,.5",et),"╅":(tt={},tt[1]="M.5,0 L.5,.5 L1,.5",tt[3]="M0,.5 L.5,.5 L.5,1",tt),"╆":(it={},it[1]="M.5,0 L.5,.5 L0,.5",it[3]="M0.5,1 L.5,.5 L1,.5",it),"╇":(rt={},rt[1]="M.5,.5 L.5,1",rt[3]="M.5,.5 L.5,0 M0,.5 L1,.5",rt),"╈":(nt={},nt[1]="M.5,.5 L.5,0",nt[3]="M0,.5 L1,.5 M.5,.5 L.5,1",nt),"╉":(ot={},ot[1]="M.5,.5 L1,.5",ot[3]="M.5,0 L.5,1 M.5,.5 L0,.5",ot),"╊":(st={},st[1]="M.5,.5 L0,.5",st[3]="M.5,0 L.5,1 M.5,.5 L1,.5",st),"╌":(at={},at[1]="M.1,.5 L.4,.5 M.6,.5 L.9,.5",at),"╍":(lt={},lt[3]="M.1,.5 L.4,.5 M.6,.5 L.9,.5",lt),"┄":(ct={},ct[1]="M.0667,.5 L.2667,.5 M.4,.5 L.6,.5 M.7333,.5 L.9333,.5",ct),"┅":(dt={},dt[3]="M.0667,.5 L.2667,.5 M.4,.5 L.6,.5 M.7333,.5 L.9333,.5",dt),"┈":(ht={},ht[1]="M.05,.5 L.2,.5 M.3,.5 L.45,.5 M.55,.5 L.7,.5 M.8,.5 L.95,.5",ht),"┉":(pt={},pt[3]="M.05,.5 L.2,.5 M.3,.5 L.45,.5 M.55,.5 L.7,.5 M.8,.5 L.95,.5",pt),"╎":(ut={},ut[1]="M.5,.1 L.5,.4 M.5,.6 L.5,.9",ut),"╏":(ft={},ft[3]="M.5,.1 L.5,.4 M.5,.6 L.5,.9",ft),"┆":(_t={},_t[1]="M.5,.0667 L.5,.2667 M.5,.4 L.5,.6 M.5,.7333 L.5,.9333",_t),"┇":(gt={},gt[3]="M.5,.0667 L.5,.2667 M.5,.4 L.5,.6 M.5,.7333 L.5,.9333",gt),"┊":(mt={},mt[1]="M.5,.05 L.5,.2 M.5,.3 L.5,.45 L.5,.55 M.5,.7 L.5,.95",mt),"┋":(bt={},bt[3]="M.5,.05 L.5,.2 M.5,.3 L.5,.45 L.5,.55 M.5,.7 L.5,.95",bt),"╭":(yt={},yt[1]="C.5,1,.5,.5,1,.5",yt),"╮":(vt={},vt[1]="C.5,1,.5,.5,0,.5",vt),"╯":(wt={},wt[1]="C.5,0,.5,.5,0,.5",wt),"╰":(xt={},xt[1]="C.5,0,.5,.5,1,.5",xt)},t.powerlineDefinitions={"":{d:"M0,0 L1,.5 L0,1",type:0},"":{d:"M0,0 L1,.5 L0,1",type:1,horizontalPadding:.5},"":{d:"M1,0 L0,.5 L1,1",type:0},"":{d:"M1,0 L0,.5 L1,1",type:1,horizontalPadding:.5}},t.tryDrawCustomChar=function(e,i,r,n,o,s){var a=t.blockElementDefinitions[i];if(a)return function(e,t,i,r,n,o){for(var s=0;s<t.length;s++){var a=t[s],l=n/8,c=o/8;e.fillRect(i+a.x*l,r+a.y*c,a.w*l,a.h*c)}}(e,a,r,n,o,s),!0;var l=kt[i];if(l)return function(e,t,i,r,n,o){var s,a=Lt.get(t);a||(a=new Map,Lt.set(t,a));var l=e.fillStyle;if("string"!=typeof l)throw new Error('Unexpected fillStyle type "'+l+'"');var c=a.get(l);if(!c){var d=t[0].length,h=t.length,p=document.createElement("canvas");p.width=d,p.height=h;var u=(0,Et.throwIfFalsy)(p.getContext("2d")),f=new ImageData(d,h),_=void 0,g=void 0,m=void 0,b=void 0;if(l.startsWith("#"))_=parseInt(l.slice(1,3),16),g=parseInt(l.slice(3,5),16),m=parseInt(l.slice(5,7),16),b=l.length>7&&parseInt(l.slice(7,9),16)||1;else{if(!l.startsWith("rgba"))throw new Error('Unexpected fillStyle color format "'+l+'" when drawing pattern glyph');_=(s=Ct(l.substring(5,l.length-1).split(",").map((function(e){return parseFloat(e)})),4))[0],g=s[1],m=s[2],b=s[3]}for(var y=0;y<h;y++)for(var v=0;v<d;v++)f.data[4*(y*d+v)]=_,f.data[4*(y*d+v)+1]=g,f.data[4*(y*d+v)+2]=m,f.data[4*(y*d+v)+3]=t[y][v]*(255*b);u.putImageData(f,0,0),c=(0,Et.throwIfFalsy)(e.createPattern(p,null)),a.set(l,c)}e.fillStyle=c,e.fillRect(i,r,n,o)}(e,l,r,n,o,s),!0;var c=t.boxDrawingDefinitions[i];if(c)return function(e,t,i,r,n,o){var s,a,l,c;e.strokeStyle=e.fillStyle;try{for(var d=St(Object.entries(t)),h=d.next();!h.done;h=d.next()){var p=Ct(h.value,2),u=p[0],f=p[1];e.beginPath(),e.lineWidth=window.devicePixelRatio*Number.parseInt(u);var _=void 0;_="function"==typeof f?f(.15,.15/o*n):f;try{for(var g=(l=void 0,St(_.split(" "))),m=g.next();!m.done;m=g.next()){var b=m.value,y=b[0],v=Ot[y];if(v){var w=b.substring(1).split(",");w[0]&&w[1]&&v(e,Mt(w,n,o,i,r))}else console.error('Could not find drawing instructions for "'+y+'"')}}catch(e){l={error:e}}finally{try{m&&!m.done&&(c=g.return)&&c.call(g)}finally{if(l)throw l.error}}e.stroke(),e.closePath()}}catch(e){s={error:e}}finally{try{h&&!h.done&&(a=d.return)&&a.call(d)}finally{if(s)throw s.error}}}(e,c,r,n,o,s),!0;var d=t.powerlineDefinitions[i];return!!d&&(function(e,t,i,r,n,o){var s,a;e.beginPath(),e.lineWidth=window.devicePixelRatio;try{for(var l=St(t.d.split(" ")),c=l.next();!c.done;c=l.next()){var d=c.value,h=d[0],p=Ot[h];if(p){var u=d.substring(1).split(",");u[0]&&u[1]&&p(e,Mt(u,n,o,i,r,t.horizontalPadding))}else console.error('Could not find drawing instructions for "'+h+'"')}}catch(e){s={error:e}}finally{try{c&&!c.done&&(a=l.return)&&a.call(l)}finally{if(s)throw s.error}}1===t.type?(e.strokeStyle=e.fillStyle,e.stroke()):e.fill(),e.closePath()}(e,d,r,n,o,s),!0)};var Lt=new Map;function At(e,t,i){return void 0===i&&(i=0),Math.max(Math.min(e,t),i)}var Ot={C:function(e,t){return e.bezierCurveTo(t[0],t[1],t[2],t[3],t[4],t[5])},L:function(e,t){return e.lineTo(t[0],t[1])},M:function(e,t){return e.moveTo(t[0],t[1])}};function Mt(e,t,i,r,n,o){void 0===o&&(o=0);var s=e.map((function(e){return parseFloat(e)||parseInt(e)}));if(s.length<2)throw new Error("Too few arguments for instruction");for(var a=0;a<s.length;a+=2)s[a]*=t-2*o*window.devicePixelRatio,0!==s[a]&&(s[a]=At(Math.round(s[a]+.5)-.5,t,0)),s[a]+=r+o*window.devicePixelRatio;for(var l=1;l<s.length;l+=2)s[l]*=i,0!==s[l]&&(s[l]=At(Math.round(s[l]+.5)-.5,i,0)),s[l]+=n;return s}},3700:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.GridCache=void 0;var i=function(){function e(){this.cache=[]}return e.prototype.resize=function(e,t){for(var i=0;i<e;i++){this.cache.length<=i&&this.cache.push([]);for(var r=this.cache[i].length;r<t;r++)this.cache[i].push(void 0);this.cache[i].length=t}this.cache.length=e},e.prototype.clear=function(){for(var e=0;e<this.cache.length;e++)for(var t=0;t<this.cache[e].length;t++)this.cache[e][t]=void 0},e}();t.GridCache=i},5098:function(e,t,i){var r,n=this&&this.__extends||(r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])},r(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function i(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),o=this&&this.__decorate||function(e,t,i,r){var n,o=arguments.length,s=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,r);else for(var a=e.length-1;a>=0;a--)(n=e[a])&&(s=(o<3?n(s):o>3?n(t,i,s):n(t,i))||s);return o>3&&s&&Object.defineProperty(t,i,s),s},s=this&&this.__param||function(e,t){return function(i,r){t(i,r,e)}};Object.defineProperty(t,"__esModule",{value:!0}),t.LinkRenderLayer=void 0;var a=i(1546),l=i(8803),c=i(2040),d=i(2585),h=function(e){function t(t,i,r,n,o,s,a,l,c){var d=e.call(this,t,"link",i,!0,r,n,a,l,c)||this;return o.onShowLinkUnderline((function(e){return d._onShowLinkUnderline(e)})),o.onHideLinkUnderline((function(e){return d._onHideLinkUnderline(e)})),s.onShowLinkUnderline((function(e){return d._onShowLinkUnderline(e)})),s.onHideLinkUnderline((function(e){return d._onHideLinkUnderline(e)})),d}return n(t,e),t.prototype.resize=function(t){e.prototype.resize.call(this,t),this._state=void 0},t.prototype.reset=function(){this._clearCurrentLink()},t.prototype._clearCurrentLink=function(){if(this._state){this._clearCells(this._state.x1,this._state.y1,this._state.cols-this._state.x1,1);var e=this._state.y2-this._state.y1-1;e>0&&this._clearCells(0,this._state.y1+1,this._state.cols,e),this._clearCells(0,this._state.y2,this._state.x2,1),this._state=void 0}},t.prototype._onShowLinkUnderline=function(e){if(e.fg===l.INVERTED_DEFAULT_COLOR?this._ctx.fillStyle=this._colors.background.css:e.fg&&(0,c.is256Color)(e.fg)?this._ctx.fillStyle=this._colors.ansi[e.fg].css:this._ctx.fillStyle=this._colors.foreground.css,e.y1===e.y2)this._fillBottomLineAtCells(e.x1,e.y1,e.x2-e.x1);else{this._fillBottomLineAtCells(e.x1,e.y1,e.cols-e.x1);for(var t=e.y1+1;t<e.y2;t++)this._fillBottomLineAtCells(0,t,e.cols);this._fillBottomLineAtCells(0,e.y2,e.x2)}this._state=e},t.prototype._onHideLinkUnderline=function(e){this._clearCurrentLink()},o([s(6,d.IBufferService),s(7,d.IOptionsService),s(8,d.IDecorationService)],t)}(a.BaseRenderLayer);t.LinkRenderLayer=h},3525:function(e,t,i){var r,n=this&&this.__extends||(r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])},r(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function i(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),o=this&&this.__decorate||function(e,t,i,r){var n,o=arguments.length,s=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,r);else for(var a=e.length-1;a>=0;a--)(n=e[a])&&(s=(o<3?n(s):o>3?n(t,i,s):n(t,i))||s);return o>3&&s&&Object.defineProperty(t,i,s),s},s=this&&this.__param||function(e,t){return function(i,r){t(i,r,e)}},a=this&&this.__values||function(e){var t="function"==typeof Symbol&&Symbol.iterator,i=t&&e[t],r=0;if(i)return i.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(t,"__esModule",{value:!0}),t.Renderer=void 0;var l=i(9596),c=i(4149),d=i(2512),h=i(5098),p=i(844),u=i(4725),f=i(2585),_=i(1420),g=i(8460),m=1,b=function(e){function t(t,i,r,n,o,s,a,p){var u=e.call(this)||this;u._colors=t,u._screenElement=i,u._bufferService=s,u._charSizeService=a,u._optionsService=p,u._id=m++,u._onRequestRedraw=new g.EventEmitter;var f=u._optionsService.rawOptions.allowTransparency;return u._renderLayers=[o.createInstance(l.TextRenderLayer,u._screenElement,0,u._colors,f,u._id),o.createInstance(c.SelectionRenderLayer,u._screenElement,1,u._colors,u._id),o.createInstance(h.LinkRenderLayer,u._screenElement,2,u._colors,u._id,r,n),o.createInstance(d.CursorRenderLayer,u._screenElement,3,u._colors,u._id,u._onRequestRedraw)],u.dimensions={scaledCharWidth:0,scaledCharHeight:0,scaledCellWidth:0,scaledCellHeight:0,scaledCharLeft:0,scaledCharTop:0,scaledCanvasWidth:0,scaledCanvasHeight:0,canvasWidth:0,canvasHeight:0,actualCellWidth:0,actualCellHeight:0},u._devicePixelRatio=window.devicePixelRatio,u._updateDimensions(),u.onOptionsChanged(),u}return n(t,e),Object.defineProperty(t.prototype,"onRequestRedraw",{get:function(){return this._onRequestRedraw.event},enumerable:!1,configurable:!0}),t.prototype.dispose=function(){var t,i;try{for(var r=a(this._renderLayers),n=r.next();!n.done;n=r.next())n.value.dispose()}catch(e){t={error:e}}finally{try{n&&!n.done&&(i=r.return)&&i.call(r)}finally{if(t)throw t.error}}e.prototype.dispose.call(this),(0,_.removeTerminalFromCache)(this._id)},t.prototype.onDevicePixelRatioChange=function(){this._devicePixelRatio!==window.devicePixelRatio&&(this._devicePixelRatio=window.devicePixelRatio,this.onResize(this._bufferService.cols,this._bufferService.rows))},t.prototype.setColors=function(e){var t,i;this._colors=e;try{for(var r=a(this._renderLayers),n=r.next();!n.done;n=r.next()){var o=n.value;o.setColors(this._colors),o.reset()}}catch(e){t={error:e}}finally{try{n&&!n.done&&(i=r.return)&&i.call(r)}finally{if(t)throw t.error}}},t.prototype.onResize=function(e,t){var i,r;this._updateDimensions();try{for(var n=a(this._renderLayers),o=n.next();!o.done;o=n.next())o.value.resize(this.dimensions)}catch(e){i={error:e}}finally{try{o&&!o.done&&(r=n.return)&&r.call(n)}finally{if(i)throw i.error}}this._screenElement.style.width=this.dimensions.canvasWidth+"px",this._screenElement.style.height=this.dimensions.canvasHeight+"px"},t.prototype.onCharSizeChanged=function(){this.onResize(this._bufferService.cols,this._bufferService.rows)},t.prototype.onBlur=function(){this._runOperation((function(e){return e.onBlur()}))},t.prototype.onFocus=function(){this._runOperation((function(e){return e.onFocus()}))},t.prototype.onSelectionChanged=function(e,t,i){void 0===i&&(i=!1),this._runOperation((function(r){return r.onSelectionChanged(e,t,i)})),this._colors.selectionForeground&&this._onRequestRedraw.fire({start:0,end:this._bufferService.rows-1})},t.prototype.onCursorMove=function(){this._runOperation((function(e){return e.onCursorMove()}))},t.prototype.onOptionsChanged=function(){this._runOperation((function(e){return e.onOptionsChanged()}))},t.prototype.clear=function(){this._runOperation((function(e){return e.reset()}))},t.prototype._runOperation=function(e){var t,i;try{for(var r=a(this._renderLayers),n=r.next();!n.done;n=r.next())e(n.value)}catch(e){t={error:e}}finally{try{n&&!n.done&&(i=r.return)&&i.call(r)}finally{if(t)throw t.error}}},t.prototype.renderRows=function(e,t){var i,r;try{for(var n=a(this._renderLayers),o=n.next();!o.done;o=n.next())o.value.onGridChanged(e,t)}catch(e){i={error:e}}finally{try{o&&!o.done&&(r=n.return)&&r.call(n)}finally{if(i)throw i.error}}},t.prototype.clearTextureAtlas=function(){var e,t;try{for(var i=a(this._renderLayers),r=i.next();!r.done;r=i.next())r.value.clearTextureAtlas()}catch(t){e={error:t}}finally{try{r&&!r.done&&(t=i.return)&&t.call(i)}finally{if(e)throw e.error}}},t.prototype._updateDimensions=function(){this._charSizeService.hasValidSize&&(this.dimensions.scaledCharWidth=Math.floor(this._charSizeService.width*window.devicePixelRatio),this.dimensions.scaledCharHeight=Math.ceil(this._charSizeService.height*window.devicePixelRatio),this.dimensions.scaledCellHeight=Math.floor(this.dimensions.scaledCharHeight*this._optionsService.rawOptions.lineHeight),this.dimensions.scaledCharTop=1===this._optionsService.rawOptions.lineHeight?0:Math.round((this.dimensions.scaledCellHeight-this.dimensions.scaledCharHeight)/2),this.dimensions.scaledCellWidth=this.dimensions.scaledCharWidth+Math.round(this._optionsService.rawOptions.letterSpacing),this.dimensions.scaledCharLeft=Math.floor(this._optionsService.rawOptions.letterSpacing/2),this.dimensions.scaledCanvasHeight=this._bufferService.rows*this.dimensions.scaledCellHeight,this.dimensions.scaledCanvasWidth=this._bufferService.cols*this.dimensions.scaledCellWidth,this.dimensions.canvasHeight=Math.round(this.dimensions.scaledCanvasHeight/window.devicePixelRatio),this.dimensions.canvasWidth=Math.round(this.dimensions.scaledCanvasWidth/window.devicePixelRatio),this.dimensions.actualCellHeight=this.dimensions.canvasHeight/this._bufferService.rows,this.dimensions.actualCellWidth=this.dimensions.canvasWidth/this._bufferService.cols)},o([s(4,f.IInstantiationService),s(5,f.IBufferService),s(6,u.ICharSizeService),s(7,f.IOptionsService)],t)}(p.Disposable);t.Renderer=b},1752:(e,t)=>{function i(e){return 57508<=e&&e<=57558}Object.defineProperty(t,"__esModule",{value:!0}),t.excludeFromContrastRatioDemands=t.isPowerlineGlyph=t.throwIfFalsy=void 0,t.throwIfFalsy=function(e){if(!e)throw new Error("value must not be falsy");return e},t.isPowerlineGlyph=i,t.excludeFromContrastRatioDemands=function(e){return i(e)||function(e){return 9472<=e&&e<=9631}(e)}},4149:function(e,t,i){var r,n=this&&this.__extends||(r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])},r(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function i(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),o=this&&this.__decorate||function(e,t,i,r){var n,o=arguments.length,s=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,r);else for(var a=e.length-1;a>=0;a--)(n=e[a])&&(s=(o<3?n(s):o>3?n(t,i,s):n(t,i))||s);return o>3&&s&&Object.defineProperty(t,i,s),s},s=this&&this.__param||function(e,t){return function(i,r){t(i,r,e)}};Object.defineProperty(t,"__esModule",{value:!0}),t.SelectionRenderLayer=void 0;var a=i(1546),l=i(2585),c=function(e){function t(t,i,r,n,o,s,a){var l=e.call(this,t,"selection",i,!0,r,n,o,s,a)||this;return l._clearState(),l}return n(t,e),t.prototype._clearState=function(){this._state={start:void 0,end:void 0,columnSelectMode:void 0,ydisp:void 0}},t.prototype.resize=function(t){e.prototype.resize.call(this,t),this._clearState()},t.prototype.reset=function(){this._state.start&&this._state.end&&(this._clearState(),this._clearAll())},t.prototype.onSelectionChanged=function(t,i,r){if(e.prototype.onSelectionChanged.call(this,t,i,r),this._didStateChange(t,i,r,this._bufferService.buffer.ydisp))if(this._clearAll(),t&&i){var n=t[1]-this._bufferService.buffer.ydisp,o=i[1]-this._bufferService.buffer.ydisp,s=Math.max(n,0),a=Math.min(o,this._bufferService.rows-1);if(s>=this._bufferService.rows||a<0)this._state.ydisp=this._bufferService.buffer.ydisp;else{if(this._ctx.fillStyle=this._colors.selectionTransparent.css,r){var l=t[0],c=i[0]-l,d=a-s+1;this._fillCells(l,s,c,d)}else{l=n===s?t[0]:0;var h=s===o?i[0]:this._bufferService.cols;this._fillCells(l,s,h-l,1);var p=Math.max(a-s-1,0);if(this._fillCells(0,s+1,this._bufferService.cols,p),s!==a){var u=o===a?i[0]:this._bufferService.cols;this._fillCells(0,a,u,1)}}this._state.start=[t[0],t[1]],this._state.end=[i[0],i[1]],this._state.columnSelectMode=r,this._state.ydisp=this._bufferService.buffer.ydisp}}else this._clearState()},t.prototype._didStateChange=function(e,t,i,r){return!this._areCoordinatesEqual(e,this._state.start)||!this._areCoordinatesEqual(t,this._state.end)||i!==this._state.columnSelectMode||r!==this._state.ydisp},t.prototype._areCoordinatesEqual=function(e,t){return!(!e||!t)&&e[0]===t[0]&&e[1]===t[1]},o([s(4,l.IBufferService),s(5,l.IOptionsService),s(6,l.IDecorationService)],t)}(a.BaseRenderLayer);t.SelectionRenderLayer=c},9596:function(e,t,i){var r,n=this&&this.__extends||(r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])},r(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function i(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),o=this&&this.__decorate||function(e,t,i,r){var n,o=arguments.length,s=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,r);else for(var a=e.length-1;a>=0;a--)(n=e[a])&&(s=(o<3?n(s):o>3?n(t,i,s):n(t,i))||s);return o>3&&s&&Object.defineProperty(t,i,s),s},s=this&&this.__param||function(e,t){return function(i,r){t(i,r,e)}},a=this&&this.__values||function(e){var t="function"==typeof Symbol&&Symbol.iterator,i=t&&e[t],r=0;if(i)return i.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(t,"__esModule",{value:!0}),t.TextRenderLayer=void 0;var l=i(3700),c=i(1546),d=i(3734),h=i(643),p=i(511),u=i(2585),f=i(4725),_=i(4269),g=function(e){function t(t,i,r,n,o,s,a,c,d){var h=e.call(this,t,"text",i,n,r,o,s,a,d)||this;return h._characterJoinerService=c,h._characterWidth=0,h._characterFont="",h._characterOverlapCache={},h._workCell=new p.CellData,h._state=new l.GridCache,h}return n(t,e),t.prototype.resize=function(t){e.prototype.resize.call(this,t);var i=this._getFont(!1,!1);this._characterWidth===t.scaledCharWidth&&this._characterFont===i||(this._characterWidth=t.scaledCharWidth,this._characterFont=i,this._characterOverlapCache={}),this._state.clear(),this._state.resize(this._bufferService.cols,this._bufferService.rows)},t.prototype.reset=function(){this._state.clear(),this._clearAll()},t.prototype._forEachCell=function(e,t,i){for(var r=e;r<=t;r++)for(var n=r+this._bufferService.buffer.ydisp,o=this._bufferService.buffer.lines.get(n),s=this._characterJoinerService.getJoinedCharacters(n),a=0;a<this._bufferService.cols;a++){o.loadCell(a,this._workCell);var l=this._workCell,c=!1,d=a;if(0!==l.getWidth()){if(s.length>0&&a===s[0][0]){c=!0;var p=s.shift();l=new _.JoinedCellData(this._workCell,o.translateToString(!0,p[0],p[1]),p[1]-p[0]),d=p[1]-1}!c&&this._isOverlapping(l)&&d<o.length-1&&o.getCodePoint(d+1)===h.NULL_CELL_CODE&&(l.content&=-12582913,l.content|=2<<22),i(l,a,r),a=d}}},t.prototype._drawBackground=function(e,t){var i=this,r=this._ctx,n=this._bufferService.cols,o=0,s=0,l=null;r.save(),this._forEachCell(e,t,(function(e,t,c){var h,p,u=null;e.isInverse()?u=e.isFgDefault()?i._colors.foreground.css:e.isFgRGB()?"rgb("+d.AttributeData.toColorRGB(e.getFgColor()).join(",")+")":i._colors.ansi[e.getFgColor()].css:e.isBgRGB()?u="rgb("+d.AttributeData.toColorRGB(e.getBgColor()).join(",")+")":e.isBgPalette()&&(u=i._colors.ansi[e.getBgColor()].css);var f=!1;try{for(var _=a(i._decorationService.getDecorationsAtCell(t,i._bufferService.buffer.ydisp+c)),g=_.next();!g.done;g=_.next()){var m=g.value;"top"!==m.options.layer&&f||(m.backgroundColorRGB&&(u=m.backgroundColorRGB.css),f="top"===m.options.layer)}}catch(e){h={error:e}}finally{try{g&&!g.done&&(p=_.return)&&p.call(_)}finally{if(h)throw h.error}}null===l&&(o=t,s=c),c!==s?(r.fillStyle=l||"",i._fillCells(o,s,n-o,1),o=t,s=c):l!==u&&(r.fillStyle=l||"",i._fillCells(o,s,t-o,1),o=t,s=c),l=u})),null!==l&&(r.fillStyle=l,this._fillCells(o,s,n-o,1)),r.restore()},t.prototype._drawForeground=function(e,t){var i=this;this._forEachCell(e,t,(function(e,t,r){if(!e.isInvisible()&&(i._drawChars(e,t,r),e.isUnderline()||e.isStrikethrough())){if(i._ctx.save(),e.isInverse())if(e.isBgDefault())i._ctx.fillStyle=i._colors.background.css;else if(e.isBgRGB())i._ctx.fillStyle="rgb("+d.AttributeData.toColorRGB(e.getBgColor()).join(",")+")";else{var n=e.getBgColor();i._optionsService.rawOptions.drawBoldTextInBrightColors&&e.isBold()&&n<8&&(n+=8),i._ctx.fillStyle=i._colors.ansi[n].css}else if(e.isFgDefault())i._ctx.fillStyle=i._colors.foreground.css;else if(e.isFgRGB())i._ctx.fillStyle="rgb("+d.AttributeData.toColorRGB(e.getFgColor()).join(",")+")";else{var o=e.getFgColor();i._optionsService.rawOptions.drawBoldTextInBrightColors&&e.isBold()&&o<8&&(o+=8),i._ctx.fillStyle=i._colors.ansi[o].css}e.isStrikethrough()&&i._fillMiddleLineAtCells(t,r,e.getWidth()),e.isUnderline()&&i._fillBottomLineAtCells(t,r,e.getWidth()),i._ctx.restore()}}))},t.prototype.onGridChanged=function(e,t){0!==this._state.cache.length&&(this._charAtlas&&this._charAtlas.beginFrame(),this._clearCells(0,e,this._bufferService.cols,t-e+1),this._drawBackground(e,t),this._drawForeground(e,t))},t.prototype.onOptionsChanged=function(){this._setTransparency(this._optionsService.rawOptions.allowTransparency)},t.prototype._isOverlapping=function(e){if(1!==e.getWidth())return!1;if(e.getCode()<256)return!1;var t=e.getChars();if(this._characterOverlapCache.hasOwnProperty(t))return this._characterOverlapCache[t];this._ctx.save(),this._ctx.font=this._characterFont;var i=Math.floor(this._ctx.measureText(t).width)>this._characterWidth;return this._ctx.restore(),this._characterOverlapCache[t]=i,i},o([s(5,u.IBufferService),s(6,u.IOptionsService),s(7,f.ICharacterJoinerService),s(8,u.IDecorationService)],t)}(c.BaseRenderLayer);t.TextRenderLayer=g},9616:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.BaseCharAtlas=void 0;var i=function(){function e(){this._didWarmUp=!1}return e.prototype.dispose=function(){},e.prototype.warmUp=function(){this._didWarmUp||(this._doWarmUp(),this._didWarmUp=!0)},e.prototype._doWarmUp=function(){},e.prototype.clear=function(){},e.prototype.beginFrame=function(){},e}();t.BaseCharAtlas=i},1420:(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.removeTerminalFromCache=t.acquireCharAtlas=void 0;var r=i(2040),n=i(1906),o=[];t.acquireCharAtlas=function(e,t,i,s,a){for(var l=(0,r.generateConfig)(s,a,e,i),c=0;c<o.length;c++){var d=(h=o[c]).ownedBy.indexOf(t);if(d>=0){if((0,r.configEquals)(h.config,l))return h.atlas;1===h.ownedBy.length?(h.atlas.dispose(),o.splice(c,1)):h.ownedBy.splice(d,1);break}}for(c=0;c<o.length;c++){var h=o[c];if((0,r.configEquals)(h.config,l))return h.ownedBy.push(t),h.atlas}var p={atlas:new n.DynamicCharAtlas(document,l),config:l,ownedBy:[t]};return o.push(p),p.atlas},t.removeTerminalFromCache=function(e){for(var t=0;t<o.length;t++){var i=o[t].ownedBy.indexOf(e);if(-1!==i){1===o[t].ownedBy.length?(o[t].atlas.dispose(),o.splice(t,1)):o[t].ownedBy.splice(i,1);break}}}},2040:(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.is256Color=t.configEquals=t.generateConfig=void 0;var r=i(643);t.generateConfig=function(e,t,i,r){var n={foreground:r.foreground,background:r.background,cursor:void 0,cursorAccent:void 0,selection:void 0,ansi:r.ansi.slice()};return{devicePixelRatio:window.devicePixelRatio,scaledCharWidth:e,scaledCharHeight:t,fontFamily:i.fontFamily,fontSize:i.fontSize,fontWeight:i.fontWeight,fontWeightBold:i.fontWeightBold,allowTransparency:i.allowTransparency,colors:n}},t.configEquals=function(e,t){for(var i=0;i<e.colors.ansi.length;i++)if(e.colors.ansi[i].rgba!==t.colors.ansi[i].rgba)return!1;return e.devicePixelRatio===t.devicePixelRatio&&e.fontFamily===t.fontFamily&&e.fontSize===t.fontSize&&e.fontWeight===t.fontWeight&&e.fontWeightBold===t.fontWeightBold&&e.allowTransparency===t.allowTransparency&&e.scaledCharWidth===t.scaledCharWidth&&e.scaledCharHeight===t.scaledCharHeight&&e.colors.foreground===t.colors.foreground&&e.colors.background===t.colors.background},t.is256Color=function(e){return e<r.DEFAULT_COLOR}},8803:(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.CHAR_ATLAS_CELL_SPACING=t.TEXT_BASELINE=t.DIM_OPACITY=t.INVERTED_DEFAULT_COLOR=void 0;var r=i(6114);t.INVERTED_DEFAULT_COLOR=257,t.DIM_OPACITY=.5,t.TEXT_BASELINE=r.isFirefox||r.isLegacyEdge?"bottom":"ideographic",t.CHAR_ATLAS_CELL_SPACING=1},1906:function(e,t,i){var r,n=this&&this.__extends||(r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])},r(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function i(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)});Object.defineProperty(t,"__esModule",{value:!0}),t.NoneCharAtlas=t.DynamicCharAtlas=t.getGlyphCacheKey=void 0;var o=i(8803),s=i(9616),a=i(5680),l=i(7001),c=i(6114),d=i(1752),h=i(8055),p=1024,u=1024,f={css:"rgba(0, 0, 0, 0)",rgba:0};function _(e){return e.code<<21|e.bg<<12|e.fg<<3|(e.bold?0:4)+(e.dim?0:2)+(e.italic?0:1)}t.getGlyphCacheKey=_;var g=function(e){function t(t,i){var r=e.call(this)||this;r._config=i,r._drawToCacheCount=0,r._glyphsWaitingOnBitmap=[],r._bitmapCommitTimeout=null,r._bitmap=null,r._cacheCanvas=t.createElement("canvas"),r._cacheCanvas.width=p,r._cacheCanvas.height=u,r._cacheCtx=(0,d.throwIfFalsy)(r._cacheCanvas.getContext("2d",{alpha:!0}));var n=t.createElement("canvas");n.width=r._config.scaledCharWidth,n.height=r._config.scaledCharHeight,r._tmpCtx=(0,d.throwIfFalsy)(n.getContext("2d",{alpha:r._config.allowTransparency})),r._width=Math.floor(p/r._config.scaledCharWidth),r._height=Math.floor(u/r._config.scaledCharHeight);var o=r._width*r._height;return r._cacheMap=new l.LRUMap(o),r._cacheMap.prealloc(o),r}return n(t,e),t.prototype.dispose=function(){null!==this._bitmapCommitTimeout&&(window.clearTimeout(this._bitmapCommitTimeout),this._bitmapCommitTimeout=null)},t.prototype.beginFrame=function(){this._drawToCacheCount=0},t.prototype.clear=function(){if(this._cacheMap.size>0){var e=this._width*this._height;this._cacheMap=new l.LRUMap(e),this._cacheMap.prealloc(e)}this._cacheCtx.clearRect(0,0,p,u),this._tmpCtx.clearRect(0,0,this._config.scaledCharWidth,this._config.scaledCharHeight)},t.prototype.draw=function(e,t,i,r){if(32===t.code)return!0;if(!this._canCache(t))return!1;var n=_(t),o=this._cacheMap.get(n);if(null!=o)return this._drawFromCache(e,o,i,r),!0;if(this._drawToCacheCount<100){var s;s=this._cacheMap.size<this._cacheMap.capacity?this._cacheMap.size:this._cacheMap.peek().index;var a=this._drawToCache(t,s);return this._cacheMap.set(n,a),this._drawFromCache(e,a,i,r),!0}return!1},t.prototype._canCache=function(e){return e.code<256},t.prototype._toCoordinateX=function(e){return e%this._width*this._config.scaledCharWidth},t.prototype._toCoordinateY=function(e){return Math.floor(e/this._width)*this._config.scaledCharHeight},t.prototype._drawFromCache=function(e,t,i,r){if(!t.isEmpty){var n=this._toCoordinateX(t.index),o=this._toCoordinateY(t.index);e.drawImage(t.inBitmap?this._bitmap:this._cacheCanvas,n,o,this._config.scaledCharWidth,this._config.scaledCharHeight,i,r,this._config.scaledCharWidth,this._config.scaledCharHeight)}},t.prototype._getColorFromAnsiIndex=function(e){return e<this._config.colors.ansi.length?this._config.colors.ansi[e]:a.DEFAULT_ANSI_COLORS[e]},t.prototype._getBackgroundColor=function(e){return this._config.allowTransparency?f:e.bg===o.INVERTED_DEFAULT_COLOR?this._config.colors.foreground:e.bg<256?this._getColorFromAnsiIndex(e.bg):this._config.colors.background},t.prototype._getForegroundColor=function(e){return e.fg===o.INVERTED_DEFAULT_COLOR?h.color.opaque(this._config.colors.background):e.fg<256?this._getColorFromAnsiIndex(e.fg):this._config.colors.foreground},t.prototype._drawToCache=function(e,t){this._drawToCacheCount++,this._tmpCtx.save();var i=this._getBackgroundColor(e);this._tmpCtx.globalCompositeOperation="copy",this._tmpCtx.fillStyle=i.css,this._tmpCtx.fillRect(0,0,this._config.scaledCharWidth,this._config.scaledCharHeight),this._tmpCtx.globalCompositeOperation="source-over";var r=e.bold?this._config.fontWeightBold:this._config.fontWeight,n=e.italic?"italic":"";this._tmpCtx.font=n+" "+r+" "+this._config.fontSize*this._config.devicePixelRatio+"px "+this._config.fontFamily,this._tmpCtx.textBaseline=o.TEXT_BASELINE,this._tmpCtx.fillStyle=this._getForegroundColor(e).css,e.dim&&(this._tmpCtx.globalAlpha=o.DIM_OPACITY),this._tmpCtx.fillText(e.chars,0,this._config.scaledCharHeight);var s=this._tmpCtx.getImageData(0,0,this._config.scaledCharWidth,this._config.scaledCharHeight),a=!1;if(this._config.allowTransparency||(a=b(s,i)),a&&"_"===e.chars&&!this._config.allowTransparency)for(var l=1;l<=5&&(this._tmpCtx.fillText(e.chars,0,this._config.scaledCharHeight-l),a=b(s=this._tmpCtx.getImageData(0,0,this._config.scaledCharWidth,this._config.scaledCharHeight),i));l++);this._tmpCtx.restore();var c=this._toCoordinateX(t),d=this._toCoordinateY(t);this._cacheCtx.putImageData(s,c,d);var h={index:t,isEmpty:a,inBitmap:!1};return this._addGlyphToBitmap(h),h},t.prototype._addGlyphToBitmap=function(e){var t=this;!("createImageBitmap"in window)||c.isFirefox||c.isSafari||(this._glyphsWaitingOnBitmap.push(e),null===this._bitmapCommitTimeout&&(this._bitmapCommitTimeout=window.setTimeout((function(){return t._generateBitmap()}),100)))},t.prototype._generateBitmap=function(){var e=this,t=this._glyphsWaitingOnBitmap;this._glyphsWaitingOnBitmap=[],window.createImageBitmap(this._cacheCanvas).then((function(i){e._bitmap=i;for(var r=0;r<t.length;r++)t[r].inBitmap=!0})),this._bitmapCommitTimeout=null},t}(s.BaseCharAtlas);t.DynamicCharAtlas=g;var m=function(e){function t(t,i){return e.call(this)||this}return n(t,e),t.prototype.draw=function(e,t,i,r){return!1},t}(s.BaseCharAtlas);function b(e,t){for(var i=!0,r=t.rgba>>>24,n=t.rgba>>>16&255,o=t.rgba>>>8&255,s=0;s<e.data.length;s+=4)e.data[s]===r&&e.data[s+1]===n&&e.data[s+2]===o?e.data[s+3]=0:i=!1;return i}t.NoneCharAtlas=m},7001:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.LRUMap=void 0;var i=function(){function e(e){this.capacity=e,this._map={},this._head=null,this._tail=null,this._nodePool=[],this.size=0}return e.prototype._unlinkNode=function(e){var t=e.prev,i=e.next;e===this._head&&(this._head=i),e===this._tail&&(this._tail=t),null!==t&&(t.next=i),null!==i&&(i.prev=t)},e.prototype._appendNode=function(e){var t=this._tail;null!==t&&(t.next=e),e.prev=t,e.next=null,this._tail=e,null===this._head&&(this._head=e)},e.prototype.prealloc=function(e){for(var t=this._nodePool,i=0;i<e;i++)t.push({prev:null,next:null,key:null,value:null})},e.prototype.get=function(e){var t=this._map[e];return void 0!==t?(this._unlinkNode(t),this._appendNode(t),t.value):null},e.prototype.peekValue=function(e){var t=this._map[e];return void 0!==t?t.value:null},e.prototype.peek=function(){var e=this._head;return null===e?null:e.value},e.prototype.set=function(e,t){var i=this._map[e];if(void 0!==i)i=this._map[e],this._unlinkNode(i),i.value=t;else if(this.size>=this.capacity)i=this._head,this._unlinkNode(i),delete this._map[i.key],i.key=e,i.value=t,this._map[e]=i;else{var r=this._nodePool;r.length>0?((i=r.pop()).key=e,i.value=t):i={prev:null,next:null,key:e,value:t},this._map[e]=i,this.size++}this._appendNode(i)},e}();t.LRUMap=i},1296:function(e,t,i){var r,n=this&&this.__extends||(r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])},r(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function i(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),o=this&&this.__decorate||function(e,t,i,r){var n,o=arguments.length,s=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,r);else for(var a=e.length-1;a>=0;a--)(n=e[a])&&(s=(o<3?n(s):o>3?n(t,i,s):n(t,i))||s);return o>3&&s&&Object.defineProperty(t,i,s),s},s=this&&this.__param||function(e,t){return function(i,r){t(i,r,e)}},a=this&&this.__values||function(e){var t="function"==typeof Symbol&&Symbol.iterator,i=t&&e[t],r=0;if(i)return i.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(t,"__esModule",{value:!0}),t.DomRenderer=void 0;var l=i(3787),c=i(8803),d=i(844),h=i(4725),p=i(2585),u=i(8460),f=i(8055),_=i(9631),g="xterm-dom-renderer-owner-",m="xterm-fg-",b="xterm-bg-",y="xterm-focus",v=1,w=function(e){function t(t,i,r,n,o,s,a,c,d,h){var p=e.call(this)||this;return p._colors=t,p._element=i,p._screenElement=r,p._viewportElement=n,p._linkifier=o,p._linkifier2=s,p._charSizeService=c,p._optionsService=d,p._bufferService=h,p._terminalClass=v++,p._rowElements=[],p._rowContainer=document.createElement("div"),p._rowContainer.classList.add("xterm-rows"),p._rowContainer.style.lineHeight="normal",p._rowContainer.setAttribute("aria-hidden","true"),p._refreshRowElements(p._bufferService.cols,p._bufferService.rows),p._selectionContainer=document.createElement("div"),p._selectionContainer.classList.add("xterm-selection"),p._selectionContainer.setAttribute("aria-hidden","true"),p.dimensions={scaledCharWidth:0,scaledCharHeight:0,scaledCellWidth:0,scaledCellHeight:0,scaledCharLeft:0,scaledCharTop:0,scaledCanvasWidth:0,scaledCanvasHeight:0,canvasWidth:0,canvasHeight:0,actualCellWidth:0,actualCellHeight:0},p._updateDimensions(),p._injectCss(),p._rowFactory=a.createInstance(l.DomRendererRowFactory,document,p._colors),p._element.classList.add(g+p._terminalClass),p._screenElement.appendChild(p._rowContainer),p._screenElement.appendChild(p._selectionContainer),p.register(p._linkifier.onShowLinkUnderline((function(e){return p._onLinkHover(e)}))),p.register(p._linkifier.onHideLinkUnderline((function(e){return p._onLinkLeave(e)}))),p.register(p._linkifier2.onShowLinkUnderline((function(e){return p._onLinkHover(e)}))),p.register(p._linkifier2.onHideLinkUnderline((function(e){return p._onLinkLeave(e)}))),p}return n(t,e),Object.defineProperty(t.prototype,"onRequestRedraw",{get:function(){return(new u.EventEmitter).event},enumerable:!1,configurable:!0}),t.prototype.dispose=function(){this._element.classList.remove(g+this._terminalClass),(0,_.removeElementFromParent)(this._rowContainer,this._selectionContainer,this._themeStyleElement,this._dimensionsStyleElement),e.prototype.dispose.call(this)},t.prototype._updateDimensions=function(){var e,t;this.dimensions.scaledCharWidth=this._charSizeService.width*window.devicePixelRatio,this.dimensions.scaledCharHeight=Math.ceil(this._charSizeService.height*window.devicePixelRatio),this.dimensions.scaledCellWidth=this.dimensions.scaledCharWidth+Math.round(this._optionsService.rawOptions.letterSpacing),this.dimensions.scaledCellHeight=Math.floor(this.dimensions.scaledCharHeight*this._optionsService.rawOptions.lineHeight),this.dimensions.scaledCharLeft=0,this.dimensions.scaledCharTop=0,this.dimensions.scaledCanvasWidth=this.dimensions.scaledCellWidth*this._bufferService.cols,this.dimensions.scaledCanvasHeight=this.dimensions.scaledCellHeight*this._bufferService.rows,this.dimensions.canvasWidth=Math.round(this.dimensions.scaledCanvasWidth/window.devicePixelRatio),this.dimensions.canvasHeight=Math.round(this.dimensions.scaledCanvasHeight/window.devicePixelRatio),this.dimensions.actualCellWidth=this.dimensions.canvasWidth/this._bufferService.cols,this.dimensions.actualCellHeight=this.dimensions.canvasHeight/this._bufferService.rows;try{for(var i=a(this._rowElements),r=i.next();!r.done;r=i.next()){var n=r.value;n.style.width=this.dimensions.canvasWidth+"px",n.style.height=this.dimensions.actualCellHeight+"px",n.style.lineHeight=this.dimensions.actualCellHeight+"px",n.style.overflow="hidden"}}catch(t){e={error:t}}finally{try{r&&!r.done&&(t=i.return)&&t.call(i)}finally{if(e)throw e.error}}this._dimensionsStyleElement||(this._dimensionsStyleElement=document.createElement("style"),this._screenElement.appendChild(this._dimensionsStyleElement));var o=this._terminalSelector+" .xterm-rows span { display: inline-block; height: 100%; vertical-align: top; width: "+this.dimensions.actualCellWidth+"px}";this._dimensionsStyleElement.textContent=o,this._selectionContainer.style.height=this._viewportElement.style.height,this._screenElement.style.width=this.dimensions.canvasWidth+"px",this._screenElement.style.height=this.dimensions.canvasHeight+"px"},t.prototype.setColors=function(e){this._colors=e,this._injectCss()},t.prototype._injectCss=function(){var e=this;this._themeStyleElement||(this._themeStyleElement=document.createElement("style"),this._screenElement.appendChild(this._themeStyleElement));var t=this._terminalSelector+" .xterm-rows { color: "+this._colors.foreground.css+"; font-family: "+this._optionsService.rawOptions.fontFamily+"; font-size: "+this._optionsService.rawOptions.fontSize+"px;}";t+=this._terminalSelector+" span:not(."+l.BOLD_CLASS+") { font-weight: "+this._optionsService.rawOptions.fontWeight+";}"+this._terminalSelector+" span."+l.BOLD_CLASS+" { font-weight: "+this._optionsService.rawOptions.fontWeightBold+";}"+this._terminalSelector+" span."+l.ITALIC_CLASS+" { font-style: italic;}",t+="@keyframes blink_box_shadow_"+this._terminalClass+" { 50% {  box-shadow: none; }}",t+="@keyframes blink_block_"+this._terminalClass+" { 0% {  background-color: "+this._colors.cursor.css+";  color: "+this._colors.cursorAccent.css+"; } 50% {  background-color: "+this._colors.cursorAccent.css+";  color: "+this._colors.cursor.css+"; }}",t+=this._terminalSelector+" .xterm-rows:not(.xterm-focus) ."+l.CURSOR_CLASS+"."+l.CURSOR_STYLE_BLOCK_CLASS+" { outline: 1px solid "+this._colors.cursor.css+"; outline-offset: -1px;}"+this._terminalSelector+" .xterm-rows.xterm-focus ."+l.CURSOR_CLASS+"."+l.CURSOR_BLINK_CLASS+":not(."+l.CURSOR_STYLE_BLOCK_CLASS+") { animation: blink_box_shadow_"+this._terminalClass+" 1s step-end infinite;}"+this._terminalSelector+" .xterm-rows.xterm-focus ."+l.CURSOR_CLASS+"."+l.CURSOR_BLINK_CLASS+"."+l.CURSOR_STYLE_BLOCK_CLASS+" { animation: blink_block_"+this._terminalClass+" 1s step-end infinite;}"+this._terminalSelector+" .xterm-rows.xterm-focus ."+l.CURSOR_CLASS+"."+l.CURSOR_STYLE_BLOCK_CLASS+" { background-color: "+this._colors.cursor.css+"; color: "+this._colors.cursorAccent.css+";}"+this._terminalSelector+" .xterm-rows ."+l.CURSOR_CLASS+"."+l.CURSOR_STYLE_BAR_CLASS+" { box-shadow: "+this._optionsService.rawOptions.cursorWidth+"px 0 0 "+this._colors.cursor.css+" inset;}"+this._terminalSelector+" .xterm-rows ."+l.CURSOR_CLASS+"."+l.CURSOR_STYLE_UNDERLINE_CLASS+" { box-shadow: 0 -1px 0 "+this._colors.cursor.css+" inset;}",t+=this._terminalSelector+" .xterm-selection { position: absolute; top: 0; left: 0; z-index: 1; pointer-events: none;}"+this._terminalSelector+" .xterm-selection div { position: absolute; background-color: "+this._colors.selectionOpaque.css+";}",this._colors.ansi.forEach((function(i,r){t+=e._terminalSelector+" ."+m+r+" { color: "+i.css+"; }"+e._terminalSelector+" ."+b+r+" { background-color: "+i.css+"; }"})),t+=this._terminalSelector+" ."+m+c.INVERTED_DEFAULT_COLOR+" { color: "+f.color.opaque(this._colors.background).css+"; }"+this._terminalSelector+" ."+b+c.INVERTED_DEFAULT_COLOR+" { background-color: "+this._colors.foreground.css+"; }",this._themeStyleElement.textContent=t},t.prototype.onDevicePixelRatioChange=function(){this._updateDimensions()},t.prototype._refreshRowElements=function(e,t){for(var i=this._rowElements.length;i<=t;i++){var r=document.createElement("div");this._rowContainer.appendChild(r),this._rowElements.push(r)}for(;this._rowElements.length>t;)this._rowContainer.removeChild(this._rowElements.pop())},t.prototype.onResize=function(e,t){this._refreshRowElements(e,t),this._updateDimensions()},t.prototype.onCharSizeChanged=function(){this._updateDimensions()},t.prototype.onBlur=function(){this._rowContainer.classList.remove(y)},t.prototype.onFocus=function(){this._rowContainer.classList.add(y)},t.prototype.onSelectionChanged=function(e,t,i){for(;this._selectionContainer.children.length;)this._selectionContainer.removeChild(this._selectionContainer.children[0]);if(this._rowFactory.onSelectionChanged(e,t,i),this.renderRows(0,this._bufferService.rows-1),e&&t){var r=e[1]-this._bufferService.buffer.ydisp,n=t[1]-this._bufferService.buffer.ydisp,o=Math.max(r,0),s=Math.min(n,this._bufferService.rows-1);if(!(o>=this._bufferService.rows||s<0)){var a=document.createDocumentFragment();if(i){var l=e[0]>t[0];a.appendChild(this._createSelectionElement(o,l?t[0]:e[0],l?e[0]:t[0],s-o+1))}else{var c=r===o?e[0]:0,d=o===n?t[0]:this._bufferService.cols;a.appendChild(this._createSelectionElement(o,c,d));var h=s-o-1;if(a.appendChild(this._createSelectionElement(o+1,0,this._bufferService.cols,h)),o!==s){var p=n===s?t[0]:this._bufferService.cols;a.appendChild(this._createSelectionElement(s,0,p))}}this._selectionContainer.appendChild(a)}}},t.prototype._createSelectionElement=function(e,t,i,r){void 0===r&&(r=1);var n=document.createElement("div");return n.style.height=r*this.dimensions.actualCellHeight+"px",n.style.top=e*this.dimensions.actualCellHeight+"px",n.style.left=t*this.dimensions.actualCellWidth+"px",n.style.width=this.dimensions.actualCellWidth*(i-t)+"px",n},t.prototype.onCursorMove=function(){},t.prototype.onOptionsChanged=function(){this._updateDimensions(),this._injectCss()},t.prototype.clear=function(){var e,t;try{for(var i=a(this._rowElements),r=i.next();!r.done;r=i.next())r.value.innerText=""}catch(t){e={error:t}}finally{try{r&&!r.done&&(t=i.return)&&t.call(i)}finally{if(e)throw e.error}}},t.prototype.renderRows=function(e,t){for(var i=this._bufferService.buffer.ybase+this._bufferService.buffer.y,r=Math.min(this._bufferService.buffer.x,this._bufferService.cols-1),n=this._optionsService.rawOptions.cursorBlink,o=e;o<=t;o++){var s=this._rowElements[o];s.innerText="";var a=o+this._bufferService.buffer.ydisp,l=this._bufferService.buffer.lines.get(a),c=this._optionsService.rawOptions.cursorStyle;s.appendChild(this._rowFactory.createRow(l,a,a===i,c,r,n,this.dimensions.actualCellWidth,this._bufferService.cols))}},Object.defineProperty(t.prototype,"_terminalSelector",{get:function(){return"."+g+this._terminalClass},enumerable:!1,configurable:!0}),t.prototype._onLinkHover=function(e){this._setCellUnderline(e.x1,e.x2,e.y1,e.y2,e.cols,!0)},t.prototype._onLinkLeave=function(e){this._setCellUnderline(e.x1,e.x2,e.y1,e.y2,e.cols,!1)},t.prototype._setCellUnderline=function(e,t,i,r,n,o){for(;e!==t||i!==r;){var s=this._rowElements[i];if(!s)return;var a=s.children[e];a&&(a.style.textDecoration=o?"underline":"none"),++e>=n&&(e=0,i++)}},o([s(6,p.IInstantiationService),s(7,h.ICharSizeService),s(8,p.IOptionsService),s(9,p.IBufferService)],t)}(d.Disposable);t.DomRenderer=w},3787:function(e,t,i){var r=this&&this.__decorate||function(e,t,i,r){var n,o=arguments.length,s=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,r);else for(var a=e.length-1;a>=0;a--)(n=e[a])&&(s=(o<3?n(s):o>3?n(t,i,s):n(t,i))||s);return o>3&&s&&Object.defineProperty(t,i,s),s},n=this&&this.__param||function(e,t){return function(i,r){t(i,r,e)}},o=this&&this.__values||function(e){var t="function"==typeof Symbol&&Symbol.iterator,i=t&&e[t],r=0;if(i)return i.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(t,"__esModule",{value:!0}),t.DomRendererRowFactory=t.CURSOR_STYLE_UNDERLINE_CLASS=t.CURSOR_STYLE_BAR_CLASS=t.CURSOR_STYLE_BLOCK_CLASS=t.CURSOR_BLINK_CLASS=t.CURSOR_CLASS=t.STRIKETHROUGH_CLASS=t.UNDERLINE_CLASS=t.ITALIC_CLASS=t.DIM_CLASS=t.BOLD_CLASS=void 0;var s=i(8803),a=i(643),l=i(511),c=i(2585),d=i(8055),h=i(4725),p=i(4269),u=i(1752);t.BOLD_CLASS="xterm-bold",t.DIM_CLASS="xterm-dim",t.ITALIC_CLASS="xterm-italic",t.UNDERLINE_CLASS="xterm-underline",t.STRIKETHROUGH_CLASS="xterm-strikethrough",t.CURSOR_CLASS="xterm-cursor",t.CURSOR_BLINK_CLASS="xterm-cursor-blink",t.CURSOR_STYLE_BLOCK_CLASS="xterm-cursor-block",t.CURSOR_STYLE_BAR_CLASS="xterm-cursor-bar",t.CURSOR_STYLE_UNDERLINE_CLASS="xterm-cursor-underline";var f=function(){function e(e,t,i,r,n,o){this._document=e,this._colors=t,this._characterJoinerService=i,this._optionsService=r,this._coreService=n,this._decorationService=o,this._workCell=new l.CellData,this._columnSelectMode=!1}return e.prototype.setColors=function(e){this._colors=e},e.prototype.onSelectionChanged=function(e,t,i){this._selectionStart=e,this._selectionEnd=t,this._columnSelectMode=i},e.prototype.createRow=function(e,i,r,n,l,c,h,u){for(var f,g,m=this._document.createDocumentFragment(),b=this._characterJoinerService.getJoinedCharacters(i),y=0,v=Math.min(e.length,u)-1;v>=0;v--)if(e.loadCell(v,this._workCell).getCode()!==a.NULL_CELL_CODE||r&&v===l){y=v+1;break}for(v=0;v<y;v++){e.loadCell(v,this._workCell);var w=this._workCell.getWidth();if(0!==w){var x=!1,C=v,S=this._workCell;if(b.length>0&&v===b[0][0]){x=!0;var E=b.shift();S=new p.JoinedCellData(this._workCell,e.translateToString(!0,E[0],E[1]),E[1]-E[0]),C=E[1]-1,w=S.getWidth()}var k=this._document.createElement("span");if(w>1&&(k.style.width=h*w+"px"),x&&(k.style.display="inline",l>=v&&l<=C&&(l=v)),!this._coreService.isCursorHidden&&r&&v===l)switch(k.classList.add(t.CURSOR_CLASS),c&&k.classList.add(t.CURSOR_BLINK_CLASS),n){case"bar":k.classList.add(t.CURSOR_STYLE_BAR_CLASS);break;case"underline":k.classList.add(t.CURSOR_STYLE_UNDERLINE_CLASS);break;default:k.classList.add(t.CURSOR_STYLE_BLOCK_CLASS)}S.isBold()&&k.classList.add(t.BOLD_CLASS),S.isItalic()&&k.classList.add(t.ITALIC_CLASS),S.isDim()&&k.classList.add(t.DIM_CLASS),S.isUnderline()&&k.classList.add(t.UNDERLINE_CLASS),S.isInvisible()?k.textContent=a.WHITESPACE_CELL_CHAR:k.textContent=S.getChars()||a.WHITESPACE_CELL_CHAR,S.isStrikethrough()&&k.classList.add(t.STRIKETHROUGH_CLASS);var L=S.getFgColor(),A=S.getFgColorMode(),O=S.getBgColor(),M=S.getBgColorMode(),P=!!S.isInverse();if(P){var R=L;L=O,O=R;var D=A;A=M,M=D}var T=void 0,I=void 0,B=!1;try{for(var F=(f=void 0,o(this._decorationService.getDecorationsAtCell(v,i))),W=F.next();!W.done;W=F.next()){var H=W.value;"top"!==H.options.layer&&B||(H.backgroundColorRGB&&(M=50331648,O=H.backgroundColorRGB.rgba>>8&16777215,T=H.backgroundColorRGB),H.foregroundColorRGB&&(A=50331648,L=H.foregroundColorRGB.rgba>>8&16777215,I=H.foregroundColorRGB),B="top"===H.options.layer)}}catch(e){f={error:e}}finally{try{W&&!W.done&&(g=F.return)&&g.call(F)}finally{if(f)throw f.error}}var U=this._isCellInSelection(v,i);B||this._colors.selectionForeground&&U&&(A=50331648,L=this._colors.selectionForeground.rgba>>8&16777215,I=this._colors.selectionForeground),U&&(T=this._colors.selectionOpaque,B=!0),B&&k.classList.add("xterm-decoration-top");var j=void 0;switch(M){case 16777216:case 33554432:j=this._colors.ansi[O],k.classList.add("xterm-bg-"+O);break;case 50331648:j=d.rgba.toColor(O>>16,O>>8&255,255&O),this._addStyle(k,"background-color:#"+_((O>>>0).toString(16),"0",6));break;default:P?(j=this._colors.foreground,k.classList.add("xterm-bg-"+s.INVERTED_DEFAULT_COLOR)):j=this._colors.background}switch(A){case 16777216:case 33554432:S.isBold()&&L<8&&this._optionsService.rawOptions.drawBoldTextInBrightColors&&(L+=8),this._applyMinimumContrast(k,j,this._colors.ansi[L],S,T,void 0)||k.classList.add("xterm-fg-"+L);break;case 50331648:var z=d.rgba.toColor(L>>16&255,L>>8&255,255&L);this._applyMinimumContrast(k,j,z,S,T,I)||this._addStyle(k,"color:#"+_(L.toString(16),"0",6));break;default:this._applyMinimumContrast(k,j,this._colors.foreground,S,T,void 0)||P&&k.classList.add("xterm-fg-"+s.INVERTED_DEFAULT_COLOR)}m.appendChild(k),v=C}}return m},e.prototype._applyMinimumContrast=function(e,t,i,r,n,o){if(1===this._optionsService.rawOptions.minimumContrastRatio||(0,u.excludeFromContrastRatioDemands)(r.getCode()))return!1;var s=void 0;return n||o||(s=this._colors.contrastCache.getColor(t.rgba,i.rgba)),void 0===s&&(s=d.color.ensureContrastRatio(n||t,o||i,this._optionsService.rawOptions.minimumContrastRatio),this._colors.contrastCache.setColor((n||t).rgba,(o||i).rgba,null!=s?s:null)),!!s&&(this._addStyle(e,"color:"+s.css),!0)},e.prototype._addStyle=function(e,t){e.setAttribute("style",""+(e.getAttribute("style")||"")+t+";")},e.prototype._isCellInSelection=function(e,t){var i=this._selectionStart,r=this._selectionEnd;return!(!i||!r)&&(this._columnSelectMode?i[0]<=r[0]?e>=i[0]&&t>=i[1]&&e<r[0]&&t<=r[1]:e<i[0]&&t>=i[1]&&e>=r[0]&&t<=r[1]:t>i[1]&&t<r[1]||i[1]===r[1]&&t===i[1]&&e>=i[0]&&e<r[0]||i[1]<r[1]&&t===r[1]&&e<r[0]||i[1]<r[1]&&t===i[1]&&e>=i[0])},r([n(2,h.ICharacterJoinerService),n(3,c.IOptionsService),n(4,c.ICoreService),n(5,c.IDecorationService)],e)}();function _(e,t,i){for(;e.length<i;)e=t+e;return e}t.DomRendererRowFactory=f},456:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.SelectionModel=void 0;var i=function(){function e(e){this._bufferService=e,this.isSelectAllActive=!1,this.selectionStartLength=0}return e.prototype.clearSelection=function(){this.selectionStart=void 0,this.selectionEnd=void 0,this.isSelectAllActive=!1,this.selectionStartLength=0},Object.defineProperty(e.prototype,"finalSelectionStart",{get:function(){return this.isSelectAllActive?[0,0]:this.selectionEnd&&this.selectionStart&&this.areSelectionValuesReversed()?this.selectionEnd:this.selectionStart},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"finalSelectionEnd",{get:function(){return this.isSelectAllActive?[this._bufferService.cols,this._bufferService.buffer.ybase+this._bufferService.rows-1]:this.selectionStart?!this.selectionEnd||this.areSelectionValuesReversed()?(e=this.selectionStart[0]+this.selectionStartLength)>this._bufferService.cols?e%this._bufferService.cols==0?[this._bufferService.cols,this.selectionStart[1]+Math.floor(e/this._bufferService.cols)-1]:[e%this._bufferService.cols,this.selectionStart[1]+Math.floor(e/this._bufferService.cols)]:[e,this.selectionStart[1]]:this.selectionStartLength&&this.selectionEnd[1]===this.selectionStart[1]?(e=this.selectionStart[0]+this.selectionStartLength)>this._bufferService.cols?[e%this._bufferService.cols,this.selectionStart[1]+Math.floor(e/this._bufferService.cols)]:[Math.max(e,this.selectionEnd[0]),this.selectionEnd[1]]:this.selectionEnd:void 0;var e},enumerable:!1,configurable:!0}),e.prototype.areSelectionValuesReversed=function(){var e=this.selectionStart,t=this.selectionEnd;return!(!e||!t)&&(e[1]>t[1]||e[1]===t[1]&&e[0]>t[0])},e.prototype.onTrim=function(e){return this.selectionStart&&(this.selectionStart[1]-=e),this.selectionEnd&&(this.selectionEnd[1]-=e),this.selectionEnd&&this.selectionEnd[1]<0?(this.clearSelection(),!0):(this.selectionStart&&this.selectionStart[1]<0&&(this.selectionStart[1]=0),!1)},e}();t.SelectionModel=i},428:function(e,t,i){var r=this&&this.__decorate||function(e,t,i,r){var n,o=arguments.length,s=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,r);else for(var a=e.length-1;a>=0;a--)(n=e[a])&&(s=(o<3?n(s):o>3?n(t,i,s):n(t,i))||s);return o>3&&s&&Object.defineProperty(t,i,s),s},n=this&&this.__param||function(e,t){return function(i,r){t(i,r,e)}};Object.defineProperty(t,"__esModule",{value:!0}),t.CharSizeService=void 0;var o=i(2585),s=i(8460),a=function(){function e(e,t,i){this._optionsService=i,this.width=0,this.height=0,this._onCharSizeChange=new s.EventEmitter,this._measureStrategy=new l(e,t,this._optionsService)}return Object.defineProperty(e.prototype,"hasValidSize",{get:function(){return this.width>0&&this.height>0},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"onCharSizeChange",{get:function(){return this._onCharSizeChange.event},enumerable:!1,configurable:!0}),e.prototype.measure=function(){var e=this._measureStrategy.measure();e.width===this.width&&e.height===this.height||(this.width=e.width,this.height=e.height,this._onCharSizeChange.fire())},r([n(2,o.IOptionsService)],e)}();t.CharSizeService=a;var l=function(){function e(e,t,i){this._document=e,this._parentElement=t,this._optionsService=i,this._result={width:0,height:0},this._measureElement=this._document.createElement("span"),this._measureElement.classList.add("xterm-char-measure-element"),this._measureElement.textContent="W",this._measureElement.setAttribute("aria-hidden","true"),this._parentElement.appendChild(this._measureElement)}return e.prototype.measure=function(){this._measureElement.style.fontFamily=this._optionsService.rawOptions.fontFamily,this._measureElement.style.fontSize=this._optionsService.rawOptions.fontSize+"px";var e=this._measureElement.getBoundingClientRect();return 0!==e.width&&0!==e.height&&(this._result.width=e.width,this._result.height=Math.ceil(e.height)),this._result},e}()},4269:function(e,t,i){var r,n=this&&this.__extends||(r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])},r(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function i(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),o=this&&this.__decorate||function(e,t,i,r){var n,o=arguments.length,s=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,r);else for(var a=e.length-1;a>=0;a--)(n=e[a])&&(s=(o<3?n(s):o>3?n(t,i,s):n(t,i))||s);return o>3&&s&&Object.defineProperty(t,i,s),s},s=this&&this.__param||function(e,t){return function(i,r){t(i,r,e)}};Object.defineProperty(t,"__esModule",{value:!0}),t.CharacterJoinerService=t.JoinedCellData=void 0;var a=i(3734),l=i(643),c=i(511),d=i(2585),h=function(e){function t(t,i,r){var n=e.call(this)||this;return n.content=0,n.combinedData="",n.fg=t.fg,n.bg=t.bg,n.combinedData=i,n._width=r,n}return n(t,e),t.prototype.isCombined=function(){return 2097152},t.prototype.getWidth=function(){return this._width},t.prototype.getChars=function(){return this.combinedData},t.prototype.getCode=function(){return 2097151},t.prototype.setFromCharData=function(e){throw new Error("not implemented")},t.prototype.getAsCharData=function(){return[this.fg,this.getChars(),this.getWidth(),this.getCode()]},t}(a.AttributeData);t.JoinedCellData=h;var p=function(){function e(e){this._bufferService=e,this._characterJoiners=[],this._nextCharacterJoinerId=0,this._workCell=new c.CellData}return e.prototype.register=function(e){var t={id:this._nextCharacterJoinerId++,handler:e};return this._characterJoiners.push(t),t.id},e.prototype.deregister=function(e){for(var t=0;t<this._characterJoiners.length;t++)if(this._characterJoiners[t].id===e)return this._characterJoiners.splice(t,1),!0;return!1},e.prototype.getJoinedCharacters=function(e){if(0===this._characterJoiners.length)return[];var t=this._bufferService.buffer.lines.get(e);if(!t||0===t.length)return[];for(var i=[],r=t.translateToString(!0),n=0,o=0,s=0,a=t.getFg(0),c=t.getBg(0),d=0;d<t.getTrimmedLength();d++)if(t.loadCell(d,this._workCell),0!==this._workCell.getWidth()){if(this._workCell.fg!==a||this._workCell.bg!==c){if(d-n>1)for(var h=this._getJoinedRanges(r,s,o,t,n),p=0;p<h.length;p++)i.push(h[p]);n=d,s=o,a=this._workCell.fg,c=this._workCell.bg}o+=this._workCell.getChars().length||l.WHITESPACE_CELL_CHAR.length}if(this._bufferService.cols-n>1)for(h=this._getJoinedRanges(r,s,o,t,n),p=0;p<h.length;p++)i.push(h[p]);return i},e.prototype._getJoinedRanges=function(t,i,r,n,o){var s=t.substring(i,r),a=[];try{a=this._characterJoiners[0].handler(s)}catch(e){console.error(e)}for(var l=1;l<this._characterJoiners.length;l++)try{for(var c=this._characterJoiners[l].handler(s),d=0;d<c.length;d++)e._mergeRanges(a,c[d])}catch(e){console.error(e)}return this._stringRangesToCellRanges(a,n,o),a},e.prototype._stringRangesToCellRanges=function(e,t,i){var r=0,n=!1,o=0,s=e[r];if(s){for(var a=i;a<this._bufferService.cols;a++){var c=t.getWidth(a),d=t.getString(a).length||l.WHITESPACE_CELL_CHAR.length;if(0!==c){if(!n&&s[0]<=o&&(s[0]=a,n=!0),s[1]<=o){if(s[1]=a,!(s=e[++r]))break;s[0]<=o?(s[0]=a,n=!0):n=!1}o+=d}}s&&(s[1]=this._bufferService.cols)}},e._mergeRanges=function(e,t){for(var i=!1,r=0;r<e.length;r++){var n=e[r];if(i){if(t[1]<=n[0])return e[r-1][1]=t[1],e;if(t[1]<=n[1])return e[r-1][1]=Math.max(t[1],n[1]),e.splice(r,1),e;e.splice(r,1),r--}else{if(t[1]<=n[0])return e.splice(r,0,t),e;if(t[1]<=n[1])return n[0]=Math.min(t[0],n[0]),e;t[0]<n[1]&&(n[0]=Math.min(t[0],n[0]),i=!0)}}return i?e[e.length-1][1]=t[1]:e.push(t),e},e=o([s(0,d.IBufferService)],e)}();t.CharacterJoinerService=p},5114:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.CoreBrowserService=void 0;var i=function(){function e(e){this._textarea=e}return Object.defineProperty(e.prototype,"isFocused",{get:function(){return(this._textarea.getRootNode?this._textarea.getRootNode():document).activeElement===this._textarea&&document.hasFocus()},enumerable:!1,configurable:!0}),e}();t.CoreBrowserService=i},8934:function(e,t,i){var r=this&&this.__decorate||function(e,t,i,r){var n,o=arguments.length,s=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,r);else for(var a=e.length-1;a>=0;a--)(n=e[a])&&(s=(o<3?n(s):o>3?n(t,i,s):n(t,i))||s);return o>3&&s&&Object.defineProperty(t,i,s),s},n=this&&this.__param||function(e,t){return function(i,r){t(i,r,e)}};Object.defineProperty(t,"__esModule",{value:!0}),t.MouseService=void 0;var o=i(4725),s=i(9806),a=function(){function e(e,t){this._renderService=e,this._charSizeService=t}return e.prototype.getCoords=function(e,t,i,r,n){return(0,s.getCoords)(window,e,t,i,r,this._charSizeService.hasValidSize,this._renderService.dimensions.actualCellWidth,this._renderService.dimensions.actualCellHeight,n)},e.prototype.getRawByteCoords=function(e,t,i,r){var n=this.getCoords(e,t,i,r);return(0,s.getRawByteCoords)(n)},r([n(0,o.IRenderService),n(1,o.ICharSizeService)],e)}();t.MouseService=a},3230:function(e,t,i){var r,n=this&&this.__extends||(r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])},r(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function i(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),o=this&&this.__decorate||function(e,t,i,r){var n,o=arguments.length,s=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,r);else for(var a=e.length-1;a>=0;a--)(n=e[a])&&(s=(o<3?n(s):o>3?n(t,i,s):n(t,i))||s);return o>3&&s&&Object.defineProperty(t,i,s),s},s=this&&this.__param||function(e,t){return function(i,r){t(i,r,e)}};Object.defineProperty(t,"__esModule",{value:!0}),t.RenderService=void 0;var a=i(6193),l=i(8460),c=i(844),d=i(5596),h=i(3656),p=i(2585),u=i(4725),f=function(e){function t(t,i,r,n,o,s,c){var p=e.call(this)||this;if(p._renderer=t,p._rowCount=i,p._charSizeService=o,p._isPaused=!1,p._needsFullRefresh=!1,p._isNextRenderRedrawOnly=!0,p._needsSelectionRefresh=!1,p._canvasWidth=0,p._canvasHeight=0,p._selectionState={start:void 0,end:void 0,columnSelectMode:!1},p._onDimensionsChange=new l.EventEmitter,p._onRenderedViewportChange=new l.EventEmitter,p._onRender=new l.EventEmitter,p._onRefreshRequest=new l.EventEmitter,p.register({dispose:function(){return p._renderer.dispose()}}),p._renderDebouncer=new a.RenderDebouncer((function(e,t){return p._renderRows(e,t)})),p.register(p._renderDebouncer),p._screenDprMonitor=new d.ScreenDprMonitor,p._screenDprMonitor.setListener((function(){return p.onDevicePixelRatioChange()})),p.register(p._screenDprMonitor),p.register(c.onResize((function(){return p._fullRefresh()}))),p.register(c.buffers.onBufferActivate((function(){var e;return null===(e=p._renderer)||void 0===e?void 0:e.clear()}))),p.register(n.onOptionChange((function(){return p._handleOptionsChanged()}))),p.register(p._charSizeService.onCharSizeChange((function(){return p.onCharSizeChanged()}))),p.register(s.onDecorationRegistered((function(){return p._fullRefresh()}))),p.register(s.onDecorationRemoved((function(){return p._fullRefresh()}))),p._renderer.onRequestRedraw((function(e){return p.refreshRows(e.start,e.end,!0)})),p.register((0,h.addDisposableDomListener)(window,"resize",(function(){return p.onDevicePixelRatioChange()}))),"IntersectionObserver"in window){var u=new IntersectionObserver((function(e){return p._onIntersectionChange(e[e.length-1])}),{threshold:0});u.observe(r),p.register({dispose:function(){return u.disconnect()}})}return p}return n(t,e),Object.defineProperty(t.prototype,"onDimensionsChange",{get:function(){return this._onDimensionsChange.event},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"onRenderedViewportChange",{get:function(){return this._onRenderedViewportChange.event},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"onRender",{get:function(){return this._onRender.event},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"onRefreshRequest",{get:function(){return this._onRefreshRequest.event},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"dimensions",{get:function(){return this._renderer.dimensions},enumerable:!1,configurable:!0}),t.prototype._onIntersectionChange=function(e){this._isPaused=void 0===e.isIntersecting?0===e.intersectionRatio:!e.isIntersecting,this._isPaused||this._charSizeService.hasValidSize||this._charSizeService.measure(),!this._isPaused&&this._needsFullRefresh&&(this.refreshRows(0,this._rowCount-1),this._needsFullRefresh=!1)},t.prototype.refreshRows=function(e,t,i){void 0===i&&(i=!1),this._isPaused?this._needsFullRefresh=!0:(i||(this._isNextRenderRedrawOnly=!1),this._renderDebouncer.refresh(e,t,this._rowCount))},t.prototype._renderRows=function(e,t){this._renderer.renderRows(e,t),this._needsSelectionRefresh&&(this._renderer.onSelectionChanged(this._selectionState.start,this._selectionState.end,this._selectionState.columnSelectMode),this._needsSelectionRefresh=!1),this._isNextRenderRedrawOnly||this._onRenderedViewportChange.fire({start:e,end:t}),this._onRender.fire({start:e,end:t}),this._isNextRenderRedrawOnly=!0},t.prototype.resize=function(e,t){this._rowCount=t,this._fireOnCanvasResize()},t.prototype._handleOptionsChanged=function(){this._renderer.onOptionsChanged(),this.refreshRows(0,this._rowCount-1),this._fireOnCanvasResize()},t.prototype._fireOnCanvasResize=function(){this._renderer.dimensions.canvasWidth===this._canvasWidth&&this._renderer.dimensions.canvasHeight===this._canvasHeight||this._onDimensionsChange.fire(this._renderer.dimensions)},t.prototype.dispose=function(){e.prototype.dispose.call(this)},t.prototype.setRenderer=function(e){var t=this;this._renderer.dispose(),this._renderer=e,this._renderer.onRequestRedraw((function(e){return t.refreshRows(e.start,e.end,!0)})),this._needsSelectionRefresh=!0,this._fullRefresh()},t.prototype.addRefreshCallback=function(e){return this._renderDebouncer.addRefreshCallback(e)},t.prototype._fullRefresh=function(){this._isPaused?this._needsFullRefresh=!0:this.refreshRows(0,this._rowCount-1)},t.prototype.clearTextureAtlas=function(){var e,t;null===(t=null===(e=this._renderer)||void 0===e?void 0:e.clearTextureAtlas)||void 0===t||t.call(e),this._fullRefresh()},t.prototype.setColors=function(e){this._renderer.setColors(e),this._fullRefresh()},t.prototype.onDevicePixelRatioChange=function(){this._charSizeService.measure(),this._renderer.onDevicePixelRatioChange(),this.refreshRows(0,this._rowCount-1)},t.prototype.onResize=function(e,t){this._renderer.onResize(e,t),this._fullRefresh()},t.prototype.onCharSizeChanged=function(){this._renderer.onCharSizeChanged()},t.prototype.onBlur=function(){this._renderer.onBlur()},t.prototype.onFocus=function(){this._renderer.onFocus()},t.prototype.onSelectionChanged=function(e,t,i){this._selectionState.start=e,this._selectionState.end=t,this._selectionState.columnSelectMode=i,this._renderer.onSelectionChanged(e,t,i)},t.prototype.onCursorMove=function(){this._renderer.onCursorMove()},t.prototype.clear=function(){this._renderer.clear()},o([s(3,p.IOptionsService),s(4,u.ICharSizeService),s(5,p.IDecorationService),s(6,p.IBufferService)],t)}(c.Disposable);t.RenderService=f},9312:function(e,t,i){var r,n=this&&this.__extends||(r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])},r(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function i(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),o=this&&this.__decorate||function(e,t,i,r){var n,o=arguments.length,s=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,r);else for(var a=e.length-1;a>=0;a--)(n=e[a])&&(s=(o<3?n(s):o>3?n(t,i,s):n(t,i))||s);return o>3&&s&&Object.defineProperty(t,i,s),s},s=this&&this.__param||function(e,t){return function(i,r){t(i,r,e)}};Object.defineProperty(t,"__esModule",{value:!0}),t.SelectionService=void 0;var a=i(6114),l=i(456),c=i(511),d=i(8460),h=i(4725),p=i(2585),u=i(9806),f=i(9504),_=i(844),g=i(4841),m=String.fromCharCode(160),b=new RegExp(m,"g"),y=function(e){function t(t,i,r,n,o,s,a,h){var p=e.call(this)||this;return p._element=t,p._screenElement=i,p._linkifier=r,p._bufferService=n,p._coreService=o,p._mouseService=s,p._optionsService=a,p._renderService=h,p._dragScrollAmount=0,p._enabled=!0,p._workCell=new c.CellData,p._mouseDownTimeStamp=0,p._oldHasSelection=!1,p._oldSelectionStart=void 0,p._oldSelectionEnd=void 0,p._onLinuxMouseSelection=p.register(new d.EventEmitter),p._onRedrawRequest=p.register(new d.EventEmitter),p._onSelectionChange=p.register(new d.EventEmitter),p._onRequestScrollLines=p.register(new d.EventEmitter),p._mouseMoveListener=function(e){return p._onMouseMove(e)},p._mouseUpListener=function(e){return p._onMouseUp(e)},p._coreService.onUserInput((function(){p.hasSelection&&p.clearSelection()})),p._trimListener=p._bufferService.buffer.lines.onTrim((function(e){return p._onTrim(e)})),p.register(p._bufferService.buffers.onBufferActivate((function(e){return p._onBufferActivate(e)}))),p.enable(),p._model=new l.SelectionModel(p._bufferService),p._activeSelectionMode=0,p}return n(t,e),Object.defineProperty(t.prototype,"onLinuxMouseSelection",{get:function(){return this._onLinuxMouseSelection.event},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"onRequestRedraw",{get:function(){return this._onRedrawRequest.event},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"onSelectionChange",{get:function(){return this._onSelectionChange.event},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"onRequestScrollLines",{get:function(){return this._onRequestScrollLines.event},enumerable:!1,configurable:!0}),t.prototype.dispose=function(){this._removeMouseDownListeners()},t.prototype.reset=function(){this.clearSelection()},t.prototype.disable=function(){this.clearSelection(),this._enabled=!1},t.prototype.enable=function(){this._enabled=!0},Object.defineProperty(t.prototype,"selectionStart",{get:function(){return this._model.finalSelectionStart},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"selectionEnd",{get:function(){return this._model.finalSelectionEnd},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"hasSelection",{get:function(){var e=this._model.finalSelectionStart,t=this._model.finalSelectionEnd;return!(!e||!t||e[0]===t[0]&&e[1]===t[1])},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"selectionText",{get:function(){var e=this._model.finalSelectionStart,t=this._model.finalSelectionEnd;if(!e||!t)return"";var i=this._bufferService.buffer,r=[];if(3===this._activeSelectionMode){if(e[0]===t[0])return"";for(var n=e[0]<t[0]?e[0]:t[0],o=e[0]<t[0]?t[0]:e[0],s=e[1];s<=t[1];s++){var l=i.translateBufferLineToString(s,!0,n,o);r.push(l)}}else{var c=e[1]===t[1]?t[0]:void 0;for(r.push(i.translateBufferLineToString(e[1],!0,e[0],c)),s=e[1]+1;s<=t[1]-1;s++){var d=i.lines.get(s);l=i.translateBufferLineToString(s,!0),(null==d?void 0:d.isWrapped)?r[r.length-1]+=l:r.push(l)}e[1]!==t[1]&&(d=i.lines.get(t[1]),l=i.translateBufferLineToString(t[1],!0,0,t[0]),d&&d.isWrapped?r[r.length-1]+=l:r.push(l))}return r.map((function(e){return e.replace(b," ")})).join(a.isWindows?"\r\n":"\n")},enumerable:!1,configurable:!0}),t.prototype.clearSelection=function(){this._model.clearSelection(),this._removeMouseDownListeners(),this.refresh(),this._onSelectionChange.fire()},t.prototype.refresh=function(e){var t=this;this._refreshAnimationFrame||(this._refreshAnimationFrame=window.requestAnimationFrame((function(){return t._refresh()}))),a.isLinux&&e&&this.selectionText.length&&this._onLinuxMouseSelection.fire(this.selectionText)},t.prototype._refresh=function(){this._refreshAnimationFrame=void 0,this._onRedrawRequest.fire({start:this._model.finalSelectionStart,end:this._model.finalSelectionEnd,columnSelectMode:3===this._activeSelectionMode})},t.prototype._isClickInSelection=function(e){var t=this._getMouseBufferCoords(e),i=this._model.finalSelectionStart,r=this._model.finalSelectionEnd;return!!(i&&r&&t)&&this._areCoordsInSelection(t,i,r)},t.prototype.isCellInSelection=function(e,t){var i=this._model.finalSelectionStart,r=this._model.finalSelectionEnd;return!(!i||!r)&&this._areCoordsInSelection([e,t],i,r)},t.prototype._areCoordsInSelection=function(e,t,i){return e[1]>t[1]&&e[1]<i[1]||t[1]===i[1]&&e[1]===t[1]&&e[0]>=t[0]&&e[0]<i[0]||t[1]<i[1]&&e[1]===i[1]&&e[0]<i[0]||t[1]<i[1]&&e[1]===t[1]&&e[0]>=t[0]},t.prototype._selectWordAtCursor=function(e,t){var i,r,n=null===(r=null===(i=this._linkifier.currentLink)||void 0===i?void 0:i.link)||void 0===r?void 0:r.range;if(n)return this._model.selectionStart=[n.start.x-1,n.start.y-1],this._model.selectionStartLength=(0,g.getRangeLength)(n,this._bufferService.cols),this._model.selectionEnd=void 0,!0;var o=this._getMouseBufferCoords(e);return!!o&&(this._selectWordAt(o,t),this._model.selectionEnd=void 0,!0)},t.prototype.selectAll=function(){this._model.isSelectAllActive=!0,this.refresh(),this._onSelectionChange.fire()},t.prototype.selectLines=function(e,t){this._model.clearSelection(),e=Math.max(e,0),t=Math.min(t,this._bufferService.buffer.lines.length-1),this._model.selectionStart=[0,e],this._model.selectionEnd=[this._bufferService.cols,t],this.refresh(),this._onSelectionChange.fire()},t.prototype._onTrim=function(e){this._model.onTrim(e)&&this.refresh()},t.prototype._getMouseBufferCoords=function(e){var t=this._mouseService.getCoords(e,this._screenElement,this._bufferService.cols,this._bufferService.rows,!0);if(t)return t[0]--,t[1]--,t[1]+=this._bufferService.buffer.ydisp,t},t.prototype._getMouseEventScrollAmount=function(e){var t=(0,u.getCoordsRelativeToElement)(window,e,this._screenElement)[1],i=this._renderService.dimensions.canvasHeight;return t>=0&&t<=i?0:(t>i&&(t-=i),t=Math.min(Math.max(t,-50),50),(t/=50)/Math.abs(t)+Math.round(14*t))},t.prototype.shouldForceSelection=function(e){return a.isMac?e.altKey&&this._optionsService.rawOptions.macOptionClickForcesSelection:e.shiftKey},t.prototype.onMouseDown=function(e){if(this._mouseDownTimeStamp=e.timeStamp,(2!==e.button||!this.hasSelection)&&0===e.button){if(!this._enabled){if(!this.shouldForceSelection(e))return;e.stopPropagation()}e.preventDefault(),this._dragScrollAmount=0,this._enabled&&e.shiftKey?this._onIncrementalClick(e):1===e.detail?this._onSingleClick(e):2===e.detail?this._onDoubleClick(e):3===e.detail&&this._onTripleClick(e),this._addMouseDownListeners(),this.refresh(!0)}},t.prototype._addMouseDownListeners=function(){var e=this;this._screenElement.ownerDocument&&(this._screenElement.ownerDocument.addEventListener("mousemove",this._mouseMoveListener),this._screenElement.ownerDocument.addEventListener("mouseup",this._mouseUpListener)),this._dragScrollIntervalTimer=window.setInterval((function(){return e._dragScroll()}),50)},t.prototype._removeMouseDownListeners=function(){this._screenElement.ownerDocument&&(this._screenElement.ownerDocument.removeEventListener("mousemove",this._mouseMoveListener),this._screenElement.ownerDocument.removeEventListener("mouseup",this._mouseUpListener)),clearInterval(this._dragScrollIntervalTimer),this._dragScrollIntervalTimer=void 0},t.prototype._onIncrementalClick=function(e){this._model.selectionStart&&(this._model.selectionEnd=this._getMouseBufferCoords(e))},t.prototype._onSingleClick=function(e){if(this._model.selectionStartLength=0,this._model.isSelectAllActive=!1,this._activeSelectionMode=this.shouldColumnSelect(e)?3:0,this._model.selectionStart=this._getMouseBufferCoords(e),this._model.selectionStart){this._model.selectionEnd=void 0;var t=this._bufferService.buffer.lines.get(this._model.selectionStart[1]);t&&t.length!==this._model.selectionStart[0]&&0===t.hasWidth(this._model.selectionStart[0])&&this._model.selectionStart[0]++}},t.prototype._onDoubleClick=function(e){this._selectWordAtCursor(e,!0)&&(this._activeSelectionMode=1)},t.prototype._onTripleClick=function(e){var t=this._getMouseBufferCoords(e);t&&(this._activeSelectionMode=2,this._selectLineAt(t[1]))},t.prototype.shouldColumnSelect=function(e){return e.altKey&&!(a.isMac&&this._optionsService.rawOptions.macOptionClickForcesSelection)},t.prototype._onMouseMove=function(e){if(e.stopImmediatePropagation(),this._model.selectionStart){var t=this._model.selectionEnd?[this._model.selectionEnd[0],this._model.selectionEnd[1]]:null;if(this._model.selectionEnd=this._getMouseBufferCoords(e),this._model.selectionEnd){2===this._activeSelectionMode?this._model.selectionEnd[1]<this._model.selectionStart[1]?this._model.selectionEnd[0]=0:this._model.selectionEnd[0]=this._bufferService.cols:1===this._activeSelectionMode&&this._selectToWordAt(this._model.selectionEnd),this._dragScrollAmount=this._getMouseEventScrollAmount(e),3!==this._activeSelectionMode&&(this._dragScrollAmount>0?this._model.selectionEnd[0]=this._bufferService.cols:this._dragScrollAmount<0&&(this._model.selectionEnd[0]=0));var i=this._bufferService.buffer;if(this._model.selectionEnd[1]<i.lines.length){var r=i.lines.get(this._model.selectionEnd[1]);r&&0===r.hasWidth(this._model.selectionEnd[0])&&this._model.selectionEnd[0]++}t&&t[0]===this._model.selectionEnd[0]&&t[1]===this._model.selectionEnd[1]||this.refresh(!0)}else this.refresh(!0)}},t.prototype._dragScroll=function(){if(this._model.selectionEnd&&this._model.selectionStart&&this._dragScrollAmount){this._onRequestScrollLines.fire({amount:this._dragScrollAmount,suppressScrollEvent:!1});var e=this._bufferService.buffer;this._dragScrollAmount>0?(3!==this._activeSelectionMode&&(this._model.selectionEnd[0]=this._bufferService.cols),this._model.selectionEnd[1]=Math.min(e.ydisp+this._bufferService.rows,e.lines.length-1)):(3!==this._activeSelectionMode&&(this._model.selectionEnd[0]=0),this._model.selectionEnd[1]=e.ydisp),this.refresh()}},t.prototype._onMouseUp=function(e){var t=e.timeStamp-this._mouseDownTimeStamp;if(this._removeMouseDownListeners(),this.selectionText.length<=1&&t<500&&e.altKey&&this._optionsService.getOption("altClickMovesCursor")){if(this._bufferService.buffer.ybase===this._bufferService.buffer.ydisp){var i=this._mouseService.getCoords(e,this._element,this._bufferService.cols,this._bufferService.rows,!1);if(i&&void 0!==i[0]&&void 0!==i[1]){var r=(0,f.moveToCellSequence)(i[0]-1,i[1]-1,this._bufferService,this._coreService.decPrivateModes.applicationCursorKeys);this._coreService.triggerDataEvent(r,!0)}}}else this._fireEventIfSelectionChanged()},t.prototype._fireEventIfSelectionChanged=function(){var e=this._model.finalSelectionStart,t=this._model.finalSelectionEnd,i=!(!e||!t||e[0]===t[0]&&e[1]===t[1]);i?e&&t&&(this._oldSelectionStart&&this._oldSelectionEnd&&e[0]===this._oldSelectionStart[0]&&e[1]===this._oldSelectionStart[1]&&t[0]===this._oldSelectionEnd[0]&&t[1]===this._oldSelectionEnd[1]||this._fireOnSelectionChange(e,t,i)):this._oldHasSelection&&this._fireOnSelectionChange(e,t,i)},t.prototype._fireOnSelectionChange=function(e,t,i){this._oldSelectionStart=e,this._oldSelectionEnd=t,this._oldHasSelection=i,this._onSelectionChange.fire()},t.prototype._onBufferActivate=function(e){var t=this;this.clearSelection(),this._trimListener.dispose(),this._trimListener=e.activeBuffer.lines.onTrim((function(e){return t._onTrim(e)}))},t.prototype._convertViewportColToCharacterIndex=function(e,t){for(var i=t[0],r=0;t[0]>=r;r++){var n=e.loadCell(r,this._workCell).getChars().length;0===this._workCell.getWidth()?i--:n>1&&t[0]!==r&&(i+=n-1)}return i},t.prototype.setSelection=function(e,t,i){this._model.clearSelection(),this._removeMouseDownListeners(),this._model.selectionStart=[e,t],this._model.selectionStartLength=i,this.refresh(),this._fireEventIfSelectionChanged()},t.prototype.rightClickSelect=function(e){this._isClickInSelection(e)||(this._selectWordAtCursor(e,!1)&&this.refresh(!0),this._fireEventIfSelectionChanged())},t.prototype._getWordAt=function(e,t,i,r){if(void 0===i&&(i=!0),void 0===r&&(r=!0),!(e[0]>=this._bufferService.cols)){var n=this._bufferService.buffer,o=n.lines.get(e[1]);if(o){var s=n.translateBufferLineToString(e[1],!1),a=this._convertViewportColToCharacterIndex(o,e),l=a,c=e[0]-a,d=0,h=0,p=0,u=0;if(" "===s.charAt(a)){for(;a>0&&" "===s.charAt(a-1);)a--;for(;l<s.length&&" "===s.charAt(l+1);)l++}else{var f=e[0],_=e[0];0===o.getWidth(f)&&(d++,f--),2===o.getWidth(_)&&(h++,_++);var g=o.getString(_).length;for(g>1&&(u+=g-1,l+=g-1);f>0&&a>0&&!this._isCharWordSeparator(o.loadCell(f-1,this._workCell));){o.loadCell(f-1,this._workCell);var m=this._workCell.getChars().length;0===this._workCell.getWidth()?(d++,f--):m>1&&(p+=m-1,a-=m-1),a--,f--}for(;_<o.length&&l+1<s.length&&!this._isCharWordSeparator(o.loadCell(_+1,this._workCell));){o.loadCell(_+1,this._workCell);var b=this._workCell.getChars().length;2===this._workCell.getWidth()?(h++,_++):b>1&&(u+=b-1,l+=b-1),l++,_++}}l++;var y=a+c-d+p,v=Math.min(this._bufferService.cols,l-a+d+h-p-u);if(t||""!==s.slice(a,l).trim()){if(i&&0===y&&32!==o.getCodePoint(0)){var w=n.lines.get(e[1]-1);if(w&&o.isWrapped&&32!==w.getCodePoint(this._bufferService.cols-1)){var x=this._getWordAt([this._bufferService.cols-1,e[1]-1],!1,!0,!1);if(x){var C=this._bufferService.cols-x.start;y-=C,v+=C}}}if(r&&y+v===this._bufferService.cols&&32!==o.getCodePoint(this._bufferService.cols-1)){var S=n.lines.get(e[1]+1);if((null==S?void 0:S.isWrapped)&&32!==S.getCodePoint(0)){var E=this._getWordAt([0,e[1]+1],!1,!1,!0);E&&(v+=E.length)}}return{start:y,length:v}}}}},t.prototype._selectWordAt=function(e,t){var i=this._getWordAt(e,t);if(i){for(;i.start<0;)i.start+=this._bufferService.cols,e[1]--;this._model.selectionStart=[i.start,e[1]],this._model.selectionStartLength=i.length}},t.prototype._selectToWordAt=function(e){var t=this._getWordAt(e,!0);if(t){for(var i=e[1];t.start<0;)t.start+=this._bufferService.cols,i--;if(!this._model.areSelectionValuesReversed())for(;t.start+t.length>this._bufferService.cols;)t.length-=this._bufferService.cols,i++;this._model.selectionEnd=[this._model.areSelectionValuesReversed()?t.start:t.start+t.length,i]}},t.prototype._isCharWordSeparator=function(e){return 0!==e.getWidth()&&this._optionsService.rawOptions.wordSeparator.indexOf(e.getChars())>=0},t.prototype._selectLineAt=function(e){var t=this._bufferService.buffer.getWrappedRangeForLine(e),i={start:{x:0,y:t.first},end:{x:this._bufferService.cols-1,y:t.last}};this._model.selectionStart=[0,t.first],this._model.selectionEnd=void 0,this._model.selectionStartLength=(0,g.getRangeLength)(i,this._bufferService.cols)},o([s(3,p.IBufferService),s(4,p.ICoreService),s(5,h.IMouseService),s(6,p.IOptionsService),s(7,h.IRenderService)],t)}(_.Disposable);t.SelectionService=y},4725:(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.ICharacterJoinerService=t.ISoundService=t.ISelectionService=t.IRenderService=t.IMouseService=t.ICoreBrowserService=t.ICharSizeService=void 0;var r=i(8343);t.ICharSizeService=(0,r.createDecorator)("CharSizeService"),t.ICoreBrowserService=(0,r.createDecorator)("CoreBrowserService"),t.IMouseService=(0,r.createDecorator)("MouseService"),t.IRenderService=(0,r.createDecorator)("RenderService"),t.ISelectionService=(0,r.createDecorator)("SelectionService"),t.ISoundService=(0,r.createDecorator)("SoundService"),t.ICharacterJoinerService=(0,r.createDecorator)("CharacterJoinerService")},357:function(e,t,i){var r=this&&this.__decorate||function(e,t,i,r){var n,o=arguments.length,s=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,r);else for(var a=e.length-1;a>=0;a--)(n=e[a])&&(s=(o<3?n(s):o>3?n(t,i,s):n(t,i))||s);return o>3&&s&&Object.defineProperty(t,i,s),s},n=this&&this.__param||function(e,t){return function(i,r){t(i,r,e)}};Object.defineProperty(t,"__esModule",{value:!0}),t.SoundService=void 0;var o=i(2585),s=function(){function e(e){this._optionsService=e}return Object.defineProperty(e,"audioContext",{get:function(){if(!e._audioContext){var t=window.AudioContext||window.webkitAudioContext;if(!t)return console.warn("Web Audio API is not supported by this browser. Consider upgrading to the latest version"),null;e._audioContext=new t}return e._audioContext},enumerable:!1,configurable:!0}),e.prototype.playBellSound=function(){var t=e.audioContext;if(t){var i=t.createBufferSource();t.decodeAudioData(this._base64ToArrayBuffer(this._removeMimeType(this._optionsService.rawOptions.bellSound)),(function(e){i.buffer=e,i.connect(t.destination),i.start(0)}))}},e.prototype._base64ToArrayBuffer=function(e){for(var t=window.atob(e),i=t.length,r=new Uint8Array(i),n=0;n<i;n++)r[n]=t.charCodeAt(n);return r.buffer},e.prototype._removeMimeType=function(e){return e.split(",")[1]},e=r([n(0,o.IOptionsService)],e)}();t.SoundService=s},6349:(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.CircularList=void 0;var r=i(8460),n=function(){function e(e){this._maxLength=e,this.onDeleteEmitter=new r.EventEmitter,this.onInsertEmitter=new r.EventEmitter,this.onTrimEmitter=new r.EventEmitter,this._array=new Array(this._maxLength),this._startIndex=0,this._length=0}return Object.defineProperty(e.prototype,"onDelete",{get:function(){return this.onDeleteEmitter.event},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"onInsert",{get:function(){return this.onInsertEmitter.event},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"onTrim",{get:function(){return this.onTrimEmitter.event},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"maxLength",{get:function(){return this._maxLength},set:function(e){if(this._maxLength!==e){for(var t=new Array(e),i=0;i<Math.min(e,this.length);i++)t[i]=this._array[this._getCyclicIndex(i)];this._array=t,this._maxLength=e,this._startIndex=0}},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"length",{get:function(){return this._length},set:function(e){if(e>this._length)for(var t=this._length;t<e;t++)this._array[t]=void 0;this._length=e},enumerable:!1,configurable:!0}),e.prototype.get=function(e){return this._array[this._getCyclicIndex(e)]},e.prototype.set=function(e,t){this._array[this._getCyclicIndex(e)]=t},e.prototype.push=function(e){this._array[this._getCyclicIndex(this._length)]=e,this._length===this._maxLength?(this._startIndex=++this._startIndex%this._maxLength,this.onTrimEmitter.fire(1)):this._length++},e.prototype.recycle=function(){if(this._length!==this._maxLength)throw new Error("Can only recycle when the buffer is full");return this._startIndex=++this._startIndex%this._maxLength,this.onTrimEmitter.fire(1),this._array[this._getCyclicIndex(this._length-1)]},Object.defineProperty(e.prototype,"isFull",{get:function(){return this._length===this._maxLength},enumerable:!1,configurable:!0}),e.prototype.pop=function(){return this._array[this._getCyclicIndex(this._length---1)]},e.prototype.splice=function(e,t){for(var i=[],r=2;r<arguments.length;r++)i[r-2]=arguments[r];if(t){for(var n=e;n<this._length-t;n++)this._array[this._getCyclicIndex(n)]=this._array[this._getCyclicIndex(n+t)];this._length-=t,this.onDeleteEmitter.fire({index:e,amount:t})}for(n=this._length-1;n>=e;n--)this._array[this._getCyclicIndex(n+i.length)]=this._array[this._getCyclicIndex(n)];for(n=0;n<i.length;n++)this._array[this._getCyclicIndex(e+n)]=i[n];if(i.length&&this.onInsertEmitter.fire({index:e,amount:i.length}),this._length+i.length>this._maxLength){var o=this._length+i.length-this._maxLength;this._startIndex+=o,this._length=this._maxLength,this.onTrimEmitter.fire(o)}else this._length+=i.length},e.prototype.trimStart=function(e){e>this._length&&(e=this._length),this._startIndex+=e,this._length-=e,this.onTrimEmitter.fire(e)},e.prototype.shiftElements=function(e,t,i){if(!(t<=0)){if(e<0||e>=this._length)throw new Error("start argument out of range");if(e+i<0)throw new Error("Cannot shift elements in list beyond index 0");if(i>0){for(var r=t-1;r>=0;r--)this.set(e+r+i,this.get(e+r));var n=e+t+i-this._length;if(n>0)for(this._length+=n;this._length>this._maxLength;)this._length--,this._startIndex++,this.onTrimEmitter.fire(1)}else for(r=0;r<t;r++)this.set(e+r+i,this.get(e+r))}},e.prototype._getCyclicIndex=function(e){return(this._startIndex+e)%this._maxLength},e}();t.CircularList=n},1439:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.clone=void 0,t.clone=function e(t,i){if(void 0===i&&(i=5),"object"!=typeof t)return t;var r=Array.isArray(t)?[]:{};for(var n in t)r[n]=i<=1?t[n]:t[n]&&e(t[n],i-1);return r}},8055:function(e,t){var i,r,n,o,s=this&&this.__read||function(e,t){var i="function"==typeof Symbol&&e[Symbol.iterator];if(!i)return e;var r,n,o=i.call(e),s=[];try{for(;(void 0===t||t-- >0)&&!(r=o.next()).done;)s.push(r.value)}catch(e){n={error:e}}finally{try{r&&!r.done&&(i=o.return)&&i.call(o)}finally{if(n)throw n.error}}return s};function a(e){var t=e.toString(16);return t.length<2?"0"+t:t}function l(e,t){return e<t?(t+.05)/(e+.05):(e+.05)/(t+.05)}Object.defineProperty(t,"__esModule",{value:!0}),t.contrastRatio=t.toPaddedHex=t.rgba=t.rgb=t.css=t.color=t.channels=void 0,function(e){e.toCss=function(e,t,i,r){return void 0!==r?"#"+a(e)+a(t)+a(i)+a(r):"#"+a(e)+a(t)+a(i)},e.toRgba=function(e,t,i,r){return void 0===r&&(r=255),(e<<24|t<<16|i<<8|r)>>>0}}(i=t.channels||(t.channels={})),(r=t.color||(t.color={})).blend=function(e,t){var r=(255&t.rgba)/255;if(1===r)return{css:t.css,rgba:t.rgba};var n=t.rgba>>24&255,o=t.rgba>>16&255,s=t.rgba>>8&255,a=e.rgba>>24&255,l=e.rgba>>16&255,c=e.rgba>>8&255,d=a+Math.round((n-a)*r),h=l+Math.round((o-l)*r),p=c+Math.round((s-c)*r);return{css:i.toCss(d,h,p),rgba:i.toRgba(d,h,p)}},r.isOpaque=function(e){return 255==(255&e.rgba)},r.ensureContrastRatio=function(e,t,i){var r=o.ensureContrastRatio(e.rgba,t.rgba,i);if(r)return o.toColor(r>>24&255,r>>16&255,r>>8&255)},r.opaque=function(e){var t=(255|e.rgba)>>>0,r=s(o.toChannels(t),3),n=r[0],a=r[1],l=r[2];return{css:i.toCss(n,a,l),rgba:t}},r.opacity=function(e,t){var r=Math.round(255*t),n=s(o.toChannels(e.rgba),3),a=n[0],l=n[1],c=n[2];return{css:i.toCss(a,l,c,r),rgba:i.toRgba(a,l,c,r)}},r.toColorRGB=function(e){return[e.rgba>>24&255,e.rgba>>16&255,e.rgba>>8&255]},(t.css||(t.css={})).toColor=function(e){if(e.match(/#[0-9a-f]{3,8}/i))switch(e.length){case 4:var t=parseInt(e.slice(1,2).repeat(2),16),i=parseInt(e.slice(2,3).repeat(2),16),r=parseInt(e.slice(3,4).repeat(2),16);return o.toColor(t,i,r);case 5:t=parseInt(e.slice(1,2).repeat(2),16),i=parseInt(e.slice(2,3).repeat(2),16),r=parseInt(e.slice(3,4).repeat(2),16);var n=parseInt(e.slice(4,5).repeat(2),16);return o.toColor(t,i,r,n);case 7:return{css:e,rgba:(parseInt(e.slice(1),16)<<8|255)>>>0};case 9:return{css:e,rgba:parseInt(e.slice(1),16)>>>0}}var s=e.match(/rgba?\(\s*(\d{1,3})\s*,\s*(\d{1,3})\s*,\s*(\d{1,3})\s*(,\s*(0|1|\d?\.(\d+))\s*)?\)/);if(s)return t=parseInt(s[1]),i=parseInt(s[2]),r=parseInt(s[3]),n=Math.round(255*(void 0===s[5]?1:parseFloat(s[5]))),o.toColor(t,i,r,n);throw new Error("css.toColor: Unsupported css format")},function(e){function t(e,t,i){var r=e/255,n=t/255,o=i/255;return.2126*(r<=.03928?r/12.92:Math.pow((r+.055)/1.055,2.4))+.7152*(n<=.03928?n/12.92:Math.pow((n+.055)/1.055,2.4))+.0722*(o<=.03928?o/12.92:Math.pow((o+.055)/1.055,2.4))}e.relativeLuminance=function(e){return t(e>>16&255,e>>8&255,255&e)},e.relativeLuminance2=t}(n=t.rgb||(t.rgb={})),function(e){function t(e,t,i){for(var r=e>>24&255,o=e>>16&255,s=e>>8&255,a=t>>24&255,c=t>>16&255,d=t>>8&255,h=l(n.relativeLuminance2(a,c,d),n.relativeLuminance2(r,o,s));h<i&&(a>0||c>0||d>0);)a-=Math.max(0,Math.ceil(.1*a)),c-=Math.max(0,Math.ceil(.1*c)),d-=Math.max(0,Math.ceil(.1*d)),h=l(n.relativeLuminance2(a,c,d),n.relativeLuminance2(r,o,s));return(a<<24|c<<16|d<<8|255)>>>0}function r(e,t,i){for(var r=e>>24&255,o=e>>16&255,s=e>>8&255,a=t>>24&255,c=t>>16&255,d=t>>8&255,h=l(n.relativeLuminance2(a,c,d),n.relativeLuminance2(r,o,s));h<i&&(a<255||c<255||d<255);)a=Math.min(255,a+Math.ceil(.1*(255-a))),c=Math.min(255,c+Math.ceil(.1*(255-c))),d=Math.min(255,d+Math.ceil(.1*(255-d))),h=l(n.relativeLuminance2(a,c,d),n.relativeLuminance2(r,o,s));return(a<<24|c<<16|d<<8|255)>>>0}e.ensureContrastRatio=function(e,i,o){var s=n.relativeLuminance(e>>8),a=n.relativeLuminance(i>>8);if(l(s,a)<o){if(a<s){var c=t(e,i,o),d=l(s,n.relativeLuminance(c>>8));if(d<o){var h=r(e,e,o);return d>l(s,n.relativeLuminance(h>>8))?c:h}return c}var p=r(e,i,o),u=l(s,n.relativeLuminance(p>>8));return u<o?(h=t(e,e,o),u>l(s,n.relativeLuminance(h>>8))?p:h):p}},e.reduceLuminance=t,e.increaseLuminance=r,e.toChannels=function(e){return[e>>24&255,e>>16&255,e>>8&255,255&e]},e.toColor=function(e,t,r,n){return{css:i.toCss(e,t,r,n),rgba:i.toRgba(e,t,r,n)}}}(o=t.rgba||(t.rgba={})),t.toPaddedHex=a,t.contrastRatio=l},8969:function(e,t,i){var r,n=this&&this.__extends||(r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])},r(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function i(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),o=this&&this.__values||function(e){var t="function"==typeof Symbol&&Symbol.iterator,i=t&&e[t],r=0;if(i)return i.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(t,"__esModule",{value:!0}),t.CoreTerminal=void 0;var s=i(844),a=i(2585),l=i(4348),c=i(7866),d=i(744),h=i(7302),p=i(6975),u=i(8460),f=i(1753),_=i(3730),g=i(1480),m=i(7994),b=i(9282),y=i(5435),v=i(5981),w=!1,x=function(e){function t(t){var i=e.call(this)||this;return i._onBinary=new u.EventEmitter,i._onData=new u.EventEmitter,i._onLineFeed=new u.EventEmitter,i._onResize=new u.EventEmitter,i._onScroll=new u.EventEmitter,i._onWriteParsed=new u.EventEmitter,i._instantiationService=new l.InstantiationService,i.optionsService=new h.OptionsService(t),i._instantiationService.setService(a.IOptionsService,i.optionsService),i._bufferService=i.register(i._instantiationService.createInstance(d.BufferService)),i._instantiationService.setService(a.IBufferService,i._bufferService),i._logService=i._instantiationService.createInstance(c.LogService),i._instantiationService.setService(a.ILogService,i._logService),i.coreService=i.register(i._instantiationService.createInstance(p.CoreService,(function(){return i.scrollToBottom()}))),i._instantiationService.setService(a.ICoreService,i.coreService),i.coreMouseService=i._instantiationService.createInstance(f.CoreMouseService),i._instantiationService.setService(a.ICoreMouseService,i.coreMouseService),i._dirtyRowService=i._instantiationService.createInstance(_.DirtyRowService),i._instantiationService.setService(a.IDirtyRowService,i._dirtyRowService),i.unicodeService=i._instantiationService.createInstance(g.UnicodeService),i._instantiationService.setService(a.IUnicodeService,i.unicodeService),i._charsetService=i._instantiationService.createInstance(m.CharsetService),i._instantiationService.setService(a.ICharsetService,i._charsetService),i._inputHandler=new y.InputHandler(i._bufferService,i._charsetService,i.coreService,i._dirtyRowService,i._logService,i.optionsService,i.coreMouseService,i.unicodeService),i.register((0,u.forwardEvent)(i._inputHandler.onLineFeed,i._onLineFeed)),i.register(i._inputHandler),i.register((0,u.forwardEvent)(i._bufferService.onResize,i._onResize)),i.register((0,u.forwardEvent)(i.coreService.onData,i._onData)),i.register((0,u.forwardEvent)(i.coreService.onBinary,i._onBinary)),i.register(i.optionsService.onOptionChange((function(e){return i._updateOptions(e)}))),i.register(i._bufferService.onScroll((function(e){i._onScroll.fire({position:i._bufferService.buffer.ydisp,source:0}),i._dirtyRowService.markRangeDirty(i._bufferService.buffer.scrollTop,i._bufferService.buffer.scrollBottom)}))),i.register(i._inputHandler.onScroll((function(e){i._onScroll.fire({position:i._bufferService.buffer.ydisp,source:0}),i._dirtyRowService.markRangeDirty(i._bufferService.buffer.scrollTop,i._bufferService.buffer.scrollBottom)}))),i._writeBuffer=new v.WriteBuffer((function(e,t){return i._inputHandler.parse(e,t)})),i.register((0,u.forwardEvent)(i._writeBuffer.onWriteParsed,i._onWriteParsed)),i}return n(t,e),Object.defineProperty(t.prototype,"onBinary",{get:function(){return this._onBinary.event},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"onData",{get:function(){return this._onData.event},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"onLineFeed",{get:function(){return this._onLineFeed.event},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"onResize",{get:function(){return this._onResize.event},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"onWriteParsed",{get:function(){return this._onWriteParsed.event},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"onScroll",{get:function(){var e=this;return this._onScrollApi||(this._onScrollApi=new u.EventEmitter,this.register(this._onScroll.event((function(t){var i;null===(i=e._onScrollApi)||void 0===i||i.fire(t.position)})))),this._onScrollApi.event},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"cols",{get:function(){return this._bufferService.cols},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"rows",{get:function(){return this._bufferService.rows},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"buffers",{get:function(){return this._bufferService.buffers},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"options",{get:function(){return this.optionsService.options},set:function(e){for(var t in e)this.optionsService.options[t]=e[t]},enumerable:!1,configurable:!0}),t.prototype.dispose=function(){var t;this._isDisposed||(e.prototype.dispose.call(this),null===(t=this._windowsMode)||void 0===t||t.dispose(),this._windowsMode=void 0)},t.prototype.write=function(e,t){this._writeBuffer.write(e,t)},t.prototype.writeSync=function(e,t){this._logService.logLevel<=a.LogLevelEnum.WARN&&!w&&(this._logService.warn("writeSync is unreliable and will be removed soon."),w=!0),this._writeBuffer.writeSync(e,t)},t.prototype.resize=function(e,t){isNaN(e)||isNaN(t)||(e=Math.max(e,d.MINIMUM_COLS),t=Math.max(t,d.MINIMUM_ROWS),this._bufferService.resize(e,t))},t.prototype.scroll=function(e,t){void 0===t&&(t=!1),this._bufferService.scroll(e,t)},t.prototype.scrollLines=function(e,t,i){this._bufferService.scrollLines(e,t,i)},t.prototype.scrollPages=function(e){this._bufferService.scrollPages(e)},t.prototype.scrollToTop=function(){this._bufferService.scrollToTop()},t.prototype.scrollToBottom=function(){this._bufferService.scrollToBottom()},t.prototype.scrollToLine=function(e){this._bufferService.scrollToLine(e)},t.prototype.registerEscHandler=function(e,t){return this._inputHandler.registerEscHandler(e,t)},t.prototype.registerDcsHandler=function(e,t){return this._inputHandler.registerDcsHandler(e,t)},t.prototype.registerCsiHandler=function(e,t){return this._inputHandler.registerCsiHandler(e,t)},t.prototype.registerOscHandler=function(e,t){return this._inputHandler.registerOscHandler(e,t)},t.prototype._setup=function(){this.optionsService.rawOptions.windowsMode&&this._enableWindowsMode()},t.prototype.reset=function(){this._inputHandler.reset(),this._bufferService.reset(),this._charsetService.reset(),this.coreService.reset(),this.coreMouseService.reset()},t.prototype._updateOptions=function(e){var t;switch(e){case"scrollback":this.buffers.resize(this.cols,this.rows);break;case"windowsMode":this.optionsService.rawOptions.windowsMode?this._enableWindowsMode():(null===(t=this._windowsMode)||void 0===t||t.dispose(),this._windowsMode=void 0)}},t.prototype._enableWindowsMode=function(){var e=this;if(!this._windowsMode){var t=[];t.push(this.onLineFeed(b.updateWindowsModeWrappedState.bind(null,this._bufferService))),t.push(this.registerCsiHandler({final:"H"},(function(){return(0,b.updateWindowsModeWrappedState)(e._bufferService),!1}))),this._windowsMode={dispose:function(){var e,i;try{for(var r=o(t),n=r.next();!n.done;n=r.next())n.value.dispose()}catch(t){e={error:t}}finally{try{n&&!n.done&&(i=r.return)&&i.call(r)}finally{if(e)throw e.error}}}}}},t}(s.Disposable);t.CoreTerminal=x},8460:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.forwardEvent=t.EventEmitter=void 0;var i=function(){function e(){this._listeners=[],this._disposed=!1}return Object.defineProperty(e.prototype,"event",{get:function(){var e=this;return this._event||(this._event=function(t){return e._listeners.push(t),{dispose:function(){if(!e._disposed)for(var i=0;i<e._listeners.length;i++)if(e._listeners[i]===t)return void e._listeners.splice(i,1)}}}),this._event},enumerable:!1,configurable:!0}),e.prototype.fire=function(e,t){for(var i=[],r=0;r<this._listeners.length;r++)i.push(this._listeners[r]);for(r=0;r<i.length;r++)i[r].call(void 0,e,t)},e.prototype.dispose=function(){this._listeners&&(this._listeners.length=0),this._disposed=!0},e}();t.EventEmitter=i,t.forwardEvent=function(e,t){return e((function(e){return t.fire(e)}))}},5435:function(e,t,i){var r,n=this&&this.__extends||(r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])},r(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function i(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)});Object.defineProperty(t,"__esModule",{value:!0}),t.InputHandler=t.WindowsOptionsReportType=void 0;var o,s=i(2584),a=i(7116),l=i(2015),c=i(844),d=i(8273),h=i(482),p=i(8437),u=i(8460),f=i(643),_=i(511),g=i(3734),m=i(2585),b=i(6242),y=i(6351),v=i(5941),w={"(":0,")":1,"*":2,"+":3,"-":1,".":2},x=131072;function C(e,t){if(e>24)return t.setWinLines||!1;switch(e){case 1:return!!t.restoreWin;case 2:return!!t.minimizeWin;case 3:return!!t.setWinPosition;case 4:return!!t.setWinSizePixels;case 5:return!!t.raiseWin;case 6:return!!t.lowerWin;case 7:return!!t.refreshWin;case 8:return!!t.setWinSizeChars;case 9:return!!t.maximizeWin;case 10:return!!t.fullscreenWin;case 11:return!!t.getWinState;case 13:return!!t.getWinPosition;case 14:return!!t.getWinSizePixels;case 15:return!!t.getScreenSizePixels;case 16:return!!t.getCellSizePixels;case 18:return!!t.getWinSizeChars;case 19:return!!t.getScreenSizeChars;case 20:return!!t.getIconTitle;case 21:return!!t.getWinTitle;case 22:return!!t.pushTitle;case 23:return!!t.popTitle;case 24:return!!t.setWinLines}return!1}!function(e){e[e.GET_WIN_SIZE_PIXELS=0]="GET_WIN_SIZE_PIXELS",e[e.GET_CELL_SIZE_PIXELS=1]="GET_CELL_SIZE_PIXELS"}(o=t.WindowsOptionsReportType||(t.WindowsOptionsReportType={}));var S=function(){function e(e,t,i,r){this._bufferService=e,this._coreService=t,this._logService=i,this._optionsService=r,this._data=new Uint32Array(0)}return e.prototype.hook=function(e){this._data=new Uint32Array(0)},e.prototype.put=function(e,t,i){this._data=(0,d.concat)(this._data,e.subarray(t,i))},e.prototype.unhook=function(e){if(!e)return this._data=new Uint32Array(0),!0;var t=(0,h.utf32ToString)(this._data);switch(this._data=new Uint32Array(0),t){case'"q':this._coreService.triggerDataEvent(s.C0.ESC+'P1$r0"q'+s.C0.ESC+"\\");break;case'"p':this._coreService.triggerDataEvent(s.C0.ESC+'P1$r61;1"p'+s.C0.ESC+"\\");break;case"r":var i=this._bufferService.buffer.scrollTop+1+";"+(this._bufferService.buffer.scrollBottom+1)+"r";this._coreService.triggerDataEvent(s.C0.ESC+"P1$r"+i+s.C0.ESC+"\\");break;case"m":this._coreService.triggerDataEvent(s.C0.ESC+"P1$r0m"+s.C0.ESC+"\\");break;case" q":var r={block:2,underline:4,bar:6}[this._optionsService.rawOptions.cursorStyle];r-=this._optionsService.rawOptions.cursorBlink?1:0,this._coreService.triggerDataEvent(s.C0.ESC+"P1$r"+r+" q"+s.C0.ESC+"\\");break;default:this._logService.debug("Unknown DCS $q %s",t),this._coreService.triggerDataEvent(s.C0.ESC+"P0$r"+s.C0.ESC+"\\")}return!0},e}(),E=function(e){function t(t,i,r,n,o,c,d,f,g){void 0===g&&(g=new l.EscapeSequenceParser);var m=e.call(this)||this;m._bufferService=t,m._charsetService=i,m._coreService=r,m._dirtyRowService=n,m._logService=o,m._optionsService=c,m._coreMouseService=d,m._unicodeService=f,m._parser=g,m._parseBuffer=new Uint32Array(4096),m._stringDecoder=new h.StringToUtf32,m._utf8Decoder=new h.Utf8ToUtf32,m._workCell=new _.CellData,m._windowTitle="",m._iconName="",m._windowTitleStack=[],m._iconNameStack=[],m._curAttrData=p.DEFAULT_ATTR_DATA.clone(),m._eraseAttrDataInternal=p.DEFAULT_ATTR_DATA.clone(),m._onRequestBell=new u.EventEmitter,m._onRequestRefreshRows=new u.EventEmitter,m._onRequestReset=new u.EventEmitter,m._onRequestSendFocus=new u.EventEmitter,m._onRequestSyncScrollBar=new u.EventEmitter,m._onRequestWindowsOptionsReport=new u.EventEmitter,m._onA11yChar=new u.EventEmitter,m._onA11yTab=new u.EventEmitter,m._onCursorMove=new u.EventEmitter,m._onLineFeed=new u.EventEmitter,m._onScroll=new u.EventEmitter,m._onTitleChange=new u.EventEmitter,m._onColor=new u.EventEmitter,m._parseStack={paused:!1,cursorStartX:0,cursorStartY:0,decodedLength:0,position:0},m._specialColors=[256,257,258],m.register(m._parser),m._activeBuffer=m._bufferService.buffer,m.register(m._bufferService.buffers.onBufferActivate((function(e){return m._activeBuffer=e.activeBuffer}))),m._parser.setCsiHandlerFallback((function(e,t){m._logService.debug("Unknown CSI code: ",{identifier:m._parser.identToString(e),params:t.toArray()})})),m._parser.setEscHandlerFallback((function(e){m._logService.debug("Unknown ESC code: ",{identifier:m._parser.identToString(e)})})),m._parser.setExecuteHandlerFallback((function(e){m._logService.debug("Unknown EXECUTE code: ",{code:e})})),m._parser.setOscHandlerFallback((function(e,t,i){m._logService.debug("Unknown OSC code: ",{identifier:e,action:t,data:i})})),m._parser.setDcsHandlerFallback((function(e,t,i){"HOOK"===t&&(i=i.toArray()),m._logService.debug("Unknown DCS code: ",{identifier:m._parser.identToString(e),action:t,payload:i})})),m._parser.setPrintHandler((function(e,t,i){return m.print(e,t,i)})),m._parser.registerCsiHandler({final:"@"},(function(e){return m.insertChars(e)})),m._parser.registerCsiHandler({intermediates:" ",final:"@"},(function(e){return m.scrollLeft(e)})),m._parser.registerCsiHandler({final:"A"},(function(e){return m.cursorUp(e)})),m._parser.registerCsiHandler({intermediates:" ",final:"A"},(function(e){return m.scrollRight(e)})),m._parser.registerCsiHandler({final:"B"},(function(e){return m.cursorDown(e)})),m._parser.registerCsiHandler({final:"C"},(function(e){return m.cursorForward(e)})),m._parser.registerCsiHandler({final:"D"},(function(e){return m.cursorBackward(e)})),m._parser.registerCsiHandler({final:"E"},(function(e){return m.cursorNextLine(e)})),m._parser.registerCsiHandler({final:"F"},(function(e){return m.cursorPrecedingLine(e)})),m._parser.registerCsiHandler({final:"G"},(function(e){return m.cursorCharAbsolute(e)})),m._parser.registerCsiHandler({final:"H"},(function(e){return m.cursorPosition(e)})),m._parser.registerCsiHandler({final:"I"},(function(e){return m.cursorForwardTab(e)})),m._parser.registerCsiHandler({final:"J"},(function(e){return m.eraseInDisplay(e)})),m._parser.registerCsiHandler({prefix:"?",final:"J"},(function(e){return m.eraseInDisplay(e)})),m._parser.registerCsiHandler({final:"K"},(function(e){return m.eraseInLine(e)})),m._parser.registerCsiHandler({prefix:"?",final:"K"},(function(e){return m.eraseInLine(e)})),m._parser.registerCsiHandler({final:"L"},(function(e){return m.insertLines(e)})),m._parser.registerCsiHandler({final:"M"},(function(e){return m.deleteLines(e)})),m._parser.registerCsiHandler({final:"P"},(function(e){return m.deleteChars(e)})),m._parser.registerCsiHandler({final:"S"},(function(e){return m.scrollUp(e)})),m._parser.registerCsiHandler({final:"T"},(function(e){return m.scrollDown(e)})),m._parser.registerCsiHandler({final:"X"},(function(e){return m.eraseChars(e)})),m._parser.registerCsiHandler({final:"Z"},(function(e){return m.cursorBackwardTab(e)})),m._parser.registerCsiHandler({final:"`"},(function(e){return m.charPosAbsolute(e)})),m._parser.registerCsiHandler({final:"a"},(function(e){return m.hPositionRelative(e)})),m._parser.registerCsiHandler({final:"b"},(function(e){return m.repeatPrecedingCharacter(e)})),m._parser.registerCsiHandler({final:"c"},(function(e){return m.sendDeviceAttributesPrimary(e)})),m._parser.registerCsiHandler({prefix:">",final:"c"},(function(e){return m.sendDeviceAttributesSecondary(e)})),m._parser.registerCsiHandler({final:"d"},(function(e){return m.linePosAbsolute(e)})),m._parser.registerCsiHandler({final:"e"},(function(e){return m.vPositionRelative(e)})),m._parser.registerCsiHandler({final:"f"},(function(e){return m.hVPosition(e)})),m._parser.registerCsiHandler({final:"g"},(function(e){return m.tabClear(e)})),m._parser.registerCsiHandler({final:"h"},(function(e){return m.setMode(e)})),m._parser.registerCsiHandler({prefix:"?",final:"h"},(function(e){return m.setModePrivate(e)})),m._parser.registerCsiHandler({final:"l"},(function(e){return m.resetMode(e)})),m._parser.registerCsiHandler({prefix:"?",final:"l"},(function(e){return m.resetModePrivate(e)})),m._parser.registerCsiHandler({final:"m"},(function(e){return m.charAttributes(e)})),m._parser.registerCsiHandler({final:"n"},(function(e){return m.deviceStatus(e)})),m._parser.registerCsiHandler({prefix:"?",final:"n"},(function(e){return m.deviceStatusPrivate(e)})),m._parser.registerCsiHandler({intermediates:"!",final:"p"},(function(e){return m.softReset(e)})),m._parser.registerCsiHandler({intermediates:" ",final:"q"},(function(e){return m.setCursorStyle(e)})),m._parser.registerCsiHandler({final:"r"},(function(e){return m.setScrollRegion(e)})),m._parser.registerCsiHandler({final:"s"},(function(e){return m.saveCursor(e)})),m._parser.registerCsiHandler({final:"t"},(function(e){return m.windowOptions(e)})),m._parser.registerCsiHandler({final:"u"},(function(e){return m.restoreCursor(e)})),m._parser.registerCsiHandler({intermediates:"'",final:"}"},(function(e){return m.insertColumns(e)})),m._parser.registerCsiHandler({intermediates:"'",final:"~"},(function(e){return m.deleteColumns(e)})),m._parser.setExecuteHandler(s.C0.BEL,(function(){return m.bell()})),m._parser.setExecuteHandler(s.C0.LF,(function(){return m.lineFeed()})),m._parser.setExecuteHandler(s.C0.VT,(function(){return m.lineFeed()})),m._parser.setExecuteHandler(s.C0.FF,(function(){return m.lineFeed()})),m._parser.setExecuteHandler(s.C0.CR,(function(){return m.carriageReturn()})),m._parser.setExecuteHandler(s.C0.BS,(function(){return m.backspace()})),m._parser.setExecuteHandler(s.C0.HT,(function(){return m.tab()})),m._parser.setExecuteHandler(s.C0.SO,(function(){return m.shiftOut()})),m._parser.setExecuteHandler(s.C0.SI,(function(){return m.shiftIn()})),m._parser.setExecuteHandler(s.C1.IND,(function(){return m.index()})),m._parser.setExecuteHandler(s.C1.NEL,(function(){return m.nextLine()})),m._parser.setExecuteHandler(s.C1.HTS,(function(){return m.tabSet()})),m._parser.registerOscHandler(0,new b.OscHandler((function(e){return m.setTitle(e),m.setIconName(e),!0}))),m._parser.registerOscHandler(1,new b.OscHandler((function(e){return m.setIconName(e)}))),m._parser.registerOscHandler(2,new b.OscHandler((function(e){return m.setTitle(e)}))),m._parser.registerOscHandler(4,new b.OscHandler((function(e){return m.setOrReportIndexedColor(e)}))),m._parser.registerOscHandler(10,new b.OscHandler((function(e){return m.setOrReportFgColor(e)}))),m._parser.registerOscHandler(11,new b.OscHandler((function(e){return m.setOrReportBgColor(e)}))),m._parser.registerOscHandler(12,new b.OscHandler((function(e){return m.setOrReportCursorColor(e)}))),m._parser.registerOscHandler(104,new b.OscHandler((function(e){return m.restoreIndexedColor(e)}))),m._parser.registerOscHandler(110,new b.OscHandler((function(e){return m.restoreFgColor(e)}))),m._parser.registerOscHandler(111,new b.OscHandler((function(e){return m.restoreBgColor(e)}))),m._parser.registerOscHandler(112,new b.OscHandler((function(e){return m.restoreCursorColor(e)}))),m._parser.registerEscHandler({final:"7"},(function(){return m.saveCursor()})),m._parser.registerEscHandler({final:"8"},(function(){return m.restoreCursor()})),m._parser.registerEscHandler({final:"D"},(function(){return m.index()})),m._parser.registerEscHandler({final:"E"},(function(){return m.nextLine()})),m._parser.registerEscHandler({final:"H"},(function(){return m.tabSet()})),m._parser.registerEscHandler({final:"M"},(function(){return m.reverseIndex()})),m._parser.registerEscHandler({final:"="},(function(){return m.keypadApplicationMode()})),m._parser.registerEscHandler({final:">"},(function(){return m.keypadNumericMode()})),m._parser.registerEscHandler({final:"c"},(function(){return m.fullReset()})),m._parser.registerEscHandler({final:"n"},(function(){return m.setgLevel(2)})),m._parser.registerEscHandler({final:"o"},(function(){return m.setgLevel(3)})),m._parser.registerEscHandler({final:"|"},(function(){return m.setgLevel(3)})),m._parser.registerEscHandler({final:"}"},(function(){return m.setgLevel(2)})),m._parser.registerEscHandler({final:"~"},(function(){return m.setgLevel(1)})),m._parser.registerEscHandler({intermediates:"%",final:"@"},(function(){return m.selectDefaultCharset()})),m._parser.registerEscHandler({intermediates:"%",final:"G"},(function(){return m.selectDefaultCharset()}));var y=function(e){v._parser.registerEscHandler({intermediates:"(",final:e},(function(){return m.selectCharset("("+e)})),v._parser.registerEscHandler({intermediates:")",final:e},(function(){return m.selectCharset(")"+e)})),v._parser.registerEscHandler({intermediates:"*",final:e},(function(){return m.selectCharset("*"+e)})),v._parser.registerEscHandler({intermediates:"+",final:e},(function(){return m.selectCharset("+"+e)})),v._parser.registerEscHandler({intermediates:"-",final:e},(function(){return m.selectCharset("-"+e)})),v._parser.registerEscHandler({intermediates:".",final:e},(function(){return m.selectCharset("."+e)})),v._parser.registerEscHandler({intermediates:"/",final:e},(function(){return m.selectCharset("/"+e)}))},v=this;for(var w in a.CHARSETS)y(w);return m._parser.registerEscHandler({intermediates:"#",final:"8"},(function(){return m.screenAlignmentPattern()})),m._parser.setErrorHandler((function(e){return m._logService.error("Parsing error: ",e),e})),m._parser.registerDcsHandler({intermediates:"$",final:"q"},new S(m._bufferService,m._coreService,m._logService,m._optionsService)),m}return n(t,e),Object.defineProperty(t.prototype,"onRequestBell",{get:function(){return this._onRequestBell.event},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"onRequestRefreshRows",{get:function(){return this._onRequestRefreshRows.event},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"onRequestReset",{get:function(){return this._onRequestReset.event},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"onRequestSendFocus",{get:function(){return this._onRequestSendFocus.event},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"onRequestSyncScrollBar",{get:function(){return this._onRequestSyncScrollBar.event},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"onRequestWindowsOptionsReport",{get:function(){return this._onRequestWindowsOptionsReport.event},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"onA11yChar",{get:function(){return this._onA11yChar.event},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"onA11yTab",{get:function(){return this._onA11yTab.event},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"onCursorMove",{get:function(){return this._onCursorMove.event},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"onLineFeed",{get:function(){return this._onLineFeed.event},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"onScroll",{get:function(){return this._onScroll.event},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"onTitleChange",{get:function(){return this._onTitleChange.event},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"onColor",{get:function(){return this._onColor.event},enumerable:!1,configurable:!0}),t.prototype.dispose=function(){e.prototype.dispose.call(this)},t.prototype._preserveStack=function(e,t,i,r){this._parseStack.paused=!0,this._parseStack.cursorStartX=e,this._parseStack.cursorStartY=t,this._parseStack.decodedLength=i,this._parseStack.position=r},t.prototype._logSlowResolvingAsync=function(e){this._logService.logLevel<=m.LogLevelEnum.WARN&&Promise.race([e,new Promise((function(e,t){return setTimeout((function(){return t("#SLOW_TIMEOUT")}),5e3)}))]).catch((function(e){if("#SLOW_TIMEOUT"!==e)throw e;console.warn("async parser handler taking longer than 5000 ms")}))},t.prototype.parse=function(e,t){var i,r=this._activeBuffer.x,n=this._activeBuffer.y,o=0,s=this._parseStack.paused;if(s){if(i=this._parser.parse(this._parseBuffer,this._parseStack.decodedLength,t))return this._logSlowResolvingAsync(i),i;r=this._parseStack.cursorStartX,n=this._parseStack.cursorStartY,this._parseStack.paused=!1,e.length>x&&(o=this._parseStack.position+x)}if(this._logService.logLevel<=m.LogLevelEnum.DEBUG&&this._logService.debug("parsing data"+("string"==typeof e?' "'+e+'"':' "'+Array.prototype.map.call(e,(function(e){return String.fromCharCode(e)})).join("")+'"'),"string"==typeof e?e.split("").map((function(e){return e.charCodeAt(0)})):e),this._parseBuffer.length<e.length&&this._parseBuffer.length<x&&(this._parseBuffer=new Uint32Array(Math.min(e.length,x))),s||this._dirtyRowService.clearRange(),e.length>x)for(var a=o;a<e.length;a+=x){var l=a+x<e.length?a+x:e.length,c="string"==typeof e?this._stringDecoder.decode(e.substring(a,l),this._parseBuffer):this._utf8Decoder.decode(e.subarray(a,l),this._parseBuffer);if(i=this._parser.parse(this._parseBuffer,c))return this._preserveStack(r,n,c,a),this._logSlowResolvingAsync(i),i}else if(!s&&(c="string"==typeof e?this._stringDecoder.decode(e,this._parseBuffer):this._utf8Decoder.decode(e,this._parseBuffer),i=this._parser.parse(this._parseBuffer,c)))return this._preserveStack(r,n,c,0),this._logSlowResolvingAsync(i),i;this._activeBuffer.x===r&&this._activeBuffer.y===n||this._onCursorMove.fire(),this._onRequestRefreshRows.fire(this._dirtyRowService.start,this._dirtyRowService.end)},t.prototype.print=function(e,t,i){var r,n,o=this._charsetService.charset,s=this._optionsService.rawOptions.screenReaderMode,a=this._bufferService.cols,l=this._coreService.decPrivateModes.wraparound,c=this._coreService.modes.insertMode,d=this._curAttrData,p=this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y);this._dirtyRowService.markDirty(this._activeBuffer.y),this._activeBuffer.x&&i-t>0&&2===p.getWidth(this._activeBuffer.x-1)&&p.setCellFromCodePoint(this._activeBuffer.x-1,0,1,d.fg,d.bg,d.extended);for(var u=t;u<i;++u){if(r=e[u],n=this._unicodeService.wcwidth(r),r<127&&o){var _=o[String.fromCharCode(r)];_&&(r=_.charCodeAt(0))}if(s&&this._onA11yChar.fire((0,h.stringFromCodePoint)(r)),n||!this._activeBuffer.x){if(this._activeBuffer.x+n-1>=a)if(l){for(;this._activeBuffer.x<a;)p.setCellFromCodePoint(this._activeBuffer.x++,0,1,d.fg,d.bg,d.extended);this._activeBuffer.x=0,this._activeBuffer.y++,this._activeBuffer.y===this._activeBuffer.scrollBottom+1?(this._activeBuffer.y--,this._bufferService.scroll(this._eraseAttrData(),!0)):(this._activeBuffer.y>=this._bufferService.rows&&(this._activeBuffer.y=this._bufferService.rows-1),this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y).isWrapped=!0),p=this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y)}else if(this._activeBuffer.x=a-1,2===n)continue;if(c&&(p.insertCells(this._activeBuffer.x,n,this._activeBuffer.getNullCell(d),d),2===p.getWidth(a-1)&&p.setCellFromCodePoint(a-1,f.NULL_CELL_CODE,f.NULL_CELL_WIDTH,d.fg,d.bg,d.extended)),p.setCellFromCodePoint(this._activeBuffer.x++,r,n,d.fg,d.bg,d.extended),n>0)for(;--n;)p.setCellFromCodePoint(this._activeBuffer.x++,0,0,d.fg,d.bg,d.extended)}else p.getWidth(this._activeBuffer.x-1)?p.addCodepointToCell(this._activeBuffer.x-1,r):p.addCodepointToCell(this._activeBuffer.x-2,r)}i-t>0&&(p.loadCell(this._activeBuffer.x-1,this._workCell),2===this._workCell.getWidth()||this._workCell.getCode()>65535?this._parser.precedingCodepoint=0:this._workCell.isCombined()?this._parser.precedingCodepoint=this._workCell.getChars().charCodeAt(0):this._parser.precedingCodepoint=this._workCell.content),this._activeBuffer.x<a&&i-t>0&&0===p.getWidth(this._activeBuffer.x)&&!p.hasContent(this._activeBuffer.x)&&p.setCellFromCodePoint(this._activeBuffer.x,0,1,d.fg,d.bg,d.extended),this._dirtyRowService.markDirty(this._activeBuffer.y)},t.prototype.registerCsiHandler=function(e,t){var i=this;return"t"!==e.final||e.prefix||e.intermediates?this._parser.registerCsiHandler(e,t):this._parser.registerCsiHandler(e,(function(e){return!C(e.params[0],i._optionsService.rawOptions.windowOptions)||t(e)}))},t.prototype.registerDcsHandler=function(e,t){return this._parser.registerDcsHandler(e,new y.DcsHandler(t))},t.prototype.registerEscHandler=function(e,t){return this._parser.registerEscHandler(e,t)},t.prototype.registerOscHandler=function(e,t){return this._parser.registerOscHandler(e,new b.OscHandler(t))},t.prototype.bell=function(){return this._onRequestBell.fire(),!0},t.prototype.lineFeed=function(){return this._dirtyRowService.markDirty(this._activeBuffer.y),this._optionsService.rawOptions.convertEol&&(this._activeBuffer.x=0),this._activeBuffer.y++,this._activeBuffer.y===this._activeBuffer.scrollBottom+1?(this._activeBuffer.y--,this._bufferService.scroll(this._eraseAttrData())):this._activeBuffer.y>=this._bufferService.rows&&(this._activeBuffer.y=this._bufferService.rows-1),this._activeBuffer.x>=this._bufferService.cols&&this._activeBuffer.x--,this._dirtyRowService.markDirty(this._activeBuffer.y),this._onLineFeed.fire(),!0},t.prototype.carriageReturn=function(){return this._activeBuffer.x=0,!0},t.prototype.backspace=function(){var e;if(!this._coreService.decPrivateModes.reverseWraparound)return this._restrictCursor(),this._activeBuffer.x>0&&this._activeBuffer.x--,!0;if(this._restrictCursor(this._bufferService.cols),this._activeBuffer.x>0)this._activeBuffer.x--;else if(0===this._activeBuffer.x&&this._activeBuffer.y>this._activeBuffer.scrollTop&&this._activeBuffer.y<=this._activeBuffer.scrollBottom&&(null===(e=this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y))||void 0===e?void 0:e.isWrapped)){this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y).isWrapped=!1,this._activeBuffer.y--,this._activeBuffer.x=this._bufferService.cols-1;var t=this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y);t.hasWidth(this._activeBuffer.x)&&!t.hasContent(this._activeBuffer.x)&&this._activeBuffer.x--}return this._restrictCursor(),!0},t.prototype.tab=function(){if(this._activeBuffer.x>=this._bufferService.cols)return!0;var e=this._activeBuffer.x;return this._activeBuffer.x=this._activeBuffer.nextStop(),this._optionsService.rawOptions.screenReaderMode&&this._onA11yTab.fire(this._activeBuffer.x-e),!0},t.prototype.shiftOut=function(){return this._charsetService.setgLevel(1),!0},t.prototype.shiftIn=function(){return this._charsetService.setgLevel(0),!0},t.prototype._restrictCursor=function(e){void 0===e&&(e=this._bufferService.cols-1),this._activeBuffer.x=Math.min(e,Math.max(0,this._activeBuffer.x)),this._activeBuffer.y=this._coreService.decPrivateModes.origin?Math.min(this._activeBuffer.scrollBottom,Math.max(this._activeBuffer.scrollTop,this._activeBuffer.y)):Math.min(this._bufferService.rows-1,Math.max(0,this._activeBuffer.y)),this._dirtyRowService.markDirty(this._activeBuffer.y)},t.prototype._setCursor=function(e,t){this._dirtyRowService.markDirty(this._activeBuffer.y),this._coreService.decPrivateModes.origin?(this._activeBuffer.x=e,this._activeBuffer.y=this._activeBuffer.scrollTop+t):(this._activeBuffer.x=e,this._activeBuffer.y=t),this._restrictCursor(),this._dirtyRowService.markDirty(this._activeBuffer.y)},t.prototype._moveCursor=function(e,t){this._restrictCursor(),this._setCursor(this._activeBuffer.x+e,this._activeBuffer.y+t)},t.prototype.cursorUp=function(e){var t=this._activeBuffer.y-this._activeBuffer.scrollTop;return t>=0?this._moveCursor(0,-Math.min(t,e.params[0]||1)):this._moveCursor(0,-(e.params[0]||1)),!0},t.prototype.cursorDown=function(e){var t=this._activeBuffer.scrollBottom-this._activeBuffer.y;return t>=0?this._moveCursor(0,Math.min(t,e.params[0]||1)):this._moveCursor(0,e.params[0]||1),!0},t.prototype.cursorForward=function(e){return this._moveCursor(e.params[0]||1,0),!0},t.prototype.cursorBackward=function(e){return this._moveCursor(-(e.params[0]||1),0),!0},t.prototype.cursorNextLine=function(e){return this.cursorDown(e),this._activeBuffer.x=0,!0},t.prototype.cursorPrecedingLine=function(e){return this.cursorUp(e),this._activeBuffer.x=0,!0},t.prototype.cursorCharAbsolute=function(e){return this._setCursor((e.params[0]||1)-1,this._activeBuffer.y),!0},t.prototype.cursorPosition=function(e){return this._setCursor(e.length>=2?(e.params[1]||1)-1:0,(e.params[0]||1)-1),!0},t.prototype.charPosAbsolute=function(e){return this._setCursor((e.params[0]||1)-1,this._activeBuffer.y),!0},t.prototype.hPositionRelative=function(e){return this._moveCursor(e.params[0]||1,0),!0},t.prototype.linePosAbsolute=function(e){return this._setCursor(this._activeBuffer.x,(e.params[0]||1)-1),!0},t.prototype.vPositionRelative=function(e){return this._moveCursor(0,e.params[0]||1),!0},t.prototype.hVPosition=function(e){return this.cursorPosition(e),!0},t.prototype.tabClear=function(e){var t=e.params[0];return 0===t?delete this._activeBuffer.tabs[this._activeBuffer.x]:3===t&&(this._activeBuffer.tabs={}),!0},t.prototype.cursorForwardTab=function(e){if(this._activeBuffer.x>=this._bufferService.cols)return!0;for(var t=e.params[0]||1;t--;)this._activeBuffer.x=this._activeBuffer.nextStop();return!0},t.prototype.cursorBackwardTab=function(e){if(this._activeBuffer.x>=this._bufferService.cols)return!0;for(var t=e.params[0]||1;t--;)this._activeBuffer.x=this._activeBuffer.prevStop();return!0},t.prototype._eraseInBufferLine=function(e,t,i,r){void 0===r&&(r=!1);var n=this._activeBuffer.lines.get(this._activeBuffer.ybase+e);n.replaceCells(t,i,this._activeBuffer.getNullCell(this._eraseAttrData()),this._eraseAttrData()),r&&(n.isWrapped=!1)},t.prototype._resetBufferLine=function(e){var t=this._activeBuffer.lines.get(this._activeBuffer.ybase+e);t.fill(this._activeBuffer.getNullCell(this._eraseAttrData())),this._bufferService.buffer.clearMarkers(this._activeBuffer.ybase+e),t.isWrapped=!1},t.prototype.eraseInDisplay=function(e){var t;switch(this._restrictCursor(this._bufferService.cols),e.params[0]){case 0:for(t=this._activeBuffer.y,this._dirtyRowService.markDirty(t),this._eraseInBufferLine(t++,this._activeBuffer.x,this._bufferService.cols,0===this._activeBuffer.x);t<this._bufferService.rows;t++)this._resetBufferLine(t);this._dirtyRowService.markDirty(t);break;case 1:for(t=this._activeBuffer.y,this._dirtyRowService.markDirty(t),this._eraseInBufferLine(t,0,this._activeBuffer.x+1,!0),this._activeBuffer.x+1>=this._bufferService.cols&&(this._activeBuffer.lines.get(t+1).isWrapped=!1);t--;)this._resetBufferLine(t);this._dirtyRowService.markDirty(0);break;case 2:for(t=this._bufferService.rows,this._dirtyRowService.markDirty(t-1);t--;)this._resetBufferLine(t);this._dirtyRowService.markDirty(0);break;case 3:var i=this._activeBuffer.lines.length-this._bufferService.rows;i>0&&(this._activeBuffer.lines.trimStart(i),this._activeBuffer.ybase=Math.max(this._activeBuffer.ybase-i,0),this._activeBuffer.ydisp=Math.max(this._activeBuffer.ydisp-i,0),this._onScroll.fire(0))}return!0},t.prototype.eraseInLine=function(e){switch(this._restrictCursor(this._bufferService.cols),e.params[0]){case 0:this._eraseInBufferLine(this._activeBuffer.y,this._activeBuffer.x,this._bufferService.cols,0===this._activeBuffer.x);break;case 1:this._eraseInBufferLine(this._activeBuffer.y,0,this._activeBuffer.x+1,!1);break;case 2:this._eraseInBufferLine(this._activeBuffer.y,0,this._bufferService.cols,!0)}return this._dirtyRowService.markDirty(this._activeBuffer.y),!0},t.prototype.insertLines=function(e){this._restrictCursor();var t=e.params[0]||1;if(this._activeBuffer.y>this._activeBuffer.scrollBottom||this._activeBuffer.y<this._activeBuffer.scrollTop)return!0;for(var i=this._activeBuffer.ybase+this._activeBuffer.y,r=this._bufferService.rows-1-this._activeBuffer.scrollBottom,n=this._bufferService.rows-1+this._activeBuffer.ybase-r+1;t--;)this._activeBuffer.lines.splice(n-1,1),this._activeBuffer.lines.splice(i,0,this._activeBuffer.getBlankLine(this._eraseAttrData()));return this._dirtyRowService.markRangeDirty(this._activeBuffer.y,this._activeBuffer.scrollBottom),this._activeBuffer.x=0,!0},t.prototype.deleteLines=function(e){this._restrictCursor();var t=e.params[0]||1;if(this._activeBuffer.y>this._activeBuffer.scrollBottom||this._activeBuffer.y<this._activeBuffer.scrollTop)return!0;var i,r=this._activeBuffer.ybase+this._activeBuffer.y;for(i=this._bufferService.rows-1-this._activeBuffer.scrollBottom,i=this._bufferService.rows-1+this._activeBuffer.ybase-i;t--;)this._activeBuffer.lines.splice(r,1),this._activeBuffer.lines.splice(i,0,this._activeBuffer.getBlankLine(this._eraseAttrData()));return this._dirtyRowService.markRangeDirty(this._activeBuffer.y,this._activeBuffer.scrollBottom),this._activeBuffer.x=0,!0},t.prototype.insertChars=function(e){this._restrictCursor();var t=this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y);return t&&(t.insertCells(this._activeBuffer.x,e.params[0]||1,this._activeBuffer.getNullCell(this._eraseAttrData()),this._eraseAttrData()),this._dirtyRowService.markDirty(this._activeBuffer.y)),!0},t.prototype.deleteChars=function(e){this._restrictCursor();var t=this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y);return t&&(t.deleteCells(this._activeBuffer.x,e.params[0]||1,this._activeBuffer.getNullCell(this._eraseAttrData()),this._eraseAttrData()),this._dirtyRowService.markDirty(this._activeBuffer.y)),!0},t.prototype.scrollUp=function(e){for(var t=e.params[0]||1;t--;)this._activeBuffer.lines.splice(this._activeBuffer.ybase+this._activeBuffer.scrollTop,1),this._activeBuffer.lines.splice(this._activeBuffer.ybase+this._activeBuffer.scrollBottom,0,this._activeBuffer.getBlankLine(this._eraseAttrData()));return this._dirtyRowService.markRangeDirty(this._activeBuffer.scrollTop,this._activeBuffer.scrollBottom),!0},t.prototype.scrollDown=function(e){for(var t=e.params[0]||1;t--;)this._activeBuffer.lines.splice(this._activeBuffer.ybase+this._activeBuffer.scrollBottom,1),this._activeBuffer.lines.splice(this._activeBuffer.ybase+this._activeBuffer.scrollTop,0,this._activeBuffer.getBlankLine(p.DEFAULT_ATTR_DATA));return this._dirtyRowService.markRangeDirty(this._activeBuffer.scrollTop,this._activeBuffer.scrollBottom),!0},t.prototype.scrollLeft=function(e){if(this._activeBuffer.y>this._activeBuffer.scrollBottom||this._activeBuffer.y<this._activeBuffer.scrollTop)return!0;for(var t=e.params[0]||1,i=this._activeBuffer.scrollTop;i<=this._activeBuffer.scrollBottom;++i){var r=this._activeBuffer.lines.get(this._activeBuffer.ybase+i);r.deleteCells(0,t,this._activeBuffer.getNullCell(this._eraseAttrData()),this._eraseAttrData()),r.isWrapped=!1}return this._dirtyRowService.markRangeDirty(this._activeBuffer.scrollTop,this._activeBuffer.scrollBottom),!0},t.prototype.scrollRight=function(e){if(this._activeBuffer.y>this._activeBuffer.scrollBottom||this._activeBuffer.y<this._activeBuffer.scrollTop)return!0;for(var t=e.params[0]||1,i=this._activeBuffer.scrollTop;i<=this._activeBuffer.scrollBottom;++i){var r=this._activeBuffer.lines.get(this._activeBuffer.ybase+i);r.insertCells(0,t,this._activeBuffer.getNullCell(this._eraseAttrData()),this._eraseAttrData()),r.isWrapped=!1}return this._dirtyRowService.markRangeDirty(this._activeBuffer.scrollTop,this._activeBuffer.scrollBottom),!0},t.prototype.insertColumns=function(e){if(this._activeBuffer.y>this._activeBuffer.scrollBottom||this._activeBuffer.y<this._activeBuffer.scrollTop)return!0;for(var t=e.params[0]||1,i=this._activeBuffer.scrollTop;i<=this._activeBuffer.scrollBottom;++i){var r=this._activeBuffer.lines.get(this._activeBuffer.ybase+i);r.insertCells(this._activeBuffer.x,t,this._activeBuffer.getNullCell(this._eraseAttrData()),this._eraseAttrData()),r.isWrapped=!1}return this._dirtyRowService.markRangeDirty(this._activeBuffer.scrollTop,this._activeBuffer.scrollBottom),!0},t.prototype.deleteColumns=function(e){if(this._activeBuffer.y>this._activeBuffer.scrollBottom||this._activeBuffer.y<this._activeBuffer.scrollTop)return!0;for(var t=e.params[0]||1,i=this._activeBuffer.scrollTop;i<=this._activeBuffer.scrollBottom;++i){var r=this._activeBuffer.lines.get(this._activeBuffer.ybase+i);r.deleteCells(this._activeBuffer.x,t,this._activeBuffer.getNullCell(this._eraseAttrData()),this._eraseAttrData()),r.isWrapped=!1}return this._dirtyRowService.markRangeDirty(this._activeBuffer.scrollTop,this._activeBuffer.scrollBottom),!0},t.prototype.eraseChars=function(e){this._restrictCursor();var t=this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y);return t&&(t.replaceCells(this._activeBuffer.x,this._activeBuffer.x+(e.params[0]||1),this._activeBuffer.getNullCell(this._eraseAttrData()),this._eraseAttrData()),this._dirtyRowService.markDirty(this._activeBuffer.y)),!0},t.prototype.repeatPrecedingCharacter=function(e){if(!this._parser.precedingCodepoint)return!0;for(var t=e.params[0]||1,i=new Uint32Array(t),r=0;r<t;++r)i[r]=this._parser.precedingCodepoint;return this.print(i,0,i.length),!0},t.prototype.sendDeviceAttributesPrimary=function(e){return e.params[0]>0||(this._is("xterm")||this._is("rxvt-unicode")||this._is("screen")?this._coreService.triggerDataEvent(s.C0.ESC+"[?1;2c"):this._is("linux")&&this._coreService.triggerDataEvent(s.C0.ESC+"[?6c")),!0},t.prototype.sendDeviceAttributesSecondary=function(e){return e.params[0]>0||(this._is("xterm")?this._coreService.triggerDataEvent(s.C0.ESC+"[>0;276;0c"):this._is("rxvt-unicode")?this._coreService.triggerDataEvent(s.C0.ESC+"[>85;95;0c"):this._is("linux")?this._coreService.triggerDataEvent(e.params[0]+"c"):this._is("screen")&&this._coreService.triggerDataEvent(s.C0.ESC+"[>83;40003;0c")),!0},t.prototype._is=function(e){return 0===(this._optionsService.rawOptions.termName+"").indexOf(e)},t.prototype.setMode=function(e){for(var t=0;t<e.length;t++)4===e.params[t]&&(this._coreService.modes.insertMode=!0);return!0},t.prototype.setModePrivate=function(e){for(var t=0;t<e.length;t++)switch(e.params[t]){case 1:this._coreService.decPrivateModes.applicationCursorKeys=!0;break;case 2:this._charsetService.setgCharset(0,a.DEFAULT_CHARSET),this._charsetService.setgCharset(1,a.DEFAULT_CHARSET),this._charsetService.setgCharset(2,a.DEFAULT_CHARSET),this._charsetService.setgCharset(3,a.DEFAULT_CHARSET);break;case 3:this._optionsService.rawOptions.windowOptions.setWinLines&&(this._bufferService.resize(132,this._bufferService.rows),this._onRequestReset.fire());break;case 6:this._coreService.decPrivateModes.origin=!0,this._setCursor(0,0);break;case 7:this._coreService.decPrivateModes.wraparound=!0;break;case 12:break;case 45:this._coreService.decPrivateModes.reverseWraparound=!0;break;case 66:this._logService.debug("Serial port requested application keypad."),this._coreService.decPrivateModes.applicationKeypad=!0,this._onRequestSyncScrollBar.fire();break;case 9:this._coreMouseService.activeProtocol="X10";break;case 1e3:this._coreMouseService.activeProtocol="VT200";break;case 1002:this._coreMouseService.activeProtocol="DRAG";break;case 1003:this._coreMouseService.activeProtocol="ANY";break;case 1004:this._coreService.decPrivateModes.sendFocus=!0,this._onRequestSendFocus.fire();break;case 1005:this._logService.debug("DECSET 1005 not supported (see #2507)");break;case 1006:this._coreMouseService.activeEncoding="SGR";break;case 1015:this._logService.debug("DECSET 1015 not supported (see #2507)");break;case 25:this._coreService.isCursorHidden=!1;break;case 1048:this.saveCursor();break;case 1049:this.saveCursor();case 47:case 1047:this._bufferService.buffers.activateAltBuffer(this._eraseAttrData()),this._coreService.isCursorInitialized=!0,this._onRequestRefreshRows.fire(0,this._bufferService.rows-1),this._onRequestSyncScrollBar.fire();break;case 2004:this._coreService.decPrivateModes.bracketedPasteMode=!0}return!0},t.prototype.resetMode=function(e){for(var t=0;t<e.length;t++)4===e.params[t]&&(this._coreService.modes.insertMode=!1);return!0},t.prototype.resetModePrivate=function(e){for(var t=0;t<e.length;t++)switch(e.params[t]){case 1:this._coreService.decPrivateModes.applicationCursorKeys=!1;break;case 3:this._optionsService.rawOptions.windowOptions.setWinLines&&(this._bufferService.resize(80,this._bufferService.rows),this._onRequestReset.fire());break;case 6:this._coreService.decPrivateModes.origin=!1,this._setCursor(0,0);break;case 7:this._coreService.decPrivateModes.wraparound=!1;break;case 12:break;case 45:this._coreService.decPrivateModes.reverseWraparound=!1;break;case 66:this._logService.debug("Switching back to normal keypad."),this._coreService.decPrivateModes.applicationKeypad=!1,this._onRequestSyncScrollBar.fire();break;case 9:case 1e3:case 1002:case 1003:this._coreMouseService.activeProtocol="NONE";break;case 1004:this._coreService.decPrivateModes.sendFocus=!1;break;case 1005:this._logService.debug("DECRST 1005 not supported (see #2507)");break;case 1006:this._coreMouseService.activeEncoding="DEFAULT";break;case 1015:this._logService.debug("DECRST 1015 not supported (see #2507)");break;case 25:this._coreService.isCursorHidden=!0;break;case 1048:this.restoreCursor();break;case 1049:case 47:case 1047:this._bufferService.buffers.activateNormalBuffer(),1049===e.params[t]&&this.restoreCursor(),this._coreService.isCursorInitialized=!0,this._onRequestRefreshRows.fire(0,this._bufferService.rows-1),this._onRequestSyncScrollBar.fire();break;case 2004:this._coreService.decPrivateModes.bracketedPasteMode=!1}return!0},t.prototype._updateAttrColor=function(e,t,i,r,n){return 2===t?(e|=50331648,e&=-16777216,e|=g.AttributeData.fromColorRGB([i,r,n])):5===t&&(e&=-50331904,e|=33554432|255&i),e},t.prototype._extractColor=function(e,t,i){var r=[0,0,-1,0,0,0],n=0,o=0;do{if(r[o+n]=e.params[t+o],e.hasSubParams(t+o)){var s=e.getSubParams(t+o),a=0;do{5===r[1]&&(n=1),r[o+a+1+n]=s[a]}while(++a<s.length&&a+o+1+n<r.length);break}if(5===r[1]&&o+n>=2||2===r[1]&&o+n>=5)break;r[1]&&(n=1)}while(++o+t<e.length&&o+n<r.length);for(a=2;a<r.length;++a)-1===r[a]&&(r[a]=0);switch(r[0]){case 38:i.fg=this._updateAttrColor(i.fg,r[1],r[3],r[4],r[5]);break;case 48:i.bg=this._updateAttrColor(i.bg,r[1],r[3],r[4],r[5]);break;case 58:i.extended=i.extended.clone(),i.extended.underlineColor=this._updateAttrColor(i.extended.underlineColor,r[1],r[3],r[4],r[5])}return o},t.prototype._processUnderline=function(e,t){t.extended=t.extended.clone(),(!~e||e>5)&&(e=1),t.extended.underlineStyle=e,t.fg|=268435456,0===e&&(t.fg&=-268435457),t.updateExtended()},t.prototype.charAttributes=function(e){if(1===e.length&&0===e.params[0])return this._curAttrData.fg=p.DEFAULT_ATTR_DATA.fg,this._curAttrData.bg=p.DEFAULT_ATTR_DATA.bg,!0;for(var t,i=e.length,r=this._curAttrData,n=0;n<i;n++)(t=e.params[n])>=30&&t<=37?(r.fg&=-50331904,r.fg|=16777216|t-30):t>=40&&t<=47?(r.bg&=-50331904,r.bg|=16777216|t-40):t>=90&&t<=97?(r.fg&=-50331904,r.fg|=16777224|t-90):t>=100&&t<=107?(r.bg&=-50331904,r.bg|=16777224|t-100):0===t?(r.fg=p.DEFAULT_ATTR_DATA.fg,r.bg=p.DEFAULT_ATTR_DATA.bg):1===t?r.fg|=134217728:3===t?r.bg|=67108864:4===t?(r.fg|=268435456,this._processUnderline(e.hasSubParams(n)?e.getSubParams(n)[0]:1,r)):5===t?r.fg|=536870912:7===t?r.fg|=67108864:8===t?r.fg|=1073741824:9===t?r.fg|=2147483648:2===t?r.bg|=134217728:21===t?this._processUnderline(2,r):22===t?(r.fg&=-134217729,r.bg&=-134217729):23===t?r.bg&=-67108865:24===t?r.fg&=-268435457:25===t?r.fg&=-536870913:27===t?r.fg&=-67108865:28===t?r.fg&=-1073741825:29===t?r.fg&=2147483647:39===t?(r.fg&=-67108864,r.fg|=16777215&p.DEFAULT_ATTR_DATA.fg):49===t?(r.bg&=-67108864,r.bg|=16777215&p.DEFAULT_ATTR_DATA.bg):38===t||48===t||58===t?n+=this._extractColor(e,n,r):59===t?(r.extended=r.extended.clone(),r.extended.underlineColor=-1,r.updateExtended()):100===t?(r.fg&=-67108864,r.fg|=16777215&p.DEFAULT_ATTR_DATA.fg,r.bg&=-67108864,r.bg|=16777215&p.DEFAULT_ATTR_DATA.bg):this._logService.debug("Unknown SGR attribute: %d.",t);return!0},t.prototype.deviceStatus=function(e){switch(e.params[0]){case 5:this._coreService.triggerDataEvent(s.C0.ESC+"[0n");break;case 6:var t=this._activeBuffer.y+1,i=this._activeBuffer.x+1;this._coreService.triggerDataEvent(s.C0.ESC+"["+t+";"+i+"R")}return!0},t.prototype.deviceStatusPrivate=function(e){if(6===e.params[0]){var t=this._activeBuffer.y+1,i=this._activeBuffer.x+1;this._coreService.triggerDataEvent(s.C0.ESC+"[?"+t+";"+i+"R")}return!0},t.prototype.softReset=function(e){return this._coreService.isCursorHidden=!1,this._onRequestSyncScrollBar.fire(),this._activeBuffer.scrollTop=0,this._activeBuffer.scrollBottom=this._bufferService.rows-1,this._curAttrData=p.DEFAULT_ATTR_DATA.clone(),this._coreService.reset(),this._charsetService.reset(),this._activeBuffer.savedX=0,this._activeBuffer.savedY=this._activeBuffer.ybase,this._activeBuffer.savedCurAttrData.fg=this._curAttrData.fg,this._activeBuffer.savedCurAttrData.bg=this._curAttrData.bg,this._activeBuffer.savedCharset=this._charsetService.charset,this._coreService.decPrivateModes.origin=!1,!0},t.prototype.setCursorStyle=function(e){var t=e.params[0]||1;switch(t){case 1:case 2:this._optionsService.options.cursorStyle="block";break;case 3:case 4:this._optionsService.options.cursorStyle="underline";break;case 5:case 6:this._optionsService.options.cursorStyle="bar"}var i=t%2==1;return this._optionsService.options.cursorBlink=i,!0},t.prototype.setScrollRegion=function(e){var t,i=e.params[0]||1;return(e.length<2||(t=e.params[1])>this._bufferService.rows||0===t)&&(t=this._bufferService.rows),t>i&&(this._activeBuffer.scrollTop=i-1,this._activeBuffer.scrollBottom=t-1,this._setCursor(0,0)),!0},t.prototype.windowOptions=function(e){if(!C(e.params[0],this._optionsService.rawOptions.windowOptions))return!0;var t=e.length>1?e.params[1]:0;switch(e.params[0]){case 14:2!==t&&this._onRequestWindowsOptionsReport.fire(o.GET_WIN_SIZE_PIXELS);break;case 16:this._onRequestWindowsOptionsReport.fire(o.GET_CELL_SIZE_PIXELS);break;case 18:this._bufferService&&this._coreService.triggerDataEvent(s.C0.ESC+"[8;"+this._bufferService.rows+";"+this._bufferService.cols+"t");break;case 22:0!==t&&2!==t||(this._windowTitleStack.push(this._windowTitle),this._windowTitleStack.length>10&&this._windowTitleStack.shift()),0!==t&&1!==t||(this._iconNameStack.push(this._iconName),this._iconNameStack.length>10&&this._iconNameStack.shift());break;case 23:0!==t&&2!==t||this._windowTitleStack.length&&this.setTitle(this._windowTitleStack.pop()),0!==t&&1!==t||this._iconNameStack.length&&this.setIconName(this._iconNameStack.pop())}return!0},t.prototype.saveCursor=function(e){return this._activeBuffer.savedX=this._activeBuffer.x,this._activeBuffer.savedY=this._activeBuffer.ybase+this._activeBuffer.y,this._activeBuffer.savedCurAttrData.fg=this._curAttrData.fg,this._activeBuffer.savedCurAttrData.bg=this._curAttrData.bg,this._activeBuffer.savedCharset=this._charsetService.charset,!0},t.prototype.restoreCursor=function(e){return this._activeBuffer.x=this._activeBuffer.savedX||0,this._activeBuffer.y=Math.max(this._activeBuffer.savedY-this._activeBuffer.ybase,0),this._curAttrData.fg=this._activeBuffer.savedCurAttrData.fg,this._curAttrData.bg=this._activeBuffer.savedCurAttrData.bg,this._charsetService.charset=this._savedCharset,this._activeBuffer.savedCharset&&(this._charsetService.charset=this._activeBuffer.savedCharset),this._restrictCursor(),!0},t.prototype.setTitle=function(e){return this._windowTitle=e,this._onTitleChange.fire(e),!0},t.prototype.setIconName=function(e){return this._iconName=e,!0},t.prototype.setOrReportIndexedColor=function(e){for(var t=[],i=e.split(";");i.length>1;){var r=i.shift(),n=i.shift();if(/^\d+$/.exec(r)){var o=parseInt(r);if(0<=o&&o<256)if("?"===n)t.push({type:0,index:o});else{var s=(0,v.parseColor)(n);s&&t.push({type:1,index:o,color:s})}}}return t.length&&this._onColor.fire(t),!0},t.prototype._setOrReportSpecialColor=function(e,t){for(var i=e.split(";"),r=0;r<i.length&&!(t>=this._specialColors.length);++r,++t)if("?"===i[r])this._onColor.fire([{type:0,index:this._specialColors[t]}]);else{var n=(0,v.parseColor)(i[r]);n&&this._onColor.fire([{type:1,index:this._specialColors[t],color:n}])}return!0},t.prototype.setOrReportFgColor=function(e){return this._setOrReportSpecialColor(e,0)},t.prototype.setOrReportBgColor=function(e){return this._setOrReportSpecialColor(e,1)},t.prototype.setOrReportCursorColor=function(e){return this._setOrReportSpecialColor(e,2)},t.prototype.restoreIndexedColor=function(e){if(!e)return this._onColor.fire([{type:2}]),!0;for(var t=[],i=e.split(";"),r=0;r<i.length;++r)if(/^\d+$/.exec(i[r])){var n=parseInt(i[r]);0<=n&&n<256&&t.push({type:2,index:n})}return t.length&&this._onColor.fire(t),!0},t.prototype.restoreFgColor=function(e){return this._onColor.fire([{type:2,index:256}]),!0},t.prototype.restoreBgColor=function(e){return this._onColor.fire([{type:2,index:257}]),!0},t.prototype.restoreCursorColor=function(e){return this._onColor.fire([{type:2,index:258}]),!0},t.prototype.nextLine=function(){return this._activeBuffer.x=0,this.index(),!0},t.prototype.keypadApplicationMode=function(){return this._logService.debug("Serial port requested application keypad."),this._coreService.decPrivateModes.applicationKeypad=!0,this._onRequestSyncScrollBar.fire(),!0},t.prototype.keypadNumericMode=function(){return this._logService.debug("Switching back to normal keypad."),this._coreService.decPrivateModes.applicationKeypad=!1,this._onRequestSyncScrollBar.fire(),!0},t.prototype.selectDefaultCharset=function(){return this._charsetService.setgLevel(0),this._charsetService.setgCharset(0,a.DEFAULT_CHARSET),!0},t.prototype.selectCharset=function(e){return 2!==e.length?(this.selectDefaultCharset(),!0):("/"===e[0]||this._charsetService.setgCharset(w[e[0]],a.CHARSETS[e[1]]||a.DEFAULT_CHARSET),!0)},t.prototype.index=function(){return this._restrictCursor(),this._activeBuffer.y++,this._activeBuffer.y===this._activeBuffer.scrollBottom+1?(this._activeBuffer.y--,this._bufferService.scroll(this._eraseAttrData())):this._activeBuffer.y>=this._bufferService.rows&&(this._activeBuffer.y=this._bufferService.rows-1),this._restrictCursor(),!0},t.prototype.tabSet=function(){return this._activeBuffer.tabs[this._activeBuffer.x]=!0,!0},t.prototype.reverseIndex=function(){if(this._restrictCursor(),this._activeBuffer.y===this._activeBuffer.scrollTop){var e=this._activeBuffer.scrollBottom-this._activeBuffer.scrollTop;this._activeBuffer.lines.shiftElements(this._activeBuffer.ybase+this._activeBuffer.y,e,1),this._activeBuffer.lines.set(this._activeBuffer.ybase+this._activeBuffer.y,this._activeBuffer.getBlankLine(this._eraseAttrData())),this._dirtyRowService.markRangeDirty(this._activeBuffer.scrollTop,this._activeBuffer.scrollBottom)}else this._activeBuffer.y--,this._restrictCursor();return!0},t.prototype.fullReset=function(){return this._parser.reset(),this._onRequestReset.fire(),!0},t.prototype.reset=function(){this._curAttrData=p.DEFAULT_ATTR_DATA.clone(),this._eraseAttrDataInternal=p.DEFAULT_ATTR_DATA.clone()},t.prototype._eraseAttrData=function(){return this._eraseAttrDataInternal.bg&=-67108864,this._eraseAttrDataInternal.bg|=67108863&this._curAttrData.bg,this._eraseAttrDataInternal},t.prototype.setgLevel=function(e){return this._charsetService.setgLevel(e),!0},t.prototype.screenAlignmentPattern=function(){var e=new _.CellData;e.content=1<<22|"E".charCodeAt(0),e.fg=this._curAttrData.fg,e.bg=this._curAttrData.bg,this._setCursor(0,0);for(var t=0;t<this._bufferService.rows;++t){var i=this._activeBuffer.ybase+this._activeBuffer.y+t,r=this._activeBuffer.lines.get(i);r&&(r.fill(e),r.isWrapped=!1)}return this._dirtyRowService.markAllDirty(),this._setCursor(0,0),!0},t}(c.Disposable);t.InputHandler=E},844:function(e,t){var i=this&&this.__values||function(e){var t="function"==typeof Symbol&&Symbol.iterator,i=t&&e[t],r=0;if(i)return i.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(t,"__esModule",{value:!0}),t.getDisposeArrayDisposable=t.disposeArray=t.Disposable=void 0;var r=function(){function e(){this._disposables=[],this._isDisposed=!1}return e.prototype.dispose=function(){var e,t;this._isDisposed=!0;try{for(var r=i(this._disposables),n=r.next();!n.done;n=r.next())n.value.dispose()}catch(t){e={error:t}}finally{try{n&&!n.done&&(t=r.return)&&t.call(r)}finally{if(e)throw e.error}}this._disposables.length=0},e.prototype.register=function(e){return this._disposables.push(e),e},e.prototype.unregister=function(e){var t=this._disposables.indexOf(e);-1!==t&&this._disposables.splice(t,1)},e}();function n(e){var t,r;try{for(var n=i(e),o=n.next();!o.done;o=n.next())o.value.dispose()}catch(e){t={error:e}}finally{try{o&&!o.done&&(r=n.return)&&r.call(n)}finally{if(t)throw t.error}}e.length=0}t.Disposable=r,t.disposeArray=n,t.getDisposeArrayDisposable=function(e){return{dispose:function(){return n(e)}}}},6114:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.isLinux=t.isWindows=t.isIphone=t.isIpad=t.isMac=t.isSafari=t.isLegacyEdge=t.isFirefox=void 0;var i="undefined"==typeof navigator,r=i?"node":navigator.userAgent,n=i?"node":navigator.platform;t.isFirefox=r.includes("Firefox"),t.isLegacyEdge=r.includes("Edge"),t.isSafari=/^((?!chrome|android).)*safari/i.test(r),t.isMac=["Macintosh","MacIntel","MacPPC","Mac68K"].includes(n),t.isIpad="iPad"===n,t.isIphone="iPhone"===n,t.isWindows=["Windows","Win16","Win32","WinCE"].includes(n),t.isLinux=n.indexOf("Linux")>=0},6106:function(e,t){var i=this&&this.__generator||function(e,t){var i,r,n,o,s={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(o){return function(a){return function(o){if(i)throw new TypeError("Generator is already executing.");for(;s;)try{if(i=1,r&&(n=2&o[0]?r.return:o[0]?r.throw||((n=r.return)&&n.call(r),0):r.next)&&!(n=n.call(r,o[1])).done)return n;switch(r=0,n&&(o=[2&o[0],n.value]),o[0]){case 0:case 1:n=o;break;case 4:return s.label++,{value:o[1],done:!1};case 5:s.label++,r=o[1],o=[0];continue;case 7:o=s.ops.pop(),s.trys.pop();continue;default:if(!((n=(n=s.trys).length>0&&n[n.length-1])||6!==o[0]&&2!==o[0])){s=0;continue}if(3===o[0]&&(!n||o[1]>n[0]&&o[1]<n[3])){s.label=o[1];break}if(6===o[0]&&s.label<n[1]){s.label=n[1],n=o;break}if(n&&s.label<n[2]){s.label=n[2],s.ops.push(o);break}n[2]&&s.ops.pop(),s.trys.pop();continue}o=t.call(e,s)}catch(e){o=[6,e],r=0}finally{i=n=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,a])}}};Object.defineProperty(t,"__esModule",{value:!0}),t.SortedList=void 0;var r=function(){function e(e){this._getKey=e,this._array=[]}return e.prototype.clear=function(){this._array.length=0},e.prototype.insert=function(e){if(0!==this._array.length){var t=this._search(this._getKey(e),0,this._array.length-1);this._array.splice(t,0,e)}else this._array.push(e)},e.prototype.delete=function(e){if(0===this._array.length)return!1;var t=this._getKey(e),i=this._search(t,0,this._array.length-1);if(this._getKey(this._array[i])!==t)return!1;do{if(this._array[i]===e)return this._array.splice(i,1),!0}while(++i<this._array.length&&this._getKey(this._array[i])===t);return!1},e.prototype.getKeyIterator=function(e){var t;return i(this,(function(i){switch(i.label){case 0:if(0===this._array.length)return[2];if((t=this._search(e,0,this._array.length-1))<0||t>=this._array.length)return[2];if(this._getKey(this._array[t])!==e)return[2];i.label=1;case 1:return[4,this._array[t]];case 2:i.sent(),i.label=3;case 3:if(++t<this._array.length&&this._getKey(this._array[t])===e)return[3,1];i.label=4;case 4:return[2]}}))},e.prototype.values=function(){return this._array.values()},e.prototype._search=function(e,t,i){if(i<t)return t;var r=Math.floor((t+i)/2);if(this._getKey(this._array[r])>e)return this._search(e,t,r-1);if(this._getKey(this._array[r])<e)return this._search(e,r+1,i);for(;r>0&&this._getKey(this._array[r-1])===e;)r--;return r},e}();t.SortedList=r},8273:(e,t)=>{function i(e,t,i,r){if(void 0===i&&(i=0),void 0===r&&(r=e.length),i>=e.length)return e;i=(e.length+i)%e.length,r=r>=e.length?e.length:(e.length+r)%e.length;for(var n=i;n<r;++n)e[n]=t;return e}Object.defineProperty(t,"__esModule",{value:!0}),t.concat=t.fillFallback=t.fill=void 0,t.fill=function(e,t,r,n){return e.fill?e.fill(t,r,n):i(e,t,r,n)},t.fillFallback=i,t.concat=function(e,t){var i=new e.constructor(e.length+t.length);return i.set(e),i.set(t,e.length),i}},9282:(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.updateWindowsModeWrappedState=void 0;var r=i(643);t.updateWindowsModeWrappedState=function(e){var t=e.buffer.lines.get(e.buffer.ybase+e.buffer.y-1),i=null==t?void 0:t.get(e.cols-1),n=e.buffer.lines.get(e.buffer.ybase+e.buffer.y);n&&i&&(n.isWrapped=i[r.CHAR_DATA_CODE_INDEX]!==r.NULL_CELL_CODE&&i[r.CHAR_DATA_CODE_INDEX]!==r.WHITESPACE_CELL_CODE)}},3734:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.ExtendedAttrs=t.AttributeData=void 0;var i=function(){function e(){this.fg=0,this.bg=0,this.extended=new r}return e.toColorRGB=function(e){return[e>>>16&255,e>>>8&255,255&e]},e.fromColorRGB=function(e){return(255&e[0])<<16|(255&e[1])<<8|255&e[2]},e.prototype.clone=function(){var t=new e;return t.fg=this.fg,t.bg=this.bg,t.extended=this.extended.clone(),t},e.prototype.isInverse=function(){return 67108864&this.fg},e.prototype.isBold=function(){return 134217728&this.fg},e.prototype.isUnderline=function(){return 268435456&this.fg},e.prototype.isBlink=function(){return 536870912&this.fg},e.prototype.isInvisible=function(){return 1073741824&this.fg},e.prototype.isItalic=function(){return 67108864&this.bg},e.prototype.isDim=function(){return 134217728&this.bg},e.prototype.isStrikethrough=function(){return 2147483648&this.fg},e.prototype.getFgColorMode=function(){return 50331648&this.fg},e.prototype.getBgColorMode=function(){return 50331648&this.bg},e.prototype.isFgRGB=function(){return 50331648==(50331648&this.fg)},e.prototype.isBgRGB=function(){return 50331648==(50331648&this.bg)},e.prototype.isFgPalette=function(){return 16777216==(50331648&this.fg)||33554432==(50331648&this.fg)},e.prototype.isBgPalette=function(){return 16777216==(50331648&this.bg)||33554432==(50331648&this.bg)},e.prototype.isFgDefault=function(){return 0==(50331648&this.fg)},e.prototype.isBgDefault=function(){return 0==(50331648&this.bg)},e.prototype.isAttributeDefault=function(){return 0===this.fg&&0===this.bg},e.prototype.getFgColor=function(){switch(50331648&this.fg){case 16777216:case 33554432:return 255&this.fg;case 50331648:return 16777215&this.fg;default:return-1}},e.prototype.getBgColor=function(){switch(50331648&this.bg){case 16777216:case 33554432:return 255&this.bg;case 50331648:return 16777215&this.bg;default:return-1}},e.prototype.hasExtendedAttrs=function(){return 268435456&this.bg},e.prototype.updateExtended=function(){this.extended.isEmpty()?this.bg&=-268435457:this.bg|=268435456},e.prototype.getUnderlineColor=function(){if(268435456&this.bg&&~this.extended.underlineColor)switch(50331648&this.extended.underlineColor){case 16777216:case 33554432:return 255&this.extended.underlineColor;case 50331648:return 16777215&this.extended.underlineColor;default:return this.getFgColor()}return this.getFgColor()},e.prototype.getUnderlineColorMode=function(){return 268435456&this.bg&&~this.extended.underlineColor?50331648&this.extended.underlineColor:this.getFgColorMode()},e.prototype.isUnderlineColorRGB=function(){return 268435456&this.bg&&~this.extended.underlineColor?50331648==(50331648&this.extended.underlineColor):this.isFgRGB()},e.prototype.isUnderlineColorPalette=function(){return 268435456&this.bg&&~this.extended.underlineColor?16777216==(50331648&this.extended.underlineColor)||33554432==(50331648&this.extended.underlineColor):this.isFgPalette()},e.prototype.isUnderlineColorDefault=function(){return 268435456&this.bg&&~this.extended.underlineColor?0==(50331648&this.extended.underlineColor):this.isFgDefault()},e.prototype.getUnderlineStyle=function(){return 268435456&this.fg?268435456&this.bg?this.extended.underlineStyle:1:0},e}();t.AttributeData=i;var r=function(){function e(e,t){void 0===e&&(e=0),void 0===t&&(t=-1),this.underlineStyle=e,this.underlineColor=t}return e.prototype.clone=function(){return new e(this.underlineStyle,this.underlineColor)},e.prototype.isEmpty=function(){return 0===this.underlineStyle},e}();t.ExtendedAttrs=r},9092:function(e,t,i){var r=this&&this.__read||function(e,t){var i="function"==typeof Symbol&&e[Symbol.iterator];if(!i)return e;var r,n,o=i.call(e),s=[];try{for(;(void 0===t||t-- >0)&&!(r=o.next()).done;)s.push(r.value)}catch(e){n={error:e}}finally{try{r&&!r.done&&(i=o.return)&&i.call(o)}finally{if(n)throw n.error}}return s},n=this&&this.__spreadArray||function(e,t,i){if(i||2===arguments.length)for(var r,n=0,o=t.length;n<o;n++)!r&&n in t||(r||(r=Array.prototype.slice.call(t,0,n)),r[n]=t[n]);return e.concat(r||Array.prototype.slice.call(t))};Object.defineProperty(t,"__esModule",{value:!0}),t.BufferStringIterator=t.Buffer=t.MAX_BUFFER_SIZE=void 0;var o=i(6349),s=i(8437),a=i(511),l=i(643),c=i(4634),d=i(4863),h=i(7116),p=i(3734);t.MAX_BUFFER_SIZE=4294967295;var u=function(){function e(e,t,i){this._hasScrollback=e,this._optionsService=t,this._bufferService=i,this.ydisp=0,this.ybase=0,this.y=0,this.x=0,this.savedY=0,this.savedX=0,this.savedCurAttrData=s.DEFAULT_ATTR_DATA.clone(),this.savedCharset=h.DEFAULT_CHARSET,this.markers=[],this._nullCell=a.CellData.fromCharData([0,l.NULL_CELL_CHAR,l.NULL_CELL_WIDTH,l.NULL_CELL_CODE]),this._whitespaceCell=a.CellData.fromCharData([0,l.WHITESPACE_CELL_CHAR,l.WHITESPACE_CELL_WIDTH,l.WHITESPACE_CELL_CODE]),this._isClearing=!1,this._cols=this._bufferService.cols,this._rows=this._bufferService.rows,this.lines=new o.CircularList(this._getCorrectBufferLength(this._rows)),this.scrollTop=0,this.scrollBottom=this._rows-1,this.setupTabStops()}return e.prototype.getNullCell=function(e){return e?(this._nullCell.fg=e.fg,this._nullCell.bg=e.bg,this._nullCell.extended=e.extended):(this._nullCell.fg=0,this._nullCell.bg=0,this._nullCell.extended=new p.ExtendedAttrs),this._nullCell},e.prototype.getWhitespaceCell=function(e){return e?(this._whitespaceCell.fg=e.fg,this._whitespaceCell.bg=e.bg,this._whitespaceCell.extended=e.extended):(this._whitespaceCell.fg=0,this._whitespaceCell.bg=0,this._whitespaceCell.extended=new p.ExtendedAttrs),this._whitespaceCell},e.prototype.getBlankLine=function(e,t){return new s.BufferLine(this._bufferService.cols,this.getNullCell(e),t)},Object.defineProperty(e.prototype,"hasScrollback",{get:function(){return this._hasScrollback&&this.lines.maxLength>this._rows},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isCursorInViewport",{get:function(){var e=this.ybase+this.y-this.ydisp;return e>=0&&e<this._rows},enumerable:!1,configurable:!0}),e.prototype._getCorrectBufferLength=function(e){if(!this._hasScrollback)return e;var i=e+this._optionsService.rawOptions.scrollback;return i>t.MAX_BUFFER_SIZE?t.MAX_BUFFER_SIZE:i},e.prototype.fillViewportRows=function(e){if(0===this.lines.length){void 0===e&&(e=s.DEFAULT_ATTR_DATA);for(var t=this._rows;t--;)this.lines.push(this.getBlankLine(e))}},e.prototype.clear=function(){this.ydisp=0,this.ybase=0,this.y=0,this.x=0,this.lines=new o.CircularList(this._getCorrectBufferLength(this._rows)),this.scrollTop=0,this.scrollBottom=this._rows-1,this.setupTabStops()},e.prototype.resize=function(e,t){var i=this.getNullCell(s.DEFAULT_ATTR_DATA),r=this._getCorrectBufferLength(t);if(r>this.lines.maxLength&&(this.lines.maxLength=r),this.lines.length>0){if(this._cols<e)for(var n=0;n<this.lines.length;n++)this.lines.get(n).resize(e,i);var o=0;if(this._rows<t)for(var a=this._rows;a<t;a++)this.lines.length<t+this.ybase&&(this._optionsService.rawOptions.windowsMode?this.lines.push(new s.BufferLine(e,i)):this.ybase>0&&this.lines.length<=this.ybase+this.y+o+1?(this.ybase--,o++,this.ydisp>0&&this.ydisp--):this.lines.push(new s.BufferLine(e,i)));else for(a=this._rows;a>t;a--)this.lines.length>t+this.ybase&&(this.lines.length>this.ybase+this.y+1?this.lines.pop():(this.ybase++,this.ydisp++));if(r<this.lines.maxLength){var l=this.lines.length-r;l>0&&(this.lines.trimStart(l),this.ybase=Math.max(this.ybase-l,0),this.ydisp=Math.max(this.ydisp-l,0),this.savedY=Math.max(this.savedY-l,0)),this.lines.maxLength=r}this.x=Math.min(this.x,e-1),this.y=Math.min(this.y,t-1),o&&(this.y+=o),this.savedX=Math.min(this.savedX,e-1),this.scrollTop=0}if(this.scrollBottom=t-1,this._isReflowEnabled&&(this._reflow(e,t),this._cols>e))for(n=0;n<this.lines.length;n++)this.lines.get(n).resize(e,i);this._cols=e,this._rows=t},Object.defineProperty(e.prototype,"_isReflowEnabled",{get:function(){return this._hasScrollback&&!this._optionsService.rawOptions.windowsMode},enumerable:!1,configurable:!0}),e.prototype._reflow=function(e,t){this._cols!==e&&(e>this._cols?this._reflowLarger(e,t):this._reflowSmaller(e,t))},e.prototype._reflowLarger=function(e,t){var i=(0,c.reflowLargerGetLinesToRemove)(this.lines,this._cols,e,this.ybase+this.y,this.getNullCell(s.DEFAULT_ATTR_DATA));if(i.length>0){var r=(0,c.reflowLargerCreateNewLayout)(this.lines,i);(0,c.reflowLargerApplyNewLayout)(this.lines,r.layout),this._reflowLargerAdjustViewport(e,t,r.countRemoved)}},e.prototype._reflowLargerAdjustViewport=function(e,t,i){for(var r=this.getNullCell(s.DEFAULT_ATTR_DATA),n=i;n-- >0;)0===this.ybase?(this.y>0&&this.y--,this.lines.length<t&&this.lines.push(new s.BufferLine(e,r))):(this.ydisp===this.ybase&&this.ydisp--,this.ybase--);this.savedY=Math.max(this.savedY-i,0)},e.prototype._reflowSmaller=function(e,t){for(var i=this.getNullCell(s.DEFAULT_ATTR_DATA),o=[],a=0,l=this.lines.length-1;l>=0;l--){var d=this.lines.get(l);if(!(!d||!d.isWrapped&&d.getTrimmedLength()<=e)){for(var h=[d];d.isWrapped&&l>0;)d=this.lines.get(--l),h.unshift(d);var p=this.ybase+this.y;if(!(p>=l&&p<l+h.length)){var u,f=h[h.length-1].getTrimmedLength(),_=(0,c.reflowSmallerGetNewLineLengths)(h,this._cols,e),g=_.length-h.length;u=0===this.ybase&&this.y!==this.lines.length-1?Math.max(0,this.y-this.lines.maxLength+g):Math.max(0,this.lines.length-this.lines.maxLength+g);for(var m=[],b=0;b<g;b++){var y=this.getBlankLine(s.DEFAULT_ATTR_DATA,!0);m.push(y)}m.length>0&&(o.push({start:l+h.length+a,newLines:m}),a+=m.length),h.push.apply(h,n([],r(m),!1));var v=_.length-1,w=_[v];0===w&&(w=_[--v]);for(var x=h.length-g-1,C=f;x>=0;){var S=Math.min(C,w);if(void 0===h[v])break;if(h[v].copyCellsFrom(h[x],C-S,w-S,S,!0),0==(w-=S)&&(w=_[--v]),0==(C-=S)){x--;var E=Math.max(x,0);C=(0,c.getWrappedLineTrimmedLength)(h,E,this._cols)}}for(b=0;b<h.length;b++)_[b]<e&&h[b].setCell(_[b],i);for(var k=g-u;k-- >0;)0===this.ybase?this.y<t-1?(this.y++,this.lines.pop()):(this.ybase++,this.ydisp++):this.ybase<Math.min(this.lines.maxLength,this.lines.length+a)-t&&(this.ybase===this.ydisp&&this.ydisp++,this.ybase++);this.savedY=Math.min(this.savedY+g,this.ybase+t-1)}}}if(o.length>0){var L=[],A=[];for(b=0;b<this.lines.length;b++)A.push(this.lines.get(b));var O=this.lines.length,M=O-1,P=0,R=o[P];this.lines.length=Math.min(this.lines.maxLength,this.lines.length+a);var D=0;for(b=Math.min(this.lines.maxLength-1,O+a-1);b>=0;b--)if(R&&R.start>M+D){for(var T=R.newLines.length-1;T>=0;T--)this.lines.set(b--,R.newLines[T]);b++,L.push({index:M+1,amount:R.newLines.length}),D+=R.newLines.length,R=o[++P]}else this.lines.set(b,A[M--]);var I=0;for(b=L.length-1;b>=0;b--)L[b].index+=I,this.lines.onInsertEmitter.fire(L[b]),I+=L[b].amount;var B=Math.max(0,O+a-this.lines.maxLength);B>0&&this.lines.onTrimEmitter.fire(B)}},e.prototype.stringIndexToBufferIndex=function(e,t,i){for(void 0===i&&(i=!1);t;){var r=this.lines.get(e);if(!r)return[-1,-1];for(var n=i?r.getTrimmedLength():r.length,o=0;o<n;++o)if(r.get(o)[l.CHAR_DATA_WIDTH_INDEX]&&(t-=r.get(o)[l.CHAR_DATA_CHAR_INDEX].length||1),t<0)return[e,o];e++}return[e,0]},e.prototype.translateBufferLineToString=function(e,t,i,r){void 0===i&&(i=0);var n=this.lines.get(e);return n?n.translateToString(t,i,r):""},e.prototype.getWrappedRangeForLine=function(e){for(var t=e,i=e;t>0&&this.lines.get(t).isWrapped;)t--;for(;i+1<this.lines.length&&this.lines.get(i+1).isWrapped;)i++;return{first:t,last:i}},e.prototype.setupTabStops=function(e){for(null!=e?this.tabs[e]||(e=this.prevStop(e)):(this.tabs={},e=0);e<this._cols;e+=this._optionsService.rawOptions.tabStopWidth)this.tabs[e]=!0},e.prototype.prevStop=function(e){for(null==e&&(e=this.x);!this.tabs[--e]&&e>0;);return e>=this._cols?this._cols-1:e<0?0:e},e.prototype.nextStop=function(e){for(null==e&&(e=this.x);!this.tabs[++e]&&e<this._cols;);return e>=this._cols?this._cols-1:e<0?0:e},e.prototype.clearMarkers=function(e){this._isClearing=!0;for(var t=0;t<this.markers.length;t++)this.markers[t].line===e&&(this.markers[t].dispose(),this.markers.splice(t--,1));this._isClearing=!1},e.prototype.clearAllMarkers=function(){this._isClearing=!0;for(var e=0;e<this.markers.length;e++)this.markers[e].dispose(),this.markers.splice(e--,1);this._isClearing=!1},e.prototype.addMarker=function(e){var t=this,i=new d.Marker(e);return this.markers.push(i),i.register(this.lines.onTrim((function(e){i.line-=e,i.line<0&&i.dispose()}))),i.register(this.lines.onInsert((function(e){i.line>=e.index&&(i.line+=e.amount)}))),i.register(this.lines.onDelete((function(e){i.line>=e.index&&i.line<e.index+e.amount&&i.dispose(),i.line>e.index&&(i.line-=e.amount)}))),i.register(i.onDispose((function(){return t._removeMarker(i)}))),i},e.prototype._removeMarker=function(e){this._isClearing||this.markers.splice(this.markers.indexOf(e),1)},e.prototype.iterator=function(e,t,i,r,n){return new f(this,e,t,i,r,n)},e}();t.Buffer=u;var f=function(){function e(e,t,i,r,n,o){void 0===i&&(i=0),void 0===r&&(r=e.lines.length),void 0===n&&(n=0),void 0===o&&(o=0),this._buffer=e,this._trimRight=t,this._startIndex=i,this._endIndex=r,this._startOverscan=n,this._endOverscan=o,this._startIndex<0&&(this._startIndex=0),this._endIndex>this._buffer.lines.length&&(this._endIndex=this._buffer.lines.length),this._current=this._startIndex}return e.prototype.hasNext=function(){return this._current<this._endIndex},e.prototype.next=function(){var e=this._buffer.getWrappedRangeForLine(this._current);e.first<this._startIndex-this._startOverscan&&(e.first=this._startIndex-this._startOverscan),e.last>this._endIndex+this._endOverscan&&(e.last=this._endIndex+this._endOverscan),e.first=Math.max(e.first,0),e.last=Math.min(e.last,this._buffer.lines.length);for(var t="",i=e.first;i<=e.last;++i)t+=this._buffer.translateBufferLineToString(i,this._trimRight);return this._current=e.last+1,{range:e,content:t}},e}();t.BufferStringIterator=f},8437:(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.BufferLine=t.DEFAULT_ATTR_DATA=void 0;var r=i(482),n=i(643),o=i(511),s=i(3734);t.DEFAULT_ATTR_DATA=Object.freeze(new s.AttributeData);var a=function(){function e(e,t,i){void 0===i&&(i=!1),this.isWrapped=i,this._combined={},this._extendedAttrs={},this._data=new Uint32Array(3*e);for(var r=t||o.CellData.fromCharData([0,n.NULL_CELL_CHAR,n.NULL_CELL_WIDTH,n.NULL_CELL_CODE]),s=0;s<e;++s)this.setCell(s,r);this.length=e}return e.prototype.get=function(e){var t=this._data[3*e+0],i=2097151&t;return[this._data[3*e+1],2097152&t?this._combined[e]:i?(0,r.stringFromCodePoint)(i):"",t>>22,2097152&t?this._combined[e].charCodeAt(this._combined[e].length-1):i]},e.prototype.set=function(e,t){this._data[3*e+1]=t[n.CHAR_DATA_ATTR_INDEX],t[n.CHAR_DATA_CHAR_INDEX].length>1?(this._combined[e]=t[1],this._data[3*e+0]=2097152|e|t[n.CHAR_DATA_WIDTH_INDEX]<<22):this._data[3*e+0]=t[n.CHAR_DATA_CHAR_INDEX].charCodeAt(0)|t[n.CHAR_DATA_WIDTH_INDEX]<<22},e.prototype.getWidth=function(e){return this._data[3*e+0]>>22},e.prototype.hasWidth=function(e){return 12582912&this._data[3*e+0]},e.prototype.getFg=function(e){return this._data[3*e+1]},e.prototype.getBg=function(e){return this._data[3*e+2]},e.prototype.hasContent=function(e){return 4194303&this._data[3*e+0]},e.prototype.getCodePoint=function(e){var t=this._data[3*e+0];return 2097152&t?this._combined[e].charCodeAt(this._combined[e].length-1):2097151&t},e.prototype.isCombined=function(e){return 2097152&this._data[3*e+0]},e.prototype.getString=function(e){var t=this._data[3*e+0];return 2097152&t?this._combined[e]:2097151&t?(0,r.stringFromCodePoint)(2097151&t):""},e.prototype.loadCell=function(e,t){var i=3*e;return t.content=this._data[i+0],t.fg=this._data[i+1],t.bg=this._data[i+2],2097152&t.content&&(t.combinedData=this._combined[e]),268435456&t.bg&&(t.extended=this._extendedAttrs[e]),t},e.prototype.setCell=function(e,t){2097152&t.content&&(this._combined[e]=t.combinedData),268435456&t.bg&&(this._extendedAttrs[e]=t.extended),this._data[3*e+0]=t.content,this._data[3*e+1]=t.fg,this._data[3*e+2]=t.bg},e.prototype.setCellFromCodePoint=function(e,t,i,r,n,o){268435456&n&&(this._extendedAttrs[e]=o),this._data[3*e+0]=t|i<<22,this._data[3*e+1]=r,this._data[3*e+2]=n},e.prototype.addCodepointToCell=function(e,t){var i=this._data[3*e+0];2097152&i?this._combined[e]+=(0,r.stringFromCodePoint)(t):(2097151&i?(this._combined[e]=(0,r.stringFromCodePoint)(2097151&i)+(0,r.stringFromCodePoint)(t),i&=-2097152,i|=2097152):i=t|1<<22,this._data[3*e+0]=i)},e.prototype.insertCells=function(e,t,i,r){if((e%=this.length)&&2===this.getWidth(e-1)&&this.setCellFromCodePoint(e-1,0,1,(null==r?void 0:r.fg)||0,(null==r?void 0:r.bg)||0,(null==r?void 0:r.extended)||new s.ExtendedAttrs),t<this.length-e){for(var n=new o.CellData,a=this.length-e-t-1;a>=0;--a)this.setCell(e+t+a,this.loadCell(e+a,n));for(a=0;a<t;++a)this.setCell(e+a,i)}else for(a=e;a<this.length;++a)this.setCell(a,i);2===this.getWidth(this.length-1)&&this.setCellFromCodePoint(this.length-1,0,1,(null==r?void 0:r.fg)||0,(null==r?void 0:r.bg)||0,(null==r?void 0:r.extended)||new s.ExtendedAttrs)},e.prototype.deleteCells=function(e,t,i,r){if(e%=this.length,t<this.length-e){for(var n=new o.CellData,a=0;a<this.length-e-t;++a)this.setCell(e+a,this.loadCell(e+t+a,n));for(a=this.length-t;a<this.length;++a)this.setCell(a,i)}else for(a=e;a<this.length;++a)this.setCell(a,i);e&&2===this.getWidth(e-1)&&this.setCellFromCodePoint(e-1,0,1,(null==r?void 0:r.fg)||0,(null==r?void 0:r.bg)||0,(null==r?void 0:r.extended)||new s.ExtendedAttrs),0!==this.getWidth(e)||this.hasContent(e)||this.setCellFromCodePoint(e,0,1,(null==r?void 0:r.fg)||0,(null==r?void 0:r.bg)||0,(null==r?void 0:r.extended)||new s.ExtendedAttrs)},e.prototype.replaceCells=function(e,t,i,r){for(e&&2===this.getWidth(e-1)&&this.setCellFromCodePoint(e-1,0,1,(null==r?void 0:r.fg)||0,(null==r?void 0:r.bg)||0,(null==r?void 0:r.extended)||new s.ExtendedAttrs),t<this.length&&2===this.getWidth(t-1)&&this.setCellFromCodePoint(t,0,1,(null==r?void 0:r.fg)||0,(null==r?void 0:r.bg)||0,(null==r?void 0:r.extended)||new s.ExtendedAttrs);e<t&&e<this.length;)this.setCell(e++,i)},e.prototype.resize=function(e,t){if(e!==this.length){if(e>this.length){var i=new Uint32Array(3*e);this.length&&(3*e<this._data.length?i.set(this._data.subarray(0,3*e)):i.set(this._data)),this._data=i;for(var r=this.length;r<e;++r)this.setCell(r,t)}else if(e){(i=new Uint32Array(3*e)).set(this._data.subarray(0,3*e)),this._data=i;var n=Object.keys(this._combined);for(r=0;r<n.length;r++){var o=parseInt(n[r],10);o>=e&&delete this._combined[o]}}else this._data=new Uint32Array(0),this._combined={};this.length=e}},e.prototype.fill=function(e){this._combined={},this._extendedAttrs={};for(var t=0;t<this.length;++t)this.setCell(t,e)},e.prototype.copyFrom=function(e){for(var t in this.length!==e.length?this._data=new Uint32Array(e._data):this._data.set(e._data),this.length=e.length,this._combined={},e._combined)this._combined[t]=e._combined[t];for(var t in this._extendedAttrs={},e._extendedAttrs)this._extendedAttrs[t]=e._extendedAttrs[t];this.isWrapped=e.isWrapped},e.prototype.clone=function(){var t=new e(0);for(var i in t._data=new Uint32Array(this._data),t.length=this.length,this._combined)t._combined[i]=this._combined[i];for(var i in this._extendedAttrs)t._extendedAttrs[i]=this._extendedAttrs[i];return t.isWrapped=this.isWrapped,t},e.prototype.getTrimmedLength=function(){for(var e=this.length-1;e>=0;--e)if(4194303&this._data[3*e+0])return e+(this._data[3*e+0]>>22);return 0},e.prototype.copyCellsFrom=function(e,t,i,r,n){var o=e._data;if(n)for(var s=r-1;s>=0;s--)for(var a=0;a<3;a++)this._data[3*(i+s)+a]=o[3*(t+s)+a];else for(s=0;s<r;s++)for(a=0;a<3;a++)this._data[3*(i+s)+a]=o[3*(t+s)+a];var l=Object.keys(e._combined);for(a=0;a<l.length;a++){var c=parseInt(l[a],10);c>=t&&(this._combined[c-t+i]=e._combined[c])}},e.prototype.translateToString=function(e,t,i){void 0===e&&(e=!1),void 0===t&&(t=0),void 0===i&&(i=this.length),e&&(i=Math.min(i,this.getTrimmedLength()));for(var o="";t<i;){var s=this._data[3*t+0],a=2097151&s;o+=2097152&s?this._combined[t]:a?(0,r.stringFromCodePoint)(a):n.WHITESPACE_CELL_CHAR,t+=s>>22||1}return o},e}();t.BufferLine=a},4841:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getRangeLength=void 0,t.getRangeLength=function(e,t){if(e.start.y>e.end.y)throw new Error("Buffer range end ("+e.end.x+", "+e.end.y+") cannot be before start ("+e.start.x+", "+e.start.y+")");return t*(e.end.y-e.start.y)+(e.end.x-e.start.x+1)}},4634:(e,t)=>{function i(e,t,i){if(t===e.length-1)return e[t].getTrimmedLength();var r=!e[t].hasContent(i-1)&&1===e[t].getWidth(i-1),n=2===e[t+1].getWidth(0);return r&&n?i-1:i}Object.defineProperty(t,"__esModule",{value:!0}),t.getWrappedLineTrimmedLength=t.reflowSmallerGetNewLineLengths=t.reflowLargerApplyNewLayout=t.reflowLargerCreateNewLayout=t.reflowLargerGetLinesToRemove=void 0,t.reflowLargerGetLinesToRemove=function(e,t,r,n,o){for(var s=[],a=0;a<e.length-1;a++){var l=a,c=e.get(++l);if(c.isWrapped){for(var d=[e.get(a)];l<e.length&&c.isWrapped;)d.push(c),c=e.get(++l);if(n>=a&&n<l)a+=d.length-1;else{for(var h=0,p=i(d,h,t),u=1,f=0;u<d.length;){var _=i(d,u,t),g=_-f,m=r-p,b=Math.min(g,m);d[h].copyCellsFrom(d[u],f,p,b,!1),(p+=b)===r&&(h++,p=0),(f+=b)===_&&(u++,f=0),0===p&&0!==h&&2===d[h-1].getWidth(r-1)&&(d[h].copyCellsFrom(d[h-1],r-1,p++,1,!1),d[h-1].setCell(r-1,o))}d[h].replaceCells(p,r,o);for(var y=0,v=d.length-1;v>0&&(v>h||0===d[v].getTrimmedLength());v--)y++;y>0&&(s.push(a+d.length-y),s.push(y)),a+=d.length-1}}}return s},t.reflowLargerCreateNewLayout=function(e,t){for(var i=[],r=0,n=t[r],o=0,s=0;s<e.length;s++)if(n===s){var a=t[++r];e.onDeleteEmitter.fire({index:s-o,amount:a}),s+=a-1,o+=a,n=t[++r]}else i.push(s);return{layout:i,countRemoved:o}},t.reflowLargerApplyNewLayout=function(e,t){for(var i=[],r=0;r<t.length;r++)i.push(e.get(t[r]));for(r=0;r<i.length;r++)e.set(r,i[r]);e.length=t.length},t.reflowSmallerGetNewLineLengths=function(e,t,r){for(var n=[],o=e.map((function(r,n){return i(e,n,t)})).reduce((function(e,t){return e+t})),s=0,a=0,l=0;l<o;){if(o-l<r){n.push(o-l);break}s+=r;var c=i(e,a,t);s>c&&(s-=c,a++);var d=2===e[a].getWidth(s-1);d&&s--;var h=d?r-1:r;n.push(h),l+=h}return n},t.getWrappedLineTrimmedLength=i},5295:function(e,t,i){var r,n=this&&this.__extends||(r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])},r(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function i(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)});Object.defineProperty(t,"__esModule",{value:!0}),t.BufferSet=void 0;var o=i(9092),s=i(8460),a=function(e){function t(t,i){var r=e.call(this)||this;return r._optionsService=t,r._bufferService=i,r._onBufferActivate=r.register(new s.EventEmitter),r.reset(),r}return n(t,e),Object.defineProperty(t.prototype,"onBufferActivate",{get:function(){return this._onBufferActivate.event},enumerable:!1,configurable:!0}),t.prototype.reset=function(){this._normal=new o.Buffer(!0,this._optionsService,this._bufferService),this._normal.fillViewportRows(),this._alt=new o.Buffer(!1,this._optionsService,this._bufferService),this._activeBuffer=this._normal,this._onBufferActivate.fire({activeBuffer:this._normal,inactiveBuffer:this._alt}),this.setupTabStops()},Object.defineProperty(t.prototype,"alt",{get:function(){return this._alt},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"active",{get:function(){return this._activeBuffer},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"normal",{get:function(){return this._normal},enumerable:!1,configurable:!0}),t.prototype.activateNormalBuffer=function(){this._activeBuffer!==this._normal&&(this._normal.x=this._alt.x,this._normal.y=this._alt.y,this._alt.clear(),this._activeBuffer=this._normal,this._onBufferActivate.fire({activeBuffer:this._normal,inactiveBuffer:this._alt}))},t.prototype.activateAltBuffer=function(e){this._activeBuffer!==this._alt&&(this._alt.fillViewportRows(e),this._alt.x=this._normal.x,this._alt.y=this._normal.y,this._activeBuffer=this._alt,this._onBufferActivate.fire({activeBuffer:this._alt,inactiveBuffer:this._normal}))},t.prototype.resize=function(e,t){this._normal.resize(e,t),this._alt.resize(e,t)},t.prototype.setupTabStops=function(e){this._normal.setupTabStops(e),this._alt.setupTabStops(e)},t}(i(844).Disposable);t.BufferSet=a},511:function(e,t,i){var r,n=this&&this.__extends||(r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])},r(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function i(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)});Object.defineProperty(t,"__esModule",{value:!0}),t.CellData=void 0;var o=i(482),s=i(643),a=i(3734),l=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.content=0,t.fg=0,t.bg=0,t.extended=new a.ExtendedAttrs,t.combinedData="",t}return n(t,e),t.fromCharData=function(e){var i=new t;return i.setFromCharData(e),i},t.prototype.isCombined=function(){return 2097152&this.content},t.prototype.getWidth=function(){return this.content>>22},t.prototype.getChars=function(){return 2097152&this.content?this.combinedData:2097151&this.content?(0,o.stringFromCodePoint)(2097151&this.content):""},t.prototype.getCode=function(){return this.isCombined()?this.combinedData.charCodeAt(this.combinedData.length-1):2097151&this.content},t.prototype.setFromCharData=function(e){this.fg=e[s.CHAR_DATA_ATTR_INDEX],this.bg=0;var t=!1;if(e[s.CHAR_DATA_CHAR_INDEX].length>2)t=!0;else if(2===e[s.CHAR_DATA_CHAR_INDEX].length){var i=e[s.CHAR_DATA_CHAR_INDEX].charCodeAt(0);if(55296<=i&&i<=56319){var r=e[s.CHAR_DATA_CHAR_INDEX].charCodeAt(1);56320<=r&&r<=57343?this.content=1024*(i-55296)+r-56320+65536|e[s.CHAR_DATA_WIDTH_INDEX]<<22:t=!0}else t=!0}else this.content=e[s.CHAR_DATA_CHAR_INDEX].charCodeAt(0)|e[s.CHAR_DATA_WIDTH_INDEX]<<22;t&&(this.combinedData=e[s.CHAR_DATA_CHAR_INDEX],this.content=2097152|e[s.CHAR_DATA_WIDTH_INDEX]<<22)},t.prototype.getAsCharData=function(){return[this.fg,this.getChars(),this.getWidth(),this.getCode()]},t}(a.AttributeData);t.CellData=l},643:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.WHITESPACE_CELL_CODE=t.WHITESPACE_CELL_WIDTH=t.WHITESPACE_CELL_CHAR=t.NULL_CELL_CODE=t.NULL_CELL_WIDTH=t.NULL_CELL_CHAR=t.CHAR_DATA_CODE_INDEX=t.CHAR_DATA_WIDTH_INDEX=t.CHAR_DATA_CHAR_INDEX=t.CHAR_DATA_ATTR_INDEX=t.DEFAULT_ATTR=t.DEFAULT_COLOR=void 0,t.DEFAULT_COLOR=256,t.DEFAULT_ATTR=256|t.DEFAULT_COLOR<<9,t.CHAR_DATA_ATTR_INDEX=0,t.CHAR_DATA_CHAR_INDEX=1,t.CHAR_DATA_WIDTH_INDEX=2,t.CHAR_DATA_CODE_INDEX=3,t.NULL_CELL_CHAR="",t.NULL_CELL_WIDTH=1,t.NULL_CELL_CODE=0,t.WHITESPACE_CELL_CHAR=" ",t.WHITESPACE_CELL_WIDTH=1,t.WHITESPACE_CELL_CODE=32},4863:function(e,t,i){var r,n=this&&this.__extends||(r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])},r(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function i(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)});Object.defineProperty(t,"__esModule",{value:!0}),t.Marker=void 0;var o=i(8460),s=function(e){function t(i){var r=e.call(this)||this;return r.line=i,r._id=t._nextId++,r.isDisposed=!1,r._onDispose=new o.EventEmitter,r}return n(t,e),Object.defineProperty(t.prototype,"id",{get:function(){return this._id},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"onDispose",{get:function(){return this._onDispose.event},enumerable:!1,configurable:!0}),t.prototype.dispose=function(){this.isDisposed||(this.isDisposed=!0,this.line=-1,this._onDispose.fire(),e.prototype.dispose.call(this))},t._nextId=1,t}(i(844).Disposable);t.Marker=s},7116:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.DEFAULT_CHARSET=t.CHARSETS=void 0,t.CHARSETS={},t.DEFAULT_CHARSET=t.CHARSETS.B,t.CHARSETS[0]={"`":"◆",a:"▒",b:"␉",c:"␌",d:"␍",e:"␊",f:"°",g:"±",h:"␤",i:"␋",j:"┘",k:"┐",l:"┌",m:"└",n:"┼",o:"⎺",p:"⎻",q:"─",r:"⎼",s:"⎽",t:"├",u:"┤",v:"┴",w:"┬",x:"│",y:"≤",z:"≥","{":"π","|":"≠","}":"£","~":"·"},t.CHARSETS.A={"#":"£"},t.CHARSETS.B=void 0,t.CHARSETS[4]={"#":"£","@":"¾","[":"ij","\\":"½","]":"|","{":"¨","|":"f","}":"¼","~":"´"},t.CHARSETS.C=t.CHARSETS[5]={"[":"Ä","\\":"Ö","]":"Å","^":"Ü","`":"é","{":"ä","|":"ö","}":"å","~":"ü"},t.CHARSETS.R={"#":"£","@":"à","[":"°","\\":"ç","]":"§","{":"é","|":"ù","}":"è","~":"¨"},t.CHARSETS.Q={"@":"à","[":"â","\\":"ç","]":"ê","^":"î","`":"ô","{":"é","|":"ù","}":"è","~":"û"},t.CHARSETS.K={"@":"§","[":"Ä","\\":"Ö","]":"Ü","{":"ä","|":"ö","}":"ü","~":"ß"},t.CHARSETS.Y={"#":"£","@":"§","[":"°","\\":"ç","]":"é","`":"ù","{":"à","|":"ò","}":"è","~":"ì"},t.CHARSETS.E=t.CHARSETS[6]={"@":"Ä","[":"Æ","\\":"Ø","]":"Å","^":"Ü","`":"ä","{":"æ","|":"ø","}":"å","~":"ü"},t.CHARSETS.Z={"#":"£","@":"§","[":"¡","\\":"Ñ","]":"¿","{":"°","|":"ñ","}":"ç"},t.CHARSETS.H=t.CHARSETS[7]={"@":"É","[":"Ä","\\":"Ö","]":"Å","^":"Ü","`":"é","{":"ä","|":"ö","}":"å","~":"ü"},t.CHARSETS["="]={"#":"ù","@":"à","[":"é","\\":"ç","]":"ê","^":"î",_:"è","`":"ô","{":"ä","|":"ö","}":"ü","~":"û"}},2584:(e,t)=>{var i,r;Object.defineProperty(t,"__esModule",{value:!0}),t.C1_ESCAPED=t.C1=t.C0=void 0,function(e){e.NUL="\0",e.SOH="",e.STX="",e.ETX="",e.EOT="",e.ENQ="",e.ACK="",e.BEL="",e.BS="\b",e.HT="\t",e.LF="\n",e.VT="\v",e.FF="\f",e.CR="\r",e.SO="",e.SI="",e.DLE="",e.DC1="",e.DC2="",e.DC3="",e.DC4="",e.NAK="",e.SYN="",e.ETB="",e.CAN="",e.EM="",e.SUB="",e.ESC="",e.FS="",e.GS="",e.RS="",e.US="",e.SP=" ",e.DEL=""}(i=t.C0||(t.C0={})),(r=t.C1||(t.C1={})).PAD="",r.HOP="",r.BPH="",r.NBH="",r.IND="",r.NEL="",r.SSA="",r.ESA="",r.HTS="",r.HTJ="",r.VTS="",r.PLD="",r.PLU="",r.RI="",r.SS2="",r.SS3="",r.DCS="",r.PU1="",r.PU2="",r.STS="",r.CCH="",r.MW="",r.SPA="",r.EPA="",r.SOS="",r.SGCI="",r.SCI="",r.CSI="",r.ST="",r.OSC="",r.PM="",r.APC="",(t.C1_ESCAPED||(t.C1_ESCAPED={})).ST=i.ESC+"\\"},7399:(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.evaluateKeyboardEvent=void 0;var r=i(2584),n={48:["0",")"],49:["1","!"],50:["2","@"],51:["3","#"],52:["4","$"],53:["5","%"],54:["6","^"],55:["7","&"],56:["8","*"],57:["9","("],186:[";",":"],187:["=","+"],188:[",","<"],189:["-","_"],190:[".",">"],191:["/","?"],192:["`","~"],219:["[","{"],220:["\\","|"],221:["]","}"],222:["'",'"']};t.evaluateKeyboardEvent=function(e,t,i,o){var s={type:0,cancel:!1,key:void 0},a=(e.shiftKey?1:0)|(e.altKey?2:0)|(e.ctrlKey?4:0)|(e.metaKey?8:0);switch(e.keyCode){case 0:"UIKeyInputUpArrow"===e.key?s.key=t?r.C0.ESC+"OA":r.C0.ESC+"[A":"UIKeyInputLeftArrow"===e.key?s.key=t?r.C0.ESC+"OD":r.C0.ESC+"[D":"UIKeyInputRightArrow"===e.key?s.key=t?r.C0.ESC+"OC":r.C0.ESC+"[C":"UIKeyInputDownArrow"===e.key&&(s.key=t?r.C0.ESC+"OB":r.C0.ESC+"[B");break;case 8:if(e.shiftKey){s.key=r.C0.BS;break}if(e.altKey){s.key=r.C0.ESC+r.C0.DEL;break}s.key=r.C0.DEL;break;case 9:if(e.shiftKey){s.key=r.C0.ESC+"[Z";break}s.key=r.C0.HT,s.cancel=!0;break;case 13:s.key=e.altKey?r.C0.ESC+r.C0.CR:r.C0.CR,s.cancel=!0;break;case 27:s.key=r.C0.ESC,e.altKey&&(s.key=r.C0.ESC+r.C0.ESC),s.cancel=!0;break;case 37:if(e.metaKey)break;a?(s.key=r.C0.ESC+"[1;"+(a+1)+"D",s.key===r.C0.ESC+"[1;3D"&&(s.key=r.C0.ESC+(i?"b":"[1;5D"))):s.key=t?r.C0.ESC+"OD":r.C0.ESC+"[D";break;case 39:if(e.metaKey)break;a?(s.key=r.C0.ESC+"[1;"+(a+1)+"C",s.key===r.C0.ESC+"[1;3C"&&(s.key=r.C0.ESC+(i?"f":"[1;5C"))):s.key=t?r.C0.ESC+"OC":r.C0.ESC+"[C";break;case 38:if(e.metaKey)break;a?(s.key=r.C0.ESC+"[1;"+(a+1)+"A",i||s.key!==r.C0.ESC+"[1;3A"||(s.key=r.C0.ESC+"[1;5A")):s.key=t?r.C0.ESC+"OA":r.C0.ESC+"[A";break;case 40:if(e.metaKey)break;a?(s.key=r.C0.ESC+"[1;"+(a+1)+"B",i||s.key!==r.C0.ESC+"[1;3B"||(s.key=r.C0.ESC+"[1;5B")):s.key=t?r.C0.ESC+"OB":r.C0.ESC+"[B";break;case 45:e.shiftKey||e.ctrlKey||(s.key=r.C0.ESC+"[2~");break;case 46:s.key=a?r.C0.ESC+"[3;"+(a+1)+"~":r.C0.ESC+"[3~";break;case 36:s.key=a?r.C0.ESC+"[1;"+(a+1)+"H":t?r.C0.ESC+"OH":r.C0.ESC+"[H";break;case 35:s.key=a?r.C0.ESC+"[1;"+(a+1)+"F":t?r.C0.ESC+"OF":r.C0.ESC+"[F";break;case 33:e.shiftKey?s.type=2:e.ctrlKey?s.key=r.C0.ESC+"[5;"+(a+1)+"~":s.key=r.C0.ESC+"[5~";break;case 34:e.shiftKey?s.type=3:e.ctrlKey?s.key=r.C0.ESC+"[6;"+(a+1)+"~":s.key=r.C0.ESC+"[6~";break;case 112:s.key=a?r.C0.ESC+"[1;"+(a+1)+"P":r.C0.ESC+"OP";break;case 113:s.key=a?r.C0.ESC+"[1;"+(a+1)+"Q":r.C0.ESC+"OQ";break;case 114:s.key=a?r.C0.ESC+"[1;"+(a+1)+"R":r.C0.ESC+"OR";break;case 115:s.key=a?r.C0.ESC+"[1;"+(a+1)+"S":r.C0.ESC+"OS";break;case 116:s.key=a?r.C0.ESC+"[15;"+(a+1)+"~":r.C0.ESC+"[15~";break;case 117:s.key=a?r.C0.ESC+"[17;"+(a+1)+"~":r.C0.ESC+"[17~";break;case 118:s.key=a?r.C0.ESC+"[18;"+(a+1)+"~":r.C0.ESC+"[18~";break;case 119:s.key=a?r.C0.ESC+"[19;"+(a+1)+"~":r.C0.ESC+"[19~";break;case 120:s.key=a?r.C0.ESC+"[20;"+(a+1)+"~":r.C0.ESC+"[20~";break;case 121:s.key=a?r.C0.ESC+"[21;"+(a+1)+"~":r.C0.ESC+"[21~";break;case 122:s.key=a?r.C0.ESC+"[23;"+(a+1)+"~":r.C0.ESC+"[23~";break;case 123:s.key=a?r.C0.ESC+"[24;"+(a+1)+"~":r.C0.ESC+"[24~";break;default:if(!e.ctrlKey||e.shiftKey||e.altKey||e.metaKey)if(i&&!o||!e.altKey||e.metaKey)!i||e.altKey||e.ctrlKey||e.shiftKey||!e.metaKey?e.key&&!e.ctrlKey&&!e.altKey&&!e.metaKey&&e.keyCode>=48&&1===e.key.length?s.key=e.key:e.key&&e.ctrlKey&&("_"===e.key&&(s.key=r.C0.US),"@"===e.key&&(s.key=r.C0.NUL)):65===e.keyCode&&(s.type=1);else{var l=n[e.keyCode],c=null==l?void 0:l[e.shiftKey?1:0];if(c)s.key=r.C0.ESC+c;else if(e.keyCode>=65&&e.keyCode<=90){var d=e.ctrlKey?e.keyCode-64:e.keyCode+32,h=String.fromCharCode(d);e.shiftKey&&(h=h.toUpperCase()),s.key=r.C0.ESC+h}else"Dead"===e.key&&e.code.startsWith("Key")&&(h=e.code.slice(3,4),e.shiftKey||(h=h.toLowerCase()),s.key=r.C0.ESC+h,s.cancel=!0)}else e.keyCode>=65&&e.keyCode<=90?s.key=String.fromCharCode(e.keyCode-64):32===e.keyCode?s.key=r.C0.NUL:e.keyCode>=51&&e.keyCode<=55?s.key=String.fromCharCode(e.keyCode-51+27):56===e.keyCode?s.key=r.C0.DEL:219===e.keyCode?s.key=r.C0.ESC:220===e.keyCode?s.key=r.C0.FS:221===e.keyCode&&(s.key=r.C0.GS)}return s}},482:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.Utf8ToUtf32=t.StringToUtf32=t.utf32ToString=t.stringFromCodePoint=void 0,t.stringFromCodePoint=function(e){return e>65535?(e-=65536,String.fromCharCode(55296+(e>>10))+String.fromCharCode(e%1024+56320)):String.fromCharCode(e)},t.utf32ToString=function(e,t,i){void 0===t&&(t=0),void 0===i&&(i=e.length);for(var r="",n=t;n<i;++n){var o=e[n];o>65535?(o-=65536,r+=String.fromCharCode(55296+(o>>10))+String.fromCharCode(o%1024+56320)):r+=String.fromCharCode(o)}return r};var i=function(){function e(){this._interim=0}return e.prototype.clear=function(){this._interim=0},e.prototype.decode=function(e,t){var i=e.length;if(!i)return 0;var r=0,n=0;this._interim&&(56320<=(a=e.charCodeAt(n++))&&a<=57343?t[r++]=1024*(this._interim-55296)+a-56320+65536:(t[r++]=this._interim,t[r++]=a),this._interim=0);for(var o=n;o<i;++o){var s=e.charCodeAt(o);if(55296<=s&&s<=56319){if(++o>=i)return this._interim=s,r;var a;56320<=(a=e.charCodeAt(o))&&a<=57343?t[r++]=1024*(s-55296)+a-56320+65536:(t[r++]=s,t[r++]=a)}else 65279!==s&&(t[r++]=s)}return r},e}();t.StringToUtf32=i;var r=function(){function e(){this.interim=new Uint8Array(3)}return e.prototype.clear=function(){this.interim.fill(0)},e.prototype.decode=function(e,t){var i=e.length;if(!i)return 0;var r,n,o,s,a=0,l=0,c=0;if(this.interim[0]){var d=!1,h=this.interim[0];h&=192==(224&h)?31:224==(240&h)?15:7;for(var p=0,u=void 0;(u=63&this.interim[++p])&&p<4;)h<<=6,h|=u;for(var f=192==(224&this.interim[0])?2:224==(240&this.interim[0])?3:4,_=f-p;c<_;){if(c>=i)return 0;if(128!=(192&(u=e[c++]))){c--,d=!0;break}this.interim[p++]=u,h<<=6,h|=63&u}d||(2===f?h<128?c--:t[a++]=h:3===f?h<2048||h>=55296&&h<=57343||65279===h||(t[a++]=h):h<65536||h>1114111||(t[a++]=h)),this.interim.fill(0)}for(var g=i-4,m=c;m<i;){for(;!(!(m<g)||128&(r=e[m])||128&(n=e[m+1])||128&(o=e[m+2])||128&(s=e[m+3]));)t[a++]=r,t[a++]=n,t[a++]=o,t[a++]=s,m+=4;if((r=e[m++])<128)t[a++]=r;else if(192==(224&r)){if(m>=i)return this.interim[0]=r,a;if(128!=(192&(n=e[m++]))){m--;continue}if((l=(31&r)<<6|63&n)<128){m--;continue}t[a++]=l}else if(224==(240&r)){if(m>=i)return this.interim[0]=r,a;if(128!=(192&(n=e[m++]))){m--;continue}if(m>=i)return this.interim[0]=r,this.interim[1]=n,a;if(128!=(192&(o=e[m++]))){m--;continue}if((l=(15&r)<<12|(63&n)<<6|63&o)<2048||l>=55296&&l<=57343||65279===l)continue;t[a++]=l}else if(240==(248&r)){if(m>=i)return this.interim[0]=r,a;if(128!=(192&(n=e[m++]))){m--;continue}if(m>=i)return this.interim[0]=r,this.interim[1]=n,a;if(128!=(192&(o=e[m++]))){m--;continue}if(m>=i)return this.interim[0]=r,this.interim[1]=n,this.interim[2]=o,a;if(128!=(192&(s=e[m++]))){m--;continue}if((l=(7&r)<<18|(63&n)<<12|(63&o)<<6|63&s)<65536||l>1114111)continue;t[a++]=l}}return a},e}();t.Utf8ToUtf32=r},225:(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.UnicodeV6=void 0;var r,n=i(8273),o=[[768,879],[1155,1158],[1160,1161],[1425,1469],[1471,1471],[1473,1474],[1476,1477],[1479,1479],[1536,1539],[1552,1557],[1611,1630],[1648,1648],[1750,1764],[1767,1768],[1770,1773],[1807,1807],[1809,1809],[1840,1866],[1958,1968],[2027,2035],[2305,2306],[2364,2364],[2369,2376],[2381,2381],[2385,2388],[2402,2403],[2433,2433],[2492,2492],[2497,2500],[2509,2509],[2530,2531],[2561,2562],[2620,2620],[2625,2626],[2631,2632],[2635,2637],[2672,2673],[2689,2690],[2748,2748],[2753,2757],[2759,2760],[2765,2765],[2786,2787],[2817,2817],[2876,2876],[2879,2879],[2881,2883],[2893,2893],[2902,2902],[2946,2946],[3008,3008],[3021,3021],[3134,3136],[3142,3144],[3146,3149],[3157,3158],[3260,3260],[3263,3263],[3270,3270],[3276,3277],[3298,3299],[3393,3395],[3405,3405],[3530,3530],[3538,3540],[3542,3542],[3633,3633],[3636,3642],[3655,3662],[3761,3761],[3764,3769],[3771,3772],[3784,3789],[3864,3865],[3893,3893],[3895,3895],[3897,3897],[3953,3966],[3968,3972],[3974,3975],[3984,3991],[3993,4028],[4038,4038],[4141,4144],[4146,4146],[4150,4151],[4153,4153],[4184,4185],[4448,4607],[4959,4959],[5906,5908],[5938,5940],[5970,5971],[6002,6003],[6068,6069],[6071,6077],[6086,6086],[6089,6099],[6109,6109],[6155,6157],[6313,6313],[6432,6434],[6439,6440],[6450,6450],[6457,6459],[6679,6680],[6912,6915],[6964,6964],[6966,6970],[6972,6972],[6978,6978],[7019,7027],[7616,7626],[7678,7679],[8203,8207],[8234,8238],[8288,8291],[8298,8303],[8400,8431],[12330,12335],[12441,12442],[43014,43014],[43019,43019],[43045,43046],[64286,64286],[65024,65039],[65056,65059],[65279,65279],[65529,65531]],s=[[68097,68099],[68101,68102],[68108,68111],[68152,68154],[68159,68159],[119143,119145],[119155,119170],[119173,119179],[119210,119213],[119362,119364],[917505,917505],[917536,917631],[917760,917999]],a=function(){function e(){if(this.version="6",!r){r=new Uint8Array(65536),(0,n.fill)(r,1),r[0]=0,(0,n.fill)(r,0,1,32),(0,n.fill)(r,0,127,160),(0,n.fill)(r,2,4352,4448),r[9001]=2,r[9002]=2,(0,n.fill)(r,2,11904,42192),r[12351]=1,(0,n.fill)(r,2,44032,55204),(0,n.fill)(r,2,63744,64256),(0,n.fill)(r,2,65040,65050),(0,n.fill)(r,2,65072,65136),(0,n.fill)(r,2,65280,65377),(0,n.fill)(r,2,65504,65511);for(var e=0;e<o.length;++e)(0,n.fill)(r,0,o[e][0],o[e][1]+1)}}return e.prototype.wcwidth=function(e){return e<32?0:e<127?1:e<65536?r[e]:function(e,t){var i,r=0,n=t.length-1;if(e<t[0][0]||e>t[n][1])return!1;for(;n>=r;)if(e>t[i=r+n>>1][1])r=i+1;else{if(!(e<t[i][0]))return!0;n=i-1}return!1}(e,s)?0:e>=131072&&e<=196605||e>=196608&&e<=262141?2:1},e}();t.UnicodeV6=a},5981:(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.WriteBuffer=void 0;var r=i(8460),n="undefined"==typeof queueMicrotask?function(e){Promise.resolve().then(e)}:queueMicrotask,o=function(){function e(e){this._action=e,this._writeBuffer=[],this._callbacks=[],this._pendingData=0,this._bufferOffset=0,this._isSyncWriting=!1,this._syncCalls=0,this._onWriteParsed=new r.EventEmitter}return Object.defineProperty(e.prototype,"onWriteParsed",{get:function(){return this._onWriteParsed.event},enumerable:!1,configurable:!0}),e.prototype.writeSync=function(e,t){if(void 0!==t&&this._syncCalls>t)this._syncCalls=0;else if(this._pendingData+=e.length,this._writeBuffer.push(e),this._callbacks.push(void 0),this._syncCalls++,!this._isSyncWriting){var i;for(this._isSyncWriting=!0;i=this._writeBuffer.shift();){this._action(i);var r=this._callbacks.shift();r&&r()}this._pendingData=0,this._bufferOffset=2147483647,this._isSyncWriting=!1,this._syncCalls=0}},e.prototype.write=function(e,t){var i=this;if(this._pendingData>5e7)throw new Error("write data discarded, use flow control to avoid losing data");this._writeBuffer.length||(this._bufferOffset=0,setTimeout((function(){return i._innerWrite()}))),this._pendingData+=e.length,this._writeBuffer.push(e),this._callbacks.push(t)},e.prototype._innerWrite=function(e,t){var i=this;void 0===e&&(e=0),void 0===t&&(t=!0);for(var r=e||Date.now();this._writeBuffer.length>this._bufferOffset;){var o=this._writeBuffer[this._bufferOffset],s=this._action(o,t);if(s)return void s.catch((function(e){return n((function(){throw e})),Promise.resolve(!1)})).then((function(e){return Date.now()-r>=12?setTimeout((function(){return i._innerWrite(0,e)})):i._innerWrite(r,e)}));var a=this._callbacks[this._bufferOffset];if(a&&a(),this._bufferOffset++,this._pendingData-=o.length,Date.now()-r>=12)break}this._writeBuffer.length>this._bufferOffset?(this._bufferOffset>50&&(this._writeBuffer=this._writeBuffer.slice(this._bufferOffset),this._callbacks=this._callbacks.slice(this._bufferOffset),this._bufferOffset=0),setTimeout((function(){return i._innerWrite()}))):(this._writeBuffer.length=0,this._callbacks.length=0,this._pendingData=0,this._bufferOffset=0),this._onWriteParsed.fire()},e}();t.WriteBuffer=o},5941:function(e,t){var i=this&&this.__read||function(e,t){var i="function"==typeof Symbol&&e[Symbol.iterator];if(!i)return e;var r,n,o=i.call(e),s=[];try{for(;(void 0===t||t-- >0)&&!(r=o.next()).done;)s.push(r.value)}catch(e){n={error:e}}finally{try{r&&!r.done&&(i=o.return)&&i.call(o)}finally{if(n)throw n.error}}return s};Object.defineProperty(t,"__esModule",{value:!0}),t.toRgbString=t.parseColor=void 0;var r=/^([\da-f])\/([\da-f])\/([\da-f])$|^([\da-f]{2})\/([\da-f]{2})\/([\da-f]{2})$|^([\da-f]{3})\/([\da-f]{3})\/([\da-f]{3})$|^([\da-f]{4})\/([\da-f]{4})\/([\da-f]{4})$/,n=/^[\da-f]+$/;function o(e,t){var i=e.toString(16),r=i.length<2?"0"+i:i;switch(t){case 4:return i[0];case 8:return r;case 12:return(r+r).slice(0,3);default:return r+r}}t.parseColor=function(e){if(e){var t=e.toLowerCase();if(0===t.indexOf("rgb:")){t=t.slice(4);var i=r.exec(t);if(i){var o=i[1]?15:i[4]?255:i[7]?4095:65535;return[Math.round(parseInt(i[1]||i[4]||i[7]||i[10],16)/o*255),Math.round(parseInt(i[2]||i[5]||i[8]||i[11],16)/o*255),Math.round(parseInt(i[3]||i[6]||i[9]||i[12],16)/o*255)]}}else if(0===t.indexOf("#")&&(t=t.slice(1),n.exec(t)&&[3,6,9,12].includes(t.length))){for(var s=t.length/3,a=[0,0,0],l=0;l<3;++l){var c=parseInt(t.slice(s*l,s*l+s),16);a[l]=1===s?c<<4:2===s?c:3===s?c>>4:c>>8}return a}}},t.toRgbString=function(e,t){void 0===t&&(t=16);var r=i(e,3),n=r[0],s=r[1],a=r[2];return"rgb:"+o(n,t)+"/"+o(s,t)+"/"+o(a,t)}},5770:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.PAYLOAD_LIMIT=void 0,t.PAYLOAD_LIMIT=1e7},6351:(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.DcsHandler=t.DcsParser=void 0;var r=i(482),n=i(8742),o=i(5770),s=[],a=function(){function e(){this._handlers=Object.create(null),this._active=s,this._ident=0,this._handlerFb=function(){},this._stack={paused:!1,loopPosition:0,fallThrough:!1}}return e.prototype.dispose=function(){this._handlers=Object.create(null),this._handlerFb=function(){},this._active=s},e.prototype.registerHandler=function(e,t){void 0===this._handlers[e]&&(this._handlers[e]=[]);var i=this._handlers[e];return i.push(t),{dispose:function(){var e=i.indexOf(t);-1!==e&&i.splice(e,1)}}},e.prototype.clearHandler=function(e){this._handlers[e]&&delete this._handlers[e]},e.prototype.setHandlerFallback=function(e){this._handlerFb=e},e.prototype.reset=function(){if(this._active.length)for(var e=this._stack.paused?this._stack.loopPosition-1:this._active.length-1;e>=0;--e)this._active[e].unhook(!1);this._stack.paused=!1,this._active=s,this._ident=0},e.prototype.hook=function(e,t){if(this.reset(),this._ident=e,this._active=this._handlers[e]||s,this._active.length)for(var i=this._active.length-1;i>=0;i--)this._active[i].hook(t);else this._handlerFb(this._ident,"HOOK",t)},e.prototype.put=function(e,t,i){if(this._active.length)for(var n=this._active.length-1;n>=0;n--)this._active[n].put(e,t,i);else this._handlerFb(this._ident,"PUT",(0,r.utf32ToString)(e,t,i))},e.prototype.unhook=function(e,t){if(void 0===t&&(t=!0),this._active.length){var i=!1,r=this._active.length-1,n=!1;if(this._stack.paused&&(r=this._stack.loopPosition-1,i=t,n=this._stack.fallThrough,this._stack.paused=!1),!n&&!1===i){for(;r>=0&&!0!==(i=this._active[r].unhook(e));r--)if(i instanceof Promise)return this._stack.paused=!0,this._stack.loopPosition=r,this._stack.fallThrough=!1,i;r--}for(;r>=0;r--)if((i=this._active[r].unhook(!1))instanceof Promise)return this._stack.paused=!0,this._stack.loopPosition=r,this._stack.fallThrough=!0,i}else this._handlerFb(this._ident,"UNHOOK",e);this._active=s,this._ident=0},e}();t.DcsParser=a;var l=new n.Params;l.addParam(0);var c=function(){function e(e){this._handler=e,this._data="",this._params=l,this._hitLimit=!1}return e.prototype.hook=function(e){this._params=e.length>1||e.params[0]?e.clone():l,this._data="",this._hitLimit=!1},e.prototype.put=function(e,t,i){this._hitLimit||(this._data+=(0,r.utf32ToString)(e,t,i),this._data.length>o.PAYLOAD_LIMIT&&(this._data="",this._hitLimit=!0))},e.prototype.unhook=function(e){var t=this,i=!1;if(this._hitLimit)i=!1;else if(e&&(i=this._handler(this._data,this._params))instanceof Promise)return i.then((function(e){return t._params=l,t._data="",t._hitLimit=!1,e}));return this._params=l,this._data="",this._hitLimit=!1,i},e}();t.DcsHandler=c},2015:function(e,t,i){var r,n=this&&this.__extends||(r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])},r(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function i(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)});Object.defineProperty(t,"__esModule",{value:!0}),t.EscapeSequenceParser=t.VT500_TRANSITION_TABLE=t.TransitionTable=void 0;var o=i(844),s=i(8273),a=i(8742),l=i(6242),c=i(6351),d=function(){function e(e){this.table=new Uint8Array(e)}return e.prototype.setDefault=function(e,t){(0,s.fill)(this.table,e<<4|t)},e.prototype.add=function(e,t,i,r){this.table[t<<8|e]=i<<4|r},e.prototype.addMany=function(e,t,i,r){for(var n=0;n<e.length;n++)this.table[t<<8|e[n]]=i<<4|r},e}();t.TransitionTable=d;var h=160;t.VT500_TRANSITION_TABLE=function(){var e=new d(4095),t=Array.apply(null,Array(256)).map((function(e,t){return t})),i=function(e,i){return t.slice(e,i)},r=i(32,127),n=i(0,24);n.push(25),n.push.apply(n,i(28,32));var o,s=i(0,14);for(o in e.setDefault(1,0),e.addMany(r,0,2,0),s)e.addMany([24,26,153,154],o,3,0),e.addMany(i(128,144),o,3,0),e.addMany(i(144,152),o,3,0),e.add(156,o,0,0),e.add(27,o,11,1),e.add(157,o,4,8),e.addMany([152,158,159],o,0,7),e.add(155,o,11,3),e.add(144,o,11,9);return e.addMany(n,0,3,0),e.addMany(n,1,3,1),e.add(127,1,0,1),e.addMany(n,8,0,8),e.addMany(n,3,3,3),e.add(127,3,0,3),e.addMany(n,4,3,4),e.add(127,4,0,4),e.addMany(n,6,3,6),e.addMany(n,5,3,5),e.add(127,5,0,5),e.addMany(n,2,3,2),e.add(127,2,0,2),e.add(93,1,4,8),e.addMany(r,8,5,8),e.add(127,8,5,8),e.addMany([156,27,24,26,7],8,6,0),e.addMany(i(28,32),8,0,8),e.addMany([88,94,95],1,0,7),e.addMany(r,7,0,7),e.addMany(n,7,0,7),e.add(156,7,0,0),e.add(127,7,0,7),e.add(91,1,11,3),e.addMany(i(64,127),3,7,0),e.addMany(i(48,60),3,8,4),e.addMany([60,61,62,63],3,9,4),e.addMany(i(48,60),4,8,4),e.addMany(i(64,127),4,7,0),e.addMany([60,61,62,63],4,0,6),e.addMany(i(32,64),6,0,6),e.add(127,6,0,6),e.addMany(i(64,127),6,0,0),e.addMany(i(32,48),3,9,5),e.addMany(i(32,48),5,9,5),e.addMany(i(48,64),5,0,6),e.addMany(i(64,127),5,7,0),e.addMany(i(32,48),4,9,5),e.addMany(i(32,48),1,9,2),e.addMany(i(32,48),2,9,2),e.addMany(i(48,127),2,10,0),e.addMany(i(48,80),1,10,0),e.addMany(i(81,88),1,10,0),e.addMany([89,90,92],1,10,0),e.addMany(i(96,127),1,10,0),e.add(80,1,11,9),e.addMany(n,9,0,9),e.add(127,9,0,9),e.addMany(i(28,32),9,0,9),e.addMany(i(32,48),9,9,12),e.addMany(i(48,60),9,8,10),e.addMany([60,61,62,63],9,9,10),e.addMany(n,11,0,11),e.addMany(i(32,128),11,0,11),e.addMany(i(28,32),11,0,11),e.addMany(n,10,0,10),e.add(127,10,0,10),e.addMany(i(28,32),10,0,10),e.addMany(i(48,60),10,8,10),e.addMany([60,61,62,63],10,0,11),e.addMany(i(32,48),10,9,12),e.addMany(n,12,0,12),e.add(127,12,0,12),e.addMany(i(28,32),12,0,12),e.addMany(i(32,48),12,9,12),e.addMany(i(48,64),12,0,11),e.addMany(i(64,127),12,12,13),e.addMany(i(64,127),10,12,13),e.addMany(i(64,127),9,12,13),e.addMany(n,13,13,13),e.addMany(r,13,13,13),e.add(127,13,0,13),e.addMany([27,156,24,26],13,14,0),e.add(h,0,2,0),e.add(h,8,5,8),e.add(h,6,0,6),e.add(h,11,0,11),e.add(h,13,13,13),e}();var p=function(e){function i(i){void 0===i&&(i=t.VT500_TRANSITION_TABLE);var r=e.call(this)||this;return r._transitions=i,r._parseStack={state:0,handlers:[],handlerPos:0,transition:0,chunkPos:0},r.initialState=0,r.currentState=r.initialState,r._params=new a.Params,r._params.addParam(0),r._collect=0,r.precedingCodepoint=0,r._printHandlerFb=function(e,t,i){},r._executeHandlerFb=function(e){},r._csiHandlerFb=function(e,t){},r._escHandlerFb=function(e){},r._errorHandlerFb=function(e){return e},r._printHandler=r._printHandlerFb,r._executeHandlers=Object.create(null),r._csiHandlers=Object.create(null),r._escHandlers=Object.create(null),r._oscParser=new l.OscParser,r._dcsParser=new c.DcsParser,r._errorHandler=r._errorHandlerFb,r.registerEscHandler({final:"\\"},(function(){return!0})),r}return n(i,e),i.prototype._identifier=function(e,t){void 0===t&&(t=[64,126]);var i=0;if(e.prefix){if(e.prefix.length>1)throw new Error("only one byte as prefix supported");if((i=e.prefix.charCodeAt(0))&&60>i||i>63)throw new Error("prefix must be in range 0x3c .. 0x3f")}if(e.intermediates){if(e.intermediates.length>2)throw new Error("only two bytes as intermediates are supported");for(var r=0;r<e.intermediates.length;++r){var n=e.intermediates.charCodeAt(r);if(32>n||n>47)throw new Error("intermediate must be in range 0x20 .. 0x2f");i<<=8,i|=n}}if(1!==e.final.length)throw new Error("final must be a single byte");var o=e.final.charCodeAt(0);if(t[0]>o||o>t[1])throw new Error("final must be in range "+t[0]+" .. "+t[1]);return(i<<=8)|o},i.prototype.identToString=function(e){for(var t=[];e;)t.push(String.fromCharCode(255&e)),e>>=8;return t.reverse().join("")},i.prototype.dispose=function(){this._csiHandlers=Object.create(null),this._executeHandlers=Object.create(null),this._escHandlers=Object.create(null),this._oscParser.dispose(),this._dcsParser.dispose()},i.prototype.setPrintHandler=function(e){this._printHandler=e},i.prototype.clearPrintHandler=function(){this._printHandler=this._printHandlerFb},i.prototype.registerEscHandler=function(e,t){var i=this._identifier(e,[48,126]);void 0===this._escHandlers[i]&&(this._escHandlers[i]=[]);var r=this._escHandlers[i];return r.push(t),{dispose:function(){var e=r.indexOf(t);-1!==e&&r.splice(e,1)}}},i.prototype.clearEscHandler=function(e){this._escHandlers[this._identifier(e,[48,126])]&&delete this._escHandlers[this._identifier(e,[48,126])]},i.prototype.setEscHandlerFallback=function(e){this._escHandlerFb=e},i.prototype.setExecuteHandler=function(e,t){this._executeHandlers[e.charCodeAt(0)]=t},i.prototype.clearExecuteHandler=function(e){this._executeHandlers[e.charCodeAt(0)]&&delete this._executeHandlers[e.charCodeAt(0)]},i.prototype.setExecuteHandlerFallback=function(e){this._executeHandlerFb=e},i.prototype.registerCsiHandler=function(e,t){var i=this._identifier(e);void 0===this._csiHandlers[i]&&(this._csiHandlers[i]=[]);var r=this._csiHandlers[i];return r.push(t),{dispose:function(){var e=r.indexOf(t);-1!==e&&r.splice(e,1)}}},i.prototype.clearCsiHandler=function(e){this._csiHandlers[this._identifier(e)]&&delete this._csiHandlers[this._identifier(e)]},i.prototype.setCsiHandlerFallback=function(e){this._csiHandlerFb=e},i.prototype.registerDcsHandler=function(e,t){return this._dcsParser.registerHandler(this._identifier(e),t)},i.prototype.clearDcsHandler=function(e){this._dcsParser.clearHandler(this._identifier(e))},i.prototype.setDcsHandlerFallback=function(e){this._dcsParser.setHandlerFallback(e)},i.prototype.registerOscHandler=function(e,t){return this._oscParser.registerHandler(e,t)},i.prototype.clearOscHandler=function(e){this._oscParser.clearHandler(e)},i.prototype.setOscHandlerFallback=function(e){this._oscParser.setHandlerFallback(e)},i.prototype.setErrorHandler=function(e){this._errorHandler=e},i.prototype.clearErrorHandler=function(){this._errorHandler=this._errorHandlerFb},i.prototype.reset=function(){this.currentState=this.initialState,this._oscParser.reset(),this._dcsParser.reset(),this._params.reset(),this._params.addParam(0),this._collect=0,this.precedingCodepoint=0,0!==this._parseStack.state&&(this._parseStack.state=2,this._parseStack.handlers=[])},i.prototype._preserveStack=function(e,t,i,r,n){this._parseStack.state=e,this._parseStack.handlers=t,this._parseStack.handlerPos=i,this._parseStack.transition=r,this._parseStack.chunkPos=n},i.prototype.parse=function(e,t,i){var r,n=0,o=0,s=0;if(this._parseStack.state)if(2===this._parseStack.state)this._parseStack.state=0,s=this._parseStack.chunkPos+1;else{if(void 0===i||1===this._parseStack.state)throw this._parseStack.state=1,new Error("improper continuation due to previous async handler, giving up parsing");var a=this._parseStack.handlers,l=this._parseStack.handlerPos-1;switch(this._parseStack.state){case 3:if(!1===i&&l>-1)for(;l>=0&&!0!==(r=a[l](this._params));l--)if(r instanceof Promise)return this._parseStack.handlerPos=l,r;this._parseStack.handlers=[];break;case 4:if(!1===i&&l>-1)for(;l>=0&&!0!==(r=a[l]());l--)if(r instanceof Promise)return this._parseStack.handlerPos=l,r;this._parseStack.handlers=[];break;case 6:if(n=e[this._parseStack.chunkPos],r=this._dcsParser.unhook(24!==n&&26!==n,i))return r;27===n&&(this._parseStack.transition|=1),this._params.reset(),this._params.addParam(0),this._collect=0;break;case 5:if(n=e[this._parseStack.chunkPos],r=this._oscParser.end(24!==n&&26!==n,i))return r;27===n&&(this._parseStack.transition|=1),this._params.reset(),this._params.addParam(0),this._collect=0}this._parseStack.state=0,s=this._parseStack.chunkPos+1,this.precedingCodepoint=0,this.currentState=15&this._parseStack.transition}for(var c=s;c<t;++c){switch(n=e[c],(o=this._transitions.table[this.currentState<<8|(n<160?n:h)])>>4){case 2:for(var d=c+1;;++d){if(d>=t||(n=e[d])<32||n>126&&n<h){this._printHandler(e,c,d),c=d-1;break}if(++d>=t||(n=e[d])<32||n>126&&n<h){this._printHandler(e,c,d),c=d-1;break}if(++d>=t||(n=e[d])<32||n>126&&n<h){this._printHandler(e,c,d),c=d-1;break}if(++d>=t||(n=e[d])<32||n>126&&n<h){this._printHandler(e,c,d),c=d-1;break}}break;case 3:this._executeHandlers[n]?this._executeHandlers[n]():this._executeHandlerFb(n),this.precedingCodepoint=0;break;case 0:break;case 1:if(this._errorHandler({position:c,code:n,currentState:this.currentState,collect:this._collect,params:this._params,abort:!1}).abort)return;break;case 7:for(var p=(a=this._csiHandlers[this._collect<<8|n])?a.length-1:-1;p>=0&&!0!==(r=a[p](this._params));p--)if(r instanceof Promise)return this._preserveStack(3,a,p,o,c),r;p<0&&this._csiHandlerFb(this._collect<<8|n,this._params),this.precedingCodepoint=0;break;case 8:do{switch(n){case 59:this._params.addParam(0);break;case 58:this._params.addSubParam(-1);break;default:this._params.addDigit(n-48)}}while(++c<t&&(n=e[c])>47&&n<60);c--;break;case 9:this._collect<<=8,this._collect|=n;break;case 10:for(var u=this._escHandlers[this._collect<<8|n],f=u?u.length-1:-1;f>=0&&!0!==(r=u[f]());f--)if(r instanceof Promise)return this._preserveStack(4,u,f,o,c),r;f<0&&this._escHandlerFb(this._collect<<8|n),this.precedingCodepoint=0;break;case 11:this._params.reset(),this._params.addParam(0),this._collect=0;break;case 12:this._dcsParser.hook(this._collect<<8|n,this._params);break;case 13:for(var _=c+1;;++_)if(_>=t||24===(n=e[_])||26===n||27===n||n>127&&n<h){this._dcsParser.put(e,c,_),c=_-1;break}break;case 14:if(r=this._dcsParser.unhook(24!==n&&26!==n))return this._preserveStack(6,[],0,o,c),r;27===n&&(o|=1),this._params.reset(),this._params.addParam(0),this._collect=0,this.precedingCodepoint=0;break;case 4:this._oscParser.start();break;case 5:for(var g=c+1;;g++)if(g>=t||(n=e[g])<32||n>127&&n<h){this._oscParser.put(e,c,g),c=g-1;break}break;case 6:if(r=this._oscParser.end(24!==n&&26!==n))return this._preserveStack(5,[],0,o,c),r;27===n&&(o|=1),this._params.reset(),this._params.addParam(0),this._collect=0,this.precedingCodepoint=0}this.currentState=15&o}},i}(o.Disposable);t.EscapeSequenceParser=p},6242:(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.OscHandler=t.OscParser=void 0;var r=i(5770),n=i(482),o=[],s=function(){function e(){this._state=0,this._active=o,this._id=-1,this._handlers=Object.create(null),this._handlerFb=function(){},this._stack={paused:!1,loopPosition:0,fallThrough:!1}}return e.prototype.registerHandler=function(e,t){void 0===this._handlers[e]&&(this._handlers[e]=[]);var i=this._handlers[e];return i.push(t),{dispose:function(){var e=i.indexOf(t);-1!==e&&i.splice(e,1)}}},e.prototype.clearHandler=function(e){this._handlers[e]&&delete this._handlers[e]},e.prototype.setHandlerFallback=function(e){this._handlerFb=e},e.prototype.dispose=function(){this._handlers=Object.create(null),this._handlerFb=function(){},this._active=o},e.prototype.reset=function(){if(2===this._state)for(var e=this._stack.paused?this._stack.loopPosition-1:this._active.length-1;e>=0;--e)this._active[e].end(!1);this._stack.paused=!1,this._active=o,this._id=-1,this._state=0},e.prototype._start=function(){if(this._active=this._handlers[this._id]||o,this._active.length)for(var e=this._active.length-1;e>=0;e--)this._active[e].start();else this._handlerFb(this._id,"START")},e.prototype._put=function(e,t,i){if(this._active.length)for(var r=this._active.length-1;r>=0;r--)this._active[r].put(e,t,i);else this._handlerFb(this._id,"PUT",(0,n.utf32ToString)(e,t,i))},e.prototype.start=function(){this.reset(),this._state=1},e.prototype.put=function(e,t,i){if(3!==this._state){if(1===this._state)for(;t<i;){var r=e[t++];if(59===r){this._state=2,this._start();break}if(r<48||57<r)return void(this._state=3);-1===this._id&&(this._id=0),this._id=10*this._id+r-48}2===this._state&&i-t>0&&this._put(e,t,i)}},e.prototype.end=function(e,t){if(void 0===t&&(t=!0),0!==this._state){if(3!==this._state)if(1===this._state&&this._start(),this._active.length){var i=!1,r=this._active.length-1,n=!1;if(this._stack.paused&&(r=this._stack.loopPosition-1,i=t,n=this._stack.fallThrough,this._stack.paused=!1),!n&&!1===i){for(;r>=0&&!0!==(i=this._active[r].end(e));r--)if(i instanceof Promise)return this._stack.paused=!0,this._stack.loopPosition=r,this._stack.fallThrough=!1,i;r--}for(;r>=0;r--)if((i=this._active[r].end(!1))instanceof Promise)return this._stack.paused=!0,this._stack.loopPosition=r,this._stack.fallThrough=!0,i}else this._handlerFb(this._id,"END",e);this._active=o,this._id=-1,this._state=0}},e}();t.OscParser=s;var a=function(){function e(e){this._handler=e,this._data="",this._hitLimit=!1}return e.prototype.start=function(){this._data="",this._hitLimit=!1},e.prototype.put=function(e,t,i){this._hitLimit||(this._data+=(0,n.utf32ToString)(e,t,i),this._data.length>r.PAYLOAD_LIMIT&&(this._data="",this._hitLimit=!0))},e.prototype.end=function(e){var t=this,i=!1;if(this._hitLimit)i=!1;else if(e&&(i=this._handler(this._data))instanceof Promise)return i.then((function(e){return t._data="",t._hitLimit=!1,e}));return this._data="",this._hitLimit=!1,i},e}();t.OscHandler=a},8742:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.Params=void 0;var i=2147483647,r=function(){function e(e,t){if(void 0===e&&(e=32),void 0===t&&(t=32),this.maxLength=e,this.maxSubParamsLength=t,t>256)throw new Error("maxSubParamsLength must not be greater than 256");this.params=new Int32Array(e),this.length=0,this._subParams=new Int32Array(t),this._subParamsLength=0,this._subParamsIdx=new Uint16Array(e),this._rejectDigits=!1,this._rejectSubDigits=!1,this._digitIsSub=!1}return e.fromArray=function(t){var i=new e;if(!t.length)return i;for(var r=Array.isArray(t[0])?1:0;r<t.length;++r){var n=t[r];if(Array.isArray(n))for(var o=0;o<n.length;++o)i.addSubParam(n[o]);else i.addParam(n)}return i},e.prototype.clone=function(){var t=new e(this.maxLength,this.maxSubParamsLength);return t.params.set(this.params),t.length=this.length,t._subParams.set(this._subParams),t._subParamsLength=this._subParamsLength,t._subParamsIdx.set(this._subParamsIdx),t._rejectDigits=this._rejectDigits,t._rejectSubDigits=this._rejectSubDigits,t._digitIsSub=this._digitIsSub,t},e.prototype.toArray=function(){for(var e=[],t=0;t<this.length;++t){e.push(this.params[t]);var i=this._subParamsIdx[t]>>8,r=255&this._subParamsIdx[t];r-i>0&&e.push(Array.prototype.slice.call(this._subParams,i,r))}return e},e.prototype.reset=function(){this.length=0,this._subParamsLength=0,this._rejectDigits=!1,this._rejectSubDigits=!1,this._digitIsSub=!1},e.prototype.addParam=function(e){if(this._digitIsSub=!1,this.length>=this.maxLength)this._rejectDigits=!0;else{if(e<-1)throw new Error("values lesser than -1 are not allowed");this._subParamsIdx[this.length]=this._subParamsLength<<8|this._subParamsLength,this.params[this.length++]=e>i?i:e}},e.prototype.addSubParam=function(e){if(this._digitIsSub=!0,this.length)if(this._rejectDigits||this._subParamsLength>=this.maxSubParamsLength)this._rejectSubDigits=!0;else{if(e<-1)throw new Error("values lesser than -1 are not allowed");this._subParams[this._subParamsLength++]=e>i?i:e,this._subParamsIdx[this.length-1]++}},e.prototype.hasSubParams=function(e){return(255&this._subParamsIdx[e])-(this._subParamsIdx[e]>>8)>0},e.prototype.getSubParams=function(e){var t=this._subParamsIdx[e]>>8,i=255&this._subParamsIdx[e];return i-t>0?this._subParams.subarray(t,i):null},e.prototype.getSubParamsAll=function(){for(var e={},t=0;t<this.length;++t){var i=this._subParamsIdx[t]>>8,r=255&this._subParamsIdx[t];r-i>0&&(e[t]=this._subParams.slice(i,r))}return e},e.prototype.addDigit=function(e){var t;if(!(this._rejectDigits||!(t=this._digitIsSub?this._subParamsLength:this.length)||this._digitIsSub&&this._rejectSubDigits)){var r=this._digitIsSub?this._subParams:this.params,n=r[t-1];r[t-1]=~n?Math.min(10*n+e,i):e}},e}();t.Params=r},5741:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.AddonManager=void 0;var i=function(){function e(){this._addons=[]}return e.prototype.dispose=function(){for(var e=this._addons.length-1;e>=0;e--)this._addons[e].instance.dispose()},e.prototype.loadAddon=function(e,t){var i=this,r={instance:t,dispose:t.dispose,isDisposed:!1};this._addons.push(r),t.dispose=function(){return i._wrappedAddonDispose(r)},t.activate(e)},e.prototype._wrappedAddonDispose=function(e){if(!e.isDisposed){for(var t=-1,i=0;i<this._addons.length;i++)if(this._addons[i]===e){t=i;break}if(-1===t)throw new Error("Could not dispose an addon that has not been loaded");e.isDisposed=!0,e.dispose.apply(e.instance),this._addons.splice(t,1)}},e}();t.AddonManager=i},8771:(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.BufferApiView=void 0;var r=i(3785),n=i(511),o=function(){function e(e,t){this._buffer=e,this.type=t}return e.prototype.init=function(e){return this._buffer=e,this},Object.defineProperty(e.prototype,"cursorY",{get:function(){return this._buffer.y},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"cursorX",{get:function(){return this._buffer.x},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"viewportY",{get:function(){return this._buffer.ydisp},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"baseY",{get:function(){return this._buffer.ybase},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"length",{get:function(){return this._buffer.lines.length},enumerable:!1,configurable:!0}),e.prototype.getLine=function(e){var t=this._buffer.lines.get(e);if(t)return new r.BufferLineApiView(t)},e.prototype.getNullCell=function(){return new n.CellData},e}();t.BufferApiView=o},3785:(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.BufferLineApiView=void 0;var r=i(511),n=function(){function e(e){this._line=e}return Object.defineProperty(e.prototype,"isWrapped",{get:function(){return this._line.isWrapped},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"length",{get:function(){return this._line.length},enumerable:!1,configurable:!0}),e.prototype.getCell=function(e,t){if(!(e<0||e>=this._line.length))return t?(this._line.loadCell(e,t),t):this._line.loadCell(e,new r.CellData)},e.prototype.translateToString=function(e,t,i){return this._line.translateToString(e,t,i)},e}();t.BufferLineApiView=n},8285:(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.BufferNamespaceApi=void 0;var r=i(8771),n=i(8460),o=function(){function e(e){var t=this;this._core=e,this._onBufferChange=new n.EventEmitter,this._normal=new r.BufferApiView(this._core.buffers.normal,"normal"),this._alternate=new r.BufferApiView(this._core.buffers.alt,"alternate"),this._core.buffers.onBufferActivate((function(){return t._onBufferChange.fire(t.active)}))}return Object.defineProperty(e.prototype,"onBufferChange",{get:function(){return this._onBufferChange.event},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"active",{get:function(){if(this._core.buffers.active===this._core.buffers.normal)return this.normal;if(this._core.buffers.active===this._core.buffers.alt)return this.alternate;throw new Error("Active buffer is neither normal nor alternate")},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"normal",{get:function(){return this._normal.init(this._core.buffers.normal)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"alternate",{get:function(){return this._alternate.init(this._core.buffers.alt)},enumerable:!1,configurable:!0}),e}();t.BufferNamespaceApi=o},7975:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.ParserApi=void 0;var i=function(){function e(e){this._core=e}return e.prototype.registerCsiHandler=function(e,t){return this._core.registerCsiHandler(e,(function(e){return t(e.toArray())}))},e.prototype.addCsiHandler=function(e,t){return this.registerCsiHandler(e,t)},e.prototype.registerDcsHandler=function(e,t){return this._core.registerDcsHandler(e,(function(e,i){return t(e,i.toArray())}))},e.prototype.addDcsHandler=function(e,t){return this.registerDcsHandler(e,t)},e.prototype.registerEscHandler=function(e,t){return this._core.registerEscHandler(e,t)},e.prototype.addEscHandler=function(e,t){return this.registerEscHandler(e,t)},e.prototype.registerOscHandler=function(e,t){return this._core.registerOscHandler(e,t)},e.prototype.addOscHandler=function(e,t){return this.registerOscHandler(e,t)},e}();t.ParserApi=i},7090:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.UnicodeApi=void 0;var i=function(){function e(e){this._core=e}return e.prototype.register=function(e){this._core.unicodeService.register(e)},Object.defineProperty(e.prototype,"versions",{get:function(){return this._core.unicodeService.versions},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"activeVersion",{get:function(){return this._core.unicodeService.activeVersion},set:function(e){this._core.unicodeService.activeVersion=e},enumerable:!1,configurable:!0}),e}();t.UnicodeApi=i},744:function(e,t,i){var r,n=this&&this.__extends||(r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])},r(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function i(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),o=this&&this.__decorate||function(e,t,i,r){var n,o=arguments.length,s=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,r);else for(var a=e.length-1;a>=0;a--)(n=e[a])&&(s=(o<3?n(s):o>3?n(t,i,s):n(t,i))||s);return o>3&&s&&Object.defineProperty(t,i,s),s},s=this&&this.__param||function(e,t){return function(i,r){t(i,r,e)}};Object.defineProperty(t,"__esModule",{value:!0}),t.BufferService=t.MINIMUM_ROWS=t.MINIMUM_COLS=void 0;var a=i(2585),l=i(5295),c=i(8460),d=i(844);t.MINIMUM_COLS=2,t.MINIMUM_ROWS=1;var h=function(e){function i(i){var r=e.call(this)||this;return r._optionsService=i,r.isUserScrolling=!1,r._onResize=new c.EventEmitter,r._onScroll=new c.EventEmitter,r.cols=Math.max(i.rawOptions.cols||0,t.MINIMUM_COLS),r.rows=Math.max(i.rawOptions.rows||0,t.MINIMUM_ROWS),r.buffers=new l.BufferSet(i,r),r}return n(i,e),Object.defineProperty(i.prototype,"onResize",{get:function(){return this._onResize.event},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"onScroll",{get:function(){return this._onScroll.event},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"buffer",{get:function(){return this.buffers.active},enumerable:!1,configurable:!0}),i.prototype.dispose=function(){e.prototype.dispose.call(this),this.buffers.dispose()},i.prototype.resize=function(e,t){this.cols=e,this.rows=t,this.buffers.resize(e,t),this.buffers.setupTabStops(this.cols),this._onResize.fire({cols:e,rows:t})},i.prototype.reset=function(){this.buffers.reset(),this.isUserScrolling=!1},i.prototype.scroll=function(e,t){void 0===t&&(t=!1);var i,r=this.buffer;(i=this._cachedBlankLine)&&i.length===this.cols&&i.getFg(0)===e.fg&&i.getBg(0)===e.bg||(i=r.getBlankLine(e,t),this._cachedBlankLine=i),i.isWrapped=t;var n=r.ybase+r.scrollTop,o=r.ybase+r.scrollBottom;if(0===r.scrollTop){var s=r.lines.isFull;o===r.lines.length-1?s?r.lines.recycle().copyFrom(i):r.lines.push(i.clone()):r.lines.splice(o+1,0,i.clone()),s?this.isUserScrolling&&(r.ydisp=Math.max(r.ydisp-1,0)):(r.ybase++,this.isUserScrolling||r.ydisp++)}else{var a=o-n+1;r.lines.shiftElements(n+1,a-1,-1),r.lines.set(o,i.clone())}this.isUserScrolling||(r.ydisp=r.ybase),this._onScroll.fire(r.ydisp)},i.prototype.scrollLines=function(e,t,i){var r=this.buffer;if(e<0){if(0===r.ydisp)return;this.isUserScrolling=!0}else e+r.ydisp>=r.ybase&&(this.isUserScrolling=!1);var n=r.ydisp;r.ydisp=Math.max(Math.min(r.ydisp+e,r.ybase),0),n!==r.ydisp&&(t||this._onScroll.fire(r.ydisp))},i.prototype.scrollPages=function(e){this.scrollLines(e*(this.rows-1))},i.prototype.scrollToTop=function(){this.scrollLines(-this.buffer.ydisp)},i.prototype.scrollToBottom=function(){this.scrollLines(this.buffer.ybase-this.buffer.ydisp)},i.prototype.scrollToLine=function(e){var t=e-this.buffer.ydisp;0!==t&&this.scrollLines(t)},o([s(0,a.IOptionsService)],i)}(d.Disposable);t.BufferService=h},7994:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.CharsetService=void 0;var i=function(){function e(){this.glevel=0,this._charsets=[]}return e.prototype.reset=function(){this.charset=void 0,this._charsets=[],this.glevel=0},e.prototype.setgLevel=function(e){this.glevel=e,this.charset=this._charsets[e]},e.prototype.setgCharset=function(e,t){this._charsets[e]=t,this.glevel===e&&(this.charset=t)},e}();t.CharsetService=i},1753:function(e,t,i){var r=this&&this.__decorate||function(e,t,i,r){var n,o=arguments.length,s=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,r);else for(var a=e.length-1;a>=0;a--)(n=e[a])&&(s=(o<3?n(s):o>3?n(t,i,s):n(t,i))||s);return o>3&&s&&Object.defineProperty(t,i,s),s},n=this&&this.__param||function(e,t){return function(i,r){t(i,r,e)}},o=this&&this.__values||function(e){var t="function"==typeof Symbol&&Symbol.iterator,i=t&&e[t],r=0;if(i)return i.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(t,"__esModule",{value:!0}),t.CoreMouseService=void 0;var s=i(2585),a=i(8460),l={NONE:{events:0,restrict:function(){return!1}},X10:{events:1,restrict:function(e){return 4!==e.button&&1===e.action&&(e.ctrl=!1,e.alt=!1,e.shift=!1,!0)}},VT200:{events:19,restrict:function(e){return 32!==e.action}},DRAG:{events:23,restrict:function(e){return 32!==e.action||3!==e.button}},ANY:{events:31,restrict:function(e){return!0}}};function c(e,t){var i=(e.ctrl?16:0)|(e.shift?4:0)|(e.alt?8:0);return 4===e.button?(i|=64,i|=e.action):(i|=3&e.button,4&e.button&&(i|=64),8&e.button&&(i|=128),32===e.action?i|=32:0!==e.action||t||(i|=3)),i}var d=String.fromCharCode,h={DEFAULT:function(e){var t=[c(e,!1)+32,e.col+32,e.row+32];return t[0]>255||t[1]>255||t[2]>255?"":"[M"+d(t[0])+d(t[1])+d(t[2])},SGR:function(e){var t=0===e.action&&4!==e.button?"m":"M";return"[<"+c(e,!0)+";"+e.col+";"+e.row+t}},p=function(){function e(e,t){var i,r,n,s;this._bufferService=e,this._coreService=t,this._protocols={},this._encodings={},this._activeProtocol="",this._activeEncoding="",this._onProtocolChange=new a.EventEmitter,this._lastEvent=null;try{for(var c=o(Object.keys(l)),d=c.next();!d.done;d=c.next()){var p=d.value;this.addProtocol(p,l[p])}}catch(e){i={error:e}}finally{try{d&&!d.done&&(r=c.return)&&r.call(c)}finally{if(i)throw i.error}}try{for(var u=o(Object.keys(h)),f=u.next();!f.done;f=u.next()){var _=f.value;this.addEncoding(_,h[_])}}catch(e){n={error:e}}finally{try{f&&!f.done&&(s=u.return)&&s.call(u)}finally{if(n)throw n.error}}this.reset()}return e.prototype.addProtocol=function(e,t){this._protocols[e]=t},e.prototype.addEncoding=function(e,t){this._encodings[e]=t},Object.defineProperty(e.prototype,"activeProtocol",{get:function(){return this._activeProtocol},set:function(e){if(!this._protocols[e])throw new Error('unknown protocol "'+e+'"');this._activeProtocol=e,this._onProtocolChange.fire(this._protocols[e].events)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"areMouseEventsActive",{get:function(){return 0!==this._protocols[this._activeProtocol].events},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"activeEncoding",{get:function(){return this._activeEncoding},set:function(e){if(!this._encodings[e])throw new Error('unknown encoding "'+e+'"');this._activeEncoding=e},enumerable:!1,configurable:!0}),e.prototype.reset=function(){this.activeProtocol="NONE",this.activeEncoding="DEFAULT",this._lastEvent=null},Object.defineProperty(e.prototype,"onProtocolChange",{get:function(){return this._onProtocolChange.event},enumerable:!1,configurable:!0}),e.prototype.triggerMouseEvent=function(e){if(e.col<0||e.col>=this._bufferService.cols||e.row<0||e.row>=this._bufferService.rows)return!1;if(4===e.button&&32===e.action)return!1;if(3===e.button&&32!==e.action)return!1;if(4!==e.button&&(2===e.action||3===e.action))return!1;if(e.col++,e.row++,32===e.action&&this._lastEvent&&this._compareEvents(this._lastEvent,e))return!1;if(!this._protocols[this._activeProtocol].restrict(e))return!1;var t=this._encodings[this._activeEncoding](e);return t&&("DEFAULT"===this._activeEncoding?this._coreService.triggerBinaryEvent(t):this._coreService.triggerDataEvent(t,!0)),this._lastEvent=e,!0},e.prototype.explainEvents=function(e){return{down:!!(1&e),up:!!(2&e),drag:!!(4&e),move:!!(8&e),wheel:!!(16&e)}},e.prototype._compareEvents=function(e,t){return e.col===t.col&&e.row===t.row&&e.button===t.button&&e.action===t.action&&e.ctrl===t.ctrl&&e.alt===t.alt&&e.shift===t.shift},r([n(0,s.IBufferService),n(1,s.ICoreService)],e)}();t.CoreMouseService=p},6975:function(e,t,i){var r,n=this&&this.__extends||(r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])},r(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function i(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),o=this&&this.__decorate||function(e,t,i,r){var n,o=arguments.length,s=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,r);else for(var a=e.length-1;a>=0;a--)(n=e[a])&&(s=(o<3?n(s):o>3?n(t,i,s):n(t,i))||s);return o>3&&s&&Object.defineProperty(t,i,s),s},s=this&&this.__param||function(e,t){return function(i,r){t(i,r,e)}};Object.defineProperty(t,"__esModule",{value:!0}),t.CoreService=void 0;var a=i(2585),l=i(8460),c=i(1439),d=i(844),h=Object.freeze({insertMode:!1}),p=Object.freeze({applicationCursorKeys:!1,applicationKeypad:!1,bracketedPasteMode:!1,origin:!1,reverseWraparound:!1,sendFocus:!1,wraparound:!0}),u=function(e){function t(t,i,r,n){var o=e.call(this)||this;return o._bufferService=i,o._logService=r,o._optionsService=n,o.isCursorInitialized=!1,o.isCursorHidden=!1,o._onData=o.register(new l.EventEmitter),o._onUserInput=o.register(new l.EventEmitter),o._onBinary=o.register(new l.EventEmitter),o._scrollToBottom=t,o.register({dispose:function(){return o._scrollToBottom=void 0}}),o.modes=(0,c.clone)(h),o.decPrivateModes=(0,c.clone)(p),o}return n(t,e),Object.defineProperty(t.prototype,"onData",{get:function(){return this._onData.event},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"onUserInput",{get:function(){return this._onUserInput.event},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"onBinary",{get:function(){return this._onBinary.event},enumerable:!1,configurable:!0}),t.prototype.reset=function(){this.modes=(0,c.clone)(h),this.decPrivateModes=(0,c.clone)(p)},t.prototype.triggerDataEvent=function(e,t){if(void 0===t&&(t=!1),!this._optionsService.rawOptions.disableStdin){var i=this._bufferService.buffer;i.ybase!==i.ydisp&&this._scrollToBottom(),t&&this._onUserInput.fire(),this._logService.debug('sending data "'+e+'"',(function(){return e.split("").map((function(e){return e.charCodeAt(0)}))})),this._onData.fire(e)}},t.prototype.triggerBinaryEvent=function(e){this._optionsService.rawOptions.disableStdin||(this._logService.debug('sending binary "'+e+'"',(function(){return e.split("").map((function(e){return e.charCodeAt(0)}))})),this._onBinary.fire(e))},o([s(1,a.IBufferService),s(2,a.ILogService),s(3,a.IOptionsService)],t)}(d.Disposable);t.CoreService=u},9074:function(e,t,i){var r,n=this&&this.__extends||(r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])},r(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function i(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),o=this&&this.__generator||function(e,t){var i,r,n,o,s={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(o){return function(a){return function(o){if(i)throw new TypeError("Generator is already executing.");for(;s;)try{if(i=1,r&&(n=2&o[0]?r.return:o[0]?r.throw||((n=r.return)&&n.call(r),0):r.next)&&!(n=n.call(r,o[1])).done)return n;switch(r=0,n&&(o=[2&o[0],n.value]),o[0]){case 0:case 1:n=o;break;case 4:return s.label++,{value:o[1],done:!1};case 5:s.label++,r=o[1],o=[0];continue;case 7:o=s.ops.pop(),s.trys.pop();continue;default:if(!((n=(n=s.trys).length>0&&n[n.length-1])||6!==o[0]&&2!==o[0])){s=0;continue}if(3===o[0]&&(!n||o[1]>n[0]&&o[1]<n[3])){s.label=o[1];break}if(6===o[0]&&s.label<n[1]){s.label=n[1],n=o;break}if(n&&s.label<n[2]){s.label=n[2],s.ops.push(o);break}n[2]&&s.ops.pop(),s.trys.pop();continue}o=t.call(e,s)}catch(e){o=[6,e],r=0}finally{i=n=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,a])}}},s=this&&this.__values||function(e){var t="function"==typeof Symbol&&Symbol.iterator,i=t&&e[t],r=0;if(i)return i.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(t,"__esModule",{value:!0}),t.DecorationService=void 0;var a=i(8055),l=i(8460),c=i(844),d=i(6106),h=function(e){function t(){var t=e.call(this)||this;return t._decorations=new d.SortedList((function(e){return e.marker.line})),t._onDecorationRegistered=t.register(new l.EventEmitter),t._onDecorationRemoved=t.register(new l.EventEmitter),t}return n(t,e),Object.defineProperty(t.prototype,"onDecorationRegistered",{get:function(){return this._onDecorationRegistered.event},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"onDecorationRemoved",{get:function(){return this._onDecorationRemoved.event},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"decorations",{get:function(){return this._decorations.values()},enumerable:!1,configurable:!0}),t.prototype.registerDecoration=function(e){var t=this;if(!e.marker.isDisposed){var i=new p(e);if(i){var r=i.marker.onDispose((function(){return i.dispose()}));i.onDispose((function(){i&&(t._decorations.delete(i)&&t._onDecorationRemoved.fire(i),r.dispose())})),this._decorations.insert(i),this._onDecorationRegistered.fire(i)}return i}},t.prototype.reset=function(){var e,t;try{for(var i=s(this._decorations.values()),r=i.next();!r.done;r=i.next())r.value.dispose()}catch(t){e={error:t}}finally{try{r&&!r.done&&(t=i.return)&&t.call(i)}finally{if(e)throw e.error}}this._decorations.clear()},t.prototype.getDecorationsAtLine=function(e){return o(this,(function(t){return[2,this._decorations.getKeyIterator(e)]}))},t.prototype.getDecorationsAtCell=function(e,t,i){var r,n,a,l,c,d,h,p,u,f,_;return o(this,(function(o){switch(o.label){case 0:r=0,n=0,o.label=1;case 1:o.trys.push([1,6,7,8]),a=s(this._decorations.getKeyIterator(t)),l=a.next(),o.label=2;case 2:return l.done?[3,5]:(c=l.value,r=null!==(u=c.options.x)&&void 0!==u?u:0,n=r+(null!==(f=c.options.width)&&void 0!==f?f:1),!(e>=r&&e<n)||i&&(null!==(_=c.options.layer)&&void 0!==_?_:"bottom")!==i?[3,4]:[4,c]);case 3:o.sent(),o.label=4;case 4:return l=a.next(),[3,2];case 5:return[3,8];case 6:return d=o.sent(),h={error:d},[3,8];case 7:try{l&&!l.done&&(p=a.return)&&p.call(a)}finally{if(h)throw h.error}return[7];case 8:return[2]}}))},t.prototype.dispose=function(){var e,t;try{for(var i=s(this._decorations.values()),r=i.next();!r.done;r=i.next()){var n=r.value;this._onDecorationRemoved.fire(n)}}catch(t){e={error:t}}finally{try{r&&!r.done&&(t=i.return)&&t.call(i)}finally{if(e)throw e.error}}this.reset()},t}(c.Disposable);t.DecorationService=h;var p=function(e){function t(t){var i=e.call(this)||this;return i.options=t,i.isDisposed=!1,i.onRenderEmitter=i.register(new l.EventEmitter),i.onRender=i.onRenderEmitter.event,i._onDispose=i.register(new l.EventEmitter),i.onDispose=i._onDispose.event,i._cachedBg=null,i._cachedFg=null,i.marker=t.marker,i.options.overviewRulerOptions&&!i.options.overviewRulerOptions.position&&(i.options.overviewRulerOptions.position="full"),i}return n(t,e),Object.defineProperty(t.prototype,"backgroundColorRGB",{get:function(){return null===this._cachedBg&&(this.options.backgroundColor?this._cachedBg=a.css.toColor(this.options.backgroundColor):this._cachedBg=void 0),this._cachedBg},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"foregroundColorRGB",{get:function(){return null===this._cachedFg&&(this.options.foregroundColor?this._cachedFg=a.css.toColor(this.options.foregroundColor):this._cachedFg=void 0),this._cachedFg},enumerable:!1,configurable:!0}),t.prototype.dispose=function(){this._isDisposed||(this._isDisposed=!0,this._onDispose.fire(),e.prototype.dispose.call(this))},t}(c.Disposable)},3730:function(e,t,i){var r=this&&this.__decorate||function(e,t,i,r){var n,o=arguments.length,s=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,r);else for(var a=e.length-1;a>=0;a--)(n=e[a])&&(s=(o<3?n(s):o>3?n(t,i,s):n(t,i))||s);return o>3&&s&&Object.defineProperty(t,i,s),s},n=this&&this.__param||function(e,t){return function(i,r){t(i,r,e)}};Object.defineProperty(t,"__esModule",{value:!0}),t.DirtyRowService=void 0;var o=i(2585),s=function(){function e(e){this._bufferService=e,this.clearRange()}return Object.defineProperty(e.prototype,"start",{get:function(){return this._start},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"end",{get:function(){return this._end},enumerable:!1,configurable:!0}),e.prototype.clearRange=function(){this._start=this._bufferService.buffer.y,this._end=this._bufferService.buffer.y},e.prototype.markDirty=function(e){e<this._start?this._start=e:e>this._end&&(this._end=e)},e.prototype.markRangeDirty=function(e,t){if(e>t){var i=e;e=t,t=i}e<this._start&&(this._start=e),t>this._end&&(this._end=t)},e.prototype.markAllDirty=function(){this.markRangeDirty(0,this._bufferService.rows-1)},r([n(0,o.IBufferService)],e)}();t.DirtyRowService=s},4348:function(e,t,i){var r=this&&this.__values||function(e){var t="function"==typeof Symbol&&Symbol.iterator,i=t&&e[t],r=0;if(i)return i.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},n=this&&this.__read||function(e,t){var i="function"==typeof Symbol&&e[Symbol.iterator];if(!i)return e;var r,n,o=i.call(e),s=[];try{for(;(void 0===t||t-- >0)&&!(r=o.next()).done;)s.push(r.value)}catch(e){n={error:e}}finally{try{r&&!r.done&&(i=o.return)&&i.call(o)}finally{if(n)throw n.error}}return s},o=this&&this.__spreadArray||function(e,t,i){if(i||2===arguments.length)for(var r,n=0,o=t.length;n<o;n++)!r&&n in t||(r||(r=Array.prototype.slice.call(t,0,n)),r[n]=t[n]);return e.concat(r||Array.prototype.slice.call(t))};Object.defineProperty(t,"__esModule",{value:!0}),t.InstantiationService=t.ServiceCollection=void 0;var s=i(2585),a=i(8343),l=function(){function e(){for(var e,t,i=[],o=0;o<arguments.length;o++)i[o]=arguments[o];this._entries=new Map;try{for(var s=r(i),a=s.next();!a.done;a=s.next()){var l=n(a.value,2),c=l[0],d=l[1];this.set(c,d)}}catch(t){e={error:t}}finally{try{a&&!a.done&&(t=s.return)&&t.call(s)}finally{if(e)throw e.error}}}return e.prototype.set=function(e,t){var i=this._entries.get(e);return this._entries.set(e,t),i},e.prototype.forEach=function(e){this._entries.forEach((function(t,i){return e(i,t)}))},e.prototype.has=function(e){return this._entries.has(e)},e.prototype.get=function(e){return this._entries.get(e)},e}();t.ServiceCollection=l;var c=function(){function e(){this._services=new l,this._services.set(s.IInstantiationService,this)}return e.prototype.setService=function(e,t){this._services.set(e,t)},e.prototype.getService=function(e){return this._services.get(e)},e.prototype.createInstance=function(e){for(var t,i,s=[],l=1;l<arguments.length;l++)s[l-1]=arguments[l];var c=(0,a.getServiceDependencies)(e).sort((function(e,t){return e.index-t.index})),d=[];try{for(var h=r(c),p=h.next();!p.done;p=h.next()){var u=p.value,f=this._services.get(u.id);if(!f)throw new Error("[createInstance] "+e.name+" depends on UNKNOWN service "+u.id+".");d.push(f)}}catch(e){t={error:e}}finally{try{p&&!p.done&&(i=h.return)&&i.call(h)}finally{if(t)throw t.error}}var _=c.length>0?c[0].index:s.length;if(s.length!==_)throw new Error("[createInstance] First service dependency of "+e.name+" at position "+(_+1)+" conflicts with "+s.length+" static arguments");return new(e.bind.apply(e,o([void 0],n(o(o([],n(s),!1),n(d),!1)),!1)))},e}();t.InstantiationService=c},7866:function(e,t,i){var r=this&&this.__decorate||function(e,t,i,r){var n,o=arguments.length,s=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,r);else for(var a=e.length-1;a>=0;a--)(n=e[a])&&(s=(o<3?n(s):o>3?n(t,i,s):n(t,i))||s);return o>3&&s&&Object.defineProperty(t,i,s),s},n=this&&this.__param||function(e,t){return function(i,r){t(i,r,e)}},o=this&&this.__read||function(e,t){var i="function"==typeof Symbol&&e[Symbol.iterator];if(!i)return e;var r,n,o=i.call(e),s=[];try{for(;(void 0===t||t-- >0)&&!(r=o.next()).done;)s.push(r.value)}catch(e){n={error:e}}finally{try{r&&!r.done&&(i=o.return)&&i.call(o)}finally{if(n)throw n.error}}return s},s=this&&this.__spreadArray||function(e,t,i){if(i||2===arguments.length)for(var r,n=0,o=t.length;n<o;n++)!r&&n in t||(r||(r=Array.prototype.slice.call(t,0,n)),r[n]=t[n]);return e.concat(r||Array.prototype.slice.call(t))};Object.defineProperty(t,"__esModule",{value:!0}),t.LogService=void 0;var a=i(2585),l={debug:a.LogLevelEnum.DEBUG,info:a.LogLevelEnum.INFO,warn:a.LogLevelEnum.WARN,error:a.LogLevelEnum.ERROR,off:a.LogLevelEnum.OFF},c=function(){function e(e){var t=this;this._optionsService=e,this.logLevel=a.LogLevelEnum.OFF,this._updateLogLevel(),this._optionsService.onOptionChange((function(e){"logLevel"===e&&t._updateLogLevel()}))}return e.prototype._updateLogLevel=function(){this.logLevel=l[this._optionsService.rawOptions.logLevel]},e.prototype._evalLazyOptionalParams=function(e){for(var t=0;t<e.length;t++)"function"==typeof e[t]&&(e[t]=e[t]())},e.prototype._log=function(e,t,i){this._evalLazyOptionalParams(i),e.call.apply(e,s([console,"xterm.js: "+t],o(i),!1))},e.prototype.debug=function(e){for(var t=[],i=1;i<arguments.length;i++)t[i-1]=arguments[i];this.logLevel<=a.LogLevelEnum.DEBUG&&this._log(console.log,e,t)},e.prototype.info=function(e){for(var t=[],i=1;i<arguments.length;i++)t[i-1]=arguments[i];this.logLevel<=a.LogLevelEnum.INFO&&this._log(console.info,e,t)},e.prototype.warn=function(e){for(var t=[],i=1;i<arguments.length;i++)t[i-1]=arguments[i];this.logLevel<=a.LogLevelEnum.WARN&&this._log(console.warn,e,t)},e.prototype.error=function(e){for(var t=[],i=1;i<arguments.length;i++)t[i-1]=arguments[i];this.logLevel<=a.LogLevelEnum.ERROR&&this._log(console.error,e,t)},r([n(0,a.IOptionsService)],e)}();t.LogService=c},7302:function(e,t,i){var r=this&&this.__assign||function(){return r=Object.assign||function(e){for(var t,i=1,r=arguments.length;i<r;i++)for(var n in t=arguments[i])Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e},r.apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0}),t.OptionsService=t.DEFAULT_OPTIONS=t.DEFAULT_BELL_SOUND=void 0;var n=i(8460),o=i(6114);t.DEFAULT_BELL_SOUND="data:audio/mp3;base64,SUQzBAAAAAAAI1RTU0UAAAAPAAADTGF2ZjU4LjMyLjEwNAAAAAAAAAAAAAAA//tQxAADB8AhSmxhIIEVCSiJrDCQBTcu3UrAIwUdkRgQbFAZC1CQEwTJ9mjRvBA4UOLD8nKVOWfh+UlK3z/177OXrfOdKl7pyn3Xf//WreyTRUoAWgBgkOAGbZHBgG1OF6zM82DWbZaUmMBptgQhGjsyYqc9ae9XFz280948NMBWInljyzsNRFLPWdnZGWrddDsjK1unuSrVN9jJsK8KuQtQCtMBjCEtImISdNKJOopIpBFpNSMbIHCSRpRR5iakjTiyzLhchUUBwCgyKiweBv/7UsQbg8isVNoMPMjAAAA0gAAABEVFGmgqK////9bP/6XCykxBTUUzLjEwMKqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqq",t.DEFAULT_OPTIONS={cols:80,rows:24,cursorBlink:!1,cursorStyle:"block",cursorWidth:1,customGlyphs:!0,bellSound:t.DEFAULT_BELL_SOUND,bellStyle:"none",drawBoldTextInBrightColors:!0,fastScrollModifier:"alt",fastScrollSensitivity:5,fontFamily:"courier-new, courier, monospace",fontSize:15,fontWeight:"normal",fontWeightBold:"bold",lineHeight:1,linkTooltipHoverDuration:500,letterSpacing:0,logLevel:"info",scrollback:1e3,scrollSensitivity:1,screenReaderMode:!1,macOptionIsMeta:!1,macOptionClickForcesSelection:!1,minimumContrastRatio:1,disableStdin:!1,allowProposedApi:!0,allowTransparency:!1,tabStopWidth:8,theme:{},rightClickSelectsWord:o.isMac,rendererType:"canvas",windowOptions:{},windowsMode:!1,wordSeparator:" ()[]{}',\"`",altClickMovesCursor:!0,convertEol:!1,termName:"xterm",cancelEvents:!1,overviewRulerWidth:void 0};var s=["normal","bold","100","200","300","400","500","600","700","800","900"],a=function(){function e(e){this._onOptionChange=new n.EventEmitter;var i=r({},t.DEFAULT_OPTIONS);for(var o in e)if(o in i)try{var s=e[o];i[o]=this._sanitizeAndValidateOption(o,s)}catch(e){console.error(e)}this.rawOptions=i,this.options=r({},i),this._setupOptions()}return Object.defineProperty(e.prototype,"onOptionChange",{get:function(){return this._onOptionChange.event},enumerable:!1,configurable:!0}),e.prototype._setupOptions=function(){var e=this,i=function(i){if(!(i in t.DEFAULT_OPTIONS))throw new Error('No option with key "'+i+'"');return e.rawOptions[i]},r=function(i,r){if(!(i in t.DEFAULT_OPTIONS))throw new Error('No option with key "'+i+'"');r=e._sanitizeAndValidateOption(i,r),e.rawOptions[i]!==r&&(e.rawOptions[i]=r,e._onOptionChange.fire(i))};for(var n in this.rawOptions){var o={get:i.bind(this,n),set:r.bind(this,n)};Object.defineProperty(this.options,n,o)}},e.prototype.setOption=function(e,t){this.options[e]=t},e.prototype._sanitizeAndValidateOption=function(e,i){switch(e){case"bellStyle":case"cursorStyle":case"rendererType":case"wordSeparator":i||(i=t.DEFAULT_OPTIONS[e]);break;case"fontWeight":case"fontWeightBold":if("number"==typeof i&&1<=i&&i<=1e3)break;i=s.includes(i)?i:t.DEFAULT_OPTIONS[e];break;case"cursorWidth":i=Math.floor(i);case"lineHeight":case"tabStopWidth":if(i<1)throw new Error(e+" cannot be less than 1, value: "+i);break;case"minimumContrastRatio":i=Math.max(1,Math.min(21,Math.round(10*i)/10));break;case"scrollback":if((i=Math.min(i,4294967295))<0)throw new Error(e+" cannot be less than 0, value: "+i);break;case"fastScrollSensitivity":case"scrollSensitivity":if(i<=0)throw new Error(e+" cannot be less than or equal to 0, value: "+i);case"rows":case"cols":if(!i&&0!==i)throw new Error(e+" must be numeric, value: "+i)}return i},e.prototype.getOption=function(e){return this.options[e]},e}();t.OptionsService=a},8343:(e,t)=>{function i(e,t,i){t.di$target===t?t.di$dependencies.push({id:e,index:i}):(t.di$dependencies=[{id:e,index:i}],t.di$target=t)}Object.defineProperty(t,"__esModule",{value:!0}),t.createDecorator=t.getServiceDependencies=t.serviceRegistry=void 0,t.serviceRegistry=new Map,t.getServiceDependencies=function(e){return e.di$dependencies||[]},t.createDecorator=function(e){if(t.serviceRegistry.has(e))return t.serviceRegistry.get(e);var r=function(e,t,n){if(3!==arguments.length)throw new Error("@IServiceName-decorator can only be used to decorate a parameter");i(r,e,n)};return r.toString=function(){return e},t.serviceRegistry.set(e,r),r}},2585:(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.IDecorationService=t.IUnicodeService=t.IOptionsService=t.ILogService=t.LogLevelEnum=t.IInstantiationService=t.IDirtyRowService=t.ICharsetService=t.ICoreService=t.ICoreMouseService=t.IBufferService=void 0;var r,n=i(8343);t.IBufferService=(0,n.createDecorator)("BufferService"),t.ICoreMouseService=(0,n.createDecorator)("CoreMouseService"),t.ICoreService=(0,n.createDecorator)("CoreService"),t.ICharsetService=(0,n.createDecorator)("CharsetService"),t.IDirtyRowService=(0,n.createDecorator)("DirtyRowService"),t.IInstantiationService=(0,n.createDecorator)("InstantiationService"),(r=t.LogLevelEnum||(t.LogLevelEnum={}))[r.DEBUG=0]="DEBUG",r[r.INFO=1]="INFO",r[r.WARN=2]="WARN",r[r.ERROR=3]="ERROR",r[r.OFF=4]="OFF",t.ILogService=(0,n.createDecorator)("LogService"),t.IOptionsService=(0,n.createDecorator)("OptionsService"),t.IUnicodeService=(0,n.createDecorator)("UnicodeService"),t.IDecorationService=(0,n.createDecorator)("DecorationService")},1480:(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.UnicodeService=void 0;var r=i(8460),n=i(225),o=function(){function e(){this._providers=Object.create(null),this._active="",this._onChange=new r.EventEmitter;var e=new n.UnicodeV6;this.register(e),this._active=e.version,this._activeProvider=e}return Object.defineProperty(e.prototype,"onChange",{get:function(){return this._onChange.event},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"versions",{get:function(){return Object.keys(this._providers)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"activeVersion",{get:function(){return this._active},set:function(e){if(!this._providers[e])throw new Error('unknown Unicode version "'+e+'"');this._active=e,this._activeProvider=this._providers[e],this._onChange.fire(e)},enumerable:!1,configurable:!0}),e.prototype.register=function(e){this._providers[e.version]=e},e.prototype.wcwidth=function(e){return this._activeProvider.wcwidth(e)},e.prototype.getStringCellWidth=function(e){for(var t=0,i=e.length,r=0;r<i;++r){var n=e.charCodeAt(r);if(55296<=n&&n<=56319){if(++r>=i)return t+this.wcwidth(n);var o=e.charCodeAt(r);56320<=o&&o<=57343?n=1024*(n-55296)+o-56320+65536:t+=this.wcwidth(o)}t+=this.wcwidth(n)}return t},e}();t.UnicodeService=o}},t={};return function i(r){var n=t[r];if(void 0!==n)return n.exports;var o=t[r]={exports:{}};return e[r].call(o.exports,o,o.exports,i),o.exports}(4389)})()},7517:()=>{},7839:(e,t,i)=>{"use strict";i.d(t,{d8:()=>u});var r=i(5690),n=i(3978);const o=400,s=100,a=101;class l{constructor(){this._cb={}}on(e,t){this._cb.hasOwnProperty(e)||(this._cb[e]=[]),this._cb[e].push(t)}removeEventListener(e,t){this._cb.hasOwnProperty(e)&&(this._cb[e]=this._cb[e].filter((e=>e!=t)))}emit(e,t){this._cb.hasOwnProperty(e)&&this._cb[e].forEach((e=>e(t)))}}class c extends l{constructor(e,t=null,i=!1){super(),this.connected=i,this.closed=!0,this.remoteAddress=e,this._server=t,this._isServerClient=i,this._heartbeatInterval=null,this.peerID=null,this.responsePort=null,this.nonce=0}async connect(){if(!this._isServerClient&&!this.connected){this.responsePort=this._server.getRandomPort(),this._server.listen(this.responsePort,((...e)=>this.emit("_clMessage",...e)));const e=await this._sendWithAck("connect",{responsePort:this.responsePort});this.connected=!0,this.peerID=e.peerID,this.heartbeat=e.heartbeat,this._heartbeatInterval=setInterval((()=>{this._sendHeartbeat().catch((e=>{this.disconnect(!1,{message:e})}))}),e.heartbeat),this._sendHeartbeat(),this.on("_clMessage",(e=>{if("message"==e.data.type&&this.emit("message",e.data.data),"disconnect"==e.data.type){const{code:t,message:i}=e.data;this.disconnect(!1,{code:t,message:i})}})),this.emit("connect")}}async disconnect(e=!0,t={message:"Client disconnect"}){if(this.connected){if(e)try{await this._connSend("disconnect")}catch(e){}this.connected=!1,this._isServerClient?delete this._server.connections[this.peerID]:(clearInterval(this._heartbeatInterval),this._server.closeCL(this.responsePort),this._server.connections=this._server.connections.filter((e=>e!=this))),this.emit("disconnect",t)}}async _sendHeartbeat(){await this._connSend("heartbeat",{})}_sendWithAck(e,t){const i=this.nonce++;return new Promise((async(r,n)=>{let o;this._isServerClient||(o=setTimeout((()=>n(new Error("Timed out"))),15e3));const s=e=>{e.source==this.remoteAddress.split(":")[0]&&"ack"==e.data.type&&e.data.nonce===i&&(this.removeEventListener("_clMessage",s),e.data.success?(r(e.data),clearTimeout(o)):n(e.data))};this.on("_clMessage",s);try{await this._connSend(e,{...t,nonce:i})}catch(e){this._isServerClient||this._server.closeCL(this.responsePort),n(e)}}))}async _connSend(e,t={}){await this._server.send(this.remoteAddress,{type:e,peerID:this.peerID,...t})}async send(e){await this._sendWithAck("message",{data:e})}}class d extends l{constructor(e,t){super(),this.config={heartbeat:15e3,port:e,...t},this.connections={},this._timeoutInterval=setInterval((()=>{for(const e in this.connections){const t=this.connections[e];Date.now()>t.timeout&&t.socket.disconnect(!0,{message:"Timed out",code:o})}}),this.config.heartbeat)}peerExists(e){return this.connections.hasOwnProperty(e)}_onRawMessage(e){const t=e.data;if("object"!=typeof t)return;const{type:i,args:r,nonce:n}=t;if("string"!=typeof i)return;if("connect"==i){const i=parseInt(t.responsePort,10),r=`${e.source}:${i}`;if(!isNaN(i)){if(Object.values(this.connections).find((e=>e.address===r)))return;const e=u.randomSecret(32),t=new c(r,this,!0);this.connections[e]={address:r,opened:Date.now(),timeout:Date.now()+this.config.heartbeat,receivedFirstHeartbeat:!1,socket:t},this._p3.send(r,{type:"ack",success:!0,code:s,message:"Connection accepted",peerID:e,heartbeat:this.config.heartbeat,nonce:n})}}const{peerID:o}=t;if(this.peerExists(o)){const e=this.connections[o];"heartbeat"==i&&(e.receivedFirstHeartbeat||(e.receivedFirstHeartbeat=!0,super.emit("connection",e.socket)),e.timeout=Date.now()+this.config.heartbeat),"message"==i&&(e.socket.emit("message",t.data),this.send(e.address,{type:"ack",success:!0,nonce:n})),"disconnect"==i&&e.socket.disconnect()}}async send(){await this._p3.send(...arguments)}bind(e){this._p3&&this.unbind(),this._p3=e,this.open()}open(){this._p3.listen(this.config.port,((...e)=>this._onRawMessage(...e)))}close(){if(this._p3){for(const e in this.connections)this.connections[e].socket.disconnect(!0,{message:"Server shutting down",code:a}),delete this.connections[e];this._p3.closeCL(this.config.port)}}unbind(){this._p3&&(this.close(),this._p3=null)}}var h=i(9326);let p={alert:function(e){console.log("[p3]",e)},io:null,getRandomValues:null};class u extends l{constructor(e){super(),e={relayServer:u.RELAY_SERVER,autoconnect:!0,secret:u.randomSecret(),...e},this._params=e;let t=null;"undefined"!=typeof localStorage&&(t=localStorage.getItem("product-key")),e.productKey&&(t=e.productKey);let i=p.io(e.relayServer,{autoConnect:e.autoconnect,reconnection:!0,reconnectionAttempts:4,transportOptions:{polling:{extraHeaders:{Authorization:"Bearer "+JSON.stringify(t)}}}});if(i.on("hello",(e=>{if(!this.connected){if(e.message&&e.success&&p.alert(e.message),!e.success)return this.connecting=!1,this.connected=!1,this.error=!0,void super.emit("error",e);this.error=!1,this._userDisconnect=!1,this.connecting=!1,this.connected=!0,this.address=e.address;for(const e in this.ports){const t=this.ports[e];t.public&&!t._published&&this.socket.emit("port.publish",parseInt(e),t.flags)}super.emit("connect",e)}})),i.on("packet",(e=>{const{port:t,data:i,source:r}=e;this.ports.hasOwnProperty(t)&&this.ports[t].listener({data:i,source:r}),super.emit("_receive")})),i.on("connect",(()=>{i.emit("hello",this.secret)})),i.on("reconnect_error",(()=>{this.attempts++,4===this.attempts&&(this.connecting=!1,this.error=!0,super.emit("error",{success:!1,message:`Connection failed (tried reconnecting ${this.attempts} times)`}))})),i.on("disconnect",(e=>{this.connected=!1,this.address=null,"io client disconnect"!=e&&"io server disconnect"!=e&&(this.connecting=!0);for(const e in this.ports)this.ports[e]._published=!1;super.emit("disconnect")})),"undefined"!=typeof process&&process.on){let e=!1;const t=()=>{e||(e=!0,i.on("disconnect",(()=>{process.exit(0)})),this.disconnect())};process.stdin.resume(),process.on("exit",t),process.on("SIGINT",t),process.on("SIGUSR1",t),process.on("SIGUSR2",t)}this.nonce=0,this.server=e.relayServer,this.socket=i,this.secret=e.secret,this.connected=!1,this.error=!1,this.attempts=0,this.ports={},this.address=null,this.connections=[],e.autoconnect&&(this.connecting=!0)}connect(){return new Promise(((e,t)=>{if((0,h.x)("p3","P3 APIs are no longer supported and may be removed in the future."),this.connected)return e();if(!this.connecting){this.socket.io.uri=this.server,this.connecting=!0,this.attempts=0;let{extraHeaders:e}=this.socket.io.opts.transportOptions.polling,t=null;this._params.productKey||"undefined"==typeof localStorage||(t=localStorage.getItem("product-key")),e.Authorization="Bearer "+JSON.stringify(t),this.socket.connect()}super.on("connect",e),super.on("error",t)}))}disconnect(){this._userDisconnect=!0,this.address=null;for(const e of this.connections)e.disconnect(!0,{reason:"System shutting down"});this.connections=[],this.socket.disconnect()}getRandomPort(){const e=Math.floor(65536*Math.random());return this.ports.hasOwnProperty(e)?this.getRandomPort():e}send(e,t){const i=this.nonce++;return super.emit("_send"),new Promise(((r,n)=>{let o=Date.now();const s=()=>{this.socket.off("packet.ok",a),this.socket.off("packet.err",l)},a=e=>{e.nonce===i&&(s(),r({time:Date.now()-o}))},l=e=>{e.nonce===i&&(s(),n(e.message))};this.socket.emit("packet",{dest:e,nonce:i,data:t}),this.socket.on("packet.ok",a),this.socket.on("packet.err",l)}))}listen(e,t){if("number"!=typeof e)throw new Error("port must be a number");if(this.ports.hasOwnProperty(e))throw new Error("Port already in use");this.ports[e]={listener:t,public:!1,flags:[],_published:!1}}publish(e,t){if(!(t instanceof Array))throw new Error("flags must be a string array");if(!this.ports.hasOwnProperty(e))throw new Error("port doesn't exist");this.socket.emit("port.publish",e,t),this.ports[e]._published=!0,this.ports[e].public=!0,this.ports[e].flags=t}unpublish(e){if(!this.ports.hasOwnProperty(e))throw new Error("port doesn't exist");this.socket.emit("port.remove",e)}closeCL(e){if(!this.ports.hasOwnProperty(e))throw new Error("Port not open");this.ports[e].public&&this.unpublish(e),delete this.ports[e]}discover(e,t=10){const i=this.nonce++;return new Promise(((r,n)=>{const o=()=>{this.socket.off("discover",s),this.socket.off("discover.err",a)},s=(e,t)=>{t===i&&(o(),r(e))},a=(e,t)=>{t===i&&(o(),n(e))};this.socket.on("discover",s),this.socket.on("discover.err",a),this.socket.emit("discover",e,t,i)}))}createServer(e,t){const i=new d(e);return i.on("connection",(e=>{this.connections.push(e),e.on("disconnect",(()=>{this.connections=this.connections.filter((t=>t!==e))})),t(e)})),i.bind(this),i}createConnection(e){const t=new c(e,this,!1);return this.connections.push(t),t.on("disconnect",(()=>{this.connections=this.connections.filter((e=>e!==t))})),t}}u.RELAY_SERVER="wss://p3.windows96.net",u.randomSecret=(e=8)=>{const t=p.getRandomValues(e);return p.base64(Array.from(t).map((e=>String.fromCharCode(e))).join(""))},function(e){p={...p,...e}}({alert:function(e){r.O.alert(n.V.escapeHtml(e),{title:"P3 Server Message"}).wnd.wndObject.classList.add("p3-message")},io:window.io,getRandomValues:e=>window.crypto.getRandomValues(new Uint8Array(e)),base64:e=>btoa(e)})},9703:(e,t,i)=>{"use strict";i.d(t,{Tn:()=>b,_M:()=>y});const r={crv:"P-384",ext:!0,key_ops:["verify"],kty:"EC",x:"9vXP9fOYwmxMrHRHXP2t72z5jz3CDLMsnuVCgCcsmYROEkMvMTTXwax4HVXnlV8M",y:"vuSn6b7pMV_kbigT21K0YAOZmyB8QpGokySVf5EHdPkDkB52p2jbuQn78hDSwDCv"},n=[1628087717008,1635066075997],o={},s=Number.MAX_SAFE_INTEGER||7378697629483821e4,a=function(e){const t=this,i=e||{};if(i.max&&i.length)throw new Error("cannot specify both max and length");for(const e in o)i.hasOwnProperty(e)||(i[e]=o[e]);let r;if(!Array.isArray(i.characters))throw new Error("`characters` option must be an array of string");if(0===i.characters.length)throw new Error("`characters` option cannot be empty");if(r=i.characters[0].length,i.characters.forEach((function(e){if("string"!=typeof e)throw new Error("`characters` option must be an array of string");if(e.length!==r)throw new Error("`characters` options are of inconsistent length: `"+e+"` is not "+r+" characters long")})),i.length&&!Number.isInteger(i.length))throw new Error("`length` option must be an integer");if(i.base&&!Number.isInteger(i.base))throw new Error("`base` option must be an integer");t.characters=i.characters,t.base=i.base||i.characters.length,t.length=i.length||t._findLength(i.max),t.dictStringLength=r};a.prototype._findLength=function(e){const t=this;let i=t.base,r=1;if(!e)return null;for(;i<=e;)r++,i*=t.base;return r},a.prototype._pad=function(e){const t=this;let i=e;for(;t.length&&i.length<t.length;)i=t.characters[0]+i;return i},a.prototype.encode=function(e){const t=this;if("number"!=typeof e)throw new TypeError("value to be encoded must be a number");if(0>e)throw new RangeError("value to be encoded must be positive");let i,r,n=0,o="";do{i=Math.floor(e/Math.pow(t.base,n)),r=i%t.base,o=t.characters[r]+o,n++}while(i!==r);if(null!==t.length&&(o=t._pad(o),o.length>t.length))throw new RangeError("base10 value of "+e+" (encoded: "+o+") exceeds maximum length of "+t.length);return o},a.prototype.decode=function(e){const t=this;let i=e.length,r=0,n=0;for(;0<i;){const o=e.substring(i-t.dictStringLength,i),s=t.characters.indexOf(o);let a;if(a=0<n?Math.pow(t.base,n)*s:s,-1===a)throw new Error("unknown "+o+" encoding string encountered");r+=a,n++,i-=t.dictStringLength}if(r>=s)throw new RangeError("decoded value exceeds Number.MAX_SAFE_INTEGER");return r};const l="----- BEGIN PRODUCT KEY -----",c="------ END PRODUCT KEY ------",d={name:"ECDSA",hash:{name:"SHA-384"}},h="ABCDEFGHJKLMNPRSTUXYZ2345689";let p,u,f=new a({characters:h.split("")});const _=1628071686414;async function g(e=!1){u||(u="undefined"==typeof window?(await Promise.resolve().then(i.t.bind(i,7517,19))).webcrypto.subtle:window.crypto.subtle),e&&!p&&(p=await async function(e,t){return await g(),u.importKey("jwk",e,{name:"ECDSA",namedCurve:"P-384"},!1,[t])}(r,"verify"))}function m(e,t=!1){let i=[];e=(e=e.replace(/[\s-]/g,"")).match(new RegExp(".{1,2}","g"));for(let r of e){let e;try{e=f.decode(r)}catch(e){return null}t?i.push(String.fromCharCode(e)):i.push(e)}return t?i.join(""):new Uint8Array(i)}async function b(e){let t;await g(!0),e=e.replace(l,"").replace(c,"");let[i,r]=e.split(".");if(!i||!i.trim())return{valid:!1,reason:"Key data missing",data:null};if(!r||!r.trim())return{valid:!1,reason:"Key signature missing",data:null};let o=m(i.trim(),!0);try{t=JSON.parse("{"+o+"}")}catch(e){return{valid:!1,reason:`Key JSON parse failed (${e})`,data:null}}r=m(r.trim());let s=(new TextEncoder).encode(o);if(!r||!await u.verify(d,p,r,s))return{valid:!1,reason:"Invalid signature",data:null};if(t.v<1)return{valid:!1,reason:`V${t.v} keys are no longer supported.`};if(!t.createdOn)return{valid:!1,reason:"Missing key creation date",data:t};if(!t.owner)return{valid:!1,reason:"Missing key owner",data:t};if(t.createdOn+=_,n.includes(t.createdOn))return{valid:!1,reason:"Key has been revoked",data:t};switch(t.type){case"timer":if(t.validUntil+=_,Date.now()>t.validUntil)return{valid:!1,reason:"Key has expired",data:t};break;case"local":if("undefined"==typeof window)return{valid:!1,reason:"This key cannot be used on servers",data:t};break;case"infinite":break;default:return{valid:!1,reason:`Unknown key type '${t.type}'`,data:t}}return{valid:!0,data:t}}async function y(){return"undefined"!=typeof window&&localStorage.getItem("product-key")?await b(localStorage.getItem("product-key")):null}}},__webpack_module_cache__={},leafPrototypes,getProto;function __webpack_require__(e){var t=__webpack_module_cache__[e];if(void 0!==t)return t.exports;var i=__webpack_module_cache__[e]={id:e,loaded:!1,exports:{}};return __webpack_modules__[e].call(i.exports,i,i.exports,__webpack_require__),i.loaded=!0,i.exports}__webpack_require__.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return __webpack_require__.d(t,{a:t}),t},getProto=Object.getPrototypeOf?e=>Object.getPrototypeOf(e):e=>e.__proto__,__webpack_require__.t=function(e,t){if(1&t&&(e=this(e)),8&t)return e;if("object"==typeof e&&e){if(4&t&&e.__esModule)return e;if(16&t&&"function"==typeof e.then)return e}var i=Object.create(null);__webpack_require__.r(i);var r={};leafPrototypes=leafPrototypes||[null,getProto({}),getProto([]),getProto(getProto)];for(var n=2&t&&e;"object"==typeof n&&!~leafPrototypes.indexOf(n);n=getProto(n))Object.getOwnPropertyNames(n).forEach((t=>r[t]=()=>e[t]));return r.default=()=>e,__webpack_require__.d(i,r),i},__webpack_require__.d=(e,t)=>{for(var i in t)__webpack_require__.o(t,i)&&!__webpack_require__.o(e,i)&&Object.defineProperty(e,i,{enumerable:!0,get:t[i]})},__webpack_require__.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),__webpack_require__.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),__webpack_require__.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},__webpack_require__.nmd=e=>(e.paths=[],e.children||(e.children=[]),e),__webpack_require__.nc=void 0;var __webpack_exports__=__webpack_require__(845)})();